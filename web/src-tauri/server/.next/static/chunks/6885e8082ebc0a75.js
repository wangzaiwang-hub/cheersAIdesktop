(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,598500,e=>{e.v({avatar:"style-module__12l82a__avatar","dot-flashing":"style-module__12l82a__dot-flashing","dot-flashing-avatar":"style-module__12l82a__dot-flashing-avatar",text:"style-module__12l82a__text"})},925818,e=>{"use strict";var t=e.i(563199),s=e.i(268255),r=e.i(935139),a=e.i(598500);let i=s.memo(e=>{let{type:s}=e;return(0,t.jsx)("div",{className:(0,r.cn)(a.default["dot-flashing"],a.default[s])})});e.s(["default",0,i])},933548,e=>{"use strict";var t=e.i(367916);e.s(["fetchAgentLogDetail",0,e=>{let{appID:s,params:r}=e;return(0,t.get)(`/apps/${s}/agent/logs`,{params:r})},"fetchChatMessages",0,e=>{let{url:s,params:r}=e;return(0,t.get)(s,{params:r})},"fetchRunDetail",0,e=>(0,t.get)(e),"fetchTracingList",0,e=>{let{url:s}=e;return(0,t.get)(s)},"updateLogMessageAnnotations",0,e=>{let{url:s,body:r}=e;return(0,t.post)(s,{body:r})},"updateLogMessageFeedbacks",0,e=>{let{url:s,body:r}=e;return(0,t.post)(s,{body:r})}])},344595,e=>{"use strict";var t=e.i(563199),s=e.i(268255);e.i(152567);var r=e.i(408767),a=e.i(339548),i=e.i(449980),l=e.i(137667),n=e.i(390622),o=e.i(933548),u=e.i(935139);e.i(275225);var d=e.i(705405),c=e.i(925818);e.i(237855);var p=e.i(297162),x=e.i(223314),f=e.i(379415),b=e.i(481162),m=e.i(955371),y=e.i(51828);let g=e=>{let{isRunning:r,outputs:a,error:i,height:l}=e,n=(0,s.useMemo)(()=>{if(!a||"object"!=typeof a)return!1;let e=Object.keys(a),t=a[e[0]];return 1===e.length&&("string"==typeof t||Array.isArray(t)&&t.every(e=>"string"==typeof e))},[a]),o=(0,s.useMemo)(()=>{let e=[];if(!a||Object.keys(a).length>1)return e;for(let t in a)Array.isArray(a[t])?a[t].map(t=>(t?.dify_model_identity==="__dify__file__"&&e.push(t),null)):a[t]?.dify_model_identity==="__dify__file__"&&e.push(a[t]);return(0,x.getProcessedFilesFromResponse)(e)},[a]);return(0,t.jsxs)("div",{className:"p-2",children:[r&&(0,t.jsx)("div",{className:"pl-[26px] pt-4",children:(0,t.jsx)(c.default,{type:"text"})}),!r&&i&&(0,t.jsx)("div",{className:"px-4",children:(0,t.jsx)(y.default,{status:"failed",children:i})}),!r&&!a&&(0,t.jsx)("div",{className:"px-4 py-2",children:(0,t.jsx)(f.Markdown,{content:"No Output"})}),n&&(0,t.jsx)("div",{className:"px-4 py-2",children:(0,t.jsx)(f.Markdown,{content:Array.isArray(a[Object.keys(a)[0]])?a[Object.keys(a)[0]].join("\n"):a[Object.keys(a)[0]]||""})}),o.length>0&&(0,t.jsx)("div",{className:"px-4 py-2",children:(0,t.jsx)(p.FileList,{files:o,showDeleteAction:!1,showDownloadAction:!0,canPreview:!0})}),!n&&a&&Object.keys(a).length>0&&l>0&&(0,t.jsx)("div",{className:"flex flex-col gap-2",children:(0,t.jsx)(b.default,{showFileList:!0,readOnly:!0,title:(0,t.jsx)("div",{tabIndex:0,children:"Output"}),language:m.CodeLanguage.json,value:JSON.stringify(a,null,2),isJSONStringifyBeauty:!0,height:l?(l-16)/2:void 0})})]})};var _=e.i(739780),h=e.i(40720),v=e.i(567898);e.s(["default",0,e=>{let{hideResult:c,activeTab:p="RESULT",getResultCallback:x,runDetailUrl:f,tracingListUrl:b}=e,{t:m}=(0,r.useTranslation)(),{notify:y}=(0,a.useContext)(l.ToastContext),[j,k]=(0,s.useState)(p),[w,L]=(0,s.useState)(!0),[N,T]=(0,s.useState)(),[A,R]=(0,s.useState)([]),C=(0,d.useStore)(e=>e.isListening),S=(0,s.useMemo)(()=>N?.created_by_role==="account"?N.created_by_account?.name||"":N?.created_by_role==="end_user"?N.created_by_end_user?.session_id||"":"N/A",[N]),E=(0,s.useCallback)(async()=>{try{let e=await (0,o.fetchRunDetail)(f);T(e),x&&x(e)}catch(e){y({type:"error",message:`${e}`})}},[y,x,f]),O=(0,s.useCallback)(async()=>{try{let{data:e}=await (0,o.fetchTracingList)({url:b});R(e)}catch(e){y({type:"error",message:`${e}`})}},[y,b]),U=(0,s.useCallback)(async()=>{L(!0),await E(),await O(),L(!1)},[E,O]),D=async e=>{k(e),"RESULT"===e&&f&&await E(),b&&await O()};(0,s.useEffect)(()=>{C&&k("DETAIL")},[C]),(0,s.useEffect)(()=>{f&&b&&U()},[f,b]);let[I,M]=(0,s.useState)(0),F=(0,s.useRef)(null);return(0,s.useEffect)(()=>{F.current&&M(F.current?.clientHeight-16-16-2-1)},[w]),(0,t.jsxs)("div",{className:"relative flex grow flex-col",children:[(0,t.jsxs)("div",{className:"flex shrink-0 items-center border-b-[0.5px] border-divider-subtle px-4",children:[!c&&(0,t.jsx)("div",{className:(0,u.cn)("system-sm-semibold-uppercase mr-6 cursor-pointer border-b-2 border-transparent py-3 text-text-tertiary","RESULT"===j&&"!border-util-colors-blue-brand-blue-brand-600 text-text-primary"),onClick:()=>D("RESULT"),children:m("result",{ns:"runLog"})}),(0,t.jsx)("div",{className:(0,u.cn)("system-sm-semibold-uppercase mr-6 cursor-pointer border-b-2 border-transparent py-3 text-text-tertiary","DETAIL"===j&&"!border-util-colors-blue-brand-blue-brand-600 text-text-primary"),onClick:()=>D("DETAIL"),children:m("detail",{ns:"runLog"})}),(0,t.jsx)("div",{className:(0,u.cn)("system-sm-semibold-uppercase mr-6 cursor-pointer border-b-2 border-transparent py-3 text-text-tertiary","TRACING"===j&&"!border-util-colors-blue-brand-blue-brand-600 text-text-primary"),onClick:()=>D("TRACING"),children:m("tracing",{ns:"runLog"})})]}),(0,t.jsxs)("div",{ref:F,className:(0,u.cn)("relative h-0 grow overflow-y-auto rounded-b-xl bg-components-panel-bg"),children:[w&&(0,t.jsx)("div",{className:"flex h-full items-center justify-center bg-components-panel-bg",children:(0,t.jsx)(i.default,{})}),!w&&"RESULT"===j&&N&&(0,t.jsx)(g,{outputs:N.outputs,error:N.error,height:I}),!w&&"DETAIL"===j&&N&&(0,t.jsx)(_.default,{inputs:N.inputs,inputs_truncated:N.inputs_truncated,outputs:N.outputs,outputs_truncated:N.outputs_truncated,outputs_full_content:N.outputs_full_content,status:N.status,error:N.error,elapsed_time:N.elapsed_time,total_tokens:N.total_tokens,created_at:N.created_at,created_by:S,steps:N.total_steps,exceptionCounts:N.exceptions_count,isListening:C}),!w&&"DETAIL"===j&&!N&&C&&(0,t.jsx)(h.default,{status:n.WorkflowRunningStatus.Running,isListening:!0}),!w&&"TRACING"===j&&(0,t.jsx)(v.default,{className:"bg-background-section-burn",list:A})]})]})}],344595)},412962,e=>{"use strict";var t=e.i(563199),s=e.i(268255);e.i(845780);var r=e.i(856105);e.i(491401);var a=e.i(585736),i=e.i(344595);e.i(275225);var l=e.i(705405);e.i(905691);var n=e.i(706416);let o=(0,s.memo)(()=>{let e=(0,l.useStore)(e=>e.historyWorkflowData),{handleUpdateWorkflowCanvas:o}=(0,r.useWorkflowUpdate)(),u=(0,a.useHooksStore)(e=>e.getWorkflowRunAndTraceUrl),d=(0,s.useCallback)(e=>{let t=e.graph;o({nodes:t.nodes,edges:t.edges,viewport:t.viewport||{x:0,y:0,zoom:1}})},[o]);return(0,t.jsxs)("div",{className:"flex h-full w-[400px] flex-col rounded-l-2xl border-[0.5px] border-components-panel-border bg-components-panel-bg shadow-xl",children:[(0,t.jsx)("div",{className:"system-xl-semibold flex items-center justify-between p-4 pb-0 text-text-primary",children:`Test Run${(0,n.formatWorkflowRunIdentifier)(e?.finished_at)}`}),(0,t.jsx)(i.default,{runDetailUrl:u(e?.id).runUrl,tracingListUrl:u(e?.id).traceUrl,getResultCallback:d})]})});e.s(["default",0,o])},689516,e=>{e.n(e.i(412962))}]);