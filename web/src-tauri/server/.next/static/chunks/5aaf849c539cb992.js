(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,893185,e=>{"use strict";var a=e.i(268255),l=e.i(192447),i=e.i(908432);e.i(275225);var t=e.i(705405);e.s(["useFloatingRight",0,e=>{let[n,r]=(0,a.useState)(!1),p=(0,t.useStore)(e=>e.nodePanelWidth),o=(0,t.useStore)(e=>e.workflowCanvasWidth),s=(0,t.useStore)(e=>e.otherPanelWidth),u=(0,l.useStore)((0,i.useShallow)(e=>{let a=e.getNodes().find(e=>e.data.selected);if(a)return a.id}));(0,a.useEffect)(()=>{"number"==typeof o&&r(o-(u?p:0)-s-400-4<e+4)},[o,p,s,u,e]);let d=(0,a.useMemo)(()=>n?Math.min(e,(u?p:0)+s):e,[n,u,p,s,e]);return{floatingRight:n,floatingRightWidth:d}}])},256663,e=>{"use strict";var a,l=e.i(563199),i=e.i(837699),t=e.i(268255);e.i(152567);var n=e.i(408767),r=e.i(935139),p=e.i(893185),o=e.i(151094),s=e.i(757198),u=e.i(773934),d=e.i(634440),b=e.i(137667),g=e.i(390622),h=e.i(652669),c=e.i(888468),m=((a={}).textInput="textInput",a.numberInput="numberInput",a.numberSlider="numberSlider",a.checkbox="checkbox",a.options="options",a.select="select",a.inputTypeSelect="inputTypeSelect",a.uploadMethod="uploadMethod",a.fileTypes="fileTypes",a);let f=e=>{let{initialData:a,config:i}=e;return(0,d.withForm)({defaultValues:a,render:function(e){let{form:a}=e,{type:t,label:n,placeholder:r,variable:p,tooltip:o,showConditions:s,max:u,min:d,required:b,showOptional:g,supportFile:h,description:f,options:v,listeners:y,popupProps:x}=i;return(0,c.useStore)(a.store,e=>{let a=e.values;return s.every(e=>{let{variable:l,value:i}=e;return a[l]===i})})?t===m.textInput?(0,l.jsx)(a.AppField,{name:p,listeners:y,children:e=>(0,l.jsx)(e.TextField,{label:n,labelOptions:{tooltip:o,isRequired:b,showOptional:g},placeholder:r})}):t===m.numberInput?(0,l.jsx)(a.AppField,{name:p,children:e=>(0,l.jsx)(e.NumberInputField,{label:n,labelOptions:{tooltip:o,isRequired:b,showOptional:g},placeholder:r,max:u,min:d})}):t===m.numberSlider?(0,l.jsx)(a.AppField,{name:p,children:e=>(0,l.jsx)(e.NumberSliderField,{label:n,labelOptions:{tooltip:o,isRequired:b,showOptional:g},description:f,max:u,min:d})}):t===m.checkbox?(0,l.jsx)(a.AppField,{name:p,children:e=>(0,l.jsx)(e.CheckboxField,{label:n})}):t===m.select?(0,l.jsx)(a.AppField,{name:p,children:e=>(0,l.jsx)(e.SelectField,{label:n,labelOptions:{tooltip:o,isRequired:b,showOptional:g},options:v,popupProps:x})}):t===m.inputTypeSelect?(0,l.jsx)(a.AppField,{name:p,listeners:y,children:e=>(0,l.jsx)(e.InputTypeSelectField,{label:n,labelOptions:{tooltip:o,isRequired:b,showOptional:g},supportFile:!!h})}):t===m.uploadMethod?(0,l.jsx)(a.AppField,{name:p,children:e=>(0,l.jsx)(e.UploadMethodField,{label:n,labelOptions:{tooltip:o,isRequired:b,showOptional:g}})}):t===m.fileTypes?(0,l.jsx)(a.AppField,{name:p,children:e=>(0,l.jsx)(e.FileTypesField,{label:n,labelOptions:{tooltip:o,isRequired:b,showOptional:g}})}):t===m.options?(0,l.jsx)(a.AppField,{name:p,children:e=>(0,l.jsx)(e.OptionsField,{label:n,labelOptions:{tooltip:o,isRequired:b,showOptional:g}})}):(0,l.jsx)(l.Fragment,{}):(0,l.jsx)(l.Fragment,{})}})};var v=e.i(959752),y=e.i(654537),x=e.i(128984),C=e.i(832356),T=e.i(196402),F=e.i(925521);let w=C.z.enum(["all","local_file","remote_url"]),D=C.z.enum(["image","document","video","audio","custom"]),I=e=>{let{initialData:a,supportFile:r=!1,onCancel:p,onSubmit:I,isEditMode:P=!0}=e,{t:j}=(0,n.useTranslation)(),{data:V}=(0,h.useFileUploadConfig)(),{maxFileUploadLimit:z}=(0,u.useFileSizeLimit)(V),S=(0,d.useAppForm)({defaultValues:a,validators:{onSubmit:e=>{let{value:a}=e,{type:l}=a,i=((e,a,l)=>{let{maxFileUploadLimit:i}=l,t=C.z.object({type:T.InputTypeEnum,variable:C.z.string().nonempty({message:a("varKeyError.canNoBeEmpty",{ns:"appDebug",key:a("variableConfig.varName",{ns:"appDebug"})})}).max(F.MAX_VAR_KEY_LENGTH,{message:a("varKeyError.tooLong",{ns:"appDebug",key:a("variableConfig.varName",{ns:"appDebug"})})}).regex(/^(?!\d)\w+/,{message:a("varKeyError.notStartWithNumber",{ns:"appDebug",key:a("variableConfig.varName",{ns:"appDebug"})})}).regex(/^[a-z_]\w{0,29}$/i,{message:a("varKeyError.notValid",{ns:"appDebug",key:a("variableConfig.varName",{ns:"appDebug"})})}),label:C.z.string().nonempty({message:a("variableConfig.errorMsg.labelNameRequired",{ns:"appDebug"})}),required:C.z.boolean(),tooltips:C.z.string().optional()});return e===y.PipelineInputVarType.textInput||e===y.PipelineInputVarType.paragraph?C.z.object({maxLength:C.z.number().min(1).max(256),default:C.z.string().optional()}).merge(t).passthrough():e===y.PipelineInputVarType.number?C.z.object({default:C.z.number().optional(),unit:C.z.string().optional(),placeholder:C.z.string().optional()}).merge(t).passthrough():e===y.PipelineInputVarType.select?C.z.object({options:C.z.array(C.z.string()).nonempty({message:a("variableConfig.errorMsg.atLeastOneOption",{ns:"appDebug"})}).refine(e=>new Set(e).size===e.length,{message:a("variableConfig.errorMsg.optionRepeat",{ns:"appDebug"})}),default:C.z.string().optional()}).merge(t).passthrough():e===y.PipelineInputVarType.singleFile?C.z.object({allowedFileUploadMethods:C.z.array(w),allowedTypesAndExtensions:C.z.object({allowedFileExtensions:C.z.array(C.z.string()).optional(),allowedFileTypes:C.z.array(D)})}).merge(t).passthrough():e===y.PipelineInputVarType.multiFiles?C.z.object({allowedFileUploadMethods:C.z.array(w),allowedTypesAndExtensions:C.z.object({allowedFileExtensions:C.z.array(C.z.string()).optional(),allowedFileTypes:C.z.array(D)}),maxLength:C.z.number().min(1).max(i)}).merge(t).passthrough():t.passthrough()})(l,j,{maxFileUploadLimit:z}).safeParse(a);if(!i.success){let e=i.error.issues[0],a=`"${e.path.join(".")}" ${e.message}`;return b.default.notify({type:"error",message:a}),a}}},onSubmit:e=>{let l,{value:i}=e;P&&i.variable!==a?.variable&&(l={type:g.ChangeType.changeVarName,payload:{beforeKey:a?.variable||"",afterKey:i.variable}}),I(i,l)}}),[E,_]=(0,t.useState)(!1),A=(e=>{let{initialData:a,supportFile:i}=e;return(0,d.withForm)({defaultValues:a,render:function(e){let{form:r}=e,p=(e=>{let{t:a}=(0,n.useTranslation)(),{getFieldValue:l,setFieldValue:i,supportFile:r}=e,p=(0,t.useCallback)(e=>{[y.PipelineInputVarType.singleFile,y.PipelineInputVarType.multiFiles].includes(e)&&(i("allowedFileUploadMethods",v.DEFAULT_FILE_UPLOAD_SETTING.allowed_file_upload_methods),i("allowedTypesAndExtensions",{allowedFileTypes:v.DEFAULT_FILE_UPLOAD_SETTING.allowed_file_types,allowedFileExtensions:v.DEFAULT_FILE_UPLOAD_SETTING.allowed_file_extensions}),e===y.PipelineInputVarType.multiFiles&&i("maxLength",v.DEFAULT_FILE_UPLOAD_SETTING.max_length))},[i]),o=(0,t.useCallback)(e=>{let a=l("label");e&&!a&&i("label",e)},[l,i]),s=(0,t.useCallback)(e=>{e||i("label",l("variable"))},[l,i]);return(0,t.useMemo)(()=>[{type:m.inputTypeSelect,label:a("variableConfig.fieldType",{ns:"appDebug"}),variable:"type",required:!0,showConditions:[],listeners:{onChange:e=>{let{value:a}=e;return p(a)}},supportFile:r},{type:m.textInput,label:a("variableConfig.varName",{ns:"appDebug"}),variable:"variable",placeholder:a("variableConfig.inputPlaceholder",{ns:"appDebug"}),required:!0,listeners:{onBlur:e=>{let{value:a}=e;return o(a)}},showConditions:[]},{type:m.textInput,label:a("variableConfig.displayName",{ns:"appDebug"}),variable:"label",placeholder:a("variableConfig.inputPlaceholder",{ns:"appDebug"}),required:!1,listeners:{onBlur:e=>{let{value:a}=e;return s(a)}},showConditions:[]},{type:m.numberInput,label:a("variableConfig.maxLength",{ns:"appDebug"}),variable:"maxLength",placeholder:a("variableConfig.inputPlaceholder",{ns:"appDebug"}),required:!0,showConditions:[{variable:"type",value:y.PipelineInputVarType.textInput}],min:1,max:256},{type:m.options,label:a("variableConfig.options",{ns:"appDebug"}),variable:"options",required:!0,showConditions:[{variable:"type",value:y.PipelineInputVarType.select}]},{type:m.fileTypes,label:a("variableConfig.file.supportFileTypes",{ns:"appDebug"}),variable:"allowedTypesAndExtensions",required:!0,showConditions:[{variable:"type",value:y.PipelineInputVarType.singleFile}]},{type:m.fileTypes,label:a("variableConfig.file.supportFileTypes",{ns:"appDebug"}),variable:"allowedTypesAndExtensions",required:!0,showConditions:[{variable:"type",value:y.PipelineInputVarType.multiFiles}]},{type:m.checkbox,label:a("variableConfig.required",{ns:"appDebug"}),variable:"required",required:!0,showConditions:[]}],[a,r,p,o,s])})({getFieldValue:(0,t.useCallback)(e=>r.getFieldValue(e),[r]),setFieldValue:(0,t.useCallback)((e,a)=>{r.setFieldValue(e,a)},[r]),supportFile:i});return(0,l.jsx)(l.Fragment,{children:p.map((e,i)=>{let t=f({initialData:a,config:e});return(0,l.jsx)(t,{form:r},i)})})}})})({initialData:a,supportFile:r}),N=(e=>{let{initialData:a}=e;return(0,d.withForm)({defaultValues:a,render:function(e){let{form:i}=e,r=(e=>{let{t:a}=(0,n.useTranslation)(),{options:l}=e,{data:i}=(0,h.useFileUploadConfig)(),{imgSizeLimit:r,docSizeLimit:p,audioSizeLimit:o,videoSizeLimit:s}=(0,u.useFileSizeLimit)(i),d=(0,t.useMemo)(()=>l?[{value:"",label:a("variableConfig.noDefaultSelected",{ns:"appDebug"})},...l.map(e=>({value:e,label:e}))]:[],[l,a]);return(0,t.useMemo)(()=>[{type:m.textInput,label:a("variableConfig.defaultValue",{ns:"appDebug"}),variable:"default",placeholder:a("variableConfig.defaultValuePlaceholder",{ns:"appDebug"}),required:!1,showConditions:[{variable:"type",value:y.PipelineInputVarType.textInput}],showOptional:!0},{type:m.textInput,label:a("variableConfig.defaultValue",{ns:"appDebug"}),variable:"default",placeholder:a("variableConfig.defaultValuePlaceholder",{ns:"appDebug"}),required:!1,showConditions:[{variable:"type",value:y.PipelineInputVarType.paragraph}],showOptional:!0},{type:m.numberInput,label:a("variableConfig.defaultValue",{ns:"appDebug"}),variable:"default",placeholder:a("variableConfig.defaultValuePlaceholder",{ns:"appDebug"}),required:!1,showConditions:[{variable:"type",value:y.PipelineInputVarType.number}],showOptional:!0},{type:m.select,label:a("variableConfig.startSelectedOption",{ns:"appDebug"}),variable:"default",required:!1,showConditions:[{variable:"type",value:y.PipelineInputVarType.select}],showOptional:!0,options:d,popupProps:{wrapperClassName:"z-40"}},{type:m.checkbox,label:a("variableConfig.startChecked",{ns:"appDebug"}),variable:"default",required:!1,showConditions:[{variable:"type",value:y.PipelineInputVarType.checkbox}]},{type:m.textInput,label:a("variableConfig.placeholder",{ns:"appDebug"}),variable:"placeholder",placeholder:a("variableConfig.placeholderPlaceholder",{ns:"appDebug"}),required:!1,showConditions:[{variable:"type",value:y.PipelineInputVarType.textInput}],showOptional:!0},{type:m.textInput,label:a("variableConfig.placeholder",{ns:"appDebug"}),variable:"placeholder",placeholder:a("variableConfig.placeholderPlaceholder",{ns:"appDebug"}),required:!1,showConditions:[{variable:"type",value:y.PipelineInputVarType.paragraph}],showOptional:!0},{type:m.textInput,label:a("variableConfig.unit",{ns:"appDebug"}),variable:"unit",placeholder:a("variableConfig.unitPlaceholder",{ns:"appDebug"}),required:!1,showConditions:[{variable:"type",value:y.PipelineInputVarType.number}],showOptional:!0},{type:m.textInput,label:a("variableConfig.placeholder",{ns:"appDebug"}),variable:"placeholder",placeholder:a("variableConfig.placeholderPlaceholder",{ns:"appDebug"}),required:!1,showConditions:[{variable:"type",value:y.PipelineInputVarType.number}],showOptional:!0},{type:m.uploadMethod,label:a("variableConfig.uploadFileTypes",{ns:"appDebug"}),variable:"allowedFileUploadMethods",required:!1,showConditions:[{variable:"type",value:y.PipelineInputVarType.singleFile}]},{type:m.uploadMethod,label:a("variableConfig.uploadFileTypes",{ns:"appDebug"}),variable:"allowedFileUploadMethods",required:!1,showConditions:[{variable:"type",value:y.PipelineInputVarType.multiFiles}]},{type:m.numberSlider,label:a("variableConfig.maxNumberOfUploads",{ns:"appDebug"}),variable:"maxLength",required:!1,showConditions:[{variable:"type",value:y.PipelineInputVarType.multiFiles}],description:a("variableConfig.maxNumberTip",{ns:"appDebug",imgLimit:(0,x.formatFileSize)(r),docLimit:(0,x.formatFileSize)(p),audioLimit:(0,x.formatFileSize)(o),videoLimit:(0,x.formatFileSize)(s)})},{type:m.textInput,label:a("variableConfig.tooltips",{ns:"appDebug"}),variable:"tooltips",required:!1,showConditions:[],showOptional:!0}],[d,r,p,o,s,a])})({options:(0,c.useStore)(i.store,e=>e.values.options)});return(0,l.jsx)(l.Fragment,{children:r.map((e,t)=>{let n=f({initialData:a,config:e});return(0,l.jsx)(n,{form:i},t)})})}})})({initialData:a}),q=(e=>{let{initialData:a,handleShowAllSettings:r}=e;return(0,d.withForm)({defaultValues:a,render:function(e){let{form:a}=e,{t:p}=(0,n.useTranslation)(),o=(e=>{let{t:a}=(0,n.useTranslation)();return(0,t.useMemo)(()=>{let l=[];switch(e){case y.PipelineInputVarType.textInput:case y.PipelineInputVarType.paragraph:l=[a("variableConfig.defaultValue",{ns:"appDebug"}),a("variableConfig.placeholder",{ns:"appDebug"}),a("variableConfig.tooltips",{ns:"appDebug"})];break;case y.PipelineInputVarType.number:l=[a("variableConfig.defaultValue",{ns:"appDebug"}),a("variableConfig.unit",{ns:"appDebug"}),a("variableConfig.placeholder",{ns:"appDebug"}),a("variableConfig.tooltips",{ns:"appDebug"})];break;case y.PipelineInputVarType.select:l=[a("variableConfig.defaultValue",{ns:"appDebug"}),a("variableConfig.tooltips",{ns:"appDebug"})];break;case y.PipelineInputVarType.singleFile:l=[a("variableConfig.uploadMethod",{ns:"appDebug"}),a("variableConfig.tooltips",{ns:"appDebug"})];break;case y.PipelineInputVarType.multiFiles:l=[a("variableConfig.uploadMethod",{ns:"appDebug"}),a("variableConfig.maxNumberOfUploads",{ns:"appDebug"}),a("variableConfig.tooltips",{ns:"appDebug"})];break;case y.PipelineInputVarType.checkbox:l=[a("variableConfig.startChecked",{ns:"appDebug"}),a("variableConfig.tooltips",{ns:"appDebug"})];break;default:l=[a("variableConfig.tooltips",{ns:"appDebug"})]}return l.map(e=>e.toLowerCase()).join(", ")},[e,a])})((0,c.useStore)(a.store,e=>e.values.type));return(0,l.jsxs)("div",{className:"flex cursor-pointer items-center gap-x-4",onClick:r,children:[(0,l.jsxs)("div",{className:"flex grow flex-col",children:[(0,l.jsx)("span",{className:"system-sm-medium flex min-h-6 items-center text-text-secondary",children:p("variableConfig.showAllSettings",{ns:"appDebug"})}),(0,l.jsx)("span",{className:"body-xs-regular pb-0.5 text-text-tertiary first-letter:capitalize",children:o})]}),(0,l.jsx)(i.RiArrowRightSLine,{className:"h-4 w-4 shrink-0 text-text-secondary"})]})}})})({initialData:a,handleShowAllSettings:(0,t.useCallback)(()=>{_(!0)},[])});return(0,l.jsxs)("form",{className:"w-full",onSubmit:e=>{e.preventDefault(),e.stopPropagation(),S.handleSubmit()},children:[(0,l.jsxs)("div",{className:"flex flex-col gap-4 px-4 py-2",children:[(0,l.jsx)(A,{form:S}),(0,l.jsx)(s.default,{type:"horizontal"}),!E&&(0,l.jsx)(q,{form:S}),E&&(0,l.jsx)(N,{form:S})]}),(0,l.jsxs)("div",{className:"flex items-center justify-end gap-x-2 p-4 pt-2",children:[(0,l.jsx)(o.default,{variant:"secondary",onClick:p,children:j("operation.cancel",{ns:"common"})}),(0,l.jsx)(S.AppForm,{children:(0,l.jsx)(S.Actions,{})})]})]})};e.s(["default",0,e=>{let{onClose:a,onSubmit:o,initialData:s}=e,{t:u}=(0,n.useTranslation)(),{floatingRight:d,floatingRightWidth:b}=(0,p.useFloatingRight)(400),g=(0,t.useMemo)(()=>(e=>{let{type:a,label:l,variable:i,max_length:t,default_value:n,required:r,tooltips:p,options:o,placeholder:s,unit:u,allowed_file_upload_methods:d,allowed_file_types:b,allowed_file_extensions:g}=e||{...F.VAR_ITEM_TEMPLATE_IN_PIPELINE},h={type:a,label:l,variable:i,maxLength:t,required:r,options:o,allowedTypesAndExtensions:{}};return null!=n&&(h.default=n),null!=p&&(h.tooltips=p),null!=s&&(h.placeholder=s),null!=u&&(h.unit=u),d&&(h.allowedFileUploadMethods=d),b&&g&&(h.allowedTypesAndExtensions={allowedFileTypes:b,allowedFileExtensions:g}),h})(s),[s]),h=(0,t.useCallback)((e,a)=>{o((e=>{let{type:a,label:l,variable:i,maxLength:t,default:n,required:r,tooltips:p,options:o,placeholder:s,unit:u,allowedFileUploadMethods:d,allowedTypesAndExtensions:{allowedFileTypes:b,allowedFileExtensions:g}}=e;return{type:a,label:l,variable:i,max_length:t,default_value:n,required:r,tooltips:p,options:o,placeholder:s,unit:u,allowed_file_upload_methods:d,allowed_file_types:b,allowed_file_extensions:g}})(e),a)},[o]);return(0,l.jsxs)("div",{className:(0,r.cn)("relative mr-1 flex h-fit max-h-full w-[400px] flex-col overflow-y-auto rounded-2xl border-[0.5px] border-components-panel-border bg-components-panel-bg shadow-2xl shadow-shadow-shadow-9","transition-all duration-300 ease-in-out",d&&"absolute right-0 z-[100]"),style:{width:`${b}px`},children:[(0,l.jsx)("div",{className:"system-xl-semibold flex items-center pb-1 pl-4 pr-11 pt-3.5 text-text-primary",children:u(s?"inputFieldPanel.editInputField":"inputFieldPanel.addInputField",{ns:"datasetPipeline"})}),(0,l.jsx)("button",{type:"button","data-testid":"input-field-editor-close-btn",className:"absolute right-2.5 top-2.5 flex size-8 items-center justify-center",onClick:a,children:(0,l.jsx)(i.RiCloseLine,{className:"size-4 text-text-tertiary"})}),(0,l.jsx)(I,{initialData:g,supportFile:!0,onCancel:a,onSubmit:h,isEditMode:!!s})]})}],256663)},883816,e=>{e.n(e.i(256663))}]);