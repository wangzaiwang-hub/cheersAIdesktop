(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,619507,299075,e=>{"use strict";e.i(845780);var t=e.i(720315),o=e.i(949250);e.i(275225);var i=e.i(705405),n=e.i(390622),l=e.i(654537);let r=e=>({[l.PipelineInputVarType.number]:n.VarType.number,[l.PipelineInputVarType.singleFile]:n.VarType.file,[l.PipelineInputVarType.multiFiles]:n.VarType.arrayFile,[l.PipelineInputVarType.checkbox]:n.VarType.boolean})[e]||n.VarType.string;var a=e.i(192447);let s=e=>{let{getNodes:t}=(0,a.useStoreApi)().getState(),o=t(),i=o.find(t=>t.id===e),n=!!i?.data.isInIteration,l=!!i?.data.isInLoop,r=i?.parentId;return{node:i,isInIteration:n,isInLoop:l,parentNode:o.find(e=>e.id===r)}};e.s(["default",0,s],299075),e.s(["default",0,function(e){let{onlyLeafNodeVar:l,filterVar:a,hideEnv:u,hideChatVar:d,passedInAvailableNodes:c}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{onlyLeafNodeVar:!1,filterVar:()=>!0},{getTreeLeafNodes:p,getNodeById:v,getBeforeNodesInSameBranchIncludeParent:f}=(0,t.useWorkflow)(),{getNodeAvailableVars:b}=(0,o.useWorkflowVariables)(),m=(0,t.useIsChatMode)(),x=c||(l?p(e):f(e)),{parentNode:h}=s(e),g=v(e),y=(0,i.useStore)(e=>e.ragPipelineVariables),E=g?.data?.type===n.BlockEnum.DataSource,S=[];if(E){let t=y?.filter(t=>t.belong_to_node_id===e),o=t?.filter(t=>a({variable:t.variable,type:r(t.type),nodeId:e,isRagVariable:!0},["rag",e,t.variable]));o?.length&&S.push({nodeId:e,title:g.data?.title,vars:o.map(t=>({variable:`rag.${e}.${t.variable}`,type:r(t.type),description:t.label,isRagVariable:!0}))})}return{availableVars:[...b({parentNode:h,beforeNodes:x,isChatMode:m,filterVar:a,hideEnv:u,hideChatVar:d}),...S],availableNodes:x,availableNodesWithParent:[...x,...E?[g]:[]]}}],619507)},825220,e=>{"use strict";var t=e.i(268571);e.s(["Env",()=>t.default])},981875,e=>{"use strict";var t,o=((t={}).conversation="conversation",t.environment="env",t.node="node",t.system="sys",t);e.s(["VarInInspectType",()=>o])},661734,535614,951875,189497,e=>{"use strict";var t=e.i(563199),o=e.i(807324),i=e.i(732056);let n=e=>{let{ref:n,...l}=e;return(0,t.jsx)(o.default,{...l,ref:n,data:i.default})};n.displayName="InputField",e.s(["default",0,n],535614);var l=e.i(181096);let r=e=>{let{ref:i,...n}=e;return(0,t.jsx)(o.default,{...n,ref:i,data:l.default})};r.displayName="PipelineFill",e.s(["default",0,r],951875);var a=e.i(8717);let s=e=>{let{ref:i,...n}=e;return(0,t.jsx)(o.default,{...n,ref:i,data:a.default})};s.displayName="PipelineLine",e.s(["default",0,s],189497),e.s([],661734)},505816,e=>{"use strict";var t=e.i(535614);e.s(["InputField",()=>t.default])},42241,45490,370546,268571,737753,479735,484655,3371,e=>{"use strict";var t=e.i(563199),o=e.i(807324),i=e.i(986823);let n=e=>{let{ref:n,...l}=e;return(0,t.jsx)(o.default,{...l,ref:n,data:i.default})};n.displayName="BubbleX",e.s(["default",0,n],45490),e.i(218459);var l=e.i(792257);let r=e=>{let{ref:i,...n}=e;return(0,t.jsx)(o.default,{...n,ref:i,data:l.default})};r.displayName="DragHandle",e.s(["default",0,r],370546);var a=e.i(262909);let s=e=>{let{ref:i,...n}=e;return(0,t.jsx)(o.default,{...n,ref:i,data:a.default})};s.displayName="Env",e.s(["default",0,s],268571);var u=e.i(341579);let d=e=>{let{ref:i,...n}=e;return(0,t.jsx)(o.default,{...n,ref:i,data:u.default})};d.displayName="GlobalVariable",e.s(["default",0,d],737753);var c=e.i(274378);let p=e=>{let{ref:i,...n}=e;return(0,t.jsx)(o.default,{...n,ref:i,data:c.default})};p.displayName="Icon3Dots",e.s(["default",0,p],479735);var v=e.i(641469);let f=e=>{let{ref:i,...n}=e;return(0,t.jsx)(o.default,{...n,ref:i,data:v.default})};f.displayName="LongArrowLeft",e.s(["default",0,f],484655);var b=e.i(103751);let m=e=>{let{ref:i,...n}=e;return(0,t.jsx)(o.default,{...n,ref:i,data:b.default})};m.displayName="LongArrowRight",e.s(["default",0,m],3371),e.i(862712),e.i(234661),e.s([],42241)},379636,e=>{"use strict";var t=e.i(737753);e.s(["GlobalVariable",()=>t.default])},678383,e=>{"use strict";var t=e.i(328960);e.s(["Variable02",()=>t.default])},226577,e=>{"use strict";var t=e.i(45490);e.s(["BubbleX",()=>t.default])},603198,866438,54010,645960,971481,95240,e=>{"use strict";var t=e.i(563199),o=e.i(268255),i=e.i(935139);e.i(42241);var n=e.i(226577),l=e.i(825220),r=e.i(379636);e.i(661734);var a=e.i(505816);e.i(39598);var s=e.i(678383);e.i(916131);var u=e.i(806436),d=e.i(959752),c=e.i(981875),p=e.i(963855);let v=(e,t,i)=>(0,o.useMemo)(()=>t?"text-text-warning":"loop"===i?"text-util-colors-cyan-cyan-500":(0,p.isENV)(e)||i===c.VarInInspectType.environment||"environment"===i?"text-util-colors-violet-violet-600":(0,p.isConversationVar)(e)||i===c.VarInInspectType.conversation||"conversation"===i?"text-util-colors-teal-teal-700":(0,p.isGlobalVar)(e)||i===c.VarInInspectType.system?"text-util-colors-orange-orange-600":"text-text-accent",[e,t,i]),f=(0,o.memo)(e=>{let{className:o,variables:d=[],variableCategory:v}=e,f="loop"===v?u.Loop:"rag"===v||(0,p.isRagVariableVar)(d)?a.InputField:(0,p.isENV)(d)||v===c.VarInInspectType.environment||"environment"===v?l.Env:(0,p.isConversationVar)(d)||v===c.VarInInspectType.conversation||"conversation"===v?n.BubbleX:(0,p.isGlobalVar)(d)||v===c.VarInInspectType.system?r.GlobalVariable:s.Variable02;return f&&(0,t.jsx)(f,{className:(0,i.cn)("size-3.5 shrink-0",o)})}),b=(0,o.memo)(e=>{let{isExceptionVariable:o,variableCategory:n,variables:l=[],className:r}=e,a=v(l,o,n);return(0,t.jsx)(f,{variables:l,variableCategory:n,className:(0,i.cn)(a,r)})});e.s(["default",0,b],866438);var m=e.i(837699),x=e.i(403861),h=e.i(421001);let g=(0,o.memo)(e=>{let n,l,r,{variables:a,className:s,notShowFullPath:u}=e,c=(n=d.VAR_SHOW_NAME_MAP[a.join(".")],l=a.slice(1).join("."),(0,p.isRagVariableVar)(a)&&(l=a.slice(2).join(".")),r=(0,o.useMemo)(()=>{l=a.slice(1).join("."),(0,p.isRagVariableVar)(a)&&(l=a.slice(2).join("."));let e=a.length,t=(0,p.isSystemVar)(a),o=u?a[e-1]:l;return`${t?"sys.":""}${o}`},[a,u]),n||r);return(0,t.jsx)("div",{className:(0,i.cn)("system-xs-medium truncate",s),title:c,children:c})});var y=e.i(120219);let E=(0,o.memo)(e=>{let{nodeType:o,nodeTitle:i}=e;return o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.VarBlockIcon,{type:o,className:"shrink-0 text-text-secondary"}),i&&(0,t.jsx)("div",{className:"system-xs-medium max-w-[60px] truncate text-text-secondary",title:i,children:i}),(0,t.jsx)("div",{className:"system-xs-regular shrink-0 text-divider-deep",children:"/"})]}):null}),S=(0,o.memo)(e=>{let{nodeType:o,nodeTitle:n,variables:l,variableType:r,className:a,errorMsg:s,onClick:u,isExceptionVariable:d,ref:c,notShowFullPath:b,rightSlot:y}=e,S=v(l,d),O=!((0,p.isENV)(l)||(0,p.isConversationVar)(l)||(0,p.isGlobalVar)(l)||(0,p.isRagVariableVar)(l));return(0,t.jsxs)("div",{className:(0,i.cn)("inline-flex h-6 max-w-full items-center space-x-0.5 rounded-md border-[0.5px] border-components-panel-border-subtle bg-components-badge-white-to-dark px-1.5 shadow-xs",a),onClick:u,ref:c,children:[O&&(0,t.jsx)(E,{nodeType:o,nodeTitle:n}),b&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.RiMoreLine,{className:"h-3 w-3 shrink-0 text-text-secondary"}),(0,t.jsx)("div",{className:"system-xs-regular shrink-0 text-divider-deep",children:"/"})]}),(0,t.jsx)(f,{variables:l,className:S}),(0,t.jsx)(g,{variables:l,className:(0,i.cn)(S),notShowFullPath:b}),!!r&&(0,t.jsx)("div",{className:"system-xs-regular shrink-0 text-text-tertiary",children:(0,x.capitalize)(r)}),!!s&&(0,t.jsx)(h.default,{popupContent:s,asChild:!0,children:(0,t.jsx)(m.RiErrorWarningFill,{className:"h-3 w-3 shrink-0 text-text-destructive"})}),y]})}),O=(0,o.memo)(e=>{let{isSelected:o,variables:n,errorMsg:l,...r}=e,{hoverBorderColor:a,hoverBgColor:s,selectedBorderColor:u,selectedBgColor:d}=l?{hoverBorderColor:"hover:border-state-destructive-active",hoverBgColor:"hover:bg-state-destructive-hover",selectedBorderColor:"!border-state-destructive-solid",selectedBgColor:"!bg-state-destructive-hover"}:(0,p.isENV)(n)?{hoverBorderColor:"hover:border-util-colors-violet-violet-100",hoverBgColor:"hover:bg-util-colors-violet-violet-50",selectedBorderColor:"border-util-colors-violet-violet-600",selectedBgColor:"bg-util-colors-violet-violet-50"}:(0,p.isConversationVar)(n)?{hoverBorderColor:"hover:border-util-colors-teal-teal-100",hoverBgColor:"hover:bg-util-colors-teal-teal-50",selectedBorderColor:"border-util-colors-teal-teal-600",selectedBgColor:"bg-util-colors-teal-teal-50"}:{hoverBorderColor:"hover:border-state-accent-alt",hoverBgColor:"hover:bg-state-accent-hover",selectedBorderColor:"border-state-accent-solid",selectedBgColor:"bg-state-accent-hover"};return(0,t.jsx)(S,{className:(0,i.cn)("h-[18px] space-x-[1px] rounded-[5px] px-1 shadow-xs",!o&&s,!o&&a,o&&"border",o&&u,o&&d),variables:n,errorMsg:l,...r})});e.s(["default",0,O],54010);let I=(0,o.memo)(e=>(0,t.jsx)(S,{className:(0,i.cn)("w-full space-x-[1px] bg-workflow-block-parma-bg px-1 shadow-none"),...e}));e.s(["default",0,I],645960);let R=(0,o.memo)(e=>(0,t.jsx)(S,{...e}));e.s(["default",0,R],971481);let w=(0,o.memo)(e=>(0,t.jsx)(S,{className:(0,i.cn)("h-[18px] space-x-[1px] rounded-[5px] px-1 shadow-xs"),...e}));e.s(["default",0,w],95240),e.s([],603198)},653356,e=>{"use strict";var t=e.i(268255);let o=t.forwardRef(function(e,o){let{title:i,titleId:n,...l}=e;return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":n},l),i?t.createElement("title",{id:n},i):null,t.createElement("path",{d:"M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"}))});e.s(["XMarkIcon",0,o],653356)},789604,882568,702941,516457,e=>{"use strict";let t,o,i,n;var l=e.i(182370),r=e.i(725968),a=e.i(268255),s=e.i(688393),u=e.i(876581);function d(e,t){return null!==e&&null!==t&&"object"==typeof e&&"object"==typeof t&&"id"in e&&"id"in t?e.id===t.id:e===t}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;return(0,a.useCallback)((t,o)=>"string"==typeof e?(null==t?void 0:t[e])===(null==o?void 0:o[e]):e(t,o),[e])}e.s(["useByComparator",()=>c],882568);var p=e.i(614653),v=e.i(125234),f=e.i(97986),b=e.i(969350),m=e.i(589393),x=e.i(71216),h=e.i(741064),g=e.i(782165),y=e.i(518836),E=e.i(775885),S=e.i(122783),O=e.i(944296),I=e.i(777009),R=e.i(135477),w=e.i(329512),C=e.i(720048),L=e.i(326898),P=e.i(988851),T=e.i(602652),F=e.i(939895),V=e.i(274406);function N(e){let{children:t,freeze:o}=e,i=D(o,t);return a.default.createElement(a.default.Fragment,null,i)}function D(e,t){let[o,i]=(0,a.useState)(t);return e||o===t||i(t),e?o:t}e.s(["Frozen",()=>N,"useFrozenData",()=>D],702941);var j=e.i(344554),k=e.i(268850),M=e.i(294662),B=e.i(162023),A=e.i(708684),K=e.i(455028),_=e.i(330620),W=e.i(652038),z=e.i(875880),Q=e.i(858023),$=e.i(869873),G=e.i(198136),U=e.i(90158),H=e.i(642330),X=((t=X||{})[t.Open=0]="Open",t[t.Closed=1]="Closed",t),Z=((o=Z||{})[o.Single=0]="Single",o[o.Multi=1]="Multi",o),q=((i=q||{})[i.Pointer=0]="Pointer",i[i.Other=1]="Other",i),J=((n=J||{})[n.OpenListbox=0]="OpenListbox",n[n.CloseListbox=1]="CloseListbox",n[n.GoToOption=2]="GoToOption",n[n.Search=3]="Search",n[n.ClearSearch=4]="ClearSearch",n[n.RegisterOption=5]="RegisterOption",n[n.UnregisterOption=6]="UnregisterOption",n[n.SetButtonElement=7]="SetButtonElement",n[n.SetOptionsElement=8]="SetOptionsElement",n);function Y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e,o=null!==e.activeOptionIndex?e.options[e.activeOptionIndex]:null,i=(0,K.sortByDomNode)(t(e.options.slice()),e=>e.dataRef.current.domRef.current),n=o?i.indexOf(o):null;return -1===n&&(n=null),{options:i,activeOptionIndex:n}}let ee={1:e=>e.dataRef.current.disabled||1===e.listboxState?e:{...e,activeOptionIndex:null,listboxState:1,__demoMode:!1},0(e){if(e.dataRef.current.disabled||0===e.listboxState)return e;let t=e.activeOptionIndex,{isSelected:o}=e.dataRef.current,i=e.options.findIndex(e=>o(e.dataRef.current.value));return -1!==i&&(t=i),{...e,listboxState:0,activeOptionIndex:t,__demoMode:!1}},2(e,t){var o,i,n,l,r;if(e.dataRef.current.disabled||1===e.listboxState)return e;let a={...e,searchQuery:"",activationTrigger:null!=(o=t.trigger)?o:1,__demoMode:!1};if(t.focus===B.Focus.Nothing)return{...a,activeOptionIndex:null};if(t.focus===B.Focus.Specific)return{...a,activeOptionIndex:e.options.findIndex(e=>e.id===t.id)};if(t.focus===B.Focus.Previous){let o=e.activeOptionIndex;if(null!==o){let l=e.options[o].dataRef.current.domRef,r=(0,B.calculateActiveIndex)(t,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:e=>e.id,resolveDisabled:e=>e.dataRef.current.disabled});if(null!==r){let t=e.options[r].dataRef.current.domRef;if((null==(i=l.current)?void 0:i.previousElementSibling)===t.current||(null==(n=t.current)?void 0:n.previousElementSibling)===null)return{...a,activeOptionIndex:r}}}}else if(t.focus===B.Focus.Next){let o=e.activeOptionIndex;if(null!==o){let i=e.options[o].dataRef.current.domRef,n=(0,B.calculateActiveIndex)(t,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:e=>e.id,resolveDisabled:e=>e.dataRef.current.disabled});if(null!==n){let t=e.options[n].dataRef.current.domRef;if((null==(l=i.current)?void 0:l.nextElementSibling)===t.current||(null==(r=t.current)?void 0:r.nextElementSibling)===null)return{...a,activeOptionIndex:n}}}}let s=Y(e),u=(0,B.calculateActiveIndex)(t,{resolveItems:()=>s.options,resolveActiveIndex:()=>s.activeOptionIndex,resolveId:e=>e.id,resolveDisabled:e=>e.dataRef.current.disabled});return{...a,...s,activeOptionIndex:u}},3:(e,t)=>{if(e.dataRef.current.disabled||1===e.listboxState)return e;let o=+(""===e.searchQuery),i=e.searchQuery+t.value.toLowerCase(),n=(null!==e.activeOptionIndex?e.options.slice(e.activeOptionIndex+o).concat(e.options.slice(0,e.activeOptionIndex+o)):e.options).find(e=>{var t;return!e.dataRef.current.disabled&&(null==(t=e.dataRef.current.textValue)?void 0:t.startsWith(i))}),l=n?e.options.indexOf(n):-1;return -1===l||l===e.activeOptionIndex?{...e,searchQuery:i}:{...e,searchQuery:i,activeOptionIndex:l,activationTrigger:1}},4:e=>e.dataRef.current.disabled||1===e.listboxState||""===e.searchQuery?e:{...e,searchQuery:""},5:(e,t)=>{let o={id:t.id,dataRef:t.dataRef},i=Y(e,e=>[...e,o]);return null===e.activeOptionIndex&&e.dataRef.current.isSelected(t.dataRef.current.value)&&(i.activeOptionIndex=i.options.indexOf(o)),{...e,...i}},6:(e,t)=>{let o=Y(e,e=>{let o=e.findIndex(e=>e.id===t.id);return -1!==o&&e.splice(o,1),e});return{...e,...o,activationTrigger:1}},7:(e,t)=>e.buttonElement===t.element?e:{...e,buttonElement:t.element},8:(e,t)=>e.optionsElement===t.element?e:{...e,optionsElement:t.element}},et=(0,a.createContext)(null);function eo(e){let t=(0,a.useContext)(et);if(null===t){let t=Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,eo),t}return t}et.displayName="ListboxActionsContext";let ei=(0,a.createContext)(null);function en(e){let t=(0,a.useContext)(ei);if(null===t){let t=Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,en),t}return t}function el(e,t){return(0,W.match)(t.type,ee,e,t)}ei.displayName="ListboxDataContext";let er=a.Fragment,ea=(0,a.createContext)(!1),es=Q.RenderFeatures.RenderStrategy|Q.RenderFeatures.Static,eu=a.Fragment,ed=(0,Q.forwardRefWithAs)(function(e,t){var o;let i=(0,T.useDisabled)(),{value:n,defaultValue:l,form:r,name:s,onChange:u,by:d,invalid:f=!1,disabled:m=i||!1,horizontal:h=!1,multiple:y=!1,__demoMode:E=!1,...O}=e,I=h?"horizontal":"vertical",R=(0,w.useSyncRefs)(t),C=(0,v.useDefaultValue)(l),[L=y?[]:void 0,P]=(0,p.useControllable)(n,u,C),[N,D]=(0,a.useReducer)(el,{dataRef:(0,a.createRef)(),listboxState:+!E,options:[],searchQuery:"",activeOptionIndex:null,activationTrigger:1,optionsVisible:!1,buttonElement:null,optionsElement:null,__demoMode:E}),j=(0,a.useRef)({static:!1,hold:!1}),M=(0,a.useRef)(new Map),A=c(d),_=(0,a.useCallback)(e=>(0,W.match)(z.mode,{1:()=>L.some(t=>A(t,e)),0:()=>A(L,e)}),[L]),z=(0,a.useMemo)(()=>({...N,value:L,disabled:m,invalid:f,mode:+!!y,orientation:I,compare:A,isSelected:_,optionsPropsRef:j,listRef:M}),[L,m,f,y,N,M]);(0,g.useIsoMorphicEffect)(()=>{N.dataRef.current=z},[z]);let $=0===z.listboxState;(0,S.useOutsideClick)($,[z.buttonElement,z.optionsElement],(e,t)=>{var o;D({type:1}),(0,K.isFocusableElement)(t,K.FocusableMode.Loose)||(e.preventDefault(),null==(o=z.buttonElement)||o.focus())});let G=(0,a.useMemo)(()=>({open:0===z.listboxState,disabled:m,invalid:f,value:L}),[z,m,L,f]),H=(0,x.useEvent)(e=>{let t=z.options.find(t=>t.id===e);t&&eo(t.dataRef.current.value)}),X=(0,x.useEvent)(()=>{if(null!==z.activeOptionIndex){let{dataRef:e,id:t}=z.options[z.activeOptionIndex];eo(e.current.value),D({type:2,focus:B.Focus.Specific,id:t})}}),Z=(0,x.useEvent)(()=>D({type:0})),q=(0,x.useEvent)(()=>D({type:1})),J=(0,b.useDisposables)(),Y=(0,x.useEvent)((e,t,o)=>{J.dispose(),J.microTask(()=>e===B.Focus.Specific?D({type:2,focus:B.Focus.Specific,id:t,trigger:o}):D({type:2,focus:e,trigger:o}))}),ee=(0,x.useEvent)((e,t)=>(D({type:5,id:e,dataRef:t}),()=>D({type:6,id:e}))),eo=(0,x.useEvent)(e=>(0,W.match)(z.mode,{0:()=>null==P?void 0:P(e),1(){let t=z.value.slice(),o=t.findIndex(t=>A(t,e));return -1===o?t.push(e):t.splice(o,1),null==P?void 0:P(t)}})),en=(0,x.useEvent)(e=>D({type:3,value:e})),ea=(0,x.useEvent)(()=>D({type:4})),es=(0,x.useEvent)(e=>{D({type:7,element:e})}),eu=(0,x.useEvent)(e=>{D({type:8,element:e})}),ed=(0,a.useMemo)(()=>({onChange:eo,registerOption:ee,goToOption:Y,closeListbox:q,openListbox:Z,selectActiveOption:X,selectOption:H,search:en,clearSearch:ea,setButtonElement:es,setOptionsElement:eu}),[]),[ec,ep]=(0,U.useLabels)({inherit:!0}),ev=(0,a.useCallback)(()=>{if(void 0!==C)return null==P?void 0:P(C)},[P,C]),ef=(0,Q.useRender)();return a.default.createElement(ep,{value:ec,props:{htmlFor:null==(o=z.buttonElement)?void 0:o.id},slot:{open:0===z.listboxState,disabled:m}},a.default.createElement(F.FloatingProvider,null,a.default.createElement(et.Provider,{value:ed},a.default.createElement(ei.Provider,{value:z},a.default.createElement(k.OpenClosedProvider,{value:(0,W.match)(z.listboxState,{0:k.State.Open,1:k.State.Closed})},null!=s&&null!=L&&a.default.createElement(V.FormFields,{disabled:m,data:{[s]:L},form:r,onReset:ev}),ef({ourProps:{ref:R},theirProps:O,slot:G,defaultTag:er,name:"Listbox"}))))))}),ec=(0,Q.forwardRefWithAs)(function(e,t){var o;let i=en("Listbox.Button"),n=eo("Listbox.Button"),d=(0,a.useId)(),c=(0,j.useProvidedId)(),{id:p=c||`headlessui-listbox-button-${d}`,disabled:v=i.disabled||!1,autoFocus:f=!1,...b}=e,m=(0,w.useSyncRefs)(t,(0,F.useFloatingReference)(),n.setButtonElement),h=(0,F.useFloatingReferenceProps)(),g=(0,x.useEvent)(e=>{switch(e.key){case G.Keys.Enter:(0,_.attemptSubmit)(e.currentTarget);break;case G.Keys.Space:case G.Keys.ArrowDown:e.preventDefault(),(0,s.flushSync)(()=>n.openListbox()),i.value||n.goToOption(B.Focus.First);break;case G.Keys.ArrowUp:e.preventDefault(),(0,s.flushSync)(()=>n.openListbox()),i.value||n.goToOption(B.Focus.Last)}}),y=(0,x.useEvent)(e=>{e.key===G.Keys.Space&&e.preventDefault()}),E=(0,x.useEvent)(e=>{var t;if((0,M.isDisabledReactIssue7711)(e.currentTarget))return e.preventDefault();0===i.listboxState?((0,s.flushSync)(()=>n.closeListbox()),null==(t=i.buttonElement)||t.focus({preventScroll:!0})):(e.preventDefault(),n.openListbox())}),S=(0,x.useEvent)(e=>e.preventDefault()),O=(0,U.useLabelledBy)([p]),R=(0,$.useDescribedBy)(),{isFocusVisible:C,focusProps:L}=(0,l.useFocusRing)({autoFocus:f}),{isHovered:P,hoverProps:T}=(0,r.useHover)({isDisabled:v}),{pressed:V,pressProps:N}=(0,u.useActivePress)({disabled:v}),D=(0,a.useMemo)(()=>({open:0===i.listboxState,active:V||0===i.listboxState,disabled:v,invalid:i.invalid,value:i.value,hover:P,focus:C,autofocus:f}),[i.listboxState,i.value,v,P,C,V,i.invalid,f]),k=(0,Q.mergeProps)(h(),{ref:m,id:p,type:(0,I.useResolveButtonType)(e,i.buttonElement),"aria-haspopup":"listbox","aria-controls":null==(o=i.optionsElement)?void 0:o.id,"aria-expanded":0===i.listboxState,"aria-labelledby":O,"aria-describedby":R,disabled:v||void 0,autoFocus:f,onKeyDown:g,onKeyUp:y,onKeyPress:S,onClick:E},L,T,N);return(0,Q.useRender)()({ourProps:k,theirProps:b,slot:D,defaultTag:"button",name:"Listbox.Button"})}),ep=U.Label,ev=(0,Q.forwardRefWithAs)(function(e,t){var o,i;let n=(0,a.useId)(),{id:l=`headlessui-listbox-options-${n}`,anchor:r,portal:u=!1,modal:d=!0,transition:c=!1,...p}=e,v=(0,F.useResolvedAnchor)(r),[g,y]=(0,a.useState)(null);v&&(u=!0);let S=en("Listbox.Options"),I=eo("Listbox.Options"),C=(0,O.useOwnerDocument)(S.buttonElement),L=(0,O.useOwnerDocument)(S.optionsElement),T=(0,k.useOpenClosed)(),[V,N]=(0,P.useTransition)(c,g,null!==T?(T&k.State.Open)===k.State.Open:0===S.listboxState);(0,E.useOnDisappear)(V,S.buttonElement,I.closeListbox);let j=!S.__demoMode&&d&&0===S.listboxState;(0,R.useScrollLock)(j,L);let M=!S.__demoMode&&d&&0===S.listboxState;(0,h.useInertOthers)(M,{allowed:(0,a.useCallback)(()=>[S.buttonElement,S.optionsElement],[S.buttonElement,S.optionsElement])});let A=0!==S.listboxState,_=!(0,f.useDidElementMove)(A,S.buttonElement)&&V,$=D(V&&1===S.listboxState,S.value),U=(0,x.useEvent)(e=>S.compare($,e)),X=(0,a.useMemo)(()=>{var e;if(null==v||!(null!=(e=null==v?void 0:v.to)&&e.includes("selection")))return null;let t=S.options.findIndex(e=>U(e.dataRef.current.value));return -1===t&&(t=0),t},[v,S.options]),Z=(()=>{if(null==v)return;if(null===X)return{...v,inner:void 0};let e=Array.from(S.listRef.current.values());return{...v,inner:{listRef:{current:e},index:X}}})(),[q,J]=(0,F.useFloatingPanel)(Z),Y=(0,F.useFloatingPanelProps)(),ee=(0,w.useSyncRefs)(t,v?q:null,I.setOptionsElement,y),et=(0,b.useDisposables)();(0,a.useEffect)(()=>{var e;let t=S.optionsElement;t&&0===S.listboxState&&t!==(null==(e=(0,z.getOwnerDocument)(t))?void 0:e.activeElement)&&(null==t||t.focus({preventScroll:!0}))},[S.listboxState,S.optionsElement]);let el=(0,x.useEvent)(e=>{var t,o;switch(et.dispose(),e.key){case G.Keys.Space:if(""!==S.searchQuery)return e.preventDefault(),e.stopPropagation(),I.search(e.key);case G.Keys.Enter:if(e.preventDefault(),e.stopPropagation(),null!==S.activeOptionIndex){let{dataRef:e}=S.options[S.activeOptionIndex];I.onChange(e.current.value)}0===S.mode&&((0,s.flushSync)(()=>I.closeListbox()),null==(t=S.buttonElement)||t.focus({preventScroll:!0}));break;case(0,W.match)(S.orientation,{vertical:G.Keys.ArrowDown,horizontal:G.Keys.ArrowRight}):return e.preventDefault(),e.stopPropagation(),I.goToOption(B.Focus.Next);case(0,W.match)(S.orientation,{vertical:G.Keys.ArrowUp,horizontal:G.Keys.ArrowLeft}):return e.preventDefault(),e.stopPropagation(),I.goToOption(B.Focus.Previous);case G.Keys.Home:case G.Keys.PageUp:return e.preventDefault(),e.stopPropagation(),I.goToOption(B.Focus.First);case G.Keys.End:case G.Keys.PageDown:return e.preventDefault(),e.stopPropagation(),I.goToOption(B.Focus.Last);case G.Keys.Escape:e.preventDefault(),e.stopPropagation(),(0,s.flushSync)(()=>I.closeListbox()),null==(o=S.buttonElement)||o.focus({preventScroll:!0});return;case G.Keys.Tab:e.preventDefault(),e.stopPropagation(),(0,s.flushSync)(()=>I.closeListbox()),(0,K.focusFrom)(S.buttonElement,e.shiftKey?K.Focus.Previous:K.Focus.Next);break;default:1===e.key.length&&(I.search(e.key),et.setTimeout(()=>I.clearSearch(),350))}}),er=null==(o=S.buttonElement)?void 0:o.id,ea=(0,a.useMemo)(()=>({open:0===S.listboxState}),[S.listboxState]),eu=(0,Q.mergeProps)(v?Y():{},{id:l,ref:ee,"aria-activedescendant":null===S.activeOptionIndex||null==(i=S.options[S.activeOptionIndex])?void 0:i.id,"aria-multiselectable":1===S.mode||void 0,"aria-labelledby":er,"aria-orientation":S.orientation,onKeyDown:el,role:"listbox",tabIndex:0===S.listboxState?0:void 0,style:{...p.style,...J,"--button-width":(0,m.useElementSize)(S.buttonElement,!0).width},...(0,P.transitionDataAttributes)(N)}),ed=(0,Q.useRender)();return a.default.createElement(H.Portal,{enabled:!!u&&(e.static||V),ownerDocument:C},a.default.createElement(ei.Provider,{value:1===S.mode?S:{...S,isSelected:U}},ed({ourProps:eu,theirProps:p,slot:ea,defaultTag:"div",features:es,visible:_,name:"Listbox.Options"})))}),ef=(0,Q.forwardRefWithAs)(function(e,t){let o=(0,a.useId)(),{id:i=`headlessui-listbox-option-${o}`,disabled:n=!1,value:l,...r}=e,u=!0===(0,a.useContext)(ea),d=en("Listbox.Option"),c=eo("Listbox.Option"),p=null!==d.activeOptionIndex&&d.options[d.activeOptionIndex].id===i,v=d.isSelected(l),f=(0,a.useRef)(null),b=(0,C.useTextValue)(f),m=(0,y.useLatestValue)({disabled:n,value:l,domRef:f,get textValue(){return b()}}),h=(0,w.useSyncRefs)(t,f,e=>{e?d.listRef.current.set(i,e):d.listRef.current.delete(i)});(0,g.useIsoMorphicEffect)(()=>{if(!d.__demoMode&&0===d.listboxState&&p&&0!==d.activationTrigger)return(0,A.disposables)().requestAnimationFrame(()=>{var e,t;null==(t=null==(e=f.current)?void 0:e.scrollIntoView)||t.call(e,{block:"nearest"})})},[f,p,d.__demoMode,d.listboxState,d.activationTrigger,d.activeOptionIndex]),(0,g.useIsoMorphicEffect)(()=>{if(!u)return c.registerOption(i,m)},[m,i,u]);let E=(0,x.useEvent)(e=>{var t;if(n)return e.preventDefault();c.onChange(l),0===d.mode&&((0,s.flushSync)(()=>c.closeListbox()),null==(t=d.buttonElement)||t.focus({preventScroll:!0}))}),S=(0,x.useEvent)(()=>{if(n)return c.goToOption(B.Focus.Nothing);c.goToOption(B.Focus.Specific,i)}),O=(0,L.useTrackedPointer)(),I=(0,x.useEvent)(e=>{O.update(e),!n&&(p||c.goToOption(B.Focus.Specific,i,0))}),R=(0,x.useEvent)(e=>{O.wasMoved(e)&&(n||p||c.goToOption(B.Focus.Specific,i,0))}),P=(0,x.useEvent)(e=>{O.wasMoved(e)&&(n||p&&c.goToOption(B.Focus.Nothing))}),T=(0,a.useMemo)(()=>({active:p,focus:p,selected:v,disabled:n,selectedOption:v&&u}),[p,v,n,u]),F=u?{}:{id:i,ref:h,role:"option",tabIndex:!0===n?void 0:-1,"aria-disabled":!0===n||void 0,"aria-selected":v,disabled:void 0,onClick:E,onFocus:S,onPointerEnter:I,onMouseEnter:I,onPointerMove:R,onMouseMove:R,onPointerLeave:P,onMouseLeave:P},V=(0,Q.useRender)();return!v&&u?null:V({ourProps:F,theirProps:r,slot:T,defaultTag:"div",name:"Listbox.Option"})}),eb=Object.assign(ed,{Button:ec,Label:ep,Options:ev,Option:ef,SelectedOption:(0,Q.forwardRefWithAs)(function(e,t){let{options:o,placeholder:i,...n}=e,l={ref:(0,w.useSyncRefs)(t)},r=en("ListboxSelectedOption"),s=(0,a.useMemo)(()=>({}),[]),u=void 0===r.value||null===r.value||1===r.mode&&Array.isArray(r.value)&&0===r.value.length,d=(0,Q.useRender)();return a.default.createElement(ea.Provider,{value:!0},d({ourProps:l,theirProps:{...n,children:a.default.createElement(a.default.Fragment,null,i&&u?i:o)},slot:s,defaultTag:eu,name:"ListboxSelectedOption"}))})});e.s(["Listbox",()=>eb,"ListboxButton",()=>ec,"ListboxOption",()=>ef,"ListboxOptions",()=>ev],789604);let em=a.forwardRef(function(e,t){let{title:o,titleId:i,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),o?a.createElement("title",{id:i},o):null,a.createElement("path",{fillRule:"evenodd",d:"M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))});e.s(["ChevronDownIcon",0,em],516457)},649538,e=>{"use strict";var t=e.i(918077);e.s(["ChevronRight",()=>t.default])}]);