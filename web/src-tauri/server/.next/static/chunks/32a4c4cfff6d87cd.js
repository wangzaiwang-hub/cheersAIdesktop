(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,549289,e=>{"use strict";var t=e.i(625743);e.s(["ApiConnectionMod",()=>t.default])},170866,399162,539522,e=>{"use strict";var t=e.i(563199);function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,s(e,t)}e.s(["default",()=>a],399162);var n=e.i(268255);function r(e){return e&&e.stopPropagation&&e.stopPropagation(),e&&e.preventDefault&&e.preventDefault(),!1}function i(e){return null==e?[]:Array.isArray(e)?e.slice():[e]}function l(e){return null!==e&&1===e.length?e[0]:e.slice()}function o(e){Object.keys(e).forEach(t=>{"u">typeof document&&document.addEventListener(t,e[t],!1)})}function c(e,t){let s;return d(((s=e)<=t.min&&(s=t.min),s>=t.max&&(s=t.max),s),t)}function d(e,t){let s=(e-t.min)%t.step,a=e-s;return 2*Math.abs(s)>=t.step&&(a+=s>0?t.step:-t.step),parseFloat(a.toFixed(5))}let p=function(e){function t(t){var s;(s=e.call(this,t)||this).onKeyUp=()=>{s.onEnd()},s.onMouseUp=()=>{s.onEnd(s.getMouseEventMap())},s.onTouchEnd=e=>{e.preventDefault(),s.onEnd(s.getTouchEventMap())},s.onBlur=()=>{s.setState({index:-1},s.onEnd(s.getKeyDownEventMap()))},s.onMouseMove=e=>{s.setState({pending:!0});let t=s.getMousePosition(e),a=s.getDiffPosition(t[0]),n=s.getValueFromPosition(a);s.move(n)},s.onTouchMove=e=>{if(e.touches.length>1)return;s.setState({pending:!0});let t=s.getTouchPosition(e);if(void 0===s.isScrolling){let e=t[0]-s.startPosition[0],a=t[1]-s.startPosition[1];s.isScrolling=Math.abs(a)>Math.abs(e)}if(s.isScrolling)return void s.setState({index:-1});let a=s.getDiffPosition(t[0]),n=s.getValueFromPosition(a);s.move(n)},s.onKeyDown=e=>{if(!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey))switch(s.setState({pending:!0}),e.key){case"ArrowLeft":case"ArrowDown":case"Left":case"Down":e.preventDefault(),s.moveDownByStep();break;case"ArrowRight":case"ArrowUp":case"Right":case"Up":e.preventDefault(),s.moveUpByStep();break;case"Home":e.preventDefault(),s.move(s.props.min);break;case"End":e.preventDefault(),s.move(s.props.max);break;case"PageDown":e.preventDefault(),s.moveDownByStep(s.props.pageFn(s.props.step));break;case"PageUp":e.preventDefault(),s.moveUpByStep(s.props.pageFn(s.props.step))}},s.onSliderMouseDown=e=>{if(!s.props.disabled&&2!==e.button){if(s.setState({pending:!0}),!s.props.snapDragDisabled){let t=s.getMousePosition(e);s.forceValueFromPosition(t[0],e=>{s.start(e,t[0]),o(s.getMouseEventMap())})}r(e)}},s.onSliderClick=e=>{if(!s.props.disabled&&s.props.onSliderClick&&!s.hasMoved){let t=s.getMousePosition(e),a=c(s.calcValue(s.calcOffsetFromPosition(t[0])),s.props);s.props.onSliderClick(a)}},s.createOnKeyDown=e=>t=>{s.props.disabled||(s.start(e),o(s.getKeyDownEventMap()),r(t))},s.createOnMouseDown=e=>t=>{if(s.props.disabled||2===t.button)return;s.setState({pending:!0});let a=s.getMousePosition(t);s.start(e,a[0]),o(s.getMouseEventMap()),r(t)},s.createOnTouchStart=e=>t=>{if(s.props.disabled||t.touches.length>1)return;s.setState({pending:!0});let a=s.getTouchPosition(t);s.startPosition=a,s.isScrolling=void 0,s.start(e,a[0]),o(s.getTouchEventMap()),t.stopPropagation&&t.stopPropagation()},s.handleResize=()=>{let e=window.setTimeout(()=>{s.pendingResizeTimeouts.shift(),s.resize()},0);s.pendingResizeTimeouts.push(e)},s.renderThumb=(e,t)=>{let a=s.props.thumbClassName+" "+s.props.thumbClassName+"-"+t+" "+(s.state.index===t?s.props.thumbActiveClassName:""),n={ref:e=>{s["thumb"+t]=e},key:s.props.thumbClassName+"-"+t,className:a,style:e,onMouseDown:s.createOnMouseDown(t),onTouchStart:s.createOnTouchStart(t),onFocus:s.createOnKeyDown(t),tabIndex:0,role:"slider","aria-orientation":s.props.orientation,"aria-valuenow":s.state.value[t],"aria-valuemin":s.props.min,"aria-valuemax":s.props.max,"aria-label":Array.isArray(s.props.ariaLabel)?s.props.ariaLabel[t]:s.props.ariaLabel,"aria-labelledby":Array.isArray(s.props.ariaLabelledby)?s.props.ariaLabelledby[t]:s.props.ariaLabelledby,"aria-disabled":s.props.disabled},r={index:t,value:l(s.state.value),valueNow:s.state.value[t]};return s.props.ariaValuetext&&(n["aria-valuetext"]="string"==typeof s.props.ariaValuetext?s.props.ariaValuetext:s.props.ariaValuetext(r)),s.props.renderThumb(n,r)},s.renderTrack=(e,t,a)=>{let n={key:s.props.trackClassName+"-"+e,className:s.props.trackClassName+" "+s.props.trackClassName+"-"+e,style:s.buildTrackStyle(t,s.state.upperBound-a)},r={index:e,value:l(s.state.value)};return s.props.renderTrack(n,r)};let a=i(t.value);a.length||(a=i(t.defaultValue)),s.pendingResizeTimeouts=[];let d=[];for(let e=0;e<a.length;e+=1)a[e]=c(a[e],t),d.push(e);return s.resizeObserver=null,s.resizeElementRef=n.default.createRef(),s.state={index:-1,upperBound:0,sliderLength:0,value:a,zIndices:d},s}a(t,e);var s=t.prototype;return s.componentDidMount=function(){"u">typeof window&&(this.resizeObserver=new ResizeObserver(this.handleResize),this.resizeObserver.observe(this.resizeElementRef.current),this.resize())},t.getDerivedStateFromProps=function(e,t){let s=i(e.value);return s.length?t.pending?null:{value:s.map(t=>c(t,e))}:null},s.componentDidUpdate=function(){0===this.state.upperBound&&this.resize()},s.componentWillUnmount=function(){this.clearPendingResizeTimeouts(),this.resizeObserver&&this.resizeObserver.disconnect()},s.onEnd=function(e){e&&Object.keys(e).forEach(t=>{"u">typeof document&&document.removeEventListener(t,e[t],!1)}),this.hasMoved&&this.fireChangeEvent("onAfterChange"),this.setState({pending:!1}),this.hasMoved=!1},s.getValue=function(){return l(this.state.value)},s.getClosestIndex=function(e){let t=Number.MAX_VALUE,s=-1,{value:a}=this.state,n=a.length;for(let r=0;r<n;r+=1){let n=Math.abs(e-this.calcOffset(a[r]));n<t&&(t=n,s=r)}return s},s.getMousePosition=function(e){return[e["page"+this.axisKey()],e["page"+this.orthogonalAxisKey()]]},s.getTouchPosition=function(e){let t=e.touches[0];return[t["page"+this.axisKey()],t["page"+this.orthogonalAxisKey()]]},s.getKeyDownEventMap=function(){return{keydown:this.onKeyDown,keyup:this.onKeyUp,focusout:this.onBlur}},s.getMouseEventMap=function(){return{mousemove:this.onMouseMove,mouseup:this.onMouseUp}},s.getTouchEventMap=function(){return{touchmove:this.onTouchMove,touchend:this.onTouchEnd}},s.getValueFromPosition=function(e){let t=e/(this.state.sliderLength-this.state.thumbSize)*(this.props.max-this.props.min);return c(this.state.startValue+t,this.props)},s.getDiffPosition=function(e){let t=e-this.state.startPosition;return this.props.invert&&(t*=-1),t},s.resize=function(){let{slider:e,thumb0:t}=this;if(!e||!t)return;let s=this.sizeKey(),a=e.getBoundingClientRect(),n=e[s],r=a[this.posMaxKey()],i=a[this.posMinKey()],l=t.getBoundingClientRect()[s.replace("client","").toLowerCase()],o=n-l,c=Math.abs(r-i);this.state.upperBound===o&&this.state.sliderLength===c&&this.state.thumbSize===l||this.setState({upperBound:o,sliderLength:c,thumbSize:l})},s.calcOffset=function(e){let t=this.props.max-this.props.min;return 0===t?0:(e-this.props.min)/t*this.state.upperBound},s.calcValue=function(e){return e/this.state.upperBound*(this.props.max-this.props.min)+this.props.min},s.calcOffsetFromPosition=function(e){let{slider:t}=this,s=t.getBoundingClientRect(),a=s[this.posMaxKey()],n=s[this.posMinKey()],r=e-(window["page"+this.axisKey()+"Offset"]+(this.props.invert?a:n));return this.props.invert&&(r=this.state.sliderLength-r),r-=this.state.thumbSize/2},s.forceValueFromPosition=function(e,t){let s=this.calcOffsetFromPosition(e),a=this.getClosestIndex(s),n=c(this.calcValue(s),this.props),r=this.state.value.slice();r[a]=n;for(let e=0;e<r.length-1;e+=1)if(r[e+1]-r[e]<this.props.minDistance)return;this.fireChangeEvent("onBeforeChange"),this.hasMoved=!0,this.setState({value:r},()=>{t(a),this.fireChangeEvent("onChange")})},s.clearPendingResizeTimeouts=function(){do clearTimeout(this.pendingResizeTimeouts.shift());while(this.pendingResizeTimeouts.length)},s.start=function(e,t){let s=this["thumb"+e];s&&s.focus();let{zIndices:a}=this.state;a.splice(a.indexOf(e),1),a.push(e),this.setState(s=>({startValue:s.value[e],startPosition:void 0!==t?t:s.startPosition,index:e,zIndices:a}))},s.moveUpByStep=function(e){void 0===e&&(e=this.props.step);let t=this.state.value[this.state.index],s=c(this.props.invert&&"horizontal"===this.props.orientation?t-e:t+e,this.props);this.move(Math.min(s,this.props.max))},s.moveDownByStep=function(e){void 0===e&&(e=this.props.step);let t=this.state.value[this.state.index],s=c(this.props.invert&&"horizontal"===this.props.orientation?t+e:t-e,this.props);this.move(Math.max(s,this.props.min))},s.move=function(e){let t=this.state.value.slice(),{index:s}=this.state,{length:a}=t,n=t[s];if(e===n)return;this.hasMoved||this.fireChangeEvent("onBeforeChange"),this.hasMoved=!0;let{pearling:r,max:i,min:l,minDistance:o}=this.props;if(!r){if(s>0){let a=t[s-1];e<a+o&&(e=a+o)}if(s<a-1){let a=t[s+1];e>a-o&&(e=a-o)}}t[s]=e,r&&a>1&&(e>n?(this.pushSucceeding(t,o,s),function(e,t,s,a){for(let n=0;n<e;n+=1){let r=a-n*s;t[e-1-n]>r&&(t[e-1-n]=r)}}(a,t,o,i)):e<n&&(this.pushPreceding(t,o,s),function(e,t,s,a){for(let n=0;n<e;n+=1){let e=a+n*s;t[n]<e&&(t[n]=e)}}(a,t,o,l))),this.setState({value:t},this.fireChangeEvent.bind(this,"onChange"))},s.pushSucceeding=function(e,t,s){let a,n;for(n=e[a=s]+t;null!==e[a+1]&&n>e[a+1];a+=1,n=e[a]+t)e[a+1]=d(n,this.props)},s.pushPreceding=function(e,t,s){for(let a=s,n=e[a]-t;null!==e[a-1]&&n<e[a-1];a-=1,n=e[a]-t)e[a-1]=d(n,this.props)},s.axisKey=function(){return"vertical"===this.props.orientation?"Y":"X"},s.orthogonalAxisKey=function(){return"vertical"===this.props.orientation?"X":"Y"},s.posMinKey=function(){return"vertical"===this.props.orientation?this.props.invert?"bottom":"top":this.props.invert?"right":"left"},s.posMaxKey=function(){return"vertical"===this.props.orientation?this.props.invert?"top":"bottom":this.props.invert?"left":"right"},s.sizeKey=function(){return"vertical"===this.props.orientation?"clientHeight":"clientWidth"},s.fireChangeEvent=function(e){this.props[e]&&this.props[e](l(this.state.value),this.state.index)},s.buildThumbStyle=function(e,t){let s={position:"absolute",touchAction:"none",willChange:this.state.index>=0?this.posMinKey():void 0,zIndex:this.state.zIndices.indexOf(t)+1};return s[this.posMinKey()]=e+"px",s},s.buildTrackStyle=function(e,t){let s={position:"absolute",willChange:this.state.index>=0?this.posMinKey()+","+this.posMaxKey():void 0};return s[this.posMinKey()]=e,s[this.posMaxKey()]=t,s},s.buildMarkStyle=function(e){var t;return(t={position:"absolute"})[this.posMinKey()]=e,t},s.renderThumbs=function(e){let{length:t}=e,s=[];for(let a=0;a<t;a+=1)s[a]=this.buildThumbStyle(e[a],a);let a=[];for(let e=0;e<t;e+=1)a[e]=this.renderThumb(s[e],e);return a},s.renderTracks=function(e){let t=[],s=e.length-1;t.push(this.renderTrack(0,0,e[0]));for(let a=0;a<s;a+=1)t.push(this.renderTrack(a+1,e[a],e[a+1]));return t.push(this.renderTrack(s+1,e[s],this.state.upperBound)),t},s.renderMarks=function(){let{marks:e}=this.props,t=this.props.max-this.props.min+1;return"boolean"==typeof e?e=Array.from({length:t}).map((e,t)=>t):"number"==typeof e&&(e=Array.from({length:t}).map((e,t)=>t).filter(t=>t%e==0)),e.map(parseFloat).sort((e,t)=>e-t).map(e=>{let t=this.calcOffset(e),s={key:e,className:this.props.markClassName,style:this.buildMarkStyle(t)};return this.props.renderMark(s)})},s.render=function(){let e=[],{value:t}=this.state,s=t.length;for(let a=0;a<s;a+=1)e[a]=this.calcOffset(t[a],a);let a=this.props.withTracks?this.renderTracks(e):null,r=this.renderThumbs(e),i=this.props.marks?this.renderMarks():null;return n.default.createElement("div",{ref:e=>{this.slider=e,this.resizeElementRef.current=e},style:{position:"relative"},className:this.props.className+(this.props.disabled?" disabled":""),onMouseDown:this.onSliderMouseDown,onClick:this.onSliderClick},a,r,i)},t}(n.default.Component);p.displayName="ReactSlider",p.defaultProps={min:0,max:100,step:1,pageFn:e=>10*e,minDistance:0,defaultValue:0,orientation:"horizontal",className:"slider",thumbClassName:"thumb",thumbActiveClassName:"active",trackClassName:"track",markClassName:"mark",withTracks:!0,pearling:!1,disabled:!1,snapDragDisabled:!1,invert:!1,marks:[],renderThumb:e=>n.default.createElement("div",e),renderTrack:e=>n.default.createElement("div",e),renderMark:e=>n.default.createElement("span",e)},e.s(["default",()=>p],539522);var u=e.i(935139);e.s(["default",0,e=>{let{className:s,thumbClassName:a,trackClassName:n,max:r,min:i,step:l,value:o,disabled:c,onChange:d}=e;return(0,t.jsx)(p,{disabled:c,value:Number.isNaN(o)?0:o,min:i||0,max:r||100,step:l||1,className:(0,u.cn)("slider relative",s),thumbClassName:(0,u.cn)("absolute top-[-9px] h-5 w-2 rounded-[3px] border-[0.5px] border-components-slider-knob-border bg-components-slider-knob shadow-sm  focus:outline-none",!c&&"cursor-pointer",a),trackClassName:(0,u.cn)("h-0.5 rounded-full","slider-track",n),onChange:d})}],170866)},802859,e=>{"use strict";var t=e.i(563199),s=e.i(837699),a=e.i(268255),n=e.i(935139),r=e.i(291631);e.s(["InputNumber",0,e=>{let{unit:i,className:l,onChange:o,amount:c=1,value:d,size:p="regular",max:u,min:h,defaultValue:m,wrapClassName:x,controlWrapClassName:f,controlClassName:g,disabled:v,...b}=e,y=(0,a.useCallback)(e=>("number"!=typeof u||!(e>u))&&!("number"==typeof h&&e<h),[u,h]),w=(0,a.useCallback)(e=>{if(""===e.target.value)return void o(0);let t=Number(e.target.value);Number.isNaN(t)||y(t)&&o(t)},[y,o]);return(0,t.jsxs)("div",{className:(0,n.cn)("flex",x),children:[(0,t.jsx)(r.default,{...b,type:"number",className:(0,n.cn)("no-spinner rounded-r-none",l),value:d??0,max:u,min:h,disabled:v,onChange:w,unit:i,size:p}),(0,t.jsxs)("div",{className:(0,n.cn)("flex flex-col rounded-r-md border-l border-divider-subtle bg-components-input-bg-normal text-text-tertiary focus:shadow-xs",v&&"cursor-not-allowed opacity-50",f),children:[(0,t.jsx)("button",{type:"button",onClick:()=>{if(v)return;if(void 0===d)return void o(m??0);let e=d+c;y(e)&&o(e)},disabled:v,"aria-label":"increment",className:(0,n.cn)("regular"===p?"pt-1":"pt-1.5","px-1.5 hover:bg-components-input-bg-hover",v&&"cursor-not-allowed hover:bg-transparent",g),children:(0,t.jsx)(s.RiArrowUpSLine,{className:"size-3"})}),(0,t.jsx)("button",{type:"button",onClick:()=>{if(v)return;if(void 0===d)return void o(m??0);let e=d-c;y(e)&&o(e)},disabled:v,"aria-label":"decrement",className:(0,n.cn)("regular"===p?"pb-1":"pb-1.5","px-1.5 hover:bg-components-input-bg-hover",v&&"cursor-not-allowed hover:bg-transparent",g),children:(0,t.jsx)(s.RiArrowDownSLine,{className:"size-3"})})]})]})}])},363282,26273,402588,e=>{"use strict";let t;var s=e.i(563199),a=e.i(268255);e.i(152567);var n=e.i(408767),r=e.i(170866),i=e.i(260484),l=e.i(421001),o=e.i(802859);let c=e=>{let{className:t,id:a,name:n,noTooltip:c,tip:d,step:p=.1,min:u=0,max:h,value:m,enable:x,onChange:f,hasSwitch:g,onSwitchChange:v}=e;return(0,s.jsxs)("div",{className:t,children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex h-6 items-center",children:[g&&(0,s.jsx)(i.default,{size:"md",className:"mr-2",defaultValue:x,onChange:async e=>{v?.(a,e)}}),(0,s.jsx)("span",{className:"system-sm-semibold mr-1 text-text-secondary",children:n}),!c&&(0,s.jsx)(l.default,{triggerClassName:"w-4 h-4 shrink-0",popupContent:(0,s.jsx)("div",{className:"w-[200px]",children:d})})]})}),(0,s.jsxs)("div",{className:"mt-1 flex items-center",children:[(0,s.jsx)("div",{className:"mr-3 flex shrink-0 items-center",children:(0,s.jsx)(o.InputNumber,{disabled:!x,type:"number",min:u,max:h,step:p,amount:p,size:"regular",value:m,onChange:e=>{f(a,e)},className:"w-[72px]"})}),(0,s.jsx)("div",{className:"flex grow items-center",children:(0,s.jsx)(r.default,{className:"w-full",disabled:!x,value:h<5?100*m:m,min:u<1?100*u:u,max:h<5?100*h:h,onChange:e=>f(a,e/(h<5?100:1))})})]})]})};e.s(["default",0,c],26273);let d={default:.7,step:.01,min:0,max:1},p=a.memo(e=>{let{className:t,value:a,enable:r,onChange:i,hasSwitch:l,onSwitchChange:o}=e,{t:p}=(0,n.useTranslation)();return(0,s.jsx)(c,{className:t,id:"score_threshold",name:p("datasetConfig.score_threshold",{ns:"appDebug"}),tip:p("datasetConfig.score_thresholdTip",{ns:"appDebug"}),...d,value:a,enable:r,onChange:(e,t)=>{let s=Number.parseFloat(t.toFixed(2));s=Math.max(d.min,s),i(e,s=Math.min(d.max,s))},hasSwitch:l,onSwitchChange:o})});e.s(["default",0,p],363282);let u={default:2,step:1,min:1,max:(t=Number.parseInt(globalThis.document?.body?.getAttribute("data-public-top-k-max-value")||"",10))&&!isNaN(t)?t:10},h=a.memo(e=>{let{className:t,value:a,enable:r,onChange:i}=e,{t:l}=(0,n.useTranslation)();return(0,s.jsx)(c,{className:t,id:"top_k",name:l("datasetConfig.top_k",{ns:"appDebug"}),tip:l("datasetConfig.top_kTip",{ns:"appDebug"}),...u,value:a,enable:r,onChange:(e,t)=>{let s=Number.parseInt(t.toFixed(0));s=Math.max(u.min,s),i(e,s=Math.min(u.max,s))}})});e.s(["default",0,h],402588)},777582,e=>{"use strict";var t=e.i(563199);e.i(152567);var s=e.i(408767),a=e.i(363282),n=e.i(402588),r=e.i(935139);e.s(["default",0,e=>{let{topK:i,scoreThreshold:l,scoreThresholdEnabled:o,onChange:c,isInHitTesting:d=!1,isInRetrievalSetting:p=!1}=e,{t:u}=(0,s.useTranslation)();return(0,t.jsxs)("div",{className:(0,r.cn)("flex flex-col gap-2 self-stretch",p&&"w-full max-w-[480px]"),children:[!d&&!p&&(0,t.jsx)("div",{className:"flex h-7 flex-col gap-2 self-stretch pt-1",children:(0,t.jsx)("label",{className:"system-sm-semibold text-text-secondary",children:u("retrievalSettings",{ns:"dataset"})})}),(0,t.jsxs)("div",{className:(0,r.cn)("flex gap-4 self-stretch",{"flex-col":d,"flex-row":p,"flex-col sm:flex-row":!d&&!p}),children:[(0,t.jsx)("div",{className:"flex grow flex-col gap-1",children:(0,t.jsx)(n.default,{className:"grow",value:i,onChange:(e,t)=>c({top_k:t}),enable:!0})}),(0,t.jsx)("div",{className:"flex grow flex-col gap-1",children:(0,t.jsx)(a.default,{className:"grow",value:l,onChange:(e,t)=>c({score_threshold:t}),enable:o,hasSwitch:!0,onSwitchChange:(e,t)=>{c({score_threshold_enabled:t})}})})]})]})}])},859765,e=>{"use strict";var t=e.i(563199),s=e.i(326531),a=e.i(268255);e.i(201987);var n=e.i(207331),r=e.i(137667),i=e.i(837699);e.i(152567);var l=e.i(408767),o=e.i(151094),c=e.i(757198),d=e.i(683257),p=e.i(291631),u=e.i(720374),h=e.i(296124);e.i(39598);var m=e.i(549289);let x=e=>{let{items:n,value:r,onSelect:o}=e,{t:c}=(0,l.useTranslation)(),[d,p]=(0,a.useState)(!1),[x,f]=(0,a.useState)(n.find(e=>e.value===r)||null),{setShowExternalKnowledgeAPIModal:g}=(0,h.useModalContext)(),{mutateExternalKnowledgeApis:v}=(0,u.useExternalKnowledgeApi)(),b=(0,s.useRouter)();return(0,a.useEffect)(()=>{f(n.find(e=>e.value===r)||null)},[r,n]),(0,t.jsxs)("div",{className:"relative w-full",children:[(0,t.jsxs)("div",{className:`flex cursor-pointer items-center justify-between gap-0.5 self-stretch rounded-lg bg-components-input-bg-normal px-2
        py-1 hover:bg-state-base-hover-alt ${d&&"bg-state-base-hover-alt"}`,onClick:()=>p(!d),children:[x?(0,t.jsxs)("div",{className:"flex items-center gap-2 self-stretch rounded-lg p-1",children:[(0,t.jsx)(m.ApiConnectionMod,{className:"h-4 w-4 text-text-secondary"}),(0,t.jsx)("div",{className:"flex grow items-center",children:(0,t.jsx)("span",{className:"system-sm-regular overflow-hidden text-ellipsis text-components-input-text-filled",children:x.name})})]}):(0,t.jsx)("span",{className:"system-sm-regular text-components-input-text-placeholder",children:c("selectExternalKnowledgeAPI.placeholder",{ns:"dataset"})}),(0,t.jsx)(i.RiArrowDownSLine,{className:`h-4 w-4 text-text-quaternary transition-transform ${d?"text-text-secondary":""}`})]}),d&&(0,t.jsxs)("div",{className:"absolute z-10 mt-1 w-full rounded-xl border bg-components-panel-bg-blur shadow-lg",children:[n.map(e=>(0,t.jsx)("div",{className:"flex cursor-pointer items-center p-1",onClick:()=>{f(e),o(e),p(!1)},children:(0,t.jsxs)("div",{className:"flex w-full items-center gap-2 self-stretch rounded-lg p-2 hover:bg-state-base-hover",children:[(0,t.jsx)(m.ApiConnectionMod,{className:"h-4 w-4 text-text-secondary"}),(0,t.jsx)("span",{className:"system-sm-medium grow overflow-hidden text-ellipsis text-text-secondary",children:e.name}),(0,t.jsx)("span",{className:"system-xs-regular overflow-hidden text-ellipsis text-right text-text-tertiary",children:e.url})]})},e.value)),(0,t.jsx)("div",{className:"flex flex-col items-start self-stretch p-1",children:(0,t.jsxs)("div",{className:"flex cursor-pointer items-center gap-2 self-stretch rounded-lg p-2 hover:bg-state-base-hover",onClick:()=>{g({payload:{name:"",settings:{endpoint:"",api_key:""}},onSaveCallback:async()=>{v(),b.refresh()},onCancelCallback:()=>{v()},isEditMode:!1})},children:[(0,t.jsx)(i.RiAddLine,{className:"h-4 w-4 text-text-secondary"}),(0,t.jsx)("span",{className:"system-sm-medium grow overflow-hidden text-ellipsis text-text-secondary",children:c("createNewExternalAPI",{ns:"dataset"})})]})})]})]})},f=e=>{let{external_knowledge_api_id:n,external_knowledge_id:r,onChange:c}=e,{t:d}=(0,l.useTranslation)(),m=(0,s.useRouter)(),{externalKnowledgeApiList:f}=(0,u.useExternalKnowledgeApi)(),[g,v]=(0,a.useState)(n),{setShowExternalKnowledgeAPIModal:b}=(0,h.useModalContext)(),{mutateExternalKnowledgeApis:y}=(0,u.useExternalKnowledgeApi)(),w=f.map(e=>({value:e.id,name:e.name,url:e.settings.endpoint}));return(0,a.useEffect)(()=>{if(w.length>0){let e=n||w[0].value;v(e),e!==n&&c({external_knowledge_api_id:e,external_knowledge_id:r})}},[w,n,r,c]),(0,a.useEffect)(()=>{!n&&w.length>0&&c({external_knowledge_api_id:w[0].value,external_knowledge_id:r})},[]),(0,t.jsxs)("form",{className:"flex flex-col gap-4 self-stretch",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1 self-stretch",children:[(0,t.jsx)("div",{className:"flex flex-col self-stretch",children:(0,t.jsx)("label",{className:"system-sm-semibold text-text-secondary",children:d("externalAPIPanelTitle",{ns:"dataset"})})}),w.length>0?(0,t.jsx)(x,{items:w,value:g,onSelect:e=>{v(e.value),c({external_knowledge_api_id:e.value,external_knowledge_id:r})}}):(0,t.jsxs)(o.default,{variant:"tertiary",onClick:()=>{b({payload:{name:"",settings:{endpoint:"",api_key:""}},onSaveCallback:async()=>{y(),m.refresh()},onCancelCallback:()=>{y()},isEditMode:!1})},className:"justify-start gap-0.5",children:[(0,t.jsx)(i.RiAddLine,{className:"h-4 w-4 text-text-tertiary"}),(0,t.jsx)("span",{className:"system-sm-regular text-text-tertiary",children:d("noExternalKnowledge",{ns:"dataset"})})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-1 self-stretch",children:[(0,t.jsx)("div",{className:"flex flex-col self-stretch",children:(0,t.jsx)("label",{className:"system-sm-semibold text-text-secondary",children:d("externalKnowledgeId",{ns:"dataset"})})}),(0,t.jsx)(p.default,{value:r,onChange:e=>c({external_knowledge_id:e.target.value,external_knowledge_api_id:n}),placeholder:d("externalKnowledgeIdPlaceholder",{ns:"dataset"})??""})]})]})},g=()=>{let{t:e}=(0,l.useTranslation)(),s=(0,d.useDocLink)();return(0,t.jsx)("div",{className:"flex w-[360px] flex-col items-start pb-2 pr-8 pt-[108px]",children:(0,t.jsxs)("div",{className:"flex w-full min-w-[240px] flex-col items-start gap-3 self-stretch rounded-xl bg-background-section p-6",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 grow items-center justify-center gap-2 self-stretch rounded-lg border-[0.5px] border-components-card-border bg-components-card-bg p-1",children:(0,t.jsx)(i.RiBookOpenLine,{className:"h-5 w-5 text-text-accent"})}),(0,t.jsxs)("p",{className:"flex flex-col items-start gap-2 self-stretch",children:[(0,t.jsx)("span",{className:"system-xl-semibold self-stretch text-text-secondary",children:e("connectDatasetIntro.title",{ns:"dataset"})}),(0,t.jsxs)("span",{className:"system-sm-regular text-text-tertiary",children:[e("connectDatasetIntro.content.front",{ns:"dataset"}),(0,t.jsx)("a",{className:"system-sm-regular ml-1 text-text-accent",href:s("/use-dify/knowledge/external-knowledge-api"),target:"_blank",rel:"noopener noreferrer",children:e("connectDatasetIntro.content.link",{ns:"dataset"})}),e("connectDatasetIntro.content.end",{ns:"dataset"})]}),(0,t.jsx)("a",{className:"system-sm-regular self-stretch text-text-accent",href:s("/use-dify/knowledge/connect-external-knowledge-base"),target:"_blank",rel:"noopener noreferrer",children:e("connectDatasetIntro.learnMore",{ns:"dataset"})})]})]})})},v=e=>{let{name:s,description:a,onChange:n}=e,{t:r}=(0,l.useTranslation)();return(0,t.jsx)("form",{className:"flex flex-col gap-4 self-stretch",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4 self-stretch",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1 self-stretch",children:[(0,t.jsx)("div",{className:"flex flex-col justify-center self-stretch",children:(0,t.jsx)("label",{className:"system-sm-semibold text-text-secondary",children:r("externalKnowledgeName",{ns:"dataset"})})}),(0,t.jsx)(p.default,{value:s,onChange:e=>{n({name:e.target.value})},placeholder:r("externalKnowledgeNamePlaceholder",{ns:"dataset"})??""})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-1 self-stretch",children:[(0,t.jsx)("div",{className:"flex flex-col justify-center self-stretch",children:(0,t.jsx)("label",{className:"system-sm-semibold text-text-secondary",children:r("externalKnowledgeDescription",{ns:"dataset"})})}),(0,t.jsx)("div",{className:"flex flex-col gap-1 self-stretch",children:(0,t.jsx)("textarea",{value:a,onChange:e=>{n({description:e.target.value})},placeholder:r("externalKnowledgeDescriptionPlaceholder",{ns:"dataset"})??"",className:`flex h-20 items-start self-stretch rounded-lg bg-components-input-bg-normal p-3 py-2 ${a?"text-components-input-text-filled":"text-components-input-text-placeholder"} system-sm-regular`})})]})]})})};var b=e.i(777582);let y=e=>{let{onConnect:n,loading:r}=e,{t:p}=(0,l.useTranslation)(),u=(0,d.useDocLink)(),h=(0,s.useRouter)(),[m,x]=(0,a.useState)({name:"",description:"",external_knowledge_api_id:"",external_knowledge_id:"",external_retrieval_model:{top_k:4,score_threshold:.5,score_threshold_enabled:!1},provider:"external"}),y=(0,a.useCallback)(()=>{h.replace("/datasets")},[h]),w=e=>{x(e)},N=""!==m.name.trim()&&""!==m.external_knowledge_api_id&&""!==m.external_knowledge_id&&void 0!==m.external_retrieval_model.top_k&&void 0!==m.external_retrieval_model.score_threshold;return(0,t.jsx)("div",{className:"flex grow flex-col self-stretch rounded-t-2xl border-t border-effects-highlight bg-components-panel-bg",children:(0,t.jsxs)("div",{className:"flex grow justify-center self-stretch",children:[(0,t.jsx)("div",{className:"flex w-full max-w-[960px] flex-col items-center px-14 py-0",children:(0,t.jsxs)("div",{className:"flex w-full max-w-[640px] grow flex-col items-center gap-4 pb-8 pt-6",children:[(0,t.jsxs)("div",{className:"relative flex flex-col items-center gap-[2px] self-stretch py-2",children:[(0,t.jsx)("div",{className:"system-xl-semibold grow self-stretch text-text-primary",children:p("connectDataset",{ns:"dataset"})}),(0,t.jsxs)("p",{className:"system-sm-regular text-text-tertiary",children:[(0,t.jsx)("span",{children:p("connectHelper.helper1",{ns:"dataset"})}),(0,t.jsx)("span",{className:"system-sm-medium text-text-secondary",children:p("connectHelper.helper2",{ns:"dataset"})}),(0,t.jsx)("span",{children:p("connectHelper.helper3",{ns:"dataset"})}),(0,t.jsx)("a",{className:"system-sm-regular self-stretch text-text-accent",href:u("/use-dify/knowledge/connect-external-knowledge-base"),target:"_blank",rel:"noopener noreferrer",children:p("connectHelper.helper4",{ns:"dataset"})}),(0,t.jsxs)("span",{children:[p("connectHelper.helper5",{ns:"dataset"})," "]})]}),(0,t.jsx)(o.default,{className:"absolute left-[-44px] top-1 flex h-8 w-8 items-center justify-center rounded-full p-2",variant:"tertiary",onClick:y,children:(0,t.jsx)(i.RiArrowLeftLine,{className:"h-4 w-4 text-text-tertiary"})})]}),(0,t.jsx)(v,{name:m.name,description:m.description??"",onChange:e=>w({...m,...e})}),(0,t.jsx)(c.default,{}),(0,t.jsx)(f,{external_knowledge_api_id:m.external_knowledge_api_id,external_knowledge_id:m.external_knowledge_id,onChange:e=>w({...m,...e})}),(0,t.jsx)(b.default,{topK:m.external_retrieval_model.top_k,scoreThreshold:m.external_retrieval_model.score_threshold,scoreThresholdEnabled:m.external_retrieval_model.score_threshold_enabled,onChange:e=>w({...m,external_retrieval_model:{...m.external_retrieval_model,...e}})}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2 self-stretch py-2",children:[(0,t.jsx)(o.default,{variant:"secondary",onClick:y,children:(0,t.jsx)("div",{className:"system-sm-medium text-components-button-secondary-text",children:p("externalKnowledgeForm.cancel",{ns:"dataset"})})}),(0,t.jsxs)(o.default,{variant:"primary",onClick:()=>{n(m)},disabled:!N,loading:r,children:[(0,t.jsx)("div",{className:"system-sm-medium text-components-button-primary-text",children:p("externalKnowledgeForm.connect",{ns:"dataset"})}),(0,t.jsx)(i.RiArrowRightLine,{className:"h-4 w-4 text-components-button-primary-text"})]})]})]})}),(0,t.jsx)(g,{})]})})};var w=e.i(211857);e.s(["default",0,()=>{let{notify:e}=(0,r.useToastContext)(),[i,l]=(0,a.useState)(!1),o=(0,s.useRouter)(),c=async t=>{try{l(!0);let s=await (0,w.createExternalKnowledgeBase)({body:t});if(s&&s.id)e({type:"success",message:"External Knowledge Base Connected Successfully"}),(0,n.trackEvent)("create_external_knowledge_base",{provider:t.provider,name:t.name}),o.back();else throw Error("Failed to create external knowledge base")}catch(t){console.error("Error creating external knowledge base:",t),e({type:"error",message:"Failed to connect External Knowledge Base"})}l(!1)};return(0,t.jsx)(y,{onConnect:c,loading:i})}],859765)}]);