(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,51828,e=>{"use strict";var t=e.i(563199),a=e.i(922521),s=e.i(648404),r=e.i(935139);e.s(["default",0,e=>{let{status:i,children:n}=e,{theme:l}=(0,a.default)();return(0,t.jsxs)("div",{className:(0,r.cn)("system-xs-regular relative break-all rounded-lg border px-3 py-2.5","succeeded"===i&&"border-[rgba(23,178,106,0.8)] bg-workflow-display-success-bg bg-[url(~@/app/components/workflow/run/assets/bg-line-success.svg)] text-text-success","succeeded"===i&&l===s.Theme.light&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.5),inset_0_1px_3px_0_rgba(0,0,0,0.12),inset_0_2px_24px_0_rgba(23,178,106,0.2),0_1px_2px_0_rgba(9,9,11,0.05),0_0_0_1px_rgba(0,0,0,0.05)]","succeeded"===i&&l===s.Theme.dark&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.12),inset_0_1px_3px_0_rgba(0,0,0,0.4),inset_0_2px_24px_0_rgba(23,178,106,0.25),0_1px_2px_0_rgba(0,0,0,0.1),0_0_0_1px_rgba(24, 24, 27, 0.95)]","partial-succeeded"===i&&"border-[rgba(23,178,106,0.8)] bg-workflow-display-success-bg bg-[url(~@/app/components/workflow/run/assets/bg-line-success.svg)] text-text-success","partial-succeeded"===i&&l===s.Theme.light&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.5),inset_0_1px_3px_0_rgba(0,0,0,0.12),inset_0_2px_24px_0_rgba(23,178,106,0.2),0_1px_2px_0_rgba(9,9,11,0.05),0_0_0_1px_rgba(0,0,0,0.05)]","partial-succeeded"===i&&l===s.Theme.dark&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.12),inset_0_1px_3px_0_rgba(0,0,0,0.4),inset_0_2px_24px_0_rgba(23,178,106,0.25),0_1px_2px_0_rgba(0,0,0,0.1),0_0_0_1px_rgba(24, 24, 27, 0.95)]","failed"===i&&"border-[rgba(240,68,56,0.8)] bg-workflow-display-error-bg bg-[url(~@/app/components/workflow/run/assets/bg-line-error.svg)] text-text-warning","failed"===i&&l===s.Theme.light&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.5),inset_0_1px_3px_0_rgba(0,0,0,0.12),inset_0_2px_24px_0_rgba(240,68,56,0.2),0_1px_2px_0_rgba(9,9,11,0.05),0_0_0_1px_rgba(0,0,0,0.05)]","failed"===i&&l===s.Theme.dark&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.12),inset_0_1px_3px_0_rgba(0,0,0,0.4),inset_0_2px_24px_0_rgba(240,68,56,0.25),0_1px_2px_0_rgba(0,0,0,0.1),0_0_0_1px_rgba(24, 24, 27, 0.95)]","stopped"===i&&"border-[rgba(247,144,9,0.8)] bg-workflow-display-warning-bg bg-[url(~@/app/components/workflow/run/assets/bg-line-warning.svg)] text-text-destructive","stopped"===i&&l===s.Theme.light&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.5),inset_0_1px_3px_0_rgba(0,0,0,0.12),inset_0_2px_24px_0_rgba(247,144,9,0.2),0_1px_2px_0_rgba(9,9,11,0.05),0_0_0_1px_rgba(0,0,0,0.05)]","stopped"===i&&l===s.Theme.dark&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.12),inset_0_1px_3px_0_rgba(0,0,0,0.4),inset_0_2px_24px_0_rgba(247,144,9,0.25),0_1px_2px_0_rgba(0,0,0,0.1),0_0_0_1px_rgba(24, 24, 27, 0.95)]","exception"===i&&"border-[rgba(247,144,9,0.8)] bg-workflow-display-warning-bg bg-[url(~@/app/components/workflow/run/assets/bg-line-warning.svg)] text-text-destructive","exception"===i&&l===s.Theme.light&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.5),inset_0_1px_3px_0_rgba(0,0,0,0.12),inset_0_2px_24px_0_rgba(247,144,9,0.2),0_1px_2px_0_rgba(9,9,11,0.05),0_0_0_1px_rgba(0,0,0,0.05)]","exception"===i&&l===s.Theme.dark&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.12),inset_0_1px_3px_0_rgba(0,0,0,0.4),inset_0_2px_24px_0_rgba(247,144,9,0.25),0_1px_2px_0_rgba(0,0,0,0.1),0_0_0_1px_rgba(24, 24, 27, 0.95)]","running"===i&&"border-[rgba(11,165,236,0.8)] bg-workflow-display-normal-bg bg-[url(~@/app/components/workflow/run/assets/bg-line-running.svg)] text-util-colors-blue-light-blue-light-600","running"===i&&l===s.Theme.light&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.5),inset_0_1px_3px_0_rgba(0,0,0,0.12),inset_0_2px_24px_0_rgba(11,165,236,0.2),0_1px_2px_0_rgba(9,9,11,0.05),0_0_0_1px_rgba(0,0,0,0.05)]","running"===i&&l===s.Theme.dark&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.12),inset_0_1px_3px_0_rgba(0,0,0,0.4),inset_0_2px_24px_0_rgba(11,165,236,0.25),0_1px_2px_0_rgba(0,0,0,0.1),0_0_0_1px_rgba(24, 24, 27, 0.95)]"),children:[(0,t.jsx)("div",{className:(0,r.cn)("absolute left-0 top-0 h-[50px] w-[65%] bg-no-repeat",l===s.Theme.light&&"bg-[url(~@/app/components/workflow/run/assets/highlight.svg)]",l===s.Theme.dark&&"bg-[url(~@/app/components/workflow/run/assets/highlight-dark.svg)]")}),n]})}])},40720,e=>{"use strict";var t=e.i(563199);e.i(152567);var a=e.i(408767),s=e.i(836340),r=e.i(51828),i=e.i(683257),n=e.i(935139);e.s(["default",0,e=>{let{status:l,time:o,tokens:d,error:c,exceptionCounts:x,isListening:p=!1}=e,{t:u}=(0,a.useTranslation)(),m=(0,i.useDocLink)();return(0,t.jsxs)(r.default,{status:l,children:[(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsxs)("div",{className:(0,n.cn)("max-w-[120px] flex-[33%]","partial-succeeded"===l&&"min-w-[140px]"),children:[(0,t.jsx)("div",{className:"system-2xs-medium-uppercase mb-1 text-text-tertiary",children:u("resultPanel.status",{ns:"runLog"})}),(0,t.jsxs)("div",{className:(0,n.cn)("system-xs-semibold-uppercase flex items-center gap-1","succeeded"===l&&"text-util-colors-green-green-600","partial-succeeded"===l&&"text-util-colors-green-green-600","failed"===l&&"text-util-colors-red-red-600","stopped"===l&&"text-util-colors-warning-warning-600","running"===l&&"text-util-colors-blue-light-blue-light-600"),children:["running"===l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.default,{color:"blue"}),(0,t.jsx)("span",{children:p?"Listening":"Running"})]}),"succeeded"===l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.default,{color:"green"}),(0,t.jsx)("span",{children:"SUCCESS"})]}),"partial-succeeded"===l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.default,{color:"green"}),(0,t.jsx)("span",{children:"PARTIAL SUCCESS"})]}),"exception"===l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.default,{color:"yellow"}),(0,t.jsx)("span",{children:"EXCEPTION"})]}),"failed"===l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.default,{color:"red"}),(0,t.jsx)("span",{children:"FAIL"})]}),"stopped"===l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.default,{color:"yellow"}),(0,t.jsx)("span",{children:"STOP"})]})]})]}),(0,t.jsxs)("div",{className:"max-w-[152px] flex-[33%]",children:[(0,t.jsx)("div",{className:"system-2xs-medium-uppercase mb-1 text-text-tertiary",children:u("resultPanel.time",{ns:"runLog"})}),(0,t.jsxs)("div",{className:"system-sm-medium flex items-center gap-1 text-text-secondary",children:["running"===l&&(0,t.jsx)("div",{className:"h-2 w-16 rounded-sm bg-text-quaternary"}),"running"!==l&&(0,t.jsx)("span",{children:o?`${o?.toFixed(3)}s`:"-"})]})]}),(0,t.jsxs)("div",{className:"flex-[33%]",children:[(0,t.jsx)("div",{className:"system-2xs-medium-uppercase mb-1 text-text-tertiary",children:u("resultPanel.tokens",{ns:"runLog"})}),(0,t.jsxs)("div",{className:"system-sm-medium flex items-center gap-1 text-text-secondary",children:["running"===l&&(0,t.jsx)("div",{className:"h-2 w-20 rounded-sm bg-text-quaternary"}),"running"!==l&&(0,t.jsx)("span",{children:`${d||0} Tokens`})]})]})]}),"failed"===l&&c&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"my-2 h-[0.5px] bg-divider-subtle"}),(0,t.jsx)("div",{className:"system-xs-regular whitespace-pre-wrap text-text-destructive",children:c}),!!x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"my-2 h-[0.5px] bg-divider-subtle"}),(0,t.jsx)("div",{className:"system-xs-regular text-text-destructive",children:u("nodes.common.errorHandle.partialSucceeded.tip",{ns:"workflow",num:x})})]})]}),"partial-succeeded"===l&&!!x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"my-2 h-[0.5px] bg-divider-deep"}),(0,t.jsx)("div",{className:"system-xs-medium text-text-warning",children:u("nodes.common.errorHandle.partialSucceeded.tip",{ns:"workflow",num:x})})]}),"exception"===l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"my-2 h-[0.5px] bg-divider-deep"}),(0,t.jsxs)("div",{className:"system-xs-medium text-text-warning",children:[c,(0,t.jsx)("a",{href:m("/use-dify/debug/error-type"),target:"_blank",className:"text-text-accent",children:u("common.learnMore",{ns:"workflow"})})]})]})]})}])},607224,e=>{"use strict";var t=e.i(361126),a=e.i(390622);let s=[a.BlockEnum.Agent,a.BlockEnum.Tool],r=(e,t)=>{let{children:a}=e;a&&0!==a.length&&(a.find(e=>(e.message_id||e.id)===t)&&(e.hasCircle=!0,e.children=e.children.filter(e=>(e.message_id||e.id)!==t),a=e.children),a.forEach(e=>{r(e,t)}))},i=e=>{let a=(0,t.cloneDeep)(e);if(!a.children||0===a.children.length)return a;a.children=(e=>{if(!e||0===e.length)return[];let t=[],a=[];return e.forEach(e=>{let s=e.message_id||e.id;s&&!a.includes(s)&&(t.push(e),a.push(s))}),t})(a.children);let s=a.message_id||a.id,{children:n}=a;return n.find(e=>(e.message_id||e.id)===s)&&(a.hasCircle=!0,a.children=a.children.filter(e=>(e.message_id||e.id)!==s),n=a.children),n.forEach((e,t)=>{r(e,s),n[t]=i(e)}),a},n=(e,t,s)=>{let r=[...e];r.forEach(e=>{let t=e.parallel_id??e.execution_metadata?.parallel_id??null,s=e.parallel_start_node_id??e.execution_metadata?.parallel_start_node_id??null,i=e.parent_parallel_id??e.execution_metadata?.parent_parallel_id??null,n=e.parallel_start_node_id??e.execution_metadata?.parallel_start_node_id??null,l=e.parent_parallel_start_node_id??e.execution_metadata?.parent_parallel_start_node_id??null;if(!t||e.node_type===a.BlockEnum.End)return;if(s===e.node_id){let t={...e,parallelDetail:void 0};if(e.parallelDetail={isParallelStartNode:!0,children:[t]},!i)return;let a=r.find(e=>e.node_id===l);if(a&&(a?.parallelDetail||(a.parallelDetail={children:[]}),a.parallelDetail.children)){let t=a.parallelDetail.children.findLastIndex(e=>(e.parallel_start_node_id??e.execution_metadata?.parallel_start_node_id??null)===l);-1!==t?a.parallelDetail.children.splice(t+1,0,e):a.parallelDetail.children.push(e)}return}let o=r.find(e=>s===e.node_id);if(o&&o.parallelDetail&&o.parallelDetail.children){let t=o.parallelDetail.children.findLastIndex(e=>(e.parallel_start_node_id??e.execution_metadata?.parallel_start_node_id??null)===n);-1!==t?o.parallelDetail.children.splice(t+1,0,e):o.parallelDetail.children.push(e)}});let i=r.filter(e=>!(e.parallel_id??e.execution_metadata?.parallel_id)||e.node_type===a.BlockEnum.End||!(e.parent_parallel_id??e.execution_metadata?.parent_parallel_id)&&!!e.parallelDetail?.isParallelStartNode);return s&&i.forEach(e=>{Date.now(),function e(t,a){"  ".repeat(a),t.parallelDetail?.children&&t.parallelDetail.children.forEach(t=>{e(t,a+1)})}(e,0)}),!function e(t,s){let{list:r,depth:i,belongParallelIndexInfo:n}=t,l=0,o=r.filter(e=>e.parallelDetail?.isParallelStartNode).length>1;r.forEach(t=>{let d=t.parallel_id??t.execution_metadata?.parallel_id??null,c=t.parallel_start_node_id??t.execution_metadata?.parallel_start_node_id??null;if(!d||t.node_type===a.BlockEnum.End)return;let x=t.parallelDetail?.isParallelStartNode,p=x&&o?String.fromCharCode(64+(1+r.filter(e=>e.parallelDetail?.isParallelStartNode).findIndex(e=>e.node_id===t.node_id))):"",u=`${i}${p}`;if(x&&(t.parallelDetail.isParallelStartNode=!0,t.parallelDetail.parallelTitle=`${s("common.parallel",{ns:"workflow"})}-${u}`),c===t.node_id){let e=String.fromCharCode(64+ ++l);t.parallelDetail||(t.parallelDetail={branchTitle:""}),t.parallelDetail.branchTitle=`${s("common.branch",{ns:"workflow"})}-${n}-${e}`}t.parallelDetail?.children&&t.parallelDetail.children.length>0&&e({list:t.parallelDetail.children,depth:i+1,belongParallelIndexInfo:u},s)})}({list:i,depth:1},t),i};e.s(["default",0,(e,r)=>{var l,o;let d,c,x,p,u,m,g,_=(c=(d=(l=(0,t.cloneDeep)([...e]).sort((e,t)=>e.index-t.index).map(e=>{let t=[];return s.includes(e.node_type)&&e.execution_metadata?.agent_log&&e.execution_metadata?.agent_log.length>0&&(t=(e=>{if(!e||0===e.length)return[];let t=new Map,a=new Map;e.forEach(e=>{let s=e.message_id||e.id;s&&!t.has(s)&&t.set(s,e),s&&!a.has(s)&&a.set(s,[]),e.parent_id&&(a.has(e.parent_id)||a.set(e.parent_id,[]),a.get(e.parent_id).push(e))});let s=[];return t.forEach(e=>{if(!e.parent_id){let t=e.message_id||e.id,r=a.get(t);r&&r.length>0&&(e.children=r),s.push(e)}}),t.forEach(e=>{let t=e.message_id||e.id,s=a.get(t);s&&s.length>0&&(e.children=s)}),s})(e.execution_metadata.agent_log)),e.agentLog=t.length>0?t.map(e=>i(e)):[],e})).filter(e=>"retry"===e.status)).map(e=>e.node_id),o=l.filter(e=>"retry"!==e.status).map(e=>{let{execution_metadata:t}=e,a=!!t?.iteration_id,s=!!t?.loop_id,r=e.node_id;return c.includes(r)?{...e,retryDetail:d.filter(e=>a||s?a?e.node_id===r&&e.execution_metadata?.iteration_index===t?.iteration_index:!!s&&e.node_id===r&&e.execution_metadata?.loop_index===t?.loop_index:e.node_id===r)}:e}),p=(x=(0,t.cloneDeep)(o)).filter(e=>e.node_type===a.BlockEnum.Loop).map(e=>e.node_id),u=x.filter(e=>e.node_type===a.BlockEnum.Iteration).map(e=>e.node_id),m=x.filter(e=>e.execution_metadata?.loop_id&&p.includes(e.execution_metadata.loop_id)).map(e=>e.node_id),g=x.filter(e=>e.execution_metadata?.iteration_id&&u.includes(e.execution_metadata.iteration_id)).map(e=>e.node_id),x.filter(e=>!m.includes(e.node_id)&&!g.includes(e.node_id)).map(e=>{if(e.node_type===a.BlockEnum.Loop){let t,a=x.filter(t=>t.execution_metadata?.loop_id===e.node_id),s=a.find(e=>"failed"===e.status);s&&(e.status="failed",e.error=s.error);let i=(t=[],a.forEach(e=>{if(!e.execution_metadata)return;let{parallel_mode_run_id:a,loop_index:s=0}=e.execution_metadata,r=a||s;t[r]||(t[r]=[]),t[r].push(e)}),{...e,details:t});return i.details&&i.details.length>0&&(i.details=i.details.map(e=>n(e,r))),i}if(e.node_type===a.BlockEnum.Iteration){let t,a=x.filter(t=>t.execution_metadata?.iteration_id===e.node_id),s=a.find(e=>"failed"===e.status);s&&(e.status="failed",e.error=s.error);let i=(t=[],a.forEach((e,a)=>{if(!e.execution_metadata)return;let{iteration_index:s=0}=e.execution_metadata,r=void 0!==s?s:a;t[r]||(t[r]=[]),t[r].push(e)}),{...e,details:t});return i.details&&i.details.length>0&&(i.details=i.details.map(e=>n(e,r))),i}return e}));return n(_,r)}],607224)},267223,e=>{"use strict";var t=e.i(417944),a=e.i(268255);e.s(["useLogs",0,()=>{let[e,{setTrue:s,setFalse:r}]=(0,t.useBoolean)(!1),[i,n]=(0,a.useState)([]),l=(0,a.useCallback)(e=>{s(),n(e)},[s,n]),[o,{setTrue:d,setFalse:c}]=(0,t.useBoolean)(!1),[x,p]=(0,a.useState)([]),[u,m]=(0,a.useState)({}),g=(0,a.useCallback)((e,t)=>{d(),p(e),m(t)},[d,p,m]),[_,{setTrue:h,setFalse:b}]=(0,t.useBoolean)(!1),[f,w]=(0,a.useState)([]),[j,v]=(0,a.useState)({}),[y,N]=(0,a.useState)({}),k=(0,a.useCallback)((e,t,a)=>{h(),w(e),v(t),N(a)},[h,w,v]),[L,S]=(0,a.useState)([]),R=(0,a.useRef)(L),[T,E]=(0,a.useState)({}),C=(0,a.useRef)(T),D=(0,a.useCallback)(e=>{if(!e){S([]),R.current=[];return}let{message_id:t,children:a}=e,s=R.current.slice(),r=s.findIndex(e=>e.message_id===t);S(s=r>-1?s.slice(0,r+1):[...s.slice(),e]),R.current=s,a&&E({...C.current,[t]:a})},[S,E]);return{showSpecialResultPanel:e||o||_||!!L.length,showRetryDetail:e,setShowRetryDetailTrue:s,setShowRetryDetailFalse:r,retryResultList:i,setRetryResultList:n,handleShowRetryResultList:l,showIteratingDetail:o,setShowIteratingDetailTrue:d,setShowIteratingDetailFalse:c,iterationResultList:x,setIterationResultList:p,iterationResultDurationMap:u,setIterationResultDurationMap:m,handleShowIterationResultList:g,showLoopingDetail:_,setShowLoopingDetailTrue:h,setShowLoopingDetailFalse:b,loopResultList:f,setLoopResultList:w,loopResultDurationMap:j,setLoopResultDurationMap:v,loopResultVariableMap:y,setLoopResultVariableMap:N,handleShowLoopResultList:k,agentOrToolLogItemStack:L,agentOrToolLogListMap:T,handleShowAgentOrToolLog:D}}])},216669,e=>{"use strict";var t=e.i(563199),a=e.i(837699),s=e.i(268255);e.i(152567);var r=e.i(408767),i=e.i(381086);e.s(["default",0,e=>{let{type:n}=e,{t:l}=(0,r.useTranslation)(),o=(0,s.useMemo)(()=>n===i.ErrorHandleTypeEnum.failBranch?l("nodes.common.errorHandle.failBranch.inLog",{ns:"workflow"}):n===i.ErrorHandleTypeEnum.defaultValue?l("nodes.common.errorHandle.defaultValue.inLog",{ns:"workflow"}):void 0,[l,n]);return n?(0,t.jsxs)("div",{className:"relative flex rounded-lg border-[0.5px] border-components-panel-border bg-components-panel-bg-blur p-2 pr-[52px] shadow-xs",children:[(0,t.jsx)("div",{className:"absolute inset-0 rounded-lg opacity-40",style:{background:"linear-gradient(92deg, rgba(247, 144, 9, 0.25) 0%, rgba(255, 255, 255, 0.00) 100%)"}}),(0,t.jsx)(a.RiAlertFill,{className:"mr-1 h-4 w-4 shrink-0 text-text-warning-secondary"}),(0,t.jsx)("div",{className:"system-xs-medium grow text-text-primary",children:o})]}):null}])},70380,e=>{"use strict";var t=e.i(563199),a=e.i(837699),s=e.i(268255);e.i(152567);var r=e.i(408767),i=e.i(935139);let n=s.memo(e=>{let{textHasNoExport:s,downloadUrl:n,className:l}=e,{t:o}=(0,r.useTranslation)(),d=o(s?"debug.variableInspect.largeDataNoExport":"debug.variableInspect.largeData",{ns:"workflow"});return(0,t.jsxs)("div",{className:(0,i.cn)("flex h-8 items-center justify-between rounded-lg border-[0.5px] border-components-panel-border bg-components-panel-bg-blur px-2 shadow-xs",l),children:[(0,t.jsxs)("div",{className:"flex h-full w-0 grow items-center space-x-1",children:[(0,t.jsx)(a.RiInformation2Fill,{className:"size-4 shrink-0 text-text-accent"}),(0,t.jsx)("div",{className:"system-xs-regular w-0 grow truncate text-text-primary",children:d})]}),n&&(0,t.jsx)("div",{className:"system-xs-medium-uppercase ml-1 shrink-0 cursor-pointer text-text-accent",children:o("debug.variableInspect.export",{ns:"workflow"})})]})});e.s(["default",0,n])},493599,256734,890317,e=>{"use strict";var t=e.i(563199),a=e.i(837699);e.i(152567);var s=e.i(408767);e.s(["default",0,e=>{let{nodeInfo:r,onShowAgentOrToolLog:i}=e,{t:n}=(0,s.useTranslation)(),{agentLog:l,execution_metadata:o}=r,d=o?.tool_info?.agent_strategy;return(0,t.jsxs)("div",{className:"cursor-pointer rounded-[10px] bg-components-button-tertiary-bg",onClick:()=>{i({message_id:r.id,children:l||[]})},children:[(0,t.jsx)("div",{className:"system-2xs-medium-uppercase flex items-center px-3 pt-2 text-text-tertiary",children:n("nodes.agent.strategy.label",{ns:"workflow"})}),(0,t.jsxs)("div",{className:"flex items-center pb-1.5 pl-3 pr-2 pt-1",children:[d&&(0,t.jsx)("div",{className:"system-xs-medium grow text-text-secondary",children:d}),(0,t.jsxs)("div",{className:"system-xs-regular-uppercase flex shrink-0 cursor-pointer items-center px-[1px] text-text-tertiary",children:[n("detail",{ns:"runLog"}),(0,t.jsx)(a.RiArrowRightLine,{className:"ml-0.5 h-3.5 w-3.5"})]})]})]})}],256734);var r=e.i(268255),i=e.i(151094),n=e.i(222573),l=e.i(120219),o=e.i(481162),d=e.i(935139);let c=e=>{let{status:s,className:r}=e;return(0,t.jsxs)(t.Fragment,{children:["succeeded"===s&&(0,t.jsx)(a.RiCheckboxCircleFill,{className:(0,d.cn)("h-4 w-4 shrink-0 text-text-success",r)}),"failed"===s&&(0,t.jsx)(a.RiErrorWarningLine,{className:(0,d.cn)("h-4 w-4 shrink-0 text-text-warning",r)}),("stopped"===s||"exception"===s)&&(0,t.jsx)(a.RiAlertFill,{className:(0,d.cn)("h-4 w-4 shrink-0 text-text-warning-secondary",r)}),"running"===s&&(0,t.jsx)(a.RiLoader2Line,{className:(0,d.cn)("h-4 w-4 shrink-0 animate-spin text-text-accent",r)})]})};var x=e.i(955371),p=e.i(390622);let u=e=>{let{item:s,onShowAgentOrToolLog:u}=e,{label:m,status:g,children:_,data:h,metadata:b}=s,[f,w]=(0,r.useState)(!1),{getIconUrl:j}=(0,n.default)(),v=(0,r.useMemo)(()=>{let e=b?.icon;return e?e.includes("http")?e:j(e):""},[j,b?.icon]),y=(0,r.useMemo)(()=>"start"===g?"running":g,[g]);return(0,t.jsxs)("div",{className:"rounded-[10px] border-[0.5px] border-components-panel-border bg-background-default",children:[(0,t.jsxs)("div",{className:(0,d.cn)("flex cursor-pointer items-center pb-2 pl-1.5 pr-3 pt-2",f&&"pb-1"),onClick:()=>w(!f),children:[f?(0,t.jsx)(a.RiArrowRightSLine,{className:"h-4 w-4 shrink-0 rotate-90 text-text-quaternary"}):(0,t.jsx)(a.RiArrowRightSLine,{className:"h-4 w-4 shrink-0 text-text-quaternary"}),(0,t.jsx)(l.default,{className:"mr-1.5 shrink-0",type:v?p.BlockEnum.Tool:p.BlockEnum.Agent,toolIcon:v}),(0,t.jsx)("div",{className:"system-sm-semibold-uppercase grow truncate text-text-secondary",title:m,children:m}),!!b?.elapsed_time&&(0,t.jsxs)("div",{className:"system-xs-regular mr-2 shrink-0 text-text-tertiary",children:[b?.elapsed_time?.toFixed(3),"s"]}),(0,t.jsx)(c,{status:y})]}),f&&(0,t.jsxs)("div",{className:"p-1 pt-0",children:[!!_?.length&&(0,t.jsxs)(i.default,{className:"mb-1 flex w-full items-center justify-between",variant:"tertiary",onClick:()=>u(s),children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(a.RiListView,{className:"mr-1 h-4 w-4 shrink-0 text-components-button-tertiary-text"}),`${_.length} Action Logs`]}),(0,t.jsx)("div",{className:"flex",children:(0,t.jsx)(a.RiArrowRightSLine,{className:"h-4 w-4 shrink-0 text-components-button-tertiary-text"})})]}),h&&(0,t.jsx)(o.default,{readOnly:!0,title:(0,t.jsx)("div",{children:"data".toLocaleUpperCase()}),language:x.CodeLanguage.json,value:h,isJSONStringifyBeauty:!0})]})]})};var m=e.i(391185);let g=e=>{let{options:s,onShowAgentOrToolLog:n}=e,[l,o]=(0,r.useState)(!1);return(0,t.jsxs)(m.PortalToFollowElem,{placement:"bottom-start",offset:{mainAxis:2,crossAxis:-54},open:l,onOpenChange:o,children:[(0,t.jsx)(m.PortalToFollowElemTrigger,{children:(0,t.jsx)(i.default,{className:"h-6 w-6",variant:"ghost-accent",children:(0,t.jsx)(a.RiMoreLine,{className:"h-4 w-4"})})}),(0,t.jsx)(m.PortalToFollowElemContent,{children:(0,t.jsx)("div",{className:"w-[136px] rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur p-1 shadow-lg",children:s.map(e=>(0,t.jsx)("div",{className:"system-md-regular flex h-8 cursor-pointer items-center rounded-lg px-2 text-text-secondary hover:bg-state-base-hover",onClick:()=>{n(e),o(!1)},children:e.label},e.message_id))})})]})},_=e=>{let{agentOrToolLogItemStack:r,onShowAgentOrToolLog:n}=e,{t:l}=(0,s.useTranslation)(),o=r.length,d=r[0],c=r.slice(1,-1),x=r.at(-1);return(0,t.jsxs)("div",{className:"flex h-8 items-center bg-components-panel-bg p-1 pr-3",children:[(0,t.jsxs)(i.default,{className:"shrink-0 px-[5px]",size:"small",variant:"ghost-accent",onClick:()=>{n()},children:[(0,t.jsx)(a.RiArrowLeftLine,{className:"mr-1 h-3.5 w-3.5"}),"AGENT"]}),(0,t.jsx)("div",{className:"system-xs-regular mx-0.5 shrink-0 text-divider-deep",children:"/"}),o>1?(0,t.jsx)(i.default,{className:"shrink-0 px-[5px]",size:"small",variant:"ghost-accent",onClick:()=>n(d),children:l("nodes.agent.strategy.label",{ns:"workflow"})}):(0,t.jsx)("div",{className:"system-xs-medium-uppercase flex items-center px-[5px] text-text-tertiary",children:l("nodes.agent.strategy.label",{ns:"workflow"})}),!!c.length&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"system-xs-regular mx-0.5 shrink-0 text-divider-deep",children:"/"}),(0,t.jsx)(g,{options:c,onShowAgentOrToolLog:n})]}),!!x&&o>1&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"system-xs-regular mx-0.5 shrink-0 text-divider-deep",children:"/"}),(0,t.jsx)("div",{className:"system-xs-medium-uppercase flex items-center px-[5px] text-text-tertiary",children:x.label})]})]})};e.s(["default",0,e=>{let{agentOrToolLogItemStack:r,agentOrToolLogListMap:i,onShowAgentOrToolLog:n}=e,{t:l}=(0,s.useTranslation)(),o=r[r.length-1],d=i[o.message_id];return(0,t.jsxs)("div",{className:"overflow-y-auto bg-background-section",children:[(0,t.jsx)(_,{agentOrToolLogItemStack:r,onShowAgentOrToolLog:n}),(0,t.jsx)("div",{className:"space-y-1 p-2",children:d.map(e=>(0,t.jsx)(u,{item:e,onShowAgentOrToolLog:n},e.message_id))}),o.hasCircle&&(0,t.jsxs)("div",{className:"mt-1 flex items-center rounded-xl border border-components-panel-border bg-components-panel-bg-blur px-3 pr-2 shadow-md",children:[(0,t.jsx)("div",{className:"absolute inset-0 rounded-xl opacity-[0.4]",style:{background:"linear-gradient(92deg, rgba(247, 144, 9, 0.25) 0%, rgba(255, 255, 255, 0.00) 100%)"}}),(0,t.jsx)(a.RiAlertFill,{className:"mr-1.5 h-4 w-4 text-text-warning-secondary"}),(0,t.jsx)("div",{className:"system-xs-medium text-text-primary",children:l("circularInvocationTip",{ns:"runLog"})})]})]})}],890317),e.s([],493599)},252386,e=>{"use strict";var t=e.i(256734);e.s(["AgentLogTrigger",()=>t.default])},735010,e=>{"use strict";var t=e.i(563199),a=e.i(837699);e.i(152567);var s=e.i(408767),r=e.i(151094);e.i(916131);var i=e.i(520931),n=e.i(390622);e.s(["default",0,e=>{let{nodeInfo:l,allExecutions:o,onShowIterationResultList:d}=e,{t:c}=(0,s.useTranslation)(),x=0,p=l.execution_metadata?.iteration_duration_map;p?x=Object.keys(p).length:l.details?.length?x=l.details.length:l.metadata?.iterator_length&&(x=l.metadata.iterator_length);let u=((e,t)=>{if(!e||0===e.length)return 0;let a=new Set;return e.forEach((e,t)=>{if(e.some(e=>e.status===n.NodeRunningStatus.Failed)){let s=e[0]?.execution_metadata?.iteration_index??t;a.add(s)}}),t?.iteration_duration_map&&o&&o.forEach(e=>{e.execution_metadata?.iteration_id===l.node_id&&e.status===n.NodeRunningStatus.Failed&&e.execution_metadata?.iteration_index!==void 0&&a.add(e.execution_metadata.iteration_index)}),a.size})(l.details,l.execution_metadata);return(0,t.jsxs)(r.default,{className:"flex w-full cursor-pointer items-center gap-2 self-stretch rounded-lg border-none bg-components-button-tertiary-bg-hover px-3 py-2 hover:bg-components-button-tertiary-bg-hover",onClick:e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();let t=l.execution_metadata,a=l?.iterDurationMap||t?.iteration_duration_map||{},s=[];if(t?.iteration_duration_map){if(s=Object.keys(t.iteration_duration_map).map(e=>(e=>{if(!o)return[];let t=o.filter(t=>t.execution_metadata?.parallel_mode_run_id===e);if(t.length>0)return t;let a=Number.parseInt(e,10);if(!isNaN(a)){let e=o.filter(e=>e.execution_metadata?.iteration_id===l.node_id&&e.execution_metadata?.iteration_index===a);if(e.length>0)return e}return[]})(e)).filter(e=>e.length>0),o&&l.details?.length){let e=new Set;s.forEach(t=>{t.forEach(t=>{t.execution_metadata?.iteration_index!==void 0&&e.add(t.execution_metadata.iteration_index)})}),l.details.forEach((t,a)=>{!e.has(a)&&t.some(e=>e.status===n.NodeRunningStatus.Failed)&&s.push(t)}),s.sort((e,t)=>(e[0]?.execution_metadata?.iteration_index??0)-(t[0]?.execution_metadata?.iteration_index??0))}}else l.details?.length&&(s=l.details);d(s,a)},children:[(0,t.jsx)(i.Iteration,{className:"h-4 w-4 shrink-0 text-components-button-tertiary-text"}),(0,t.jsxs)("div",{className:"system-sm-medium flex-1 text-left text-components-button-tertiary-text",children:[c("nodes.iteration.iteration",{ns:"workflow",count:x}),u>0&&(0,t.jsxs)(t.Fragment,{children:[c("nodes.iteration.comma",{ns:"workflow"}),c("nodes.iteration.error",{ns:"workflow",count:u})]})]}),(0,t.jsx)(a.RiArrowRightSLine,{className:"h-4 w-4 shrink-0 text-components-button-tertiary-text"})]})}])},213284,339146,e=>{"use strict";e.s([],213284),e.i(735010),e.s(["default",()=>c],339146);var t=e.i(563199),a=e.i(837699),s=e.i(268255);e.i(152567);var r=e.i(408767);e.i(916131);var i=e.i(520931),n=e.i(567898),l=e.i(390622),o=e.i(935139);let d="singleRun",c=s.memo(e=>{let{list:c,onBack:x,iterDurationMap:p}=e,{t:u}=(0,r.useTranslation)(),[m,g]=(0,s.useState)({}),_=(0,s.useCallback)(e=>{g(t=>({...t,[e]:!t[e]}))},[]);return(0,t.jsxs)("div",{className:"bg-components-panel-bg",children:[(0,t.jsxs)("div",{className:"flex h-8 cursor-pointer items-center border-b-[0.5px] border-b-divider-regular px-4 text-text-accent-secondary",onClick:e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),x()},children:[(0,t.jsx)(a.RiArrowLeftLine,{className:"mr-1 h-4 w-4"}),(0,t.jsx)("div",{className:"system-sm-medium",children:u(`${d}.back`,{ns:"workflow"})})]}),(0,t.jsx)("div",{className:"bg-components-panel-bg p-2",children:c.map((e,s)=>(0,t.jsxs)("div",{className:(0,o.cn)("mb-1 overflow-hidden rounded-xl border-none bg-background-section-burn"),children:[(0,t.jsx)("div",{className:(0,o.cn)("flex w-full cursor-pointer items-center justify-between px-3",m[s]?"pb-2 pt-3":"py-3","rounded-xl text-left"),onClick:()=>_(s),children:(0,t.jsxs)("div",{className:(0,o.cn)("flex grow items-center gap-2"),children:[(0,t.jsx)("div",{className:"flex h-4 w-4 shrink-0 items-center justify-center rounded-[5px] border-divider-subtle bg-util-colors-cyan-cyan-500",children:(0,t.jsx)(i.Iteration,{className:"h-3 w-3 text-text-primary-on-surface"})}),(0,t.jsxs)("span",{className:"system-sm-semibold-uppercase grow text-text-primary",children:[u(`${d}.iteration`,{ns:"workflow"})," ",s+1]}),((e,s,r)=>{let i,n,d=s.some(e=>e.status===l.NodeRunningStatus.Failed),c=s.some(e=>e.status===l.NodeRunningStatus.Running),x=r&&0!==Object.keys(r).length;return d?(0,t.jsx)(a.RiErrorWarningLine,{className:"h-4 w-4 text-text-destructive"}):c?(0,t.jsx)(a.RiLoader2Line,{className:"h-3.5 w-3.5 animate-spin text-primary-600"}):(0,t.jsxs)(t.Fragment,{children:[x&&(0,t.jsx)("div",{className:"system-xs-regular text-text-tertiary",children:(i=s[0]?.execution_metadata?.iteration_index,n=r[s[0]?.execution_metadata?.parallel_mode_run_id||i],`${n&&n>.01?n.toFixed(2):.01}s`)}),(0,t.jsx)(a.RiArrowRightSLine,{className:(0,o.cn)("h-4 w-4 shrink-0 text-text-tertiary transition-transform duration-200",m[e]&&"rotate-90")})]})})(s,e,p)]})}),m[s]&&(0,t.jsx)("div",{className:"h-px grow bg-divider-subtle"}),(0,t.jsx)("div",{className:(0,o.cn)("transition-all duration-200",m[s]?"opacity-100":"max-h-0 overflow-hidden opacity-0"),children:(0,t.jsx)(n.default,{list:e,className:"bg-background-section-burn"})})]},s))})]})})},356998,891670,907932,17744,737222,416999,610580,384761,e=>{"use strict";e.s(["default",()=>L],356998);var t=e.i(563199),a=e.i(837699),s=e.i(268255);e.i(152567);var r=e.i(408767),i=e.i(421001),n=e.i(481162),l=e.i(216669),o=e.i(955371),d=e.i(51828);e.i(905691);var c=e.i(52592),x=e.i(683257),p=e.i(935139),u=e.i(120219),m=e.i(390622),g=e.i(70380);e.i(493599);var _=e.i(252386);e.i(213284);var h=e.i(735010);e.s(["IterationLogTrigger",()=>h.default],891670);var h=h;e.s([],17744);var b=e.i(151094);e.i(916131);var f=e.i(806436);let w=e=>{var s;let{nodeInfo:i,allExecutions:n,onShowLoopResultList:l}=e,{t:o}=(0,r.useTranslation)(),d=0,c=i.execution_metadata?.loop_duration_map;c?d=Object.keys(c).length:i.details?.length?d=i.details.length:i.metadata?.loop_length&&(d=i.metadata.loop_length);let x=(s=i.details)&&0!==s.length?s.reduce((e,t)=>(t.some(e=>"failed"===e.status)&&e++,e),0):0;return(0,t.jsxs)(b.default,{className:"flex w-full cursor-pointer items-center gap-2 self-stretch rounded-lg border-none bg-components-button-tertiary-bg-hover px-3 py-2 hover:bg-components-button-tertiary-bg-hover",onClick:e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();let t=i.execution_metadata,a=i?.loopDurationMap||t?.loop_duration_map||{},s=t?.loop_variable_map||{},r=[];i.details?.length?r=i.details:t?.loop_duration_map&&(r=Object.keys(t.loop_duration_map).map(e=>(e=>{if(!n)return[];let t=n.filter(t=>t.execution_metadata?.parallel_mode_run_id===e);if(t.length>0)return t;let a=Number.parseInt(e,10);if(!isNaN(a)){let e=n.filter(e=>e.execution_metadata?.loop_id===i.node_id&&e.execution_metadata?.loop_index===a);if(e.length>0)return e}return[]})(e)).filter(e=>e.length>0)),l(r,a,s)},children:[(0,t.jsx)(f.Loop,{className:"h-4 w-4 shrink-0 text-components-button-tertiary-text"}),(0,t.jsxs)("div",{className:"system-sm-medium flex-1 text-left text-components-button-tertiary-text",children:[o("nodes.loop.loop",{ns:"workflow",count:d}),x>0&&(0,t.jsxs)(t.Fragment,{children:[o("nodes.loop.comma",{ns:"workflow"}),o("nodes.loop.error",{ns:"workflow",count:x})]})]}),(0,t.jsx)(a.RiArrowRightSLine,{className:"h-4 w-4 shrink-0 text-components-button-tertiary-text"})]})};e.s(["default",()=>y],907932);var j=e.i(567898);let v="singleRun",y=s.memo(e=>{let{list:i,onBack:l,loopDurationMap:d,loopVariableMap:c}=e,{t:x}=(0,r.useTranslation)(),[u,g]=(0,s.useState)({}),_=(0,s.useCallback)(e=>{g(t=>({...t,[e]:!t[e]}))},[]);return(0,t.jsxs)("div",{className:"bg-components-panel-bg",children:[(0,t.jsxs)("div",{className:"flex h-8 cursor-pointer items-center border-b-[0.5px] border-b-divider-regular px-4 text-text-accent-secondary",onClick:e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),l()},children:[(0,t.jsx)(a.RiArrowLeftLine,{className:"mr-1 h-4 w-4"}),(0,t.jsx)("div",{className:"system-sm-medium",children:x(`${v}.back`,{ns:"workflow"})})]}),(0,t.jsx)("div",{className:"bg-components-panel-bg p-2",children:i.map((e,s)=>(0,t.jsxs)("div",{className:(0,p.cn)("mb-1 overflow-hidden rounded-xl border-none bg-background-section-burn"),children:[(0,t.jsx)("div",{className:(0,p.cn)("flex w-full cursor-pointer items-center justify-between px-3",u[s]?"pb-2 pt-3":"py-3","rounded-xl text-left"),onClick:()=>_(s),children:(0,t.jsxs)("div",{className:(0,p.cn)("flex grow items-center gap-2"),children:[(0,t.jsx)("div",{className:"flex h-4 w-4 shrink-0 items-center justify-center rounded-[5px] border-divider-subtle bg-util-colors-cyan-cyan-500",children:(0,t.jsx)(f.Loop,{className:"h-3 w-3 text-text-primary-on-surface"})}),(0,t.jsxs)("span",{className:"system-sm-semibold-uppercase grow text-text-primary",children:[x(`${v}.loop`,{ns:"workflow"})," ",s+1]}),((e,s,r)=>{let i,n,l=s.some(e=>e.status===m.NodeRunningStatus.Failed),o=s.some(e=>e.status===m.NodeRunningStatus.Running),d=r&&0!==Object.keys(r).length;return l?(0,t.jsx)(a.RiErrorWarningLine,{className:"h-4 w-4 text-text-destructive"}):o?(0,t.jsx)(a.RiLoader2Line,{className:"h-3.5 w-3.5 animate-spin text-primary-600"}):(0,t.jsxs)(t.Fragment,{children:[d&&(0,t.jsx)("div",{className:"system-xs-regular text-text-tertiary",children:(i=s[0]?.execution_metadata?.loop_index,n=r[s[0]?.execution_metadata?.parallel_mode_run_id||i],`${n&&n>.01?n.toFixed(2):.01}s`)}),(0,t.jsx)(a.RiArrowRightSLine,{className:(0,p.cn)("h-4 w-4 shrink-0 text-text-tertiary transition-transform duration-200",u[e]&&"rotate-90")})]})})(s,e,d)]})}),u[s]&&(0,t.jsx)("div",{className:"h-px grow bg-divider-subtle"}),(0,t.jsxs)("div",{className:(0,p.cn)("transition-all duration-200",u[s]?"opacity-100":"max-h-0 overflow-hidden opacity-0"),children:[c?.[s]&&(0,t.jsx)("div",{className:"p-2 pb-0",children:(0,t.jsx)(n.default,{readOnly:!0,title:(0,t.jsx)("div",{children:x("nodes.loop.loopVariables",{ns:"workflow"}).toLocaleUpperCase()}),language:o.CodeLanguage.json,height:112,value:c[s],isJSONStringifyBeauty:!0})}),(0,t.jsx)(j.default,{list:e,className:"bg-background-section-burn"})]})]},s))})]})});e.s(["LoopLogTrigger",0,w],737222),e.s([],610580);let N=e=>{let{nodeInfo:s,onShowRetryResultList:i}=e,{t:n}=(0,r.useTranslation)(),{retryDetail:l}=s;return(0,t.jsxs)(b.default,{className:"mb-1 flex w-full items-center justify-between",variant:"tertiary",onClick:e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),i(l||[])},children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(a.RiRestartFill,{className:"mr-0.5 h-4 w-4 shrink-0 text-components-button-tertiary-text"}),n("nodes.common.retry.retries",{ns:"workflow",num:l?.length})]}),(0,t.jsx)(a.RiArrowRightSLine,{className:"h-4 w-4 shrink-0 text-components-button-tertiary-text"})]})};e.s(["default",()=>k],416999);let k=(0,s.memo)(e=>{let{list:s,onBack:i}=e,{t:n}=(0,r.useTranslation)();return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"system-sm-medium flex h-8 cursor-pointer items-center bg-components-panel-bg px-4 text-text-accent-secondary",onClick:e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),i()},children:[(0,t.jsx)(a.RiArrowLeftLine,{className:"mr-1 h-4 w-4"}),n("singleRun.back",{ns:"workflow"})]}),(0,t.jsx)(j.default,{list:s.map((e,t)=>({...e,title:`${n("nodes.common.retry.retry",{ns:"workflow"})} ${t+1}`})),className:"bg-background-section-burn"})]})});e.s(["RetryLogTrigger",0,N],384761);let L=e=>{var b,f;let{className:j,nodeInfo:v,allExecutions:y,inMessage:k=!1,hideInfo:L=!1,hideProcessDetail:S,onShowIterationDetail:R,onShowLoopDetail:T,onShowRetryDetail:E,onShowAgentOrToolLog:C,notShowIterationNav:D,notShowLoopNav:F}=e,[A,I]=(0,s.useState)(!0),P=(0,s.useCallback)(e=>{S||I(e)},[S]),{t:B}=(0,r.useTranslation)(),O=(0,x.useDocLink)();(0,s.useEffect)(()=>{P(!v.expand)},[v.expand,P]);let $=v.node_type===m.BlockEnum.Iteration&&!!v.details?.length,M=v.node_type===m.BlockEnum.Loop&&!!v.details?.length,U=(0,c.hasRetryNode)(v.node_type)&&!!v.retryDetail?.length,H=v.node_type===m.BlockEnum.Agent&&!!v.agentLog?.length,V=v.node_type===m.BlockEnum.Tool&&!!v.agentLog?.length,q=(0,s.useMemo)(()=>{let e=B("common.input",{ns:"workflow"});return v.node_type===m.BlockEnum.Loop&&(e=B("nodes.loop.initialLoopVariables",{ns:"workflow"})),e.toLocaleUpperCase()},[v.node_type,B]),z=B("common.processData",{ns:"workflow"}).toLocaleUpperCase(),J=(0,s.useMemo)(()=>{let e=B("common.output",{ns:"workflow"});return v.node_type===m.BlockEnum.Loop&&(e=B("nodes.loop.finalLoopVariables",{ns:"workflow"})),e.toLocaleUpperCase()},[v.node_type,B]);return(0,t.jsx)("div",{className:(0,p.cn)("px-2 py-1",j),children:(0,t.jsxs)("div",{className:"group rounded-[10px] border border-components-panel-border bg-background-default shadow-xs transition-all hover:shadow-md",children:[(0,t.jsxs)("div",{className:(0,p.cn)("flex cursor-pointer items-center pl-1 pr-3",L?"py-2 pl-2":"py-1.5",!A&&(L?"!pb-1":"!pb-1.5")),onClick:()=>P(!A),children:[!S&&(0,t.jsx)(a.RiArrowRightSLine,{className:(0,p.cn)("mr-1 h-4 w-4 shrink-0 text-text-quaternary transition-all group-hover:text-text-tertiary",!A&&"rotate-90")}),(0,t.jsx)(u.default,{size:k?"xs":"sm",className:(0,p.cn)("mr-2 shrink-0",k&&"!mr-1"),type:v.node_type,toolIcon:v.extras?.icon||v.extras}),(0,t.jsx)(i.default,{popupContent:(0,t.jsx)("div",{className:"max-w-xs",children:v.title}),children:(0,t.jsx)("div",{className:(0,p.cn)("system-xs-semibold-uppercase grow truncate text-text-secondary",L&&"!text-xs"),children:v.title})}),"running"!==v.status&&!L&&(0,t.jsxs)("div",{className:"system-xs-regular shrink-0 text-text-tertiary",children:[v.execution_metadata?.total_tokens?`${(b=v.execution_metadata?.total_tokens||0)<1e3?b:b>=1e3&&b<1e6?`${Number.parseFloat((b/1e3).toFixed(3))}K`:b>=1e6?`${Number.parseFloat((b/1e6).toFixed(3))}M`:void 0} tokens \xb7 `:"",`${(f=v.elapsed_time||0)<1?`${(1e3*f).toFixed(3)} ms`:f>60?`${Math.floor(f/60)} m ${(f%60).toFixed(3)} s`:`${f.toFixed(3)} s`}`]}),"succeeded"===v.status&&(0,t.jsx)(a.RiCheckboxCircleFill,{className:"ml-2 h-3.5 w-3.5 shrink-0 text-text-success"}),"failed"===v.status&&(0,t.jsx)(a.RiErrorWarningLine,{className:"ml-2 h-3.5 w-3.5 shrink-0 text-text-warning"}),"stopped"===v.status&&(0,t.jsx)(a.RiAlertFill,{className:(0,p.cn)("ml-2 h-4 w-4 shrink-0 text-text-warning-secondary",k&&"h-3.5 w-3.5")}),"exception"===v.status&&(0,t.jsx)(a.RiAlertFill,{className:(0,p.cn)("ml-2 h-4 w-4 shrink-0 text-text-warning-secondary",k&&"h-3.5 w-3.5")}),"running"===v.status&&(0,t.jsxs)("div",{className:"flex shrink-0 items-center text-[13px] font-medium leading-[16px] text-text-accent",children:[(0,t.jsx)("span",{className:"mr-2 text-xs font-normal",children:"Running"}),(0,t.jsx)(a.RiLoader2Line,{className:"h-3.5 w-3.5 animate-spin"})]})]}),!A&&!S&&(0,t.jsxs)("div",{className:"px-1 pb-1",children:[$&&!D&&R&&(0,t.jsx)(h.default,{nodeInfo:v,allExecutions:y,onShowIterationResultList:R}),M&&!F&&T&&(0,t.jsx)(w,{nodeInfo:v,allExecutions:y,onShowLoopResultList:T}),U&&E&&(0,t.jsx)(N,{nodeInfo:v,onShowRetryResultList:E}),(H||V)&&C&&(0,t.jsx)(_.AgentLogTrigger,{nodeInfo:v,onShowAgentOrToolLog:C}),(0,t.jsxs)("div",{className:(0,p.cn)("mb-1",L&&"!px-2 !py-0.5"),children:["stopped"===v.status&&(0,t.jsx)(d.default,{status:"stopped",children:B("tracing.stopBy",{ns:"workflow",user:v.created_by?v.created_by.name:"N/A"})}),"exception"===v.status&&(0,t.jsxs)(d.default,{status:"stopped",children:[v.error,(0,t.jsx)("a",{href:O("/use-dify/debug/error-type"),target:"_blank",className:"text-text-accent",children:B("common.learnMore",{ns:"workflow"})})]}),"failed"===v.status&&(0,t.jsx)(d.default,{status:"failed",children:v.error}),"retry"===v.status&&(0,t.jsx)(d.default,{status:"failed",children:v.error})]}),v.inputs&&(0,t.jsx)("div",{className:(0,p.cn)("mb-1"),children:(0,t.jsx)(n.default,{readOnly:!0,title:(0,t.jsx)("div",{children:q}),language:o.CodeLanguage.json,value:v.inputs,isJSONStringifyBeauty:!0,footer:v.inputs_truncated&&(0,t.jsx)(g.default,{textHasNoExport:!0,className:"mx-1 mb-1 mt-2 h-7"})})}),v.process_data&&(0,t.jsx)("div",{className:(0,p.cn)("mb-1"),children:(0,t.jsx)(n.default,{readOnly:!0,title:(0,t.jsx)("div",{children:z}),language:o.CodeLanguage.json,value:v.process_data,isJSONStringifyBeauty:!0})}),v.outputs&&(0,t.jsx)("div",{children:(0,t.jsx)(n.default,{readOnly:!0,title:(0,t.jsx)("div",{children:J}),language:o.CodeLanguage.json,value:v.outputs,isJSONStringifyBeauty:!0,tip:(0,t.jsx)(l.default,{type:v.execution_metadata?.error_strategy}),footer:v.outputs_truncated&&(0,t.jsx)(g.default,{textHasNoExport:!0,downloadUrl:v.outputs_full_content?.download_url,className:"mx-1 mb-1 mt-2 h-7"})})})]})]})})}},730225,e=>{"use strict";var t=e.i(890317);e.s(["AgentResultPanel",()=>t.default])},443202,e=>{"use strict";e.s(["default",()=>n],443202);var t=e.i(563199);e.i(493599);var a=e.i(730225);e.i(213284);var s=e.i(339146),s=s;e.i(17744);var r=e.i(907932),r=r;e.i(610580);var i=e.i(416999),i=i;let n=e=>{let{showRetryDetail:n,setShowRetryDetailFalse:l,retryResultList:o,showIteratingDetail:d,setShowIteratingDetailFalse:c,iterationResultList:x,iterationResultDurationMap:p,showLoopingDetail:u,setShowLoopingDetailFalse:m,loopResultList:g,loopResultDurationMap:_,loopResultVariableMap:h,agentOrToolLogItemStack:b,agentOrToolLogListMap:f,handleShowAgentOrToolLog:w}=e;return(0,t.jsxs)("div",{onClick:e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},children:[!!n&&!!o?.length&&l&&(0,t.jsx)(i.default,{list:o,onBack:l}),d&&!!x?.length&&c&&(0,t.jsx)(s.default,{list:x,onBack:c,iterDurationMap:p}),u&&!!g?.length&&m&&(0,t.jsx)(r.default,{list:g,onBack:m,loopDurationMap:_,loopVariableMap:h}),!!b?.length&&f&&w&&(0,t.jsx)(a.AgentResultPanel,{agentOrToolLogItemStack:b,agentOrToolLogListMap:f,onShowAgentOrToolLog:w})]})}},567898,e=>{"use strict";e.s(["default",()=>c]);var t=e.i(563199),a=e.i(837699),s=e.i(268255);e.i(152567);var r=e.i(408767),i=e.i(607224),n=e.i(935139),l=e.i(267223),o=e.i(356998),d=e.i(443202);let c=e=>{let{list:c,className:x,hideNodeInfo:p=!1,hideNodeProcessDetail:u=!1}=e,{t:m}=(0,r.useTranslation)(),g=(0,i.default)(c,m),[_,h]=(0,s.useState)(()=>new Set),[b,f]=(0,s.useState)(null),w=(0,s.useCallback)(e=>{f(e)},[]),j=(0,s.useCallback)(e=>{let t=e.relatedTarget;if(t&&"closest"in t){let e=t.closest("[data-parallel-id]");e?f(e.getAttribute("data-parallel-id")):f(null)}else f(null)},[]),{showSpecialResultPanel:v,showRetryDetail:y,setShowRetryDetailFalse:N,retryResultList:k,handleShowRetryResultList:L,showIteratingDetail:S,setShowIteratingDetailFalse:R,iterationResultList:T,iterationResultDurationMap:E,handleShowIterationResultList:C,showLoopingDetail:D,setShowLoopingDetailFalse:F,loopResultList:A,loopResultDurationMap:I,loopResultVariableMap:P,handleShowLoopResultList:B,agentOrToolLogItemStack:O,agentOrToolLogListMap:$,handleShowAgentOrToolLog:M}=(0,l.useLogs)(),U=e=>{if(e.parallelDetail?.isParallelStartNode){let s=e.parallelDetail,r=_.has(e.id),i=b===e.id;return(0,t.jsxs)("div",{className:"relative mb-2 ml-4","data-parallel-id":e.id,onMouseEnter:()=>w(e.id),onMouseLeave:j,children:[(0,t.jsxs)("div",{className:"mb-1 flex items-center",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{var t;return t=e.id,void h(e=>{let a=new Set(e);return a.has(t)?a.delete(t):a.add(t),a})},className:(0,n.cn)("mr-2 transition-colors",i?"rounded border-components-button-primary-border bg-components-button-primary-bg text-text-primary-on-surface":"text-text-secondary hover:text-text-primary"),children:i?(0,t.jsx)(a.RiArrowDownSLine,{className:"h-3 w-3"}):(0,t.jsx)(a.RiMenu4Line,{className:"h-3 w-3 text-text-tertiary"})}),(0,t.jsx)("div",{className:"system-xs-semibold-uppercase flex items-center text-text-secondary",children:(0,t.jsx)("span",{children:s.parallelTitle})}),(0,t.jsx)("div",{className:"mx-2 h-px grow bg-divider-subtle",style:{background:"linear-gradient(to right, rgba(16, 24, 40, 0.08), rgba(255, 255, 255, 0)"}})]}),(0,t.jsxs)("div",{className:`relative pl-2 ${r?"hidden":""}`,children:[(0,t.jsx)("div",{className:(0,n.cn)("absolute bottom-0 left-[5px] top-0 w-[2px]",i?"bg-text-accent-secondary":"bg-divider-subtle")}),s.children.map(U)]})]},e.id)}{let a=b===e.id;return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:(0,n.cn)("system-2xs-medium-uppercase -mb-1.5 pl-4",a?"text-text-tertiary":"text-text-quaternary"),children:e?.parallelDetail?.branchTitle}),(0,t.jsx)(o.default,{nodeInfo:e,allExecutions:c,onShowIterationDetail:C,onShowLoopDetail:B,onShowRetryDetail:L,onShowAgentOrToolLog:M,hideInfo:p,hideProcessDetail:u})]},e.id)}};return v?(0,t.jsx)(d.default,{showRetryDetail:y,setShowRetryDetailFalse:N,retryResultList:k,showIteratingDetail:S,setShowIteratingDetailFalse:R,iterationResultList:T,iterationResultDurationMap:E,showLoopingDetail:D,setShowLoopingDetailFalse:F,loopResultList:A,loopResultDurationMap:I,loopResultVariableMap:P,agentOrToolLogItemStack:O,agentOrToolLogListMap:$,handleShowAgentOrToolLog:M}):(0,t.jsx)("div",{className:(0,n.cn)("py-2",x),onClick:e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},children:g.map(U)})}}]);