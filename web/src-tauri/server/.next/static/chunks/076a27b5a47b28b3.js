(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,813777,799750,560956,e=>{"use strict";var t,a,s=e.i(875037),n=e.i(562572),l=e.i(214309),i=e.i(367916),o=e.i(722384),c=e.i(666010);let r="dataset-metadata",d=e=>(0,o.useInvalid)([r,"dataset",e]),u=e=>{let t,a=d(e),s=(0,c.useInvalidDocumentList)(e),n=(t=(0,l.useQueryClient)(),()=>{t.invalidateQueries({queryKey:[r,"document",e],exact:!1})});return async()=>{await a(),s(),await n()}};e.s(["useBatchUpdateDocMetadata",0,()=>{let e=(0,l.useQueryClient)();return(0,s.useMutation)({mutationFn:async t=>{let a=t.metadata_list.map(e=>e.document_id);await (0,i.post)(`/datasets/${t.dataset_id}/documents/metadata`,{body:{operation_data:t.metadata_list}}),await e.invalidateQueries({queryKey:[r,"dataset",t.dataset_id]}),await e.invalidateQueries({queryKey:[r,"document",t.dataset_id]}),await e.invalidateQueries({queryKey:[...c.useDocumentListKey,t.dataset_id]}),await Promise.all(a.map(a=>e.invalidateQueries({queryKey:[r,"document",t.dataset_id,a]})))}})},"useBuiltInMetaDataFields",0,()=>(0,n.useQuery)({queryKey:[r,"built-in"],queryFn:()=>(0,i.get)("/datasets/metadata/built-in")}),"useCreateMetaData",0,e=>{let t=d(e);return(0,s.useMutation)({mutationFn:async a=>(await (0,i.post)(`/datasets/${e}/metadata`,{body:a}),await t(),Promise.resolve(!0))})},"useDatasetMetaData",0,e=>(0,n.useQuery)({queryKey:[r,"dataset",e],queryFn:()=>(0,i.get)(`/datasets/${e}/metadata`)}),"useDeleteMetaData",0,e=>{let t=u(e);return(0,s.useMutation)({mutationFn:async a=>{await (0,i.del)(`/datasets/${e}/metadata/${a}`),await t()}})},"useDocumentMetaData",0,e=>{let{datasetId:t,documentId:a}=e;return(0,n.useQuery)({queryKey:[r,"document",t,a],queryFn:()=>(0,i.get)(`/datasets/${t}/documents/${a}`,{params:{metadata:"only"}})})},"useRenameMeta",0,e=>{let t=u(e);return(0,s.useMutation)({mutationFn:async a=>{await (0,i.patch)(`/datasets/${e}/metadata/${a.id}`,{body:{name:a.name}}),await t()}})},"useUpdateBuiltInStatus",0,e=>{let t=d(e);return(0,s.useMutation)({mutationFn:async a=>{await (0,i.post)(`/datasets/${e}/metadata/built-in/${a?"enable":"disable"}`),t()}})}],813777);var m=((t={}).string="string",t.number="number",t.time="time",t),x=((a={}).changeValue="changeValue",a.delete="delete",a);e.s(["DataType",()=>m,"UpdateType",()=>x,"isShowManageMetadataLocalStorageKey",0,"dify-isShowManageMetadata"],799750),e.i(152567);var p=e.i(408767);let h="metadata.checkName";e.s(["default",0,()=>{let{t:e}=(0,p.useTranslation)();return{checkName:t=>t?/^[a-z][a-z0-9_]*$/.test(t)?t.length>255?{errorMsg:e(`${h}.tooLong`,{ns:"dataset",max:255})}:{errorMsg:""}:{errorMsg:e(`${h}.invalid`,{ns:"dataset"})}:{errorMsg:e(`${h}.empty`,{ns:"dataset"})}}}],560956)},655281,e=>{"use strict";var t=e.i(563199),a=e.i(837699),s=e.i(268255);e.i(152567);var n=e.i(408767),l=e.i(935139),i=e.i(151094);let o=s.memo(e=>{let{className:s,onClick:o}=e,{t:c}=(0,n.useTranslation)();return(0,t.jsxs)(i.default,{className:(0,l.cn)("flex w-full items-center",s),size:"small",variant:"tertiary",onClick:o,children:[(0,t.jsx)(a.RiAddLine,{className:"mr-1 size-3.5"}),(0,t.jsx)("div",{children:c("metadata.addMetadata",{ns:"dataset"})})]})});e.s(["default",0,o])},292500,e=>{"use strict";var t=e.i(563199),a=e.i(268255),s=e.i(291631),n=e.i(802859),l=e.i(935139),i=e.i(837699),o=e.i(585458);e.i(152567);var c=e.i(408767),r=e.i(836137),d=e.i(157884);let u=e=>{let{className:s,value:n,onChange:u}=e,{t:m}=(0,c.useTranslation)(),{formatTime:x}=(0,d.default)(),p=(0,a.useCallback)(e=>{e?u(e.unix()):u(null)},[u]),h=(0,a.useCallback)(e=>{let{handleClickTrigger:a}=e;return(0,t.jsxs)("div",{onClick:a,className:(0,l.cn)("group flex items-center rounded-md bg-components-input-bg-normal",s),children:[(0,t.jsx)("div",{className:(0,l.cn)("grow",n?"text-text-secondary":"text-text-tertiary"),children:n?x(n,m("metadata.dateTimeFormat",{ns:"datasetDocuments"})):m("metadata.chooseTime",{ns:"dataset"})}),(0,t.jsx)(i.RiCloseCircleFill,{className:(0,l.cn)("hidden h-4 w-4 cursor-pointer hover:text-components-input-text-filled group-hover:block",n&&"text-text-quaternary"),onClick:()=>p()}),(0,t.jsx)(i.RiCalendarLine,{className:(0,l.cn)("block h-4 w-4 shrink-0 group-hover:hidden",n?"text-text-quaternary":"text-text-tertiary")})]})},[s,n,x,m,p]);return(0,t.jsx)(r.default,{value:(0,o.default)(n?1e3*n:Date.now()),onChange:p,onClear:p,renderTrigger:h,triggerWrapClassName:"w-full",popupZIndexClassname:"z-[1000]"})};var m=e.i(799750);let x=a.memo(e=>{let{className:a,type:i,value:o,onChange:c,readOnly:r}=e,d=(0,l.cn)("h-6 grow p-0.5 text-xs");return i===m.DataType.time?(0,t.jsx)(u,{className:d,value:o,onChange:c}):i===m.DataType.number?(0,t.jsx)("div",{className:"grow text-[0]",children:(0,t.jsx)(n.InputNumber,{className:(0,l.cn)(d,"rounded-l-md"),value:o,onChange:c,size:"regular",controlWrapClassName:"overflow-hidden",controlClassName:"pt-0 pb-0",readOnly:r})}):(0,t.jsx)(s.default,{wrapperClassName:a,className:(0,l.cn)(d,"rounded-md"),value:o,onChange:e=>c(e.target.value),readOnly:r})});e.s(["default",0,x],292500)},89012,777557,873557,e=>{"use strict";var t=e.i(563199),a=e.i(837699),s=e.i(124836),n=e.i(268255);e.i(152567);var l=e.i(408767),i=e.i(291631),o=e.i(935139),c=e.i(151094);let r=n.memo(e=>{let{title:s,className:n,beforeHeader:i,children:r,onClose:d,hideCloseBtn:u,onConfirm:m}=e,{t:x}=(0,l.useTranslation)();return(0,t.jsxs)("div",{className:(0,o.cn)("w-[320px] rounded-2xl border-[0.5px] border-components-panel-border bg-components-panel-bg px-3 pb-4 pt-3.5 shadow-xl",n),children:[i||null,(0,t.jsxs)("div",{className:"mb-1 flex h-6 items-center justify-between",children:[(0,t.jsx)("div",{className:"system-xl-semibold text-text-primary",children:s}),!u&&(0,t.jsx)("div",{className:"cursor-pointer p-1.5 text-text-tertiary",onClick:d,children:(0,t.jsx)(a.RiCloseLine,{className:"size-4"})})]}),(0,t.jsx)("div",{className:"mt-2",children:r}),(0,t.jsxs)("div",{className:"mt-4 flex justify-end",children:[(0,t.jsx)(c.default,{className:"mr-2",onClick:d,children:x("operation.cancel",{ns:"common"})}),(0,t.jsx)(c.default,{onClick:m,variant:"primary",children:x("operation.save",{ns:"common"})})]})]})});var d=e.i(597280),u=e.i(799750);let m=n.memo(e=>{let{className:a,label:s,children:n}=e;return(0,t.jsxs)("div",{className:a,children:[(0,t.jsx)("div",{className:"system-sm-semibold py-1 text-text-secondary",children:s}),(0,t.jsx)("div",{className:"mt-1",children:n})]})});e.s(["default",0,m],777557);let x="metadata.createMetadata",p=n.memo(e=>{let{onClose:o=s.noop,hasBack:c,onBack:p,onSave:h}=e,{t:y}=(0,l.useTranslation)(),[g,b]=(0,n.useState)(u.DataType.string),j=(0,n.useCallback)(e=>()=>b(e),[b]),[v,f]=(0,n.useState)(""),N=(0,n.useCallback)(e=>{f(e.target.value)},[f]),_=(0,n.useCallback)(()=>{h({type:g,name:v})},[h,g,v]);return(0,t.jsx)(r,{title:y(`${x}.title`,{ns:"dataset"}),onClose:o,onConfirm:_,hideCloseBtn:c,beforeHeader:c&&(0,t.jsxs)("div",{className:"relative left-[-4px] mb-1 flex cursor-pointer items-center space-x-1 py-1 text-text-accent",onClick:p,children:[(0,t.jsx)(a.RiArrowLeftLine,{className:"size-4"}),(0,t.jsx)("div",{className:"system-xs-semibold-uppercase",children:y(`${x}.back`,{ns:"dataset"})})]}),children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(m,{label:y(`${x}.type`,{ns:"dataset"}),children:(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,t.jsx)(d.default,{title:"String",selected:g===u.DataType.string,onSelect:j(u.DataType.string)}),(0,t.jsx)(d.default,{title:"Number",selected:g===u.DataType.number,onSelect:j(u.DataType.number)}),(0,t.jsx)(d.default,{title:"Time",selected:g===u.DataType.time,onSelect:j(u.DataType.time)})]})}),(0,t.jsx)(m,{label:y(`${x}.name`,{ns:"dataset"}),children:(0,t.jsx)(i.default,{value:v,onChange:N,placeholder:y(`${x}.namePlaceholder`,{ns:"dataset"})})})]})})});e.s(["default",0,p],89012),e.s(["getIcon",0,e=>({[u.DataType.string]:a.RiTextSnippet,[u.DataType.number]:a.RiHashtag,[u.DataType.time]:a.RiTimeLine})[e]||a.RiTextSnippet],873557)},836407,e=>{"use strict";var t,a=e.i(563199),s=e.i(268255),n=e.i(813777),l=e.i(391185),i=e.i(89012),o=e.i(837699);e.i(152567);var c=e.i(408767),r=e.i(453284),d=e.i(873557);let u="metadata.selectMetadata",m=s.memo(e=>{let{list:t,onSelect:n,onNew:l,onManage:i}=e,{t:m}=(0,c.useTranslation)(),[x,p]=(0,s.useState)(""),h=(0,s.useMemo)(()=>x?t.filter(e=>e.name.toLowerCase().includes(x.toLowerCase())):t,[x,t]);return(0,a.jsxs)("div",{className:"w-[320px] rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur pb-0 pt-2 shadow-lg backdrop-blur-[5px]",children:[(0,a.jsx)(r.default,{className:"mx-2",value:x,onChange:p,placeholder:m(`${u}.search`,{ns:"dataset"})}),(0,a.jsx)("div",{className:"mt-2",children:h.map(e=>{let t=(0,d.getIcon)(e.type);return(0,a.jsxs)("div",{className:"mx-1 flex h-6 cursor-pointer  items-center justify-between rounded-md px-3 hover:bg-state-base-hover",onClick:()=>n({id:e.id,name:e.name,type:e.type}),children:[(0,a.jsxs)("div",{className:"flex h-full w-0 grow items-center text-text-secondary",children:[(0,a.jsx)(t,{className:"mr-[5px] size-3.5 shrink-0"}),(0,a.jsx)("div",{className:"system-sm-medium w-0 grow truncate",children:e.name})]}),(0,a.jsx)("div",{className:"system-xs-regular ml-1 shrink-0 text-text-tertiary",children:e.type})]},e.id)})}),(0,a.jsxs)("div",{className:"mt-1 flex justify-between border-t border-divider-subtle p-1",children:[(0,a.jsxs)("div",{className:"flex h-6 cursor-pointer items-center space-x-1 rounded-md px-3 text-text-secondary hover:bg-state-base-hover",onClick:l,children:[(0,a.jsx)(o.RiAddLine,{className:"size-3.5"}),(0,a.jsx)("div",{className:"system-sm-medium",children:m(`${u}.newAction`,{ns:"dataset"})})]}),(0,a.jsxs)("div",{className:"flex h-6 items-center text-text-secondary ",children:[(0,a.jsx)("div",{className:"mr-[3px] h-3 w-px bg-divider-regular"}),(0,a.jsxs)("div",{className:"flex h-full cursor-pointer items-center rounded-md px-1.5 hover:bg-state-base-hover",onClick:i,children:[(0,a.jsx)("div",{className:"system-sm-medium mr-1",children:m(`${u}.manageAction`,{ns:"dataset"})}),(0,a.jsx)(o.RiArrowRightUpLine,{className:"size-3.5"})]})]})]})]})});var x=((t=x||{}).select="select",t.create="create",t);let p=s.memo(e=>{let{datasetId:t,popupPlacement:o="left-start",popupOffset:c={mainAxis:-38,crossAxis:4},trigger:r,onSelect:d,onSave:u,onManage:x}=e,{data:p}=(0,n.useDatasetMetaData)(t),[h,y]=(0,s.useState)(!1),[g,b]=(0,s.useState)("select"),j=(0,s.useCallback)(async e=>{await u(e),b("select")},[u]);return(0,a.jsxs)(l.PortalToFollowElem,{open:h,onOpenChange:y,placement:o,offset:c,children:[(0,a.jsx)(l.PortalToFollowElemTrigger,{onClick:()=>y(!h),className:"block",children:r}),(0,a.jsx)(l.PortalToFollowElemContent,{className:"z-[1000]",children:"select"===g?(0,a.jsx)(m,{onSelect:e=>{d(e),y(!1)},list:p?.doc_metadata||[],onNew:()=>b("create"),onManage:x}):(0,a.jsx)(i.default,{onSave:j,hasBack:!0,onBack:()=>b("select"),onClose:()=>b("select")})})]})});e.s(["default",0,p],836407)},909564,e=>{"use strict";var t=e.i(875037),a=e.i(562572),s=e.i(367916);let n="segment",l=[n,"chunkList"],i=[n,"chunkList",{enabled:!0}],o=[n,"chunkList",{enabled:!1}],c=[n,"chunkList",{enabled:"all"}],r=[n,"childChunkList"];e.s(["useAddChildSegment",0,()=>(0,t.useMutation)({mutationKey:[n,"childChunk","add"],mutationFn:e=>{let{datasetId:t,documentId:a,segmentId:n,body:l}=e;return(0,s.post)(`/datasets/${t}/documents/${a}/segments/${n}/child_chunks`,{body:l})}}),"useAddSegment",0,()=>(0,t.useMutation)({mutationKey:[n,"add"],mutationFn:e=>{let{datasetId:t,documentId:a,body:n}=e;return(0,s.post)(`/datasets/${t}/documents/${a}/segment`,{body:n})}}),"useCheckSegmentBatchImportProgress",0,()=>(0,t.useMutation)({mutationKey:[n,"batchImport","checkProgress"],mutationFn:e=>{let{jobID:t}=e;return(0,s.get)(`/datasets/batch_import_status/${t}`)}}),"useChildSegmentList",0,(e,t)=>{let{datasetId:n,documentId:l,segmentId:i,params:o}=e;return(0,a.useQuery)({queryKey:[...r,n,l,i,o],queryFn:()=>(0,s.get)(`/datasets/${n}/documents/${l}/segments/${i}/child_chunks`,{params:o}),enabled:!t})},"useChildSegmentListKey",0,r,"useChunkListAllKey",0,c,"useChunkListDisabledKey",0,o,"useChunkListEnabledKey",0,i,"useDeleteChildSegment",0,()=>(0,t.useMutation)({mutationKey:[n,"childChunk","delete"],mutationFn:e=>{let{datasetId:t,documentId:a,segmentId:n,childChunkId:l}=e;return(0,s.del)(`/datasets/${t}/documents/${a}/segments/${n}/child_chunks/${l}`)}}),"useDeleteSegment",0,()=>(0,t.useMutation)({mutationKey:[n,"delete"],mutationFn:e=>{let{datasetId:t,documentId:a,segmentIds:n}=e,l=n.map(e=>`segment_id=${e}`).join("&");return(0,s.del)(`/datasets/${t}/documents/${a}/segments?${l}`)}}),"useDisableSegment",0,()=>(0,t.useMutation)({mutationKey:[n,"disable"],mutationFn:e=>{let{datasetId:t,documentId:a,segmentIds:n}=e,l=n.map(e=>`segment_id=${e}`).join("&");return(0,s.patch)(`/datasets/${t}/documents/${a}/segment/disable?${l}`)}}),"useEnableSegment",0,()=>(0,t.useMutation)({mutationKey:[n,"enable"],mutationFn:e=>{let{datasetId:t,documentId:a,segmentIds:n}=e,l=n.map(e=>`segment_id=${e}`).join("&");return(0,s.patch)(`/datasets/${t}/documents/${a}/segment/enable?${l}`)}}),"useSegmentBatchImport",0,()=>(0,t.useMutation)({mutationKey:[n,"batchImport"],mutationFn:e=>{let{url:t,body:a}=e;return(0,s.post)(t,{body:a})}}),"useSegmentList",0,(e,t)=>{let{datasetId:n,documentId:i,params:o}=e;return(0,a.useQuery)({queryKey:[...l,n,i,o],queryFn:()=>(0,s.get)(`/datasets/${n}/documents/${i}/segments`,{params:o}),enabled:!t})},"useSegmentListKey",0,l,"useUpdateChildSegment",0,()=>(0,t.useMutation)({mutationKey:[n,"childChunk","update"],mutationFn:e=>{let{datasetId:t,documentId:a,segmentId:n,childChunkId:l,body:i}=e;return(0,s.patch)(`/datasets/${t}/documents/${a}/segments/${n}/child_chunks/${l}`,{body:i})}}),"useUpdateSegment",0,()=>(0,t.useMutation)({mutationKey:[n,"update"],mutationFn:e=>{let{datasetId:t,documentId:a,segmentId:n,body:l}=e;return(0,s.patch)(`/datasets/${t}/documents/${a}/segments/${n}`,{body:l})}})])},316803,e=>{"use strict";var t=e.i(739033);e.s(["SearchLinesSparkle",()=>t.default])},336864,e=>{e.v({actionIcon:"style-module__GM7H8a__actionIcon",actionIconWrapperDetail:"style-module__GM7H8a__actionIconWrapperDetail",actionIconWrapperList:"style-module__GM7H8a__actionIconWrapperList",actionItem:"style-module__GM7H8a__actionItem",actionName:"style-module__GM7H8a__actionName",addFileBtn:"style-module__GM7H8a__addFileBtn",commonIcon:"style-module__GM7H8a__commonIcon",csvIcon:"style-module__GM7H8a__csvIcon",delModal:"style-module__GM7H8a__delModal",deleteActionItem:"style-module__GM7H8a__deleteActionItem",docIcon:"style-module__GM7H8a__docIcon",documentTable:"style-module__GM7H8a__documentTable",docxIcon:"style-module__GM7H8a__docxIcon",emptyElement:"style-module__GM7H8a__emptyElement",emptySymbolIconWrapper:"style-module__GM7H8a__emptySymbolIconWrapper",emptyTip:"style-module__GM7H8a__emptyTip",emptyTitle:"style-module__GM7H8a__emptyTitle",emptyWrapper:"style-module__GM7H8a__emptyWrapper",htmlIcon:"style-module__GM7H8a__htmlIcon",jsonIcon:"style-module__GM7H8a__jsonIcon",markdownIcon:"style-module__GM7H8a__markdownIcon",mdIcon:"style-module__GM7H8a__mdIcon",pdfIcon:"style-module__GM7H8a__pdfIcon",plusIcon:"style-module__GM7H8a__plusIcon",statusItemDetail:"style-module__GM7H8a__statusItemDetail",tdValue:"style-module__GM7H8a__tdValue",txtIcon:"style-module__GM7H8a__txtIcon",warningIcon:"style-module__GM7H8a__warningIcon",warningWrapper:"style-module__GM7H8a__warningWrapper",xlsIcon:"style-module__GM7H8a__xlsIcon",xlsxIcon:"style-module__GM7H8a__xlsxIcon"})},312620,223922,e=>{"use strict";var t=e.i(563199),a=e.i(837699),s=e.i(417944),n=e.i(38532),l=e.i(124836),i=e.i(326531),o=e.i(268255);e.i(152567);var c=e.i(408767),r=e.i(339548),d=e.i(547105),u=e.i(757198);e.i(9633);var m=e.i(316803),x=e.i(964596),p=e.i(260484),h=e.i(137667),y=e.i(421001),g=e.i(621379),b=e.i(666010),j=e.i(842090),v=e.i(935139),f=e.i(618403),N=e.i(336864),_=e.i(151094),C=e.i(291631),w=e.i(21151),D=e.i(211857);let k=o.memo(e=>{let{documentId:a,datasetId:n,name:l,onClose:i,onSaved:r}=e,{t:d}=(0,c.useTranslation)(),[u,m]=(0,o.useState)(l),[x,{setTrue:p,setFalse:y}]=(0,s.useBoolean)(!1),g=async()=>{p();try{await (0,D.renameDocumentName)({datasetId:n,documentId:a,name:u}),h.default.notify({type:"success",message:d("actionMsg.modifiedSuccessfully",{ns:"common"})}),r(),i()}catch(e){e&&h.default.notify({type:"error",message:e.toString()})}finally{y()}};return(0,t.jsxs)(w.default,{title:d("list.table.rename",{ns:"datasetDocuments"}),isShow:!0,onClose:i,children:[(0,t.jsx)("div",{className:"mt-6 text-sm font-medium leading-[21px] text-text-primary",children:d("list.table.name",{ns:"datasetDocuments"})}),(0,t.jsx)(C.default,{className:"mt-2 h-10",value:u,onChange:e=>m(e.target.value)}),(0,t.jsxs)("div",{className:"mt-10 flex justify-end",children:[(0,t.jsx)(_.default,{className:"mr-2 shrink-0",onClick:i,children:d("operation.cancel",{ns:"common"})}),(0,t.jsx)(_.default,{variant:"primary",className:"shrink-0",onClick:g,loading:x,children:d("operation.save",{ns:"common"})})]})]})});e.s(["default",0,k],223922);let I=o.memo(e=>{let{embeddingAvailable:_,datasetId:C,detail:w,selectedIds:D,onSelectedIdChange:I,onUpdate:M,scene:$="list",className:S=""}=e,{id:T,name:L,enabled:A=!1,archived:F=!1,data_source_type:R,display_status:H}=w||{},[G,K]=(0,o.useState)(!1),[z,q]=(0,o.useState)(!1),{notify:B}=(0,r.useContext)(h.ToastContext),{t:P}=(0,c.useTranslation)(),W=(0,i.useRouter)(),{mutateAsync:E}=(0,b.useDocumentArchive)(),{mutateAsync:U}=(0,b.useDocumentUnArchive)(),{mutateAsync:Q}=(0,b.useDocumentEnable)(),{mutateAsync:V}=(0,b.useDocumentDisable)(),{mutateAsync:O}=(0,b.useDocumentDelete)(),{mutateAsync:Z,isPending:J}=(0,b.useDocumentDownload)(),{mutateAsync:X}=(0,b.useSyncDocument)(),{mutateAsync:Y}=(0,b.useSyncWebsite)(),{mutateAsync:ee}=(0,b.useDocumentSummary)(),{mutateAsync:et}=(0,b.useDocumentPause)(),{mutateAsync:ea}=(0,b.useDocumentResume)(),es="list"===$,en=async e=>{let t;switch(e){case"archive":t=E;break;case"un_archive":t=U;break;case"enable":t=Q;break;case"disable":t=V;break;case"sync":t="notion_import"===R?X:Y;break;case"summary":t=ee;break;case"pause":t=et;break;case"resume":t=ea;break;default:t=O,q(!0)}let[a]=await (0,j.asyncRunSafe)(t({datasetId:C,documentId:T}));a?B({type:"error",message:P("actionMsg.modifiedUnsuccessfully",{ns:"common"})}):(B({type:"success",message:P("actionMsg.modifiedSuccessfully",{ns:"common"})}),D&&I&&e===g.DocumentActionType.delete&&I(D.filter(e=>e!==T)),M(e)),e===g.DocumentActionType.delete&&q(!1)},{run:el}=(0,n.useDebounceFn)(e=>{e===g.DocumentActionType.enable&&A||(e!==g.DocumentActionType.disable||A)&&en(e)},{wait:500}),[ei,eo]=(0,o.useState)(null),[ec,{setTrue:er,setFalse:ed}]=(0,s.useBoolean)(!1),eu=(0,o.useCallback)(e=>{eo(e),er()},[er]),em=(0,o.useCallback)(()=>{M()},[M]),ex=(0,o.useCallback)(async()=>{if(J)return;let[e,t]=await (0,j.asyncRunSafe)(Z({datasetId:C,documentId:T}));e||!t?.url?B({type:"error",message:P("actionMsg.downloadUnsuccessfully",{ns:"common"})}):(0,f.downloadUrl)({url:t.url,fileName:L})},[C,Z,T,J,L,B,P]);return(0,t.jsxs)("div",{className:"flex items-center",onClick:e=>e.stopPropagation(),children:[es&&!_&&(0,t.jsx)(p.default,{defaultValue:!1,onChange:l.noop,disabled:!0,size:"md"}),es&&_&&(0,t.jsxs)(t.Fragment,{children:[F?(0,t.jsx)(y.default,{popupContent:P("list.action.enableWarning",{ns:"datasetDocuments"}),popupClassName:"!font-semibold",children:(0,t.jsx)("div",{children:(0,t.jsx)(p.default,{defaultValue:!1,onChange:l.noop,disabled:!0,size:"md"})})}):(0,t.jsx)(p.default,{defaultValue:A,onChange:e=>el(e?"enable":"disable"),size:"md"}),(0,t.jsx)(u.default,{className:"!ml-4 !mr-2 !h-3",type:"vertical"})]}),_&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.default,{popupContent:P("list.action.settings",{ns:"datasetDocuments"}),popupClassName:"text-text-secondary system-xs-medium",needsDelay:!1,children:(0,t.jsx)("button",{type:"button",className:(0,v.cn)("mr-2 cursor-pointer rounded-lg",es?"p-0.5 hover:bg-state-base-hover":"border-[0.5px] border-components-button-secondary-border bg-components-button-secondary-bg p-2 shadow-xs shadow-shadow-shadow-3 backdrop-blur-[5px] hover:border-components-button-secondary-border-hover hover:bg-components-button-secondary-bg-hover"),onClick:()=>W.push(`/datasets/${C}/documents/${w.id}/settings`),children:(0,t.jsx)(a.RiEqualizer2Line,{className:"h-4 w-4 text-components-button-secondary-text"})})}),(0,t.jsx)(x.default,{htmlContent:(0,t.jsxs)("div",{className:"w-full py-1",children:[!F&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:N.default.actionItem,onClick:()=>{eu({id:w.id,name:w.name})},children:[(0,t.jsx)(a.RiEditLine,{className:"h-4 w-4 text-text-tertiary"}),(0,t.jsx)("span",{className:N.default.actionName,children:P("list.table.rename",{ns:"datasetDocuments"})})]}),R===g.DataSourceType.FILE&&(0,t.jsxs)("div",{className:N.default.actionItem,onClick:e=>{e.preventDefault(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation?.(),ex()},children:[(0,t.jsx)(a.RiDownload2Line,{className:"h-4 w-4 text-text-tertiary"}),(0,t.jsx)("span",{className:N.default.actionName,children:P("list.action.download",{ns:"datasetDocuments"})})]}),["notion_import",g.DataSourceType.WEB].includes(R)&&(0,t.jsxs)("div",{className:N.default.actionItem,onClick:()=>en("sync"),children:[(0,t.jsx)(a.RiLoopLeftLine,{className:"h-4 w-4 text-text-tertiary"}),(0,t.jsx)("span",{className:N.default.actionName,children:P("list.action.sync",{ns:"datasetDocuments"})})]}),(0,t.jsxs)("div",{className:N.default.actionItem,onClick:()=>en("summary"),children:[(0,t.jsx)(m.SearchLinesSparkle,{className:"h-4 w-4 text-text-tertiary"}),(0,t.jsx)("span",{className:N.default.actionName,children:P("list.action.summary",{ns:"datasetDocuments"})})]}),(0,t.jsx)(u.default,{className:"my-1"})]}),F&&R===g.DataSourceType.FILE&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:N.default.actionItem,onClick:e=>{e.preventDefault(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation?.(),ex()},children:[(0,t.jsx)(a.RiDownload2Line,{className:"h-4 w-4 text-text-tertiary"}),(0,t.jsx)("span",{className:N.default.actionName,children:P("list.action.download",{ns:"datasetDocuments"})})]}),(0,t.jsx)(u.default,{className:"my-1"})]}),!F&&H?.toLowerCase()==="indexing"&&(0,t.jsxs)("div",{className:N.default.actionItem,onClick:()=>en("pause"),children:[(0,t.jsx)(a.RiPauseCircleLine,{className:"h-4 w-4 text-text-tertiary"}),(0,t.jsx)("span",{className:N.default.actionName,children:P("list.action.pause",{ns:"datasetDocuments"})})]}),!F&&H?.toLowerCase()==="paused"&&(0,t.jsxs)("div",{className:N.default.actionItem,onClick:()=>en("resume"),children:[(0,t.jsx)(a.RiPlayCircleLine,{className:"h-4 w-4 text-text-tertiary"}),(0,t.jsx)("span",{className:N.default.actionName,children:P("list.action.resume",{ns:"datasetDocuments"})})]}),!F&&(0,t.jsxs)("div",{className:N.default.actionItem,onClick:()=>en("archive"),children:[(0,t.jsx)(a.RiArchive2Line,{className:"h-4 w-4 text-text-tertiary"}),(0,t.jsx)("span",{className:N.default.actionName,children:P("list.action.archive",{ns:"datasetDocuments"})})]}),F&&(0,t.jsxs)("div",{className:N.default.actionItem,onClick:()=>en("un_archive"),children:[(0,t.jsx)(a.RiArchive2Line,{className:"h-4 w-4 text-text-tertiary"}),(0,t.jsx)("span",{className:N.default.actionName,children:P("list.action.unarchive",{ns:"datasetDocuments"})})]}),(0,t.jsxs)("div",{className:(0,v.cn)(N.default.actionItem,N.default.deleteActionItem,"group"),onClick:()=>K(!0),children:[(0,t.jsx)(a.RiDeleteBinLine,{className:"h-4 w-4 text-text-tertiary group-hover:text-text-destructive"}),(0,t.jsx)("span",{className:(0,v.cn)(N.default.actionName,"group-hover:text-text-destructive"),children:P("list.action.delete",{ns:"datasetDocuments"})})]})]}),trigger:"click",position:"br",btnElement:(0,t.jsx)("div",{className:(0,v.cn)(N.default.commonIcon),children:(0,t.jsx)(a.RiMoreFill,{className:"h-4 w-4 text-components-button-secondary-text"})}),btnClassName:e=>(0,v.cn)(es?N.default.actionIconWrapperList:N.default.actionIconWrapperDetail,e?"!hover:bg-state-base-hover !shadow-none":"!bg-transparent"),popupClassName:"!w-full",className:`!z-20 flex h-fit !w-[200px] justify-end ${S}`})]}),G&&(0,t.jsx)(d.default,{isShow:G,isLoading:z,isDisabled:z,title:P("list.delete.title",{ns:"datasetDocuments"}),content:P("list.delete.content",{ns:"datasetDocuments"}),confirmText:P("operation.sure",{ns:"common"}),onConfirm:()=>en("delete"),onCancel:()=>K(!1)}),ec&&ei&&(0,t.jsx)(k,{datasetId:C,documentId:ei.id,name:ei.name,onClose:ed,onSaved:em})]})});e.s(["default",0,I],312620)},396977,e=>{"use strict";e.i(152567);var t=e.i(408767);e.s(["useIndexStatus",0,()=>{let{t:e}=(0,t.useTranslation)();return{queuing:{color:"orange",text:e("list.status.queuing",{ns:"datasetDocuments"})},indexing:{color:"blue",text:e("list.status.indexing",{ns:"datasetDocuments"})},paused:{color:"orange",text:e("list.status.paused",{ns:"datasetDocuments"})},error:{color:"red",text:e("list.status.error",{ns:"datasetDocuments"})},available:{color:"green",text:e("list.status.available",{ns:"datasetDocuments"})},enabled:{color:"green",text:e("list.status.enabled",{ns:"datasetDocuments"})},disabled:{color:"gray",text:e("list.status.disabled",{ns:"datasetDocuments"})},archived:{color:"gray",text:e("list.status.archived",{ns:"datasetDocuments"})}}}])},247176,e=>{"use strict";var t=e.i(563199),a=e.i(38532),s=e.i(268255);e.i(152567);var n=e.i(408767),l=e.i(339548),i=e.i(260484),o=e.i(137667),c=e.i(421001),r=e.i(836340),d=e.i(666010),u=e.i(842090),m=e.i(935139),x=e.i(336864),p=e.i(396977);let h={green:"text-util-colors-green-green-600",orange:"text-util-colors-warning-warning-600",red:"text-util-colors-red-red-600",blue:"text-util-colors-blue-light-blue-light-600",yellow:"text-util-colors-warning-warning-600",gray:"text-text-tertiary"},y=s.memo(e=>{let{status:y,reverse:g=!1,scene:b="list",textCls:j="",errorMessage:v,datasetId:f="",detail:N,onUpdate:_}=e,{t:C}=(0,n.useTranslation)(),{notify:w}=(0,l.useContext)(o.ToastContext),D=(0,p.useIndexStatus)(),k=y.toLowerCase(),{enabled:I=!1,archived:M=!1,id:$=""}=N||{},{mutateAsync:S}=(0,d.useDocumentEnable)(),{mutateAsync:T}=(0,d.useDocumentDisable)(),{mutateAsync:L}=(0,d.useDocumentDelete)(),A=async e=>{let t=L;switch(e){case"enable":t=S;break;case"disable":t=T}let[a]=await (0,u.asyncRunSafe)(t({datasetId:f,documentId:$}));a?w({type:"error",message:C("actionMsg.modifiedUnsuccessfully",{ns:"common"})}):(w({type:"success",message:C("actionMsg.modifiedSuccessfully",{ns:"common"})}),_?.(e))},{run:F}=(0,a.useDebounceFn)(e=>{"enable"===e&&I||("disable"!==e||I)&&A(e)},{wait:500}),R=(0,s.useMemo)(()=>["queuing","indexing","paused"].includes(k),[k]);return(0,t.jsxs)("div",{className:(0,m.cn)("flex items-center",g?"flex-row-reverse":"","detail"===b?x.default.statusItemDetail:""),children:[(0,t.jsx)(r.default,{color:D[k]?.color,className:g?"ml-2":"mr-2"}),(0,t.jsx)("span",{className:(0,m.cn)(`${h[D[k].color]} text-sm`,j),children:D[k]?.text}),v&&(0,t.jsx)(c.default,{popupContent:(0,t.jsx)("div",{className:"max-w-[260px] break-all",children:v}),triggerClassName:"ml-1 w-4 h-4",triggerTestId:"error-tooltip-trigger"}),"detail"===b&&(0,t.jsx)("div",{className:"ml-1.5 flex items-center justify-between",children:(0,t.jsx)(c.default,{popupContent:C("list.action.enableWarning",{ns:"datasetDocuments"}),popupClassName:"text-text-secondary system-xs-medium",disabled:!M,children:(0,t.jsx)(i.default,{defaultValue:!M&&I,onChange:e=>!M&&F(e?"enable":"disable"),disabled:R||M,size:"md"})})})]})});e.s(["default",0,y])},551444,e=>{"use strict";var t=e.i(563199),a=e.i(837699),s=e.i(417944),n=e.i(268255);e.i(152567);var l=e.i(408767),i=e.i(151094),o=e.i(547105),c=e.i(757198);e.i(9633);var r=e.i(316803),d=e.i(935139);let u="batchAction",m=n.memo(e=>{let{className:n,selectedIds:m,onBatchEnable:x,onBatchDisable:p,onBatchSummary:h,onBatchDownload:y,onArchive:g,onBatchDelete:b,onEditMetadata:j,onBatchReIndex:v,onCancel:f}=e,{t:N}=(0,l.useTranslation)(),[_,{setTrue:C,setFalse:w}]=(0,s.useBoolean)(!1),[D,{setTrue:k}]=(0,s.useBoolean)(!1),I=async()=>{k(),await b(),w()};return(0,t.jsxs)("div",{className:(0,d.cn)("pointer-events-none flex w-full justify-center gap-x-2",n),children:[(0,t.jsxs)("div",{className:"pointer-events-auto flex items-center gap-x-1 rounded-[10px] border border-components-actionbar-border-accent bg-components-actionbar-bg-accent p-1 shadow-xl shadow-shadow-shadow-5",children:[(0,t.jsxs)("div",{className:"inline-flex items-center gap-x-2 py-1 pl-2 pr-3",children:[(0,t.jsx)("span",{className:"system-xs-medium flex h-5 w-5 items-center justify-center rounded-md bg-text-accent text-text-primary-on-surface",children:m.length}),(0,t.jsx)("span",{className:"system-sm-semibold text-text-accent",children:N(`${u}.selected`,{ns:"dataset"})})]}),(0,t.jsx)(c.default,{type:"vertical",className:"mx-0.5 h-3.5 bg-divider-regular"}),(0,t.jsxs)(i.default,{variant:"ghost",className:"gap-x-0.5 px-3",onClick:x,children:[(0,t.jsx)(a.RiCheckboxCircleLine,{className:"size-4"}),(0,t.jsx)("span",{className:"px-0.5",children:N(`${u}.enable`,{ns:"dataset"})})]}),(0,t.jsxs)(i.default,{variant:"ghost",className:"gap-x-0.5 px-3",onClick:p,children:[(0,t.jsx)(a.RiCloseCircleLine,{className:"size-4"}),(0,t.jsx)("span",{className:"px-0.5",children:N(`${u}.disable`,{ns:"dataset"})})]}),j&&(0,t.jsxs)(i.default,{variant:"ghost",className:"gap-x-0.5 px-3",onClick:j,children:[(0,t.jsx)(a.RiDraftLine,{className:"size-4"}),(0,t.jsx)("span",{className:"px-0.5",children:N("metadata.metadata",{ns:"dataset"})})]}),h&&(0,t.jsxs)(i.default,{variant:"ghost",className:"gap-x-0.5 px-3",onClick:h,children:[(0,t.jsx)(r.SearchLinesSparkle,{className:"size-4"}),(0,t.jsx)("span",{className:"px-0.5",children:N("list.action.summary",{ns:"datasetDocuments"})})]}),g&&(0,t.jsxs)(i.default,{variant:"ghost",className:"gap-x-0.5 px-3",onClick:g,children:[(0,t.jsx)(a.RiArchive2Line,{className:"size-4"}),(0,t.jsx)("span",{className:"px-0.5",children:N(`${u}.archive`,{ns:"dataset"})})]}),v&&(0,t.jsxs)(i.default,{variant:"ghost",className:"gap-x-0.5 px-3",onClick:v,children:[(0,t.jsx)(a.RiRefreshLine,{className:"size-4"}),(0,t.jsx)("span",{className:"px-0.5",children:N(`${u}.reIndex`,{ns:"dataset"})})]}),y&&(0,t.jsxs)(i.default,{variant:"ghost",className:"gap-x-0.5 px-3",onClick:y,children:[(0,t.jsx)(a.RiDownload2Line,{className:"size-4"}),(0,t.jsx)("span",{className:"px-0.5",children:N(`${u}.download`,{ns:"dataset"})})]}),(0,t.jsxs)(i.default,{variant:"ghost",destructive:!0,className:"gap-x-0.5 px-3",onClick:C,children:[(0,t.jsx)(a.RiDeleteBinLine,{className:"size-4"}),(0,t.jsx)("span",{className:"px-0.5",children:N(`${u}.delete`,{ns:"dataset"})})]}),(0,t.jsx)(c.default,{type:"vertical",className:"mx-0.5 h-3.5 bg-divider-regular"}),(0,t.jsx)(i.default,{variant:"ghost",className:"px-3",onClick:f,children:(0,t.jsx)("span",{className:"px-0.5",children:N(`${u}.cancel`,{ns:"dataset"})})})]}),_&&(0,t.jsx)(o.default,{isShow:!0,title:N("list.delete.title",{ns:"datasetDocuments"}),content:N("list.delete.content",{ns:"datasetDocuments"}),confirmText:N("operation.sure",{ns:"common"}),onConfirm:I,onCancel:w,isLoading:D,isDisabled:D})]})});e.s(["default",0,m])}]);