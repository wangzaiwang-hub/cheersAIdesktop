(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,598500,e=>{e.v({avatar:"style-module__12l82a__avatar","dot-flashing":"style-module__12l82a__dot-flashing","dot-flashing-avatar":"style-module__12l82a__dot-flashing-avatar",text:"style-module__12l82a__text"})},925818,e=>{"use strict";var t=e.i(563199),s=e.i(268255),r=e.i(935139),a=e.i(598500);let i=s.memo(e=>{let{type:s}=e;return(0,t.jsx)("div",{className:(0,r.cn)(a.default["dot-flashing"],a.default[s])})});e.s(["default",0,i])},344595,e=>{"use strict";var t=e.i(563199),s=e.i(268255);e.i(152567);var r=e.i(408767),a=e.i(339548),i=e.i(449980),l=e.i(137667),n=e.i(390622),o=e.i(933548),u=e.i(935139);e.i(275225);var c=e.i(705405),d=e.i(925818);e.i(237855);var p=e.i(297162),x=e.i(223314),f=e.i(379415),y=e.i(481162),b=e.i(955371),m=e.i(51828);let _=e=>{let{isRunning:r,outputs:a,error:i,height:l}=e,n=(0,s.useMemo)(()=>{if(!a||"object"!=typeof a)return!1;let e=Object.keys(a),t=a[e[0]];return 1===e.length&&("string"==typeof t||Array.isArray(t)&&t.every(e=>"string"==typeof e))},[a]),o=(0,s.useMemo)(()=>{let e=[];if(!a||Object.keys(a).length>1)return e;for(let t in a)Array.isArray(a[t])?a[t].map(t=>(t?.dify_model_identity==="__dify__file__"&&e.push(t),null)):a[t]?.dify_model_identity==="__dify__file__"&&e.push(a[t]);return(0,x.getProcessedFilesFromResponse)(e)},[a]);return(0,t.jsxs)("div",{className:"p-2",children:[r&&(0,t.jsx)("div",{className:"pl-[26px] pt-4",children:(0,t.jsx)(d.default,{type:"text"})}),!r&&i&&(0,t.jsx)("div",{className:"px-4",children:(0,t.jsx)(m.default,{status:"failed",children:i})}),!r&&!a&&(0,t.jsx)("div",{className:"px-4 py-2",children:(0,t.jsx)(f.Markdown,{content:"No Output"})}),n&&(0,t.jsx)("div",{className:"px-4 py-2",children:(0,t.jsx)(f.Markdown,{content:Array.isArray(a[Object.keys(a)[0]])?a[Object.keys(a)[0]].join("\n"):a[Object.keys(a)[0]]||""})}),o.length>0&&(0,t.jsx)("div",{className:"px-4 py-2",children:(0,t.jsx)(p.FileList,{files:o,showDeleteAction:!1,showDownloadAction:!0,canPreview:!0})}),!n&&a&&Object.keys(a).length>0&&l>0&&(0,t.jsx)("div",{className:"flex flex-col gap-2",children:(0,t.jsx)(y.default,{showFileList:!0,readOnly:!0,title:(0,t.jsx)("div",{tabIndex:0,children:"Output"}),language:b.CodeLanguage.json,value:JSON.stringify(a,null,2),isJSONStringifyBeauty:!0,height:l?(l-16)/2:void 0})})]})};var h=e.i(739780),g=e.i(40720),j=e.i(567898);e.s(["default",0,e=>{let{hideResult:d,activeTab:p="RESULT",getResultCallback:x,runDetailUrl:f,tracingListUrl:y}=e,{t:b}=(0,r.useTranslation)(),{notify:m}=(0,a.useContext)(l.ToastContext),[v,w]=(0,s.useState)(p),[k,N]=(0,s.useState)(!0),[L,T]=(0,s.useState)(),[A,R]=(0,s.useState)([]),C=(0,c.useStore)(e=>e.isListening),S=(0,s.useMemo)(()=>L?.created_by_role==="account"?L.created_by_account?.name||"":L?.created_by_role==="end_user"?L.created_by_end_user?.session_id||"":"N/A",[L]),E=(0,s.useCallback)(async()=>{try{let e=await (0,o.fetchRunDetail)(f);T(e),x&&x(e)}catch(e){m({type:"error",message:`${e}`})}},[m,x,f]),O=(0,s.useCallback)(async()=>{try{let{data:e}=await (0,o.fetchTracingList)({url:y});R(e)}catch(e){m({type:"error",message:`${e}`})}},[m,y]),D=(0,s.useCallback)(async()=>{N(!0),await E(),await O(),N(!1)},[E,O]),I=async e=>{w(e),"RESULT"===e&&f&&await E(),y&&await O()};(0,s.useEffect)(()=>{C&&w("DETAIL")},[C]),(0,s.useEffect)(()=>{f&&y&&D()},[f,y]);let[U,$]=(0,s.useState)(0),M=(0,s.useRef)(null);return(0,s.useEffect)(()=>{M.current&&$(M.current?.clientHeight-16-16-2-1)},[k]),(0,t.jsxs)("div",{className:"relative flex grow flex-col",children:[(0,t.jsxs)("div",{className:"flex shrink-0 items-center border-b-[0.5px] border-divider-subtle px-4",children:[!d&&(0,t.jsx)("div",{className:(0,u.cn)("system-sm-semibold-uppercase mr-6 cursor-pointer border-b-2 border-transparent py-3 text-text-tertiary","RESULT"===v&&"!border-util-colors-blue-brand-blue-brand-600 text-text-primary"),onClick:()=>I("RESULT"),children:b("result",{ns:"runLog"})}),(0,t.jsx)("div",{className:(0,u.cn)("system-sm-semibold-uppercase mr-6 cursor-pointer border-b-2 border-transparent py-3 text-text-tertiary","DETAIL"===v&&"!border-util-colors-blue-brand-blue-brand-600 text-text-primary"),onClick:()=>I("DETAIL"),children:b("detail",{ns:"runLog"})}),(0,t.jsx)("div",{className:(0,u.cn)("system-sm-semibold-uppercase mr-6 cursor-pointer border-b-2 border-transparent py-3 text-text-tertiary","TRACING"===v&&"!border-util-colors-blue-brand-blue-brand-600 text-text-primary"),onClick:()=>I("TRACING"),children:b("tracing",{ns:"runLog"})})]}),(0,t.jsxs)("div",{ref:M,className:(0,u.cn)("relative h-0 grow overflow-y-auto rounded-b-xl bg-components-panel-bg"),children:[k&&(0,t.jsx)("div",{className:"flex h-full items-center justify-center bg-components-panel-bg",children:(0,t.jsx)(i.default,{})}),!k&&"RESULT"===v&&L&&(0,t.jsx)(_,{outputs:L.outputs,error:L.error,height:U}),!k&&"DETAIL"===v&&L&&(0,t.jsx)(h.default,{inputs:L.inputs,inputs_truncated:L.inputs_truncated,outputs:L.outputs,outputs_truncated:L.outputs_truncated,outputs_full_content:L.outputs_full_content,status:L.status,error:L.error,elapsed_time:L.elapsed_time,total_tokens:L.total_tokens,created_at:L.created_at,created_by:S,steps:L.total_steps,exceptionCounts:L.exceptions_count,isListening:C}),!k&&"DETAIL"===v&&!L&&C&&(0,t.jsx)(g.default,{status:n.WorkflowRunningStatus.Running,isListening:!0}),!k&&"TRACING"===v&&(0,t.jsx)(j.default,{className:"bg-background-section-burn",list:A})]})]})}],344595)},522617,e=>{"use strict";var t=e.i(563199),s=e.i(837699),r=e.i(892081),a=e.i(268255);e.i(152567);var i=e.i(408767),l=e.i(189299),n=e.i(344595),o=e.i(935139);e.s(["default",0,e=>{let{currentLogItem:u,defaultTab:c="DETAIL",width:d,fixedWidth:p,onCancel:x}=e,{t:f}=(0,i.useTranslation)(),y=(0,a.useRef)(null),[b,m]=(0,a.useState)(!1),_=(0,l.useStore)(e=>e.appDetail);return((0,r.useClickAway)(()=>{b&&x()},y),(0,a.useEffect)(()=>{m(!0)},[]),u&&u.workflow_run_id)?(0,t.jsxs)("div",{className:(0,o.cn)("relative z-10 flex flex-col rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg pt-3 shadow-xl"),style:{width:p?d:480,...!p?{position:"fixed",top:64,left:8+(d-480),bottom:16}:{marginRight:8}},ref:y,children:[(0,t.jsx)("h1",{className:"system-xl-semibold shrink-0 px-4 py-1 text-text-primary",children:f("runDetail.title",{ns:"appLog"})}),(0,t.jsx)("span",{className:"absolute right-3 top-4 z-20 cursor-pointer p-1",onClick:x,children:(0,t.jsx)(s.RiCloseLine,{className:"h-4 w-4 text-text-tertiary"})}),(0,t.jsx)(n.default,{hideResult:!0,activeTab:c,runDetailUrl:`/apps/${_?.id}/workflow-runs/${u.workflow_run_id}`,tracingListUrl:`/apps/${_?.id}/workflow-runs/${u.workflow_run_id}/node-executions`})]}):null}])},958431,e=>{e.n(e.i(522617))}]);