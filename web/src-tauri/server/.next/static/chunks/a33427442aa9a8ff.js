(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,451028,e=>{"use strict";var t=e.i(875037),a=e.i(21213),o=e.i(367916),r=e.i(211857);let n="knowledge/create-dataset",l=(e,t)=>{let o=(0,a.groupBy)(e,"workspace_id");return Object.keys(o).map(e=>({workspaceId:e,pages:o[e]})).map(e=>({credential_id:t,workspace_id:e.workspaceId,pages:e.pages.map(e=>{let{page_id:t,page_name:a,page_icon:o,type:r}=e;return{page_id:t,page_name:a,page_icon:o,type:r}})}))},s=e=>{let{websiteCrawlProvider:t,websiteCrawlJobId:a,websitePages:o,crawlOptions:r}=e;return{provider:t,job_id:a,urls:o.map(e=>e.source_url),only_main_content:r?.only_main_content}};e.s(["getNotionInfo",0,l,"getWebsiteInfo",0,s,"useCreateDocument",0,function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,t.useMutation)({mutationFn:async t=>(0,r.createDocument)({datasetId:e,body:t}),...a})},"useCreateFirstDocument",0,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,t.useMutation)({mutationFn:async e=>(0,r.createFirstDocument)({body:e}),...e})},"useCreatePipelineDataset",0,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,t.useMutation)({mutationKey:[n,"create-pipeline-empty-dataset"],mutationFn:()=>(0,o.post)("/rag/pipeline/empty-dataset"),...e})},"useCreatePipelineDatasetFromCustomized",0,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,t.useMutation)({mutationKey:[n,"create-pipeline-dataset"],mutationFn:e=>(0,o.post)("/rag/pipeline/dataset",{body:e}),...e})},"useFetchDefaultProcessRule",0,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,t.useMutation)({mutationFn:async e=>(0,r.fetchDefaultProcessRule)({url:e}),...e})},"useFetchFileIndexingEstimateForFile",0,function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,t.useMutation)({mutationFn:async()=>(0,r.fetchFileIndexingEstimate)((e=>{let{docForm:t,docLanguage:a,dataSourceType:o,files:r,indexingTechnique:n,processRule:l,dataset_id:s}=e;return{info_list:{data_source_type:o,file_info_list:{file_ids:r.map(e=>e.id)}},indexing_technique:n,process_rule:l,doc_form:t,doc_language:a,dataset_id:s}})(e)),...a})},"useFetchFileIndexingEstimateForNotion",0,function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,t.useMutation)({mutationFn:async()=>(0,r.fetchFileIndexingEstimate)((e=>{let{docForm:t,docLanguage:a,dataSourceType:o,notionPages:r,indexingTechnique:n,processRule:s,dataset_id:i,credential_id:d}=e;return{info_list:{data_source_type:o,notion_info_list:l(r,d)},indexing_technique:n,process_rule:s,doc_form:t,doc_language:a,dataset_id:i}})(e)),...a})},"useFetchFileIndexingEstimateForWeb",0,function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,t.useMutation)({mutationFn:async()=>(0,r.fetchFileIndexingEstimate)((e=>{let{docForm:t,docLanguage:a,dataSourceType:o,websitePages:r,crawlOptions:n,websiteCrawlProvider:l,websiteCrawlJobId:i,indexingTechnique:d,processRule:u,dataset_id:c}=e;return{info_list:{data_source_type:o,website_info_list:s({websiteCrawlProvider:l,websiteCrawlJobId:i,websitePages:r,crawlOptions:n})},indexing_technique:d,process_rule:u,doc_form:t,doc_language:a,dataset_id:c}})(e)),...a})}])},389111,946196,553588,272033,326534,e=>{"use strict";var t=e.i(563199),a=e.i(807324),o=e.i(298407);let r=e=>{let{ref:r,...n}=e;return(0,t.jsx)(a.default,{...n,ref:r,data:o.default})};r.displayName="ExternalKnowledgeBase",e.s(["default",0,r],946196);var n=e.i(607922);let l=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:n.default})};l.displayName="General",e.s(["default",0,l],553588),e.i(936177);var s=e.i(736484);let i=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:s.default})};i.displayName="ParentChild",e.s(["default",0,i],272033);var d=e.i(286099);let u=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:d.default})};u.displayName="Qa",e.s(["default",0,u],326534),e.s([],389111)},889625,e=>{"use strict";var t=e.i(553588);e.s(["General",()=>t.default])},42139,e=>{"use strict";var t=e.i(946196);e.s(["ExternalKnowledgeBase",()=>t.default])},17970,524032,e=>{"use strict";var t=e.i(272033);e.s(["ParentChild",()=>t.default],17970);var a=e.i(326534);e.s(["Qa",()=>a.default],524032)},9633,774330,204667,663554,462007,177660,215859,940446,440355,304769,908287,907288,685044,739033,951151,516885,e=>{"use strict";var t=e.i(563199),a=e.i(807324),o=e.i(307888);let r=e=>{let{ref:r,...n}=e;return(0,t.jsx)(a.default,{...n,ref:r,data:o.default})};r.displayName="AddChunks",e.s(["default",0,r],774330);var n=e.i(893473);let l=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:n.default})};l.displayName="ApiAggregate",e.s(["default",0,l],204667);var s=e.i(463490);let i=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:s.default})};i.displayName="ArrowShape",e.s(["default",0,i],663554);var d=e.i(292453);let u=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:d.default})};u.displayName="Chunk",e.s(["default",0,u],462007);var c=e.i(957435);let m=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:c.default})};m.displayName="Collapse",e.s(["default",0,m],177660),e.i(891880);var p=e.i(252327);let h=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:p.default})};h.displayName="Economic",e.s(["default",0,h],215859);var x=e.i(163953);let f=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:x.default})};f.displayName="FullTextSearch",e.s(["default",0,f],940446);var g=e.i(705324);let b=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:g.default})};b.displayName="GeneralChunk",e.s(["default",0,b],440355);var y=e.i(913145);let v=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:y.default})};v.displayName="HighQuality",e.s(["default",0,v],304769);var w=e.i(777723);let j=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:w.default})};j.displayName="HybridSearch",e.s(["default",0,j],908287);var k=e.i(598170);let N=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:k.default})};N.displayName="ParentChildChunk",e.s(["default",0,N],907288);var E=e.i(590823);let _=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:E.default})};_.displayName="QuestionAndAnswer",e.s(["default",0,_],685044);var T=e.i(430051);let C=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:T.default})};C.displayName="SearchLinesSparkle",e.s(["default",0,C],739033);var F=e.i(232868);let S=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:F.default})};S.displayName="SearchMenu",e.s(["default",0,S],951151);var I=e.i(4415);let z=e=>{let{ref:o,...r}=e;return(0,t.jsx)(a.default,{...r,ref:o,data:I.default})};z.displayName="VectorSearch",e.s(["default",0,z],516885),e.s([],9633)},621379,334163,684040,92234,e=>{"use strict";e.i(389111);var t,a,o,r,n,l,s,i,d=e.i(42139),u=e.i(889625),c=e.i(17970),m=e.i(524032);e.i(9633);var p=e.i(440355);e.s(["GeneralChunk",()=>p.default],334163);var p=p,h=e.i(907288);e.s(["ParentChildChunk",()=>h.default],684040);var h=h,x=e.i(685044);e.s(["QuestionAndAnswer",()=>x.default],92234);var x=x,f=((t={}).FILE="upload_file",t.NOTION="notion_import",t.WEB="website_crawl",t),g=((a={}).onlyMe="only_me",a.allTeamMembers="all_team_members",a.partialMembers="partial_members",a),b=((o={}).text="text_model",o.qa="qa_model",o.parentChild="hierarchical_model",o),y=((r={}).init="init",r.running="running",r.finished="finished",r),v=((n={}).general="custom",n.parentChild="hierarchical",n),w=((l={}).SemanticFirst="semantic_first",l.KeywordFirst="keyword_first",l.Customized="customized",l),j=((s={}).RerankingModel="reranking_model",s.WeightedScore="weighted_score",s),k=((i={}).enable="enable",i.disable="disable",i.archive="archive",i.unArchive="un_archive",i.delete="delete",i.summary="summary",i);let N={text_model:u.General,qa_model:m.Qa,hierarchical_model:c.ParentChild,external:d.ExternalKnowledgeBase};p.default,x.default,h.default,e.s(["CUSTOMIZABLE_DOC_TYPES",0,["book","web_page","paper","social_media_post","personal_document","business_document","im_chat_log"],"ChunkingMode",()=>b,"CrawlStep",()=>y,"DEFAULT_WEIGHTED_SCORE",0,{allHighQualityVectorSearch:{semantic:1,keyword:0},allHighQualityFullTextSearch:{semantic:0,keyword:1},other:{semantic:.7,keyword:.3}},"DOC_FORM_ICON_WITH_BG",0,N,"DOC_FORM_TEXT",0,{text_model:"general",qa_model:"qa",hierarchical_model:"parentChild"},"DataSourceType",()=>f,"DatasetPermission",()=>g,"DisplayStatusList",0,["queuing","indexing","paused","error","available","enabled","disabled","archived"],"DocumentActionType",()=>k,"ProcessMode",()=>v,"RerankingModeEnum",()=>j,"WeightedScoreEnum",()=>w],621379)},964596,e=>{"use strict";var t=e.i(563199),a=e.i(848082),o=e.i(157169),r=e.i(268255),n=e.i(935139);function l(e){let{trigger:l="hover",position:s="bottom",htmlContent:i,popupClassName:d,btnElement:u,className:c,btnClassName:m,manualClose:p,disabled:h=!1}=e,x=(0,r.useRef)(null),f=(0,r.useRef)(null),g=e=>{null!=f.current&&window.clearTimeout(f.current),e||x.current?.click()},b=e=>{f.current=window.setTimeout(()=>{e&&x.current?.click()},100)};return(0,t.jsx)(a.Popover,{className:"relative",children:e=>{let{open:f}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{..."hover"!==l?{}:{onMouseLeave:()=>b(f),onMouseEnter:()=>g(f)},children:[(0,t.jsx)(a.PopoverButton,{ref:x,disabled:h,className:(0,n.cn)("group inline-flex items-center rounded-lg border border-components-button-secondary-border bg-components-button-secondary-bg px-3 py-2 text-base font-medium hover:border-components-button-secondary-border-hover hover:bg-components-button-secondary-bg-hover focus:outline-none",f&&"border-components-button-secondary-border bg-components-button-secondary-bg-hover",m&&"string"==typeof m&&m,m&&"string"!=typeof m&&m?.(f)),children:u}),(0,t.jsx)(o.Transition,{as:r.Fragment,children:(0,t.jsx)(a.PopoverPanel,{className:(0,n.cn)("absolute z-10 mt-1 w-full max-w-sm px-4 sm:px-0 lg:max-w-3xl","bottom"===s&&"left-1/2 -translate-x-1/2","bl"===s&&"left-0","br"===s&&"right-0",c),..."hover"!==l?{}:{onMouseLeave:()=>b(f),onMouseEnter:()=>g(f)},children:e=>{let{close:a}=e;return(0,t.jsx)("div",{className:(0,n.cn)("w-fit min-w-[130px] overflow-hidden rounded-lg bg-components-panel-bg shadow-lg ring-1 ring-black/5",d),..."hover"!==l?{}:{onMouseLeave:()=>b(f),onMouseEnter:()=>g(f)},children:(0,r.isValidElement)(i)?(0,r.cloneElement)(i,{open:f,onClose:a,...p?{onClick:a}:{}}):i})}})})]})})}})}e.s(["default",()=>l])},21213,e=>{"use strict";var t=e.i(783527),a=e.i(553682),o=e.i(388103);function r(e,r){if(null==e)return{};let n=(0,a.isArrayLike)(e)?Array.from(e):Object.values(e),l=(0,o.iteratee)(r??t.identity),s={};for(let e=0;e<n.length;e++){let t=n[e],a=l(t);Object.hasOwn(s,a)||(s[a]=[]),s[a].push(t)}return s}e.s(["groupBy",()=>r],21213)},892081,e=>{"use strict";var t=e.i(393689),a=e.i(220431);let o=function(e){if(!e||!document.getRootNode)return document;var t,o=Array.isArray(e)?e:[e];return o.every(function(e){var t=(0,a.getTargetElement)(e);return!!t&&t.getRootNode()instanceof ShadowRoot})?(t=(0,a.getTargetElement)(o[0]))?t.getRootNode():document:document};var r=e.i(99878);function n(e,n,l){void 0===l&&(l="click");var s=(0,t.default)(e);(0,r.default)(function(){var e=function(e){(Array.isArray(n)?n:[n]).some(function(t){var o=(0,a.getTargetElement)(t);return!o||o.contains(e.target)})||s.current(e)},t=o(n),r=Array.isArray(l)?l:[l];return r.forEach(function(a){return t.addEventListener(a,e)}),function(){r.forEach(function(a){return t.removeEventListener(a,e)})}},Array.isArray(l)?l:[l],n)}e.s(["useClickAway",()=>n],892081)},381086,e=>{"use strict";var t,a=((t={}).none="none",t.failBranch="fail-branch",t.defaultValue="default-value",t);e.s(["ErrorHandleTypeEnum",()=>a])},227579,e=>{"use strict";var t=e.i(563199),a=e.i(268255),o=e.i(935139);let r=a.memo(e=>{let{className:a}=e;return(0,t.jsx)("div",{className:(0,o.cn)("absolute size-[112px] rounded-full bg-util-colors-blue-brand-blue-brand-500 blur-[80px]",a)})});e.s(["default",0,r])},445924,e=>{"use strict";var t,a=e.i(563199),o=e.i(268255),r=e.i(389358),n=e.i(192447),l=e.i(876057),s=e.i(234766),i=e.i(959752),d=e.i(490525),u=e.i(786191),c=e.i(4520),m=e.i(534042),p=e.i(794611),h=e.i(322034),x=e.i(935139),f=e.i(174383),g=e.i(381086),b=e.i(390622);e.i(905691);var y=e.i(735900);let v=(0,o.memo)(e=>{let{id:t,data:r,sourceHandleId:l,sourceX:s,sourceY:i,targetX:d,targetY:u,selected:c}=e,[m]=(0,n.getBezierPath)({sourceX:s-8,sourceY:i,sourcePosition:n.Position.Right,targetX:d+8,targetY:u,targetPosition:n.Position.Left,curvature:.16}),{_sourceRunningStatus:p,_targetRunningStatus:h}=r,x=(0,o.useMemo)(()=>{if((p===b.NodeRunningStatus.Succeeded||p===b.NodeRunningStatus.Failed||p===b.NodeRunningStatus.Exception)&&(h===b.NodeRunningStatus.Succeeded||h===b.NodeRunningStatus.Failed||h===b.NodeRunningStatus.Exception||h===b.NodeRunningStatus.Running))return t},[p,h,t]),v=(0,o.useMemo)(()=>c?(0,y.getEdgeColor)(b.NodeRunningStatus.Running):x?`url(#${x})`:r?._connectedNodeIsHovering?(0,y.getEdgeColor)(b.NodeRunningStatus.Running,l===g.ErrorHandleTypeEnum.failBranch):(0,y.getEdgeColor)(),[r._connectedNodeIsHovering,x,c,l]);return(0,a.jsxs)(a.Fragment,{children:[x&&(0,a.jsx)(f.default,{id:x,startColor:(0,y.getEdgeColor)(p),stopColor:(0,y.getEdgeColor)(h),position:{x1:s,y1:i,x2:d,y2:u}}),(0,a.jsx)(n.BaseEdge,{id:t,path:m,style:{stroke:v,strokeWidth:2,opacity:r._waitingRun?.7:1}})]})});e.i(152567);var w=e.i(408767),j=e.i(421001),k=e.i(120219),N=e.i(911684);let E=(0,o.memo)(e=>{let{data:t,handleId:o,handleClassName:r}=e,l=t._connectedTargetHandleIds?.includes(o);return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(n.Handle,{id:o,type:"target",position:n.Position.Left,className:(0,x.cn)("z-[1] !h-4 !w-4 !rounded-none !border-none !bg-transparent !outline-none","after:absolute after:left-1.5 after:top-1 after:h-2 after:w-0.5 after:bg-workflow-link-line-handle","transition-all hover:scale-125",!l&&"after:opacity-0",(t.type===b.BlockEnum.Start||t.type===b.BlockEnum.TriggerWebhook||t.type===b.BlockEnum.TriggerSchedule||t.type===b.BlockEnum.TriggerPlugin)&&"opacity-0",r)})})});E.displayName="NodeTargetHandle";let _=(0,o.memo)(e=>{let{data:t,handleId:o,handleClassName:r}=e,l=t._connectedSourceHandleIds?.includes(o);return(0,a.jsx)(n.Handle,{id:o,type:"source",position:n.Position.Right,className:(0,x.cn)("group/handle z-[1] !h-4 !w-4 !rounded-none !border-none !bg-transparent !outline-none","after:absolute after:right-1.5 after:top-1 after:h-2 after:w-0.5 after:bg-workflow-link-line-handle","transition-all hover:scale-125",!l&&"after:opacity-0",r)})});_.displayName="NodeSourceHandle";let T=e=>{let{id:t,data:r}=e,{t:l}=(0,w.useTranslation)(),{error_strategy:s}=r,i=(0,n.useUpdateNodeInternals)();return((0,o.useEffect)(()=>{s===g.ErrorHandleTypeEnum.failBranch&&i(t)},[s,t,i]),s)?(0,a.jsx)("div",{className:"relative px-3 pb-2 pt-1",children:(0,a.jsxs)("div",{className:(0,x.cn)("relative flex h-6 items-center justify-between rounded-md bg-workflow-block-parma-bg px-[5px]",r._runningStatus===b.NodeRunningStatus.Exception&&"border-[0.5px] border-components-badge-status-light-warning-halo bg-state-warning-hover"),children:[(0,a.jsx)("div",{className:"system-xs-medium-uppercase text-text-tertiary",children:l("common.onFailure",{ns:"workflow"})}),(0,a.jsxs)("div",{className:(0,x.cn)("system-xs-medium text-text-secondary",r._runningStatus===b.NodeRunningStatus.Exception&&"text-text-warning"),children:[s===g.ErrorHandleTypeEnum.defaultValue&&l("nodes.common.errorHandle.defaultValue.output",{ns:"workflow"}),s===g.ErrorHandleTypeEnum.failBranch&&l("nodes.common.errorHandle.failBranch.title",{ns:"workflow"})]}),s===g.ErrorHandleTypeEnum.failBranch&&(0,a.jsx)(_,{id:t,data:r,handleId:g.ErrorHandleTypeEnum.failBranch,handleClassName:"!top-1/2 !-right-[21px] !-translate-y-1/2 after:!bg-workflow-link-line-failure-button-bg"})]})}):null},C=(0,o.memo)(e=>{let{id:t,data:r,children:n}=e,{t:l}=(0,w.useTranslation)();return(0,a.jsx)("div",{className:(0,x.cn)("flex rounded-2xl border-[2px] border-transparent"),style:{width:r.type===b.BlockEnum.Iteration||r.type===b.BlockEnum.Loop?r.width:"auto",height:r.type===b.BlockEnum.Iteration||r.type===b.BlockEnum.Loop?r.height:"auto"},children:(0,a.jsxs)("div",{className:(0,x.cn)("group relative pb-1 shadow-xs","rounded-[15px] border border-transparent","bg-workflow-block-bg hover:shadow-lg"),style:{width:r.type===b.BlockEnum.Iteration||r.type===b.BlockEnum.Loop?r.width:"240px",height:r.type===b.BlockEnum.Iteration||r.type===b.BlockEnum.Loop?r.height:"auto"},children:[(0,a.jsxs)("div",{className:(0,x.cn)("flex items-center rounded-t-2xl px-3 pb-2 pt-3"),children:[(0,a.jsx)(E,{id:t,data:r,handleClassName:"!top-4 !-left-[9px] !translate-y-0",handleId:"target"}),r.type!==b.BlockEnum.IfElse&&r.type!==b.BlockEnum.QuestionClassifier&&(0,a.jsx)(_,{id:t,data:r,handleClassName:"!top-4 !-right-[9px] !translate-y-0",handleId:"source"}),(0,a.jsx)(k.default,{className:"mr-2 shrink-0",type:r.type,size:"md"}),(0,a.jsxs)("div",{title:r.title,className:"system-sm-semibold-uppercase mr-1 flex grow items-center truncate text-text-primary",children:[(0,a.jsx)("div",{children:r.title}),r.type===b.BlockEnum.Iteration&&r.is_parallel&&(0,a.jsx)(j.default,{popupContent:(0,a.jsxs)("div",{className:"w-[180px]",children:[(0,a.jsx)("div",{className:"font-extrabold",children:l("nodes.iteration.parallelModeEnableTitle",{ns:"workflow"})}),l("nodes.iteration.parallelModeEnableDesc",{ns:"workflow"})]}),children:(0,a.jsx)("div",{className:"system-2xs-medium-uppercase ml-1 flex items-center justify-center rounded-[5px] border-[1px] border-text-warning px-[5px] py-[3px] text-text-warning ",children:l("nodes.iteration.parallelModeUpper",{ns:"workflow"})})})]})]}),r.type!==b.BlockEnum.Iteration&&r.type!==b.BlockEnum.Loop&&n&&(0,o.cloneElement)(n,{id:t,data:r}),(r.type===b.BlockEnum.Iteration||r.type===b.BlockEnum.Loop)&&n&&(0,a.jsx)("div",{className:"h-[calc(100%-42px)] w-full grow pb-1 pl-1 pr-1",children:(0,o.cloneElement)(n,{id:t,data:r})}),(0,N.hasErrorHandleNode)(r.type)&&(0,a.jsx)(T,{id:t,data:r}),r.desc&&r.type!==b.BlockEnum.Iteration&&r.type!==b.BlockEnum.Loop&&(0,a.jsx)("div",{className:"system-xs-regular whitespace-pre-line break-words px-3 pb-2 pt-1 text-text-tertiary",children:r.desc})]})})});var F=e.i(555503),S=e.i(166211),I=e.i(146106);let z="nodes.ifElse",O=o.memo(e=>{let{data:t}=e,{t:r}=(0,w.useTranslation)(),{cases:n}=t,l=n.length,s=(0,o.useCallback)(e=>!!e.variable_selector&&0!==e.variable_selector.length&&(e.sub_variable_condition?e.sub_variable_condition.conditions.every(e=>!!e.comparison_operator&&(!!(0,I.isEmptyRelatedOperator)(e.comparison_operator)||!!e.value)):!!(0,I.isEmptyRelatedOperator)(e.comparison_operator)||!!e.value),[]),i=(0,a.jsx)("div",{className:"flex h-6 items-center space-x-1 rounded-md bg-workflow-block-parma-bg px-1 text-xs font-normal text-text-secondary",children:r(`${z}.conditionNotSetup`,{ns:"workflow"})});return(0,a.jsxs)("div",{className:"px-3",children:[n.map((t,o)=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"relative flex h-6 items-center px-1",children:[(0,a.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,a.jsx)("div",{className:"text-[10px] font-semibold text-text-tertiary",children:l>1&&`CASE ${o+1}`}),(0,a.jsx)("div",{className:"text-[12px] font-semibold text-text-secondary",children:0===o?"IF":"ELIF"})]}),(0,a.jsx)(_,{...e,handleId:t.case_id,handleClassName:"!top-1/2 !-right-[21px] !-translate-y-1/2"})]}),(0,a.jsx)("div",{className:"space-y-0.5",children:t.conditions.map((e,o)=>(0,a.jsxs)("div",{className:"relative",children:[s(e)?!(0,I.isEmptyRelatedOperator)(e.comparison_operator)&&e.sub_variable_condition?(0,a.jsx)(F.default,{condition:e}):(0,a.jsx)(S.default,{variableSelector:e.variable_selector,operator:e.comparison_operator,value:e.value}):i,o!==t.conditions.length-1&&(0,a.jsx)("div",{className:"absolute bottom-[-10px] right-1 z-10 text-[10px] font-medium uppercase leading-4 text-text-accent",children:r(`${z}.${t.logical_operator}`,{ns:"workflow"})})]},e.id))})]},t.case_id)),(0,a.jsxs)("div",{className:"relative flex h-6 items-center px-1",children:[(0,a.jsx)("div",{className:"w-full text-right text-xs font-semibold text-text-secondary",children:"ELSE"}),(0,a.jsx)(_,{...e,handleId:"false",handleClassName:"!top-1/2 !-right-[21px] !-translate-y-1/2"})]})]})}),B=(0,o.memo)(e=>{let{id:t}=e,{zoom:o}=(0,n.useViewport)();return(0,a.jsx)("div",{className:(0,x.cn)("relative h-full min-h-[90px] w-full min-w-[240px] rounded-2xl bg-workflow-canvas-workflow-bg"),children:(0,a.jsx)(l.Background,{id:`iteration-background-${t}`,className:"!z-0 rounded-2xl",gap:[14/o,14/o],size:2/o,color:"var(--color-workflow-canvas-workflow-dot-color)"})})});var R=e.i(105845);let M=(0,o.memo)(e=>{let t,{id:r,data:s}=e,{zoom:d}=(0,n.useViewport)(),u=(0,n.useNodesInitialized)(),{handleNodeLoopRerender:c}=(t=(0,n.useStoreApi)(),{handleNodeLoopRerender:(0,o.useCallback)(e=>{let a,o,{getNodes:r,setNodes:n}=t.getState(),l=r(),s=l.find(t=>t.id===e);l.filter(t=>t.parentId===e).forEach(e=>{a?e.position.x+e.width>a.position.x+a.width&&(a=e):a=e,o?e.position.y+e.height>o.position.y+o.height&&(o=e):o=e});let d=a&&s.width<a.position.x+a.width,u=o&&s.height<o.position.y+o.height;(d||u)&&n((0,R.produce)(l,t=>{t.forEach(t=>{t.id===e&&(d&&(t.data.width=a.position.x+a.width+i.LOOP_PADDING.right,t.width=a.position.x+a.width+i.LOOP_PADDING.right),u&&(t.data.height=o.position.y+o.height+i.LOOP_PADDING.bottom,t.height=o.position.y+o.height+i.LOOP_PADDING.bottom))})}))},[t])});return(0,o.useEffect)(()=>{u&&c(r)},[u,r,c]),(0,a.jsx)("div",{className:(0,x.cn)("relative h-full min-h-[90px] w-full min-w-[240px] rounded-2xl bg-workflow-canvas-workflow-bg"),children:(0,a.jsx)(l.Background,{id:`loop-background-${r}`,className:"!z-0 rounded-2xl",gap:[14/d,14/d],size:2/d,color:"var(--color-workflow-canvas-workflow-dot-color)"})})});var P=e.i(617178);let A=o.memo(e=>{let{t}=(0,w.useTranslation)(),{data:o}=e,r=o.classes;return(0,a.jsx)("div",{className:"mb-1 px-3 py-1",children:!!r.length&&(0,a.jsx)("div",{className:"mt-2 space-y-0.5",children:r.map((o,r)=>(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(P.default,{title:`${t("nodes.questionClassifiers.class",{ns:"workflow"})} ${r+1}`,content:""}),(0,a.jsx)(_,{...e,handleId:o.id,handleClassName:"!top-1/2 !-translate-y-1/2 !-right-[21px]"})]},r))})})}),D={[b.BlockEnum.QuestionClassifier]:A,[b.BlockEnum.IfElse]:O,[b.BlockEnum.Iteration]:B,[b.BlockEnum.Loop]:M},L=e=>{let t=D[e.data.type];return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(C,{...e,children:t&&(0,a.jsx)(t,{})})})};var H=e.i(837699);let G=(0,o.memo)(e=>{let{id:t,data:o}=e,{t:r}=(0,w.useTranslation)();return(0,a.jsxs)("div",{className:"nodrag group mt-1 flex h-11 w-11 items-center justify-center rounded-2xl border border-workflow-block-border bg-workflow-block-bg shadow-xs",children:[(0,a.jsx)(j.default,{popupContent:r("blocks.iteration-start",{ns:"workflow"}),asChild:!1,children:(0,a.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full border-[0.5px] border-components-panel-border-subtle bg-util-colors-blue-brand-blue-brand-500",children:(0,a.jsx)(H.RiHome5Fill,{className:"h-3 w-3 text-text-primary-on-surface"})})}),(0,a.jsx)(_,{id:t,data:o,handleClassName:"!top-1/2 !-right-[9px] !-translate-y-1/2",handleId:"source"})]})}),U=(0,o.memo)(e=>{let{id:t,data:o}=e,{t:r}=(0,w.useTranslation)();return(0,a.jsxs)("div",{className:"nodrag group mt-1 flex h-11 w-11 items-center justify-center rounded-2xl border border-workflow-block-border bg-workflow-block-bg",children:[(0,a.jsx)(j.default,{popupContent:r("blocks.loop-start",{ns:"workflow"}),asChild:!1,children:(0,a.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full border-[0.5px] border-components-panel-border-subtle bg-util-colors-blue-brand-blue-brand-500",children:(0,a.jsx)(H.RiHome5Fill,{className:"h-3 w-3 text-text-primary-on-surface"})})}),(0,a.jsx)(_,{id:t,data:o,handleClassName:"!top-1/2 !-right-[9px] !-translate-y-1/2",handleId:"source"})]})});e.i(444462);var $=e.i(212838),K=e.i(378675);let q=(0,o.memo)(e=>{let{data:t}=e,{t:r}=(0,w.useTranslation)(),n=(0,o.useRef)(null),l=t.theme;return(0,a.jsx)("div",{className:(0,x.cn)("relative flex flex-col rounded-md border shadow-xs hover:shadow-md",m.THEME_MAP[l].bg,t.selected?m.THEME_MAP[l].border:"border-black/5"),style:{width:t.width,height:t.height},ref:n,children:(0,a.jsx)(K.NoteEditorContextProvider,{value:t.text,editable:!1,children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:(0,x.cn)("h-2 shrink-0 rounded-t-md opacity-50",m.THEME_MAP[l].title)}),(0,a.jsx)("div",{className:"grow overflow-y-auto px-3 py-2.5",children:(0,a.jsx)("div",{className:(0,x.cn)(t.selected&&"nodrag nopan nowheel cursor-text"),children:(0,a.jsx)($.NoteEditor,{containerElement:n.current,placeholder:r("nodes.note.editor.placeholder",{ns:"workflow"})||""})})}),t.showAuthor&&(0,a.jsx)("div",{className:"p-3 pt-0 text-xs text-text-tertiary",children:t.author})]})})})});var Q=e.i(757198),V=e.i(391185),W=e.i(175179),Z=e.i(194902),X=((t=X||{}).zoomIn="zoomIn",t.zoomOut="zoomOut",t.zoomToFit="zoomToFit",t.zoomTo25="zoomTo25",t.zoomTo50="zoomTo50",t.zoomTo75="zoomTo75",t.zoomTo100="zoomTo100",t.zoomTo200="zoomTo200",t);let Y=(0,o.memo)(()=>{let{t:e}=(0,w.useTranslation)(),{zoomIn:t,zoomOut:r,zoomTo:l,fitView:s}=(0,n.useReactFlow)(),{zoom:i}=(0,n.useViewport)(),[d,u]=(0,o.useState)(!1),c=[[{key:"zoomTo200",text:"200%"},{key:"zoomTo100",text:"100%"},{key:"zoomTo75",text:"75%"},{key:"zoomTo50",text:"50%"},{key:"zoomTo25",text:"25%"}],[{key:"zoomToFit",text:e("operator.zoomToFit",{ns:"workflow"})}]],m=(0,o.useCallback)(()=>{u(e=>!e)},[]);return(0,a.jsxs)(V.PortalToFollowElem,{placement:"top-start",open:d,onOpenChange:u,offset:{mainAxis:4,crossAxis:-2},children:[(0,a.jsx)(V.PortalToFollowElemTrigger,{asChild:!0,children:(0,a.jsx)("div",{className:(0,x.cn)("h-9 cursor-pointer rounded-lg border-[0.5px] border-components-actionbar-border bg-components-actionbar-bg","p-0.5 text-[13px] shadow-lg backdrop-blur-[5px]","hover:bg-state-base-hover"),children:(0,a.jsxs)("div",{className:(0,x.cn)("flex h-8 w-[98px] items-center justify-between rounded-lg"),children:[(0,a.jsx)(W.default,{title:e("operator.zoomOut",{ns:"workflow"}),shortcuts:["ctrl","-"],children:(0,a.jsx)("div",{className:`flex h-8 w-8 items-center justify-center rounded-lg ${i<=.25?"cursor-not-allowed":"cursor-pointer hover:bg-black/5"}`,onClick:e=>{i<=.25||(e.stopPropagation(),r())},children:(0,a.jsx)(H.RiZoomOutLine,{className:"h-4 w-4 text-text-tertiary hover:text-text-secondary"})})}),(0,a.jsxs)("div",{onClick:m,className:(0,x.cn)("system-sm-medium w-[34px] text-text-tertiary hover:text-text-secondary"),children:[Number.parseFloat(`${100*i}`).toFixed(0),"%"]}),(0,a.jsx)(W.default,{title:e("operator.zoomIn",{ns:"workflow"}),shortcuts:["ctrl","+"],children:(0,a.jsx)("div",{className:`flex h-8 w-8 items-center justify-center rounded-lg ${i>=2?"cursor-not-allowed":"cursor-pointer hover:bg-black/5"}`,onClick:e=>{i>=2||(e.stopPropagation(),t())},children:(0,a.jsx)(H.RiZoomInLine,{className:"h-4 w-4 text-text-tertiary hover:text-text-secondary"})})})]})})}),(0,a.jsx)(V.PortalToFollowElemContent,{className:"z-10",children:(0,a.jsx)("div",{className:"w-[145px] rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur shadow-lg backdrop-blur-[5px]",children:c.map((e,t)=>(0,a.jsxs)(o.Fragment,{children:[0!==t&&(0,a.jsx)(Q.default,{className:"m-0"}),(0,a.jsx)("div",{className:"p-1",children:e.map(e=>(0,a.jsxs)("div",{className:"system-md-regular flex h-8 cursor-pointer items-center justify-between space-x-1 rounded-lg py-1.5 pl-3 pr-2 text-text-secondary hover:bg-state-base-hover",onClick:()=>{var t;"zoomToFit"===(t=e.key)&&s(),"zoomTo25"===t&&l(.25),"zoomTo50"===t&&l(.5),"zoomTo75"===t&&l(.75),"zoomTo100"===t&&l(1),"zoomTo200"===t&&l(2)},children:[(0,a.jsx)("span",{children:e.text}),(0,a.jsxs)("div",{className:"flex items-center space-x-0.5",children:["zoomToFit"===e.key&&(0,a.jsx)(Z.default,{keys:["ctrl","1"]}),"zoomTo50"===e.key&&(0,a.jsx)(Z.default,{keys:["shift","5"]}),"zoomTo100"===e.key&&(0,a.jsx)(Z.default,{keys:["shift","1"]})]})]},e.key))})]},t))})})]})}),J={[i.CUSTOM_NODE]:L,[m.CUSTOM_NOTE_NODE]:q,[p.CUSTOM_SIMPLE_NODE]:L,[u.CUSTOM_ITERATION_START_NODE]:G,[c.CUSTOM_LOOP_START_NODE]:U},ee={[i.CUSTOM_EDGE]:v},et=e=>{let{nodes:t,edges:u,viewport:c,className:m,miniMapToRight:p}=e,[f,g]=(0,o.useState)(()=>(0,h.initialNodes)(t,u)),[b,y]=(0,o.useState)(()=>(0,h.initialEdges)(u,t)),v=(0,o.useCallback)(e=>g(t=>(0,n.applyNodeChanges)(e,t)),[]),w=(0,o.useCallback)(e=>y(t=>(0,n.applyEdgeChanges)(e,t)),[]);return(0,a.jsxs)("div",{id:"workflow-container",className:(0,x.cn)("relative h-full w-full",m),children:[(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.MiniMap,{pannable:!0,zoomable:!0,style:{width:102,height:72},maskColor:"var(--color-workflow-minimap-bg)",className:(0,x.cn)("!absolute !bottom-14 z-[9] !m-0 !h-[72px] !w-[102px] !rounded-lg !border-[0.5px] !border-divider-subtle !bg-background-default-subtle !shadow-md !shadow-shadow-shadow-5",p?"!right-4":"!left-4")}),(0,a.jsx)("div",{className:"absolute bottom-4 left-4 z-[9] mt-1 flex items-center gap-2",children:(0,a.jsx)(Y,{})})]}),(0,a.jsx)(r.default,{nodeTypes:J,edgeTypes:ee,nodes:f,onNodesChange:v,edges:b,onEdgesChange:w,connectionLineComponent:d.default,connectionLineContainerStyle:{zIndex:i.ITERATION_CHILDREN_Z_INDEX},defaultViewport:c,multiSelectionKeyCode:null,deleteKeyCode:null,nodesDraggable:!0,nodesConnectable:!1,nodesFocusable:!1,edgesFocusable:!1,panOnScroll:!1,selectionKeyCode:null,selectionMode:n.SelectionMode.Partial,minZoom:.25,children:(0,a.jsx)(l.Background,{gap:[14,14],size:2,className:"bg-workflow-canvas-workflow-bg",color:"var(--color-workflow-canvas-workflow-dot-color)"})})]})};e.s(["default",0,e=>(0,a.jsx)(n.ReactFlowProvider,{children:(0,a.jsx)(et,{...e})})],445924)}]);