(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,974650,e=>{"use strict";e.s(["CUSTOM_DATA_SOURCE_EMPTY_NODE",0,"custom-data-source-empty"])},412008,120455,e=>{"use strict";var t=e.i(268255);e.i(152567);var r=e.i(408767),a=e.i(877166),o=e.i(390622);e.i(905691);var n=e.i(97672);let l={metaData:(0,n.genNodeMetaData)({sort:-1,type:o.BlockEnum.DataSourceEmpty,isUndeletable:!0,isSingleton:!0}),defaultValue:{},checkValid:()=>({isValid:!0})};var i=e.i(671258);e.i(698628);var s=e.i(127210);let d={metaData:(0,n.genNodeMetaData)({sort:3.1,type:o.BlockEnum.KnowledgeBase,isRequired:!0,isUndeletable:!0,isSingleton:!0,isTypeFixed:!0}),defaultValue:{index_chunk_variable_selector:[],keyword_number:10,retrieval_model:{top_k:3,score_threshold_enabled:!1,score_threshold:.5}},checkValid(e,t){let{chunk_structure:r,indexing_technique:a,retrieval_model:o,embedding_model:n,embedding_model_provider:l,index_chunk_variable_selector:i,_embeddingModelList:d,_rerankModelList:u}=e,{search_method:c,reranking_enable:p,reranking_model:f}=o||{},m=d?.find(e=>e.provider===l),h=m?.models.find(e=>e.model===n),w=u?.find(e=>e.provider===f?.reranking_provider_name),g=w?.models.find(e=>e.model===f?.reranking_model_name);if(!r)return{isValid:!1,errorMessage:t("nodes.knowledgeBase.chunkIsRequired",{ns:"workflow"})};if(0===i.length)return{isValid:!1,errorMessage:t("nodes.knowledgeBase.chunksVariableIsRequired",{ns:"workflow"})};if(!a)return{isValid:!1,errorMessage:t("nodes.knowledgeBase.indexMethodIsRequired",{ns:"workflow"})};if(a===s.IndexingType.QUALIFIED){if(!n||!l)return{isValid:!1,errorMessage:t("nodes.knowledgeBase.embeddingModelIsRequired",{ns:"workflow"})};else if(!h)return{isValid:!1,errorMessage:t("nodes.knowledgeBase.embeddingModelIsInvalid",{ns:"workflow"})}}if(!o||!c)return{isValid:!1,errorMessage:t("nodes.knowledgeBase.retrievalSettingIsRequired",{ns:"workflow"})};if(p){if(!f||!f.reranking_provider_name||!f.reranking_model_name)return{isValid:!1,errorMessage:t("nodes.knowledgeBase.rerankingModelIsRequired",{ns:"workflow"})};else if(!g)return{isValid:!1,errorMessage:t("nodes.knowledgeBase.rerankingModelIsInvalid",{ns:"workflow"})}}return{isValid:!0,errorMessage:""}}};e.s(["default",0,d],120455);var u=e.i(683257);e.s(["useAvailableNodesMetaData",0,()=>{let{t:e}=(0,r.useTranslation)(),n=(0,u.useDocLink)(),s=(0,t.useMemo)(()=>[...a.WORKFLOW_COMMON_NODES,{...i.default,defaultValue:{...i.default.defaultValue,_dataSourceStartToAdd:!0}},d,l],[]),c=(0,t.useMemo)(()=>n("/use-dify/knowledge/knowledge-pipeline/knowledge-pipeline-orchestration"),[n]),p=(0,t.useMemo)(()=>s.map(t=>{let{metaData:r}=t,a=e(`blocks.${r.type}`,{ns:"workflow"}),o=e(`blocksAbout.${r.type}`,{ns:"workflow"});return{...t,metaData:{...r,title:a,description:o,helpLinkUri:c},defaultValue:{...t.defaultValue,type:r.type,title:a}}}),[s,e]),f=(0,t.useMemo)(()=>p.reduce((e,t)=>(e[t.metaData.type]=t,e),{}),[p]);return(0,t.useMemo)(()=>({nodes:p,nodesMap:{...f,[o.BlockEnum.VariableAssigner]:f?.[o.BlockEnum.VariableAggregator]}}),[p,f])}],412008)},160186,609211,656391,316462,342746,313111,168408,621830,138957,21734,853484,e=>{"use strict";e.s([],160186),e.i(412008),e.s(["useDSL",()=>S],313111);var t=e.i(268255);e.i(152567);var r=e.i(408767),a=e.i(137667),o=e.i(959752);e.i(275225);var n=e.i(705405),l=e.i(249420),i=e.i(475390),s=e.i(141696),d=e.i(618403);e.s(["useNodesSyncDraft",()=>b],342746);var u=e.i(105845),c=e.i(192447),p=e.i(337160),f=e.i(720315),m=e.i(925521);e.i(845780);var h=e.i(856105),w=e.i(974650),g=e.i(534042),k=e.i(141167),y=e.i(390622);e.i(905691);var x=e.i(52592);let v=(e,t)=>{let r;for(let a=0;a<e.length;a++){let n=e[a];if(n.data.type===y.BlockEnum.DataSource)return{nodes:e,viewport:t};n.type!==o.CUSTOM_NODE||r||(r=n),n.type===o.CUSTOM_NODE&&r&&n.position.x<r.position.x&&(r=n)}if(r){let a=r.position.x-o.NODE_WIDTH_X_OFFSET,n=r.position.y,{newNode:l}=(0,x.generateNewNode)({id:"data-source-empty",type:w.CUSTOM_DATA_SOURCE_EMPTY_NODE,data:{title:"",desc:"",type:y.BlockEnum.DataSourceEmpty,width:240,_isTempNode:!0},position:{x:a,y:n}});return{nodes:[l,(0,x.generateNewNode)({id:"note",type:g.CUSTOM_NOTE_NODE,data:{title:"",desc:"",type:"",text:'{"root":{"children":[{"children":[{"detail":0,"format":1,"mode":"normal","style":"font-size: 14px;","text":"Get started with a blank pipeline","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":1,"textStyle":"font-size: 14px;"},{"children":[],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":1,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"A Knowledge Pipeline starts with Data Source as the starting node and ends with the knowledge base node. The general steps are: import documents from the data source → use extractor to extract document content → split and clean content into structured chunks → store in the knowledge base.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"children":[{"detail":0,"format":2,"mode":"normal","style":"","text":"Link to documentation","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"link","version":1,"textFormat":2,"rel":"noreferrer","target":"_blank","title":null,"url":"https://dify.ai"}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":2,"textStyle":""},{"children":[],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""}],"direction":"ltr","format":"","indent":0,"type":"root","version":1,"textFormat":1,"textStyle":"font-size: 14px;"}}',theme:k.NoteTheme.blue,author:"",showAuthor:!0,width:240,height:300,_isTempNode:!0},position:{x:a,y:n+100}}).newNode,...e],viewport:{x:(o.START_INITIAL_POSITION.x-a)*(t?.zoom||1),y:(o.START_INITIAL_POSITION.y-n)*(t?.zoom||1),zoom:t?.zoom||1}}}return{nodes:e,viewport:t}};e.s(["processNodesWithoutDataSource",0,v],609211),e.s([],656391);let C=()=>{let e=(0,n.useWorkflowStore)(),{handleUpdateWorkflowCanvas:r}=(0,h.useWorkflowUpdate)();return{handleRefreshWorkflowDraft:(0,t.useCallback)(()=>{let{pipelineId:t,setSyncWorkflowDraftHash:a,setIsSyncingWorkflowDraft:o,setEnvironmentVariables:n,setEnvSecrets:l}=e.getState();o(!0),(0,s.fetchWorkflowDraft)(`/rag/pipelines/${t}/workflows/draft`).then(e=>{let{nodes:t,viewport:o}=v(e.graph.nodes,e.graph.viewport);r({...e.graph,nodes:t,viewport:o}),a(e.hash),l((e.environment_variables||[]).filter(e=>"secret"===e.value_type).reduce((e,t)=>(e[t.id]=t.value,e),{})),n(e.environment_variables?.map(e=>"secret"===e.value_type?{...e,value:"[__HIDDEN__]"}:e)||[])}).finally(()=>o(!1))},[r,e])}};e.s(["usePipelineRefreshDraft",0,C],316462);let b=()=>{let e=(0,c.useStoreApi)(),r=(0,n.useWorkflowStore)(),{getNodesReadOnly:a}=(0,f.useNodesReadOnly)(),{handleRefreshWorkflowDraft:o}=C(),l=(0,t.useCallback)(()=>{let{getNodes:t,edges:a,transform:o}=e.getState(),n=t().filter(e=>!e.data._isTempNode),[l,i,s]=o,{pipelineId:d,environmentVariables:c,syncWorkflowDraftHash:p,ragPipelineVariables:f}=r.getState();if(d&&n.length)return{url:`/rag/pipelines/${d}/workflows/draft`,params:{graph:{nodes:(0,u.produce)(n,e=>{e.forEach(e=>{Object.keys(e.data).forEach(t=>{t.startsWith("_")&&delete e.data[t]})})}),edges:(0,u.produce)(a,e=>{e.forEach(e=>{Object.keys(e.data).forEach(t=>{t.startsWith("_")&&delete e.data[t]})})}),viewport:{x:l,y:i,zoom:s}},environment_variables:c,rag_pipeline_variables:f,hash:p}}},[e,r]),i=(0,t.useCallback)(()=>{if(a())return;let e=l();e&&navigator.sendBeacon(`${m.API_PREFIX}${e.url}`,JSON.stringify(e.params))},[l,a]),d=(0,t.useCallback)(async(e,t)=>{if(a())return;let n=l();if(n){let{setSyncWorkflowDraftHash:a,setDraftUpdatedAt:l}=r.getState();try{let e=await (0,s.syncWorkflowDraft)(n);a(e.hash),l(e.updated_at),t?.onSuccess?.()}catch(r){r&&r.json&&!r.bodyUsed&&r.json().then(t=>{"draft_workflow_not_sync"!==t.code||e||o()}),t?.onError?.()}finally{t?.onSettled?.()}}},[l,a,r,o]);return{doSyncWorkflowDraft:(0,p.useSerialAsyncCallback)(d,a),syncWorkflowDraftWhenPageClose:i}},S=()=>{let{t:e}=(0,r.useTranslation)(),{notify:u}=(0,a.useToastContext)(),{eventEmitter:c}=(0,l.useEventEmitterContextContext)(),[p,f]=(0,t.useState)(!1),{doSyncWorkflowDraft:m}=b(),h=(0,n.useWorkflowStore)(),{mutateAsync:w}=(0,i.useExportPipelineDSL)(),g=(0,t.useCallback)(async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{pipelineId:r,knowledgeName:a}=h.getState();if(r&&!p)try{f(!0),await m();let{data:e}=await w({pipelineId:r,include:t}),o=new Blob([e],{type:"application/yaml"});(0,d.downloadBlob)({data:o,fileName:`${a}.pipeline`})}catch{u({type:"error",message:e("exportFailed",{ns:"app"})})}finally{f(!1)}},[u,e,m,p,w,h]);return{exportCheck:(0,t.useCallback)(async()=>{let{pipelineId:t}=h.getState();if(t)try{let e=((await (0,s.fetchWorkflowDraft)(`/rag/pipelines/${t}/workflows/draft`)).environment_variables||[]).filter(e=>"secret"===e.value_type);if(0===e.length)return void g();c?.emit({type:o.DSL_EXPORT_CHECK,payload:{data:e}})}catch{u({type:"error",message:e("exportFailed",{ns:"app"})})}},[c,g,u,e,h]),handleExportDSL:g}};e.s(["useGetRunAndTraceUrl",0,()=>{let e=(0,n.useWorkflowStore)();return{getWorkflowRunAndTraceUrl:(0,t.useCallback)(t=>{let{pipelineId:r}=e.getState();return{runUrl:`/rag/pipelines/${r}/workflow-runs/${t}`,traceUrl:`/rag/pipelines/${r}/workflow-runs/${t}/node-executions`}},[e])}}],168408);let _=()=>{let e=(0,n.useWorkflowStore)(),r=(0,n.useStore)(e=>e.showInputFieldPreviewPanel),a=(0,n.useStore)(e=>e.inputFieldEditPanelProps),o=(0,t.useMemo)(()=>r,[r]),l=(0,t.useMemo)(()=>!!a,[a]),i=(0,t.useCallback)(()=>{let{setShowInputFieldPanel:t,setShowInputFieldPreviewPanel:r,setInputFieldEditPanelProps:a}=e.getState();t?.(!1),r?.(!1),a?.(null)},[e]);return{closeAllInputFieldPanels:i,toggleInputFieldPreviewPanel:(0,t.useCallback)(()=>{let{showInputFieldPreviewPanel:t,setShowInputFieldPreviewPanel:r}=e.getState();r?.(!t)},[e]),toggleInputFieldEditPanel:(0,t.useCallback)(t=>{let{setInputFieldEditPanelProps:r}=e.getState();r?.(t)},[e]),isPreviewing:o,isEditing:l}};e.s(["useInputFieldPanel",0,_],621830);var N=e.i(413159),I=e.i(387852),T=e.i(168014),R=e.i(120455);e.s(["usePipelineInit",0,()=>{let e,a,l,d,u,c,p=(0,n.useWorkflowStore)(),{nodes:f,edges:m}=(()=>{let{t:e}=(0,r.useTranslation)(),{newNode:t}=(0,x.generateNewNode)({id:"knowledgeBase",data:{...R.default.defaultValue,type:R.default.metaData.type,title:e(`blocks.${R.default.metaData.type}`,{ns:"workflow"}),selected:!0},position:{x:o.START_INITIAL_POSITION.x+500,y:o.START_INITIAL_POSITION.y}});return{nodes:[t],edges:[]}})(),[h,w]=(0,t.useState)(),[g,k]=(0,t.useState)(!0),y=(0,N.useDatasetDetailContextWithSelector)(e=>e.dataset)?.pipeline_id,v=(0,N.useDatasetDetailContextWithSelector)(e=>e.dataset)?.name,C=(0,N.useDatasetDetailContextWithSelector)(e=>e.dataset)?.icon_info;(0,t.useEffect)(()=>{p.setState({pipelineId:y,knowledgeName:v,knowledgeIcon:C})},[y,p,v,C]),e=(0,n.useStore)(e=>e.pipelineId),a=(0,n.useWorkflowStore)(),l=(0,t.useCallback)(e=>{let{setNodesDefaultConfigs:t}=a.getState(),r={};Array.isArray(e)?e.forEach(e=>{r[e.type]=e.config}):r=e,t(r)},[a]),(0,I.useWorkflowConfig)(e?`/rag/pipelines/${e}/workflows/default-workflow-block-configs`:"",l),d=(0,t.useCallback)(e=>{let{setPublishedAt:t}=a.getState();t(e?.created_at)},[a]),(0,I.useWorkflowConfig)(e?`/rag/pipelines/${e}/workflows/publish`:"",d),u=(0,t.useCallback)(e=>{e.forEach(e=>{let t=e.declaration.identity.icon;"string"!=typeof t||t.includes(T.basePath)||(e.declaration.identity.icon=`${T.basePath}${t}`)});let{setDataSourceList:t}=a.getState();t(e)},[a]),c=(0,t.useCallback)(e=>{let{setFileUploadConfig:t}=a.getState();t(e)},[a]),(0,I.useWorkflowConfig)("/files/upload",c),(0,i.useDataSourceList)(!!e,u);let b=(0,t.useCallback)(async()=>{let{setEnvSecrets:e,setEnvironmentVariables:t,setSyncWorkflowDraftHash:r,setDraftUpdatedAt:a,setToolPublished:o,setRagPipelineVariables:n}=p.getState();try{let l=await (0,s.fetchWorkflowDraft)(`/rag/pipelines/${y}/workflows/draft`);w(l),a(l.updated_at),o(l.tool_published),e((l.environment_variables||[]).filter(e=>"secret"===e.value_type).reduce((e,t)=>(e[t.id]=t.value,e),{})),t(l.environment_variables?.map(e=>"secret"===e.value_type?{...e,value:"[__HIDDEN__]"}:e)||[]),r(l.hash),n?.(l.rag_pipeline_variables||[]),k(!1)}catch(e){e&&e.json&&!e.bodyUsed&&y&&e.json().then(e=>{"draft_workflow_not_exist"===e.code&&(p.setState({notInitialWorkflow:!0,shouldAutoOpenStartNodeSelector:!0}),(0,s.syncWorkflowDraft)({url:`/rag/pipelines/${y}/workflows/draft`,params:{graph:{nodes:f,edges:m},environment_variables:[]}}).then(e=>{let{setDraftUpdatedAt:t}=p.getState();t(e.updated_at),b()}))})}},[f,m,p,y]);return(0,t.useEffect)(()=>{b()},[]),{data:h,isLoading:g}}],138957),e.s(["usePipelineRun",()=>P],21734);var W=e.i(360766),D=e.i(225036),E=e.i(367916),M=e.i(480600);let P=()=>{let e=(0,c.useStoreApi)(),r=(0,n.useWorkflowStore)(),a=(0,c.useReactFlow)(),{doSyncWorkflowDraft:o}=b(),{handleUpdateWorkflowCanvas:l}=(0,h.useWorkflowUpdate)(),{handleWorkflowStarted:i,handleWorkflowFinished:d,handleWorkflowFailed:p,handleWorkflowNodeStarted:f,handleWorkflowNodeFinished:m,handleWorkflowNodeIterationStarted:w,handleWorkflowNodeIterationNext:g,handleWorkflowNodeIterationFinished:k,handleWorkflowNodeLoopStarted:x,handleWorkflowNodeLoopNext:v,handleWorkflowNodeLoopFinished:C,handleWorkflowNodeRetry:S,handleWorkflowAgentLog:_,handleWorkflowTextChunk:N,handleWorkflowTextReplace:T}=(0,D.useWorkflowRunEvent)(),R=(0,t.useCallback)(()=>{let{getNodes:t,edges:n}=e.getState(),{getViewport:l}=a,{backupDraft:i,setBackupDraft:s,environmentVariables:d}=r.getState();i||(s({nodes:t(),edges:n,viewport:l(),environmentVariables:d}),o())},[a,r,e,o]),P=(0,t.useCallback)(()=>{let{backupDraft:e,setBackupDraft:t,setEnvironmentVariables:a}=r.getState();if(e){let{nodes:r,edges:o,viewport:n,environmentVariables:i}=e;l({nodes:r,edges:o,viewport:n}),a(i),t(void 0)}},[l,r]),j=(0,n.useStore)(e=>e.pipelineId),F=(0,I.useInvalidAllLastRun)(M.FlowType.ragPipeline,j),{fetchInspectVars:L}=(0,W.useSetWorkflowVarsWithValue)({flowType:M.FlowType.ragPipeline,flowId:j}),A=(0,t.useCallback)(async(t,a)=>{let{getNodes:n,setNodes:l}=e.getState();l((0,u.produce)(n(),e=>{e.forEach(e=>{e.data.selected=!1,e.data._runningStatus=void 0})})),await o();let{onWorkflowStarted:s,onWorkflowFinished:c,onNodeStarted:h,onNodeFinished:b,onIterationStart:I,onIterationNext:R,onIterationFinish:W,onLoopStart:D,onLoopNext:M,onLoopFinish:P,onNodeRetry:j,onAgentLog:A,onError:O,...V}=a||{},{pipelineId:B}=r.getState();r.setState({historyWorkflowData:void 0});let{clientWidth:$,clientHeight:U}=document.getElementById("workflow-container"),H=`/rag/pipelines/${B}/workflows/draft/run`,{setWorkflowRunningData:q}=r.getState();q({result:{inputs_truncated:!1,process_data_truncated:!1,outputs_truncated:!1,status:y.WorkflowRunningStatus.Running},tracing:[],resultText:""}),(0,E.ssePost)(H,{body:t},{onWorkflowStarted:e=>{i(e),s&&s(e)},onWorkflowFinished:e=>{d(e),L({}),F(),c&&c(e)},onError:e=>{p(),O&&O(e)},onNodeStarted:e=>{f(e,{clientWidth:$,clientHeight:U}),h&&h(e)},onNodeFinished:e=>{m(e),b&&b(e)},onIterationStart:e=>{w(e,{clientWidth:$,clientHeight:U}),I&&I(e)},onIterationNext:e=>{g(e),R&&R(e)},onIterationFinish:e=>{k(e),W&&W(e)},onLoopStart:e=>{x(e,{clientWidth:$,clientHeight:U}),D&&D(e)},onLoopNext:e=>{v(e),M&&M(e)},onLoopFinish:e=>{C(e),P&&P(e)},onNodeRetry:e=>{S(e),j&&j(e)},onAgentLog:e=>{_(e),A&&A(e)},onTextChunk:e=>{N(e)},onTextReplace:e=>{T(e)},...V})},[e,r,o,i,d,p,f,m,w,g,k,x,v,C,S,N,T,_]);return{handleBackupDraft:R,handleLoadBackupDraft:P,handleRun:A,handleStopRun:(0,t.useCallback)(e=>{let{pipelineId:t}=r.getState();(0,s.stopWorkflowRun)(`/rag/pipelines/${t}/workflow-runs/tasks/${e}/stop`)},[r]),handleRestoreFromPublishedWorkflow:(0,t.useCallback)(e=>{let t=e.graph.nodes.map(e=>({...e,selected:!1,data:{...e.data,selected:!1}}));l({nodes:t,edges:e.graph.edges,viewport:e.graph.viewport}),r.getState().setEnvironmentVariables(e.environment_variables||[]),r.getState().setRagPipelineVariables?.(e.rag_pipeline_variables||[])},[l,r])}};e.s(["usePipelineStartRun",()=>j],853484);let j=()=>{let e=(0,n.useWorkflowStore)(),{handleCancelDebugAndPreviewPanel:r}=(0,h.useWorkflowInteractions)(),{doSyncWorkflowDraft:a}=b(),{closeAllInputFieldPanels:o}=_(),l=(0,t.useCallback)(async()=>{let{workflowRunningData:t}=e.getState();if(t?.result.status===y.WorkflowRunningStatus.Running)return;let{isPreparingDataSource:n,setIsPreparingDataSource:l,showDebugAndPreviewPanel:i,setShowEnvPanel:s,setShowDebugAndPreviewPanel:d}=e.getState();if(!n&&t)return void e.setState({isPreparingDataSource:!0,workflowRunningData:void 0});if(s(!1),o(),i){l?.(!1),r();return}await a(),l?.(!0),d(!0)},[e,r,a]);return{handleStartWorkflowRun:(0,t.useCallback)(()=>{l()},[l]),handleWorkflowStartRunInWorkflow:l}}},737198,e=>{e.v({icon:{type:"element",isRootNode:!0,name:"svg",attributes:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},children:[{type:"element",name:"path",attributes:{d:"M22.7 11.5L20.7005 13.5L18.7 11.5M20.9451 13C20.9814 12.6717 21 12.338 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21C14.8273 21 17.35 19.6963 19 17.6573M12 7V12L15 14",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},children:[]}]},name:"ClockFastForward"})},490414,e=>{e.v({icon:{type:"element",isRootNode:!0,name:"svg",attributes:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},children:[{type:"element",name:"g",attributes:{id:"Icon","clip-path":"url(#clip0_635_10941)"},children:[{type:"element",name:"path",attributes:{id:"Vector",d:"M14.6334 8.66683C14.6552 8.44756 14.6663 8.22516 14.6663 8.00016C14.6663 4.31826 11.6816 1.3335 7.99967 1.3335C4.31778 1.3335 1.33301 4.31826 1.33301 8.00016C1.33301 11.6821 4.31778 14.6668 7.99967 14.6668C8.11145 14.6668 8.22258 14.6641 8.33301 14.6586C8.44487 14.6531 8.556 14.6449 8.66634 14.6339M7.99967 4.00016V8.00016L5.42265 9.25534M11.853 9.97346L14.4308 11.9068C14.6238 12.0515 14.7203 12.1239 14.7548 12.2126C14.785 12.2904 14.785 12.3766 14.7548 12.4543C14.7203 12.543 14.6238 12.6154 14.4308 12.7601L11.853 14.6935C11.5784 14.8995 11.441 15.0024 11.3261 15.0001C11.226 14.998 11.1322 14.9511 11.0706 14.8723C10.9997 14.7818 10.9997 14.6101 10.9997 14.2668V10.4001C10.9997 10.0568 10.9997 9.88516 11.0706 9.79463C11.1322 9.71585 11.226 9.66895 11.3261 9.66687C11.441 9.66448 11.5784 9.76747 11.853 9.97346Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},children:[]}]},{type:"element",name:"defs",attributes:{},children:[{type:"element",name:"clipPath",attributes:{id:"clip0_635_10941"},children:[{type:"element",name:"rect",attributes:{width:"16",height:"16",fill:"white"},children:[]}]}]}]},name:"ClockPlay"})},13393,e=>{e.v({icon:{type:"element",isRootNode:!0,name:"svg",attributes:{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},children:[{type:"element",name:"g",attributes:{id:"Icon"},children:[{type:"element",name:"path",attributes:{id:"Vector",d:"M29.2673 17.3332C29.3109 16.8946 29.3332 16.4498 29.3332 15.9998C29.3332 8.63604 23.3636 2.6665 15.9998 2.6665C8.63604 2.6665 2.6665 8.63604 2.6665 15.9998C2.6665 23.3636 8.63604 29.3332 15.9998 29.3332C16.2234 29.3332 16.4457 29.3277 16.6665 29.3168C16.8902 29.3058 17.1125 29.2892 17.3332 29.2673M15.9998 7.99984V15.9998L10.8458 18.5102M23.7065 19.9464L28.8621 23.8131C29.2481 24.1026 29.441 24.2473 29.5101 24.4248C29.5705 24.5802 29.5705 24.7527 29.5101 24.9081C29.441 25.0855 29.2481 25.2303 28.8621 25.5198L23.7065 29.3864C23.1572 29.7984 22.8825 30.0044 22.6526 29.9996C22.4526 29.9955 22.265 29.9017 22.1416 29.7441C21.9998 29.5631 21.9998 29.2197 21.9998 28.5331V20.7998C21.9998 20.1131 21.9998 19.7698 22.1416 19.5888C22.265 19.4312 22.4526 19.3374 22.6526 19.3333C22.8825 19.3285 23.1572 19.5345 23.7065 19.9464Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},children:[]}]}]},name:"ClockPlaySlim"})},144768,e=>{e.v({icon:{type:"element",isRootNode:!0,name:"svg",attributes:{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},children:[{type:"element",name:"g",attributes:{id:"clock-refresh"},children:[{type:"element",name:"g",attributes:{id:"Solid"},children:[{type:"element",name:"path",attributes:{d:"M9.76984 2.8375L9.71551 3.04027C8.27602 1.22839 5.68891 0.69459 3.62457 1.88644C2.25681 2.67611 1.43067 4.04369 1.27558 5.50073C1.24636 5.77532 1.44526 6.02161 1.71985 6.05084C1.99444 6.08007 2.24074 5.88116 2.26997 5.60657C2.39268 4.4537 3.04533 3.37556 4.12456 2.75247C5.7025 1.84145 7.66731 2.20754 8.82211 3.53002L8.65016 3.48395C8.38343 3.41248 8.10926 3.57077 8.03779 3.8375C7.96632 4.10424 8.12461 4.37841 8.39134 4.44988L9.75737 4.8159C10.0241 4.88737 10.2983 4.72908 10.3697 4.46235L10.7358 3.09632C10.8072 2.82959 10.6489 2.55542 10.3822 2.48395C10.1155 2.41248 9.84131 2.57077 9.76984 2.8375Z",fill:"currentColor"},children:[]},{type:"element",name:"path",attributes:{d:"M10.2792 5.94921C10.5538 5.97844 10.7527 6.22473 10.7235 6.49932C10.5684 7.95635 9.74225 9.32394 8.3745 10.1136C6.31011 11.3055 3.72295 10.7716 2.28347 8.95968L2.22918 9.1623C2.15771 9.42903 1.88354 9.58732 1.61681 9.51585C1.35008 9.44438 1.19178 9.17021 1.26325 8.90348L1.62928 7.53746C1.70075 7.27072 1.97492 7.11243 2.24165 7.1839L3.60768 7.54993C3.87441 7.6214 4.0327 7.89557 3.96123 8.1623C3.88976 8.42903 3.61559 8.58732 3.34886 8.51585L3.17668 8.46972C4.33144 9.79246 6.29644 10.1587 7.8745 9.24758C8.95373 8.62449 9.60638 7.54634 9.72909 6.39348C9.75832 6.11889 10.0046 5.91998 10.2792 5.94921Z",fill:"currentColor"},children:[]},{type:"element",name:"path",attributes:{d:"M6.49954 3.74997C6.49954 3.47382 6.27568 3.24997 5.99954 3.24997C5.7234 3.24997 5.49954 3.47382 5.49954 3.74997V5.99997C5.49954 6.1756 5.59169 6.33835 5.74229 6.42871L6.99229 7.17871C7.22908 7.32079 7.53621 7.244 7.67828 7.00721C7.82036 6.77042 7.74358 6.46329 7.50679 6.32122L6.49954 5.71687V3.74997Z",fill:"currentColor"},children:[]}]}]}]},name:"ClockRefresh"})},711786,983389,15676,912558,e=>{"use strict";var t=e.i(563199),r=e.i(807324),a=e.i(737198);let o=e=>{let{ref:o,...n}=e;return(0,t.jsx)(r.default,{...n,ref:o,data:a.default})};o.displayName="ClockFastForward",e.s(["default",0,o],983389);var n=e.i(490414);let l=e=>{let{ref:a,...o}=e;return(0,t.jsx)(r.default,{...o,ref:a,data:n.default})};l.displayName="ClockPlay",e.s(["default",0,l],15676);var i=e.i(13393);let s=e=>{let{ref:a,...o}=e;return(0,t.jsx)(r.default,{...o,ref:a,data:i.default})};s.displayName="ClockPlaySlim",e.s(["default",0,s],912558),e.i(144768),e.s([],711786)},414696,347229,e=>{"use strict";var t=e.i(15676);e.s(["ClockPlay",()=>t.default],414696);var r=e.i(563199),a=e.i(837699),o=e.i(268255);e.i(152567);var n=e.i(408767);e.i(538868);var l=e.i(506033);e.i(711786);var t=t,i=e.i(912558),i=i,s=e.i(449980),d=e.i(391185),u=e.i(421001);e.i(160186);var c=e.i(621830);e.i(275225);var p=e.i(705405),f=e.i(363372),m=e.i(387852),h=e.i(935139);e.i(845780);var w=e.i(720315),g=e.i(265522),k=e.i(856105),y=e.i(556354),x=e.i(390622);e.i(905691);var v=e.i(706416);let C=(0,o.memo)(e=>{let{withText:C,onClearLogAndMessageModal:b,historyUrl:S}=e,{t:_}=(0,n.useTranslation)(),N=(0,w.useIsChatMode)(),[I,T]=(0,o.useState)(!1),{formatTimeFromNow:R}=(0,f.useFormatTimeFromNow)(),{handleNodesCancelSelected:W}=(0,g.useNodesInteractions)(),{handleCancelDebugAndPreviewPanel:D}=(0,k.useWorkflowInteractions)(),E=(0,p.useWorkflowStore)(),M=(0,p.useStore)(e=>e.setControlMode),P=(0,p.useStore)(e=>e.historyWorkflowData),{handleBackupDraft:j}=(0,y.useWorkflowRun)(),{closeAllInputFieldPanels:F}=(0,c.useInputFieldPanel)(),L=I&&!!S,{data:A,isLoading:O}=(0,m.useWorkflowRunHistory)(S,L);return(0,r.jsxs)(d.PortalToFollowElem,{placement:C?"bottom-start":"bottom-end",offset:{mainAxis:4,crossAxis:C?-8:10},open:I,onOpenChange:T,children:[(0,r.jsxs)(d.PortalToFollowElemTrigger,{onClick:()=>T(e=>!e),children:[C&&(0,r.jsxs)("div",{className:(0,h.cn)("flex h-8 items-center rounded-lg border-[0.5px] border-components-button-secondary-border bg-components-button-secondary-bg px-3 shadow-xs","cursor-pointer text-[13px] font-medium text-components-button-secondary-text hover:bg-components-button-secondary-bg-hover",I&&"bg-components-button-secondary-bg-hover"),children:[(0,r.jsx)(t.default,{className:"mr-1 h-4 w-4"}),_("common.showRunHistory",{ns:"workflow"})]}),!C&&(0,r.jsx)(u.default,{popupContent:_("common.viewRunHistory",{ns:"workflow"}),children:(0,r.jsx)("div",{className:(0,h.cn)("group flex h-7 w-7 cursor-pointer items-center justify-center rounded-md hover:bg-state-accent-hover",I&&"bg-state-accent-hover"),onClick:()=>{b?.()},children:(0,r.jsx)(t.default,{className:(0,h.cn)("h-4 w-4 group-hover:text-components-button-secondary-accent-text",I?"text-components-button-secondary-accent-text":"text-components-button-ghost-text")})})})]}),(0,r.jsx)(d.PortalToFollowElemContent,{className:"z-[12]",children:(0,r.jsxs)("div",{className:"ml-2 flex w-[240px] flex-col overflow-y-auto rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg shadow-xl",style:{maxHeight:"calc(2 / 3 * 100vh)"},children:[(0,r.jsxs)("div",{className:"sticky top-0 flex items-center justify-between bg-components-panel-bg px-4 pt-3 text-base font-semibold text-text-primary",children:[(0,r.jsx)("div",{className:"grow",children:_("common.runHistory",{ns:"workflow"})}),(0,r.jsx)("div",{className:"flex h-6 w-6 shrink-0 cursor-pointer items-center justify-center",onClick:()=>{b?.(),T(!1)},children:(0,r.jsx)(a.RiCloseLine,{className:"h-4 w-4 text-text-tertiary"})})]}),O&&(0,r.jsx)("div",{className:"flex h-10 items-center justify-center",children:(0,r.jsx)(s.default,{})}),!O&&(0,r.jsxs)("div",{className:"p-2",children:[!A?.data.length&&(0,r.jsxs)("div",{className:"py-12",children:[(0,r.jsx)(i.default,{className:"mx-auto mb-2 h-8 w-8 text-text-quaternary"}),(0,r.jsx)("div",{className:"text-center text-[13px] text-text-quaternary",children:_("common.notRunning",{ns:"workflow"})})]}),A?.data.map(e=>(0,r.jsxs)("div",{className:(0,h.cn)("mb-0.5 flex cursor-pointer rounded-lg px-2 py-[7px] hover:bg-state-base-hover",e.id===P?.id&&"bg-state-accent-hover hover:bg-state-accent-hover"),onClick:()=>{E.setState({historyWorkflowData:e,showInputsPanel:!1,showEnvPanel:!1}),F(),j(),T(!1),W(),D(),M(x.ControlMode.Hand)},children:[!N&&e.status===x.WorkflowRunningStatus.Stopped&&(0,r.jsx)(l.AlertTriangle,{className:"mr-1.5 mt-0.5 h-3.5 w-3.5 text-[#F79009]"}),!N&&e.status===x.WorkflowRunningStatus.Failed&&(0,r.jsx)(a.RiErrorWarningLine,{className:"mr-1.5 mt-0.5 h-3.5 w-3.5 text-[#F04438]"}),!N&&e.status===x.WorkflowRunningStatus.Succeeded&&(0,r.jsx)(a.RiCheckboxCircleLine,{className:"mr-1.5 mt-0.5 h-3.5 w-3.5 text-[#12B76A]"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:(0,h.cn)("flex items-center text-[13px] font-medium leading-[18px] text-text-primary",e.id===P?.id&&"text-text-accent"),children:`Test ${N?"Chat":"Run"}${(0,v.formatWorkflowRunIdentifier)(e.finished_at)}`}),(0,r.jsxs)("div",{className:"flex items-center text-xs leading-[18px] text-text-tertiary",children:[e.created_by_account?.name," ","·",R(1e3*(e.finished_at||e.created_at))]})]})]},e.id))]})]})})]})});e.s(["default",0,C],347229)}]);