(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,51920,e=>{"use strict";var t=e.i(563199),s=e.i(268255);e.i(152567);var a=e.i(408767),n=e.i(246913),r=e.i(766182),o=e.i(261484),l=e.i(182368),i=e.i(815488),p=e.i(595009),c=e.i(293792),d=e.i(201656),u=e.i(787586),m=e.i(837699),x=e.i(38532),h=e.i(233697),g=e.i(326531),f=e.i(45284),y=e.i(291631),b=e.i(207853),v=e.i(860053),j=e.i(364203),C=e.i(198269),w=e.i(925521),N=e.i(711536),A=e.i(494268),k=e.i(547105),S=e.i(652669);let E=()=>{let e=(0,g.useRouter)(),{t:n}=(0,a.useTranslation)(),[r,o]=(0,s.useState)(!0),l=(()=>{let{t:e}=(0,a.useTranslation)(),[t,n]=(0,s.useState)(null),r=(0,g.useSearchParams)(),o=r.get("provider_name"),l=r.get("payment_result");return(0,s.useEffect)(()=>{"anthropic"===o&&("succeeded"===l||"cancelled"===l)&&n({type:"succeeded"===l?"info":"warning",title:"succeeded"===l?e("actionMsg.paySucceeded",{ns:"common"}):e("actionMsg.payCancelled",{ns:"common"})})},[o,l,e]),t})(),i=(()=>{let e=(0,g.useRouter)(),[t,a]=(0,s.useState)(null),[n,r]=(0,s.useState)(!1),o=(0,g.useSearchParams)(),l=o.get("type"),i=o.get("code"),p=o.get("error"),{data:c}=(0,S.useNotionBinding)(i,n);return(0,s.useEffect)(()=>{c&&e.replace("/")},[c,e]),(0,s.useEffect)(()=>{"notion"===l&&(p?a({type:"warning",title:p}):i&&r(!0))},[l,i,p]),t})(),p=(()=>{let{t:e}=(0,a.useTranslation)(),[t,n]=(0,s.useState)(null),r=(0,g.useSearchParams)(),o=r.get("payment_type"),l=r.get("payment_result");return(0,s.useEffect)(()=>{"billing"===o&&("succeeded"===l||"cancelled"===l)&&n({type:"succeeded"===l?"info":"warning",title:"succeeded"===l?e("actionMsg.paySucceeded",{ns:"common"}):e("actionMsg.payCancelled",{ns:"common"})})},[o,l,e]),t})(),c=(0,s.useCallback)(()=>{o(!1),e.replace("/")},[e]),d=l||i||p;return d&&r?(0,t.jsx)(k.default,{isShow:!0,onCancel:c,onConfirm:c,showCancel:!1,type:"info"===d.type?"info":"warning",title:d.title,content:d.desc||"",confirmText:"info"===d.type&&n("operation.ok",{ns:"common"})||""}):null};var _=e.i(632815),D=e.i(648404),M=e.i(935139),I=e.i(339548),T=e.i(446717),L=e.i(257899),R=e.i(757198),F=e.i(964596),P=e.i(747271),B=e.i(137667),O=e.i(421001),G=e.i(56971),H=e.i(142410),$=e.i(752901),U=e.i(927897),W=e.i(972282),q=e.i(141696),z=e.i(586871),K=e.i(618403),Y=e.i(167574),V=e.i(168014);let Q=(0,h.default)(()=>e.A(977869),{loadableGenerated:{modules:[23120]},ssr:!1}),X=(0,h.default)(()=>e.A(274156),{loadableGenerated:{modules:[823278]},ssr:!1}),Z=(0,h.default)(()=>e.A(778712),{loadableGenerated:{modules:[339556]},ssr:!1}),J=(0,h.default)(()=>e.A(623391),{loadableGenerated:{modules:[920226]},ssr:!1}),ee=(0,h.default)(()=>e.A(606117),{loadableGenerated:{modules:[356881]},ssr:!1}),et=(0,h.default)(()=>e.A(675420),{loadableGenerated:{modules:[351332]},ssr:!1}),es=s.memo(e=>{let{app:n,onRefresh:r}=e,{t:o}=(0,a.useTranslation)(),{notify:l}=(0,I.useContext)(B.ToastContext),i=(0,A.useGlobalPublicStore)(e=>e.systemFeatures),{isCurrentWorkspaceEditor:c}=(0,N.useAppContext)(),{onPlanInfoChanged:d}=(0,G.useProviderContext)(),{push:u}=(0,g.useRouter)(),x=(0,H.useAsyncWindowOpen)(),[h,f]=(0,s.useState)(!1),[y,b]=(0,s.useState)(!1),[v,j]=(0,s.useState)(!1),[C,k]=(0,s.useState)(!1),[S,E]=(0,s.useState)(!1),[_,es]=(0,s.useState)([]),ea=(0,s.useCallback)(async()=>{try{await (0,W.deleteApp)(n.id),l({type:"success",message:o("appDeleted",{ns:"app"})}),r&&r(),d()}catch(e){l({type:"error",message:`${o("appDeleteFailed",{ns:"app"})}${"message"in e?`: ${e.message}`:""}`})}k(!1)},[n.id,l,d,r,o]),en=(0,s.useCallback)(async e=>{let{name:t,icon_type:s,icon:a,icon_background:i,description:p,use_icon_as_answer_icon:c,max_active_requests:d}=e;try{await (0,W.updateAppInfo)({appID:n.id,name:t,icon_type:s,icon:a,icon_background:i,description:p,use_icon_as_answer_icon:c,max_active_requests:d}),f(!1),l({type:"success",message:o("editDone",{ns:"app"})}),r&&r()}catch(e){l({type:"error",message:e.message||o("editFailed",{ns:"app"})})}},[n.id,l,r,o]),er=async e=>{let{name:t,icon_type:s,icon:a,icon_background:i}=e;try{let e=await (0,W.copyApp)({appID:n.id,name:t,icon_type:s,icon:a,icon_background:i,mode:n.mode});b(!1),l({type:"success",message:o("newApp.appCreated",{ns:"app"})}),localStorage.setItem(w.NEED_REFRESH_APP_LIST_KEY,"1"),r&&r(),d(),(0,z.getRedirection)(c,e,u)}catch{l({type:"error",message:o("newApp.appCreateFailed",{ns:"app"})})}},eo=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let{data:t}=await (0,W.exportAppConfig)({appID:n.id,include:e}),s=new Blob([t],{type:"application/yaml"});(0,K.downloadBlob)({data:s,fileName:`${n.name}.yml`})}catch{l({type:"error",message:o("exportFailed",{ns:"app"})})}},el=async()=>{if(n.mode!==D.AppModeEnum.WORKFLOW&&n.mode!==D.AppModeEnum.ADVANCED_CHAT)return void eo();try{let e=((await (0,q.fetchWorkflowDraft)(`/apps/${n.id}/workflows/draft`)).environment_variables||[]).filter(e=>"secret"===e.value_type);if(0===e.length)return void eo();es(e)}catch{l({type:"error",message:o("exportFailed",{ns:"app"})})}},ei=(0,s.useCallback)(()=>{r&&r(),E(!1)},[r,E]),[ep,ec]=(0,s.useState)(n.tags);(0,s.useEffect)(()=>{ec(n.tags)},[n.tags]);let ed=(0,s.useMemo)(()=>{let e=(0,Y.formatTime)({date:1e3*(n.updated_at||n.created_at),dateFormat:`${o("segment.dateTimeFormat",{ns:"datasetDocuments"})}`});return`${o("segment.editedAt",{ns:"datasetDocuments"})} ${e}`},[n.updated_at,n.created_at,o]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{onClick:e=>{e.preventDefault(),(0,z.getRedirection)(c,n,u)},className:"group relative col-span-1 inline-flex h-[160px] cursor-pointer flex-col rounded-xl border-[1px] border-solid border-components-card-border bg-components-card-bg shadow-sm transition-all duration-200 ease-in-out hover:shadow-lg",children:[(0,t.jsxs)("div",{className:"flex h-[66px] shrink-0 grow-0 items-center gap-3 px-[14px] pb-3 pt-[14px]",children:[(0,t.jsxs)("div",{className:"relative shrink-0",children:[(0,t.jsx)(L.default,{size:"large",iconType:n.icon_type,icon:n.icon,background:n.icon_background,imageUrl:n.icon_url}),(0,t.jsx)(T.AppTypeIcon,{type:n.mode,wrapperClassName:"absolute -bottom-0.5 -right-0.5 w-4 h-4 shadow-sm",className:"h-3 w-3"})]}),(0,t.jsxs)("div",{className:"w-0 grow py-[1px]",children:[(0,t.jsx)("div",{className:"flex items-center text-sm font-semibold leading-5 text-text-secondary",children:(0,t.jsx)("div",{className:"truncate",title:n.name,children:n.name})}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-[10px] font-medium leading-[18px] text-text-tertiary",children:[(0,t.jsx)("div",{className:"truncate",title:n.author_name,children:n.author_name}),(0,t.jsx)("div",{children:"Â·"}),(0,t.jsx)("div",{className:"truncate",title:ed,children:ed})]})]}),(0,t.jsxs)("div",{className:"flex h-5 w-5 shrink-0 items-center justify-center",children:[n.access_mode===$.AccessMode.PUBLIC&&(0,t.jsx)(O.default,{asChild:!1,popupContent:o("accessItemsDescription.anyone",{ns:"app"}),children:(0,t.jsx)(m.RiGlobalLine,{className:"h-4 w-4 text-text-quaternary"})}),n.access_mode===$.AccessMode.SPECIFIC_GROUPS_MEMBERS&&(0,t.jsx)(O.default,{asChild:!1,popupContent:o("accessItemsDescription.specific",{ns:"app"}),children:(0,t.jsx)(m.RiLockLine,{className:"h-4 w-4 text-text-quaternary"})}),n.access_mode===$.AccessMode.ORGANIZATION&&(0,t.jsx)(O.default,{asChild:!1,popupContent:o("accessItemsDescription.organization",{ns:"app"}),children:(0,t.jsx)(m.RiBuildingLine,{className:"h-4 w-4 text-text-quaternary"})}),n.access_mode===$.AccessMode.EXTERNAL_MEMBERS&&(0,t.jsx)(O.default,{asChild:!1,popupContent:o("accessItemsDescription.external",{ns:"app"}),children:(0,t.jsx)(m.RiVerifiedBadgeLine,{className:"h-4 w-4 text-text-quaternary"})})]})]}),(0,t.jsx)("div",{className:"title-wrapper h-[90px] px-[14px] text-xs leading-normal text-text-tertiary",children:(0,t.jsx)("div",{className:"line-clamp-2",title:n.description,children:n.description})}),(0,t.jsx)("div",{className:"absolute bottom-1 left-0 right-0 flex h-[42px] shrink-0 items-center pb-[6px] pl-[14px] pr-[6px] pt-1",children:c&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:(0,M.cn)("flex w-0 grow items-center gap-1"),onClick:e=>{e.stopPropagation(),e.preventDefault()},children:(0,t.jsx)("div",{className:"mr-[41px] w-full grow group-hover:!mr-0",children:(0,t.jsx)(P.default,{position:"bl",type:"app",targetID:n.id,value:ep.map(e=>e.id),selectedTags:ep,onCacheUpdate:ec,onChange:r})})}),(0,t.jsx)("div",{className:"mx-1 !hidden h-[14px] w-[1px] shrink-0 bg-divider-regular group-hover:!flex"}),(0,t.jsx)("div",{className:"!hidden shrink-0 group-hover:!flex",children:(0,t.jsx)(F.default,{htmlContent:(0,t.jsx)(e=>{let{data:s,isLoading:a}=(0,U.useGetUserCanAccessApp)({appId:n?.id,enabled:!!e?.open&&i.webapp_auth.enabled}),r=async()=>{e.onClose?.()},l=async t=>{t.stopPropagation(),e.onClick?.(),t.preventDefault(),f(!0)},d=async t=>{t.stopPropagation(),e.onClick?.(),t.preventDefault(),b(!0)},u=async t=>{t.stopPropagation(),e.onClick?.(),t.preventDefault(),el()},m=async t=>{t.stopPropagation(),e.onClick?.(),t.preventDefault(),j(!0)},h=async t=>{t.stopPropagation(),e.onClick?.(),t.preventDefault(),k(!0)},g=async t=>{t.stopPropagation(),e.onClick?.(),t.preventDefault(),E(!0)},y=async t=>{t.stopPropagation(),e.onClick?.(),t.preventDefault();try{await x(async()=>{let{installed_apps:e}=await (0,p.fetchInstalledAppList)(n.id)||{};if(e?.length>0)return`${V.basePath}/explore/installed/${e[0].id}`;throw Error("No app found in Explore")},{onError:e=>{B.default.notify({type:"error",message:`${e.message||e}`})}})}catch(e){B.default.notify({type:"error",message:`${e.message||e}`})}};return(0,t.jsxs)("div",{className:"relative flex w-full flex-col py-1",onMouseLeave:r,children:[(0,t.jsx)("button",{type:"button",className:"mx-1 flex h-8 cursor-pointer items-center gap-2 rounded-lg px-3 hover:bg-state-base-hover",onClick:l,children:(0,t.jsx)("span",{className:"system-sm-regular text-text-secondary",children:o("editApp",{ns:"app"})})}),(0,t.jsx)(R.default,{className:"my-1"}),(0,t.jsx)("button",{type:"button",className:"mx-1 flex h-8 cursor-pointer items-center gap-2 rounded-lg px-3 hover:bg-state-base-hover",onClick:d,children:(0,t.jsx)("span",{className:"system-sm-regular text-text-secondary",children:o("duplicate",{ns:"app"})})}),(0,t.jsx)("button",{type:"button",className:"mx-1 flex h-8 cursor-pointer items-center gap-2 rounded-lg px-3 hover:bg-state-base-hover",onClick:u,children:(0,t.jsx)("span",{className:"system-sm-regular text-text-secondary",children:o("export",{ns:"app"})})}),(n.mode===D.AppModeEnum.COMPLETION||n.mode===D.AppModeEnum.CHAT)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(R.default,{className:"my-1"}),(0,t.jsx)("button",{type:"button",className:"mx-1 flex h-8 cursor-pointer items-center rounded-lg px-3 hover:bg-state-base-hover",onClick:m,children:(0,t.jsx)("span",{className:"text-sm leading-5 text-text-secondary",children:o("switch",{ns:"app"})})})]}),!n.has_draft_trigger&&(i.webapp_auth.enabled?!(a||!s?.result)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(R.default,{className:"my-1"}),(0,t.jsx)("button",{type:"button",className:"mx-1 flex h-8 cursor-pointer items-center gap-2 rounded-lg px-3 hover:bg-state-base-hover",onClick:y,children:(0,t.jsx)("span",{className:"system-sm-regular text-text-secondary",children:o("openInExplore",{ns:"app"})})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(R.default,{className:"my-1"}),(0,t.jsx)("button",{type:"button",className:"mx-1 flex h-8 cursor-pointer items-center gap-2 rounded-lg px-3 hover:bg-state-base-hover",onClick:y,children:(0,t.jsx)("span",{className:"system-sm-regular text-text-secondary",children:o("openInExplore",{ns:"app"})})})]})),(0,t.jsx)(R.default,{className:"my-1"}),i.webapp_auth.enabled&&c&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{type:"button",className:"mx-1 flex h-8 cursor-pointer items-center rounded-lg px-3 hover:bg-state-base-hover",onClick:g,children:(0,t.jsx)("span",{className:"text-sm leading-5 text-text-secondary",children:o("accessControl",{ns:"app"})})}),(0,t.jsx)(R.default,{className:"my-1"})]}),(0,t.jsx)("button",{type:"button",className:"group mx-1 flex h-8 cursor-pointer items-center gap-2 rounded-lg px-3 py-[6px] hover:bg-state-destructive-hover",onClick:h,children:(0,t.jsx)("span",{className:"system-sm-regular text-text-secondary group-hover:text-text-destructive",children:o("operation.delete",{ns:"common"})})})]})},{}),position:"br",trigger:"click",btnElement:(0,t.jsx)("div",{className:"flex h-8 w-8 cursor-pointer items-center justify-center rounded-md",children:(0,t.jsx)(m.RiMoreFill,{className:"h-4 w-4 text-text-tertiary"})}),btnClassName:e=>(0,M.cn)(e?"!bg-state-base-hover !shadow-none":"!bg-transparent","h-8 w-8 rounded-md border-none !p-2 hover:!bg-state-base-hover"),popupClassName:n.mode===D.AppModeEnum.COMPLETION||n.mode===D.AppModeEnum.CHAT?"!w-[256px] translate-x-[-224px]":"!w-[216px] translate-x-[-128px]",className:"!z-20 h-fit"})})]})})]}),h&&(0,t.jsx)(Q,{isEditModal:!0,appName:n.name,appIconType:n.icon_type,appIcon:n.icon,appIconBackground:n.icon_background,appIconUrl:n.icon_url,appDescription:n.description,appMode:n.mode,appUseIconAsAnswerIcon:n.use_icon_as_answer_icon,max_active_requests:n.max_active_requests??null,show:h,onConfirm:en,onHide:()=>f(!1)}),y&&(0,t.jsx)(X,{appName:n.name,icon_type:n.icon_type,icon:n.icon,icon_background:n.icon_background,icon_url:n.icon_url,show:y,onConfirm:er,onHide:()=>b(!1)}),v&&(0,t.jsx)(Z,{show:v,appDetail:n,onClose:()=>j(!1),onSuccess:()=>{r&&r(),j(!1)}}),C&&(0,t.jsx)(J,{title:o("deleteAppConfirmTitle",{ns:"app"}),content:o("deleteAppConfirmContent",{ns:"app"}),isShow:C,onConfirm:ea,onCancel:()=>k(!1)}),_.length>0&&(0,t.jsx)(ee,{envList:_,onConfirm:eo,onClose:()=>es([])}),S&&(0,t.jsx)(et,{app:n,onConfirm:ei,onClose:()=>E(!1)})]})});var ea=e.i(465497);let en=s.memo(e=>{let{count:s=6}=e;return(0,t.jsx)(t.Fragment,{children:Array.from({length:s}).map((e,s)=>(0,t.jsx)("div",{className:"h-[160px] rounded-xl border-[0.5px] border-components-card-border bg-components-card-bg p-4",children:(0,t.jsxs)(ea.SkeletonContainer,{className:"h-full",children:[(0,t.jsxs)(ea.SkeletonRow,{children:[(0,t.jsx)(ea.SkeletonRectangle,{className:"h-10 w-10 animate-pulse rounded-lg"}),(0,t.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,t.jsx)(ea.SkeletonRectangle,{className:"h-4 w-2/3 animate-pulse"}),(0,t.jsx)(ea.SkeletonRectangle,{className:"h-3 w-1/3 animate-pulse"})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex flex-col gap-2",children:[(0,t.jsx)(ea.SkeletonRectangle,{className:"h-3 w-full animate-pulse"}),(0,t.jsx)(ea.SkeletonRectangle,{className:"h-3 w-4/5 animate-pulse"})]})]})},s))})});en.displayName="AppCardSkeleton";let er=s.memo(()=>{let e=Array.from({length:36});return(0,t.jsx)(t.Fragment,{children:e.map((e,s)=>(0,t.jsx)("div",{className:"inline-flex h-[160px] rounded-xl bg-background-default-lighter"},s))})}),eo=s.memo(()=>{let{t:e}=(0,a.useTranslation)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(er,{}),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 z-20 flex items-center justify-center bg-gradient-to-t from-background-body to-transparent",children:(0,t.jsx)("span",{className:"system-md-medium text-text-tertiary",children:e("newApp.noAppsFound",{ns:"app"})})})]})});var el=e.i(554327);let ei=s.memo(e=>{let{href:s,children:a}=e;return(0,t.jsx)(el.default,{className:"flex h-8 w-8 cursor-pointer items-center justify-center transition-opacity duration-200 ease-in-out hover:opacity-80",target:"_blank",rel:"noopener noreferrer",href:s,children:a})}),ep=s.memo(()=>{let{t:e}=(0,a.useTranslation)();return(0,t.jsxs)("footer",{className:"relative shrink-0 grow-0 px-12 py-2",children:[(0,t.jsx)("h3",{className:"text-gradient text-xl font-semibold leading-tight",children:e("join",{ns:"app"})}),(0,t.jsx)("p",{className:"system-sm-regular mt-1 text-text-tertiary",children:e("communityIntro",{ns:"app"})}),(0,t.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,t.jsx)(ei,{href:"https://github.com/langgenius/dify",children:(0,t.jsx)(m.RiGithubFill,{className:"h-5 w-5 text-text-tertiary"})}),(0,t.jsx)(ei,{href:"https://discord.gg/FngNHpbcY7",children:(0,t.jsx)(m.RiDiscordFill,{className:"h-5 w-5 text-text-tertiary"})}),(0,t.jsx)(ei,{href:"https://forum.dify.ai",children:(0,t.jsx)(m.RiDiscussLine,{className:"h-5 w-5 text-text-tertiary"})})]})]})}),ec=function(){let[e,t]=(0,f.useQueryStates)({tagIDs:(0,f.parseAsArrayOf)(f.parseAsString,";"),keywords:f.parseAsString,isCreatedByMe:f.parseAsBoolean},{history:"push"}),a=(0,s.useMemo)(()=>({tagIDs:e.tagIDs??void 0,keywords:e.keywords||void 0,isCreatedByMe:e.isCreatedByMe??!1}),[e.isCreatedByMe,e.keywords,e.tagIDs]),n=(0,s.useCallback)(e=>{let s=e=>{let t={};return"tagIDs"in e&&(t.tagIDs=e.tagIDs&&e.tagIDs.length>0?e.tagIDs:null),"keywords"in e&&(t.keywords=e.keywords?e.keywords:null),"isCreatedByMe"in e&&(t.isCreatedByMe=!!e.isCreatedByMe||null),t};"function"==typeof e?t(t=>s(e({tagIDs:t.tagIDs??void 0,keywords:t.keywords||void 0,isCreatedByMe:t.isCreatedByMe??!1}))):t(s(e))},[t]);return(0,s.useMemo)(()=>({query:a,setQuery:n}),[a,n])};var ed=e.i(725001);e.i(21511);var eu=e.i(823341),em=e.i(14383),ex=e.i(702015);let eh=(0,h.default)(()=>e.A(181127),{loadableGenerated:{modules:[239024]},ssr:!1}),eg=(0,h.default)(()=>e.A(219345),{loadableGenerated:{modules:[457094]},ssr:!1}),ef=(0,h.default)(()=>e.A(622467),{loadableGenerated:{modules:[512728]},ssr:!1}),ey=e=>{let{ref:n,className:o,isLoading:l=!1,onSuccess:i,selectedAppType:p}=e,{t:c}=(0,a.useTranslation)(),{onPlanInfoChanged:d}=(0,G.useProviderContext)(),u=(0,g.useSearchParams)(),{replace:m}=(0,g.useRouter)(),x=u.get("remoteInstallUrl")||void 0,[h,f]=(0,s.useState)(!1),[y,b]=(0,s.useState)(!1),[v,j]=(0,s.useState)(!!x),C=(0,s.useMemo)(()=>{if(x)return ed.CreateFromDSLModalTab.FROM_URL},[x]),w=(0,I.useContextSelector)(r.default,e=>e.controlHideCreateFromTemplatePanel);return(0,s.useEffect)(()=>{w>0&&f(!1)},[w]),(0,t.jsxs)("div",{ref:n,className:(0,M.cn)("relative col-span-1 inline-flex h-[160px] flex-col justify-between rounded-xl border-[0.5px] border-components-card-border bg-components-card-bg transition-opacity",l&&"pointer-events-none opacity-50",o),children:[(0,t.jsxs)("div",{className:"grow rounded-t-xl p-2",children:[(0,t.jsx)("div",{className:"px-6 pb-1 pt-2 text-xs font-medium leading-[18px] text-text-tertiary",children:c("createApp",{ns:"app"})}),(0,t.jsxs)("button",{type:"button",className:"mb-1 flex w-full cursor-pointer items-center rounded-lg px-6 py-[7px] text-[13px] font-medium leading-[18px] text-text-tertiary hover:bg-state-base-hover hover:text-text-secondary",onClick:()=>b(!0),children:[(0,t.jsx)(em.FilePlus01,{className:"mr-2 h-4 w-4 shrink-0"}),c("newApp.startFromBlank",{ns:"app"})]}),(0,t.jsxs)("button",{type:"button",className:"flex w-full cursor-pointer items-center rounded-lg px-6 py-[7px] text-[13px] font-medium leading-[18px] text-text-tertiary hover:bg-state-base-hover hover:text-text-secondary",onClick:()=>f(!0),children:[(0,t.jsx)(ex.FilePlus02,{className:"mr-2 h-4 w-4 shrink-0"}),c("newApp.startFromTemplate",{ns:"app"})]}),(0,t.jsxs)("button",{type:"button",onClick:()=>j(!0),className:"flex w-full cursor-pointer items-center rounded-lg px-6 py-[7px] text-[13px] font-medium leading-[18px] text-text-tertiary hover:bg-state-base-hover hover:text-text-secondary",children:[(0,t.jsx)(eu.FileArrow01,{className:"mr-2 h-4 w-4 shrink-0"}),c("importDSL",{ns:"app"})]})]}),y&&(0,t.jsx)(eh,{show:y,onClose:()=>b(!1),onSuccess:()=>{d(),i&&i()},onCreateFromTemplate:()=>{f(!0),b(!1)},defaultAppMode:"all"!==p?p:void 0}),h&&(0,t.jsx)(eg,{show:h,onClose:()=>f(!1),onSuccess:()=>{d(),i&&i()},onCreateFromBlank:()=>{b(!0),f(!1)}}),v&&(0,t.jsx)(ef,{show:v,onClose:()=>{j(!1),x&&m("/")},activeTab:C,dslUrl:x,onSuccess:()=>{d(),i&&i()}})]})};ey.displayName="CreateAppCard";let eb=s.memo(ey);D.AppModeEnum.WORKFLOW,D.AppModeEnum.ADVANCED_CHAT,D.AppModeEnum.CHAT,D.AppModeEnum.AGENT_CHAT,D.AppModeEnum.COMPLETION;let ev=(0,h.default)(()=>e.A(64459),{loadableGenerated:{modules:[903565]},ssr:!1}),ej=(0,h.default)(()=>e.A(622467),{loadableGenerated:{modules:[512728]},ssr:!1}),eC=e=>{let{controlRefreshList:n=0}=e,{t:r}=(0,a.useTranslation)(),{systemFeatures:o}=(0,A.useGlobalPublicStore)(),l=(0,g.useRouter)(),{isCurrentWorkspaceEditor:i,isCurrentWorkspaceDatasetOperator:p,isLoadingCurrentWorkspace:c}=(0,N.useAppContext)(),d=(0,j.useStore)(e=>e.showTagManagementModal),[u,h]=(0,f.useQueryState)("category",f.parseAsString.withDefault("all").withOptions({history:"push"})),{query:{tagIDs:k=[],keywords:S="",isCreatedByMe:I=!1},setQuery:T}=ec(),[L,R]=(0,s.useState)(I),[F,P]=(0,s.useState)(k),[B,O]=(0,s.useState)(S),G=(0,s.useRef)(null),H=(0,s.useRef)(null),[$,U]=(0,s.useState)(!1),[W,q]=(0,s.useState)(),z=(0,s.useCallback)(e=>{T(t=>({...t,keywords:e}))},[T]),K=(0,s.useCallback)(e=>{T(t=>({...t,tagIDs:e}))},[T]),{dragging:Y}=(e=>{let{onDSLFileDropped:t,containerRef:a,enabled:n=!0}=e,[r,o]=(0,s.useState)(!1),l=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer?.types.includes("Files")&&o(!0)},i=e=>{e.preventDefault(),e.stopPropagation()},p=e=>{e.preventDefault(),e.stopPropagation(),null!==e.relatedTarget&&a.current?.contains(e.relatedTarget)||o(!1)},c=e=>{if(e.preventDefault(),e.stopPropagation(),o(!1),!e.dataTransfer)return;let s=Array.from(e.dataTransfer.files);if(0===s.length)return;let a=s[0];(a.name.toLowerCase().endsWith(".yaml")||a.name.toLowerCase().endsWith(".yml"))&&t(a)};return(0,s.useEffect)(()=>{if(!n)return;let e=a.current;return e&&(e.addEventListener("dragenter",l),e.addEventListener("dragover",i),e.addEventListener("dragleave",p),e.addEventListener("drop",c)),()=>{e&&(e.removeEventListener("dragenter",l),e.removeEventListener("dragover",i),e.removeEventListener("dragleave",p),e.removeEventListener("drop",c))}},[a,n]),{dragging:!!n&&r}})({onDSLFileDropped:(0,s.useCallback)(e=>{q(e),U(!0)},[]),containerRef:H,enabled:i}),V={page:1,limit:30,name:B,tag_ids:k,is_created_by_me:L,..."all"!==u?{mode:u}:{}},{data:Q,isLoading:X,isFetching:Z,isFetchingNextPage:J,fetchNextPage:ee,hasNextPage:et,error:ea,refetch:er}=(0,_.useInfiniteAppList)(V,{enabled:!p});(0,s.useEffect)(()=>{n>0&&er()},[n]);let el=(0,s.useRef)(null),ei=[{value:"all",text:r("types.all",{ns:"app"}),icon:(0,t.jsx)(m.RiApps2Line,{className:"mr-1 h-[14px] w-[14px]"})},{value:D.AppModeEnum.WORKFLOW,text:r("types.workflow",{ns:"app"}),icon:(0,t.jsx)(m.RiExchange2Line,{className:"mr-1 h-[14px] w-[14px]"})},{value:D.AppModeEnum.ADVANCED_CHAT,text:r("types.advanced",{ns:"app"}),icon:(0,t.jsx)(m.RiMessage3Line,{className:"mr-1 h-[14px] w-[14px]"})},{value:D.AppModeEnum.CHAT,text:r("types.chatbot",{ns:"app"}),icon:(0,t.jsx)(m.RiMessage3Line,{className:"mr-1 h-[14px] w-[14px]"})},{value:D.AppModeEnum.AGENT_CHAT,text:r("types.agent",{ns:"app"}),icon:(0,t.jsx)(m.RiRobot3Line,{className:"mr-1 h-[14px] w-[14px]"})},{value:D.AppModeEnum.COMPLETION,text:r("types.completion",{ns:"app"}),icon:(0,t.jsx)(m.RiFile4Line,{className:"mr-1 h-[14px] w-[14px]"})}];(0,s.useEffect)(()=>{"1"===localStorage.getItem(w.NEED_REFRESH_APP_LIST_KEY)&&(localStorage.removeItem(w.NEED_REFRESH_APP_LIST_KEY),er())},[er]),(0,s.useEffect)(()=>{if(p)return l.replace("/datasets")},[l,p]),(0,s.useEffect)(()=>{let e;if(p)return;let t=et??!0;if(ea){e&&e.disconnect();return}if(el.current&&H.current){let s=Math.max(100,Math.min(.2*H.current.clientHeight,200));(e=new IntersectionObserver(e=>{!e[0].isIntersecting||X||J||ea||!t||ee()},{root:H.current,rootMargin:`${s}px`,threshold:.1})).observe(el.current)}return()=>e?.disconnect()},[X,J,ee,ea,et,p]);let{run:ed}=(0,x.useDebounceFn)(()=>{O(S)},{wait:500}),eu=e=>{z(e),ed()},{run:em}=(0,x.useDebounceFn)(()=>{K(F)},{wait:500}),ex=(0,s.useCallback)(()=>{let e=!L;R(e),T(t=>({...t,isCreatedByMe:e}))},[L,T]),eh=Q?.pages??[],eg=(eh[0]?.total??0)>0,ef=X||Z&&0===eh.length;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{ref:H,className:"relative flex h-0 shrink-0 grow flex-col overflow-y-auto bg-background-body",children:[Y&&(0,t.jsx)("div",{className:"absolute inset-0 z-50 m-0.5 rounded-2xl border-2 border-dashed border-components-dropzone-border-accent bg-[rgba(21,90,239,0.14)] p-2"}),(0,t.jsxs)("div",{className:"sticky top-0 z-10 flex flex-wrap items-center justify-between gap-y-2 bg-background-body px-12 pb-5 pt-7",children:[(0,t.jsx)(b.default,{value:u,onChange:h,options:ei}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(C.default,{className:"mr-2",label:r("showMyCreatedAppsOnly",{ns:"app"}),isChecked:L,onChange:ex}),(0,t.jsx)(v.default,{type:"app",value:F,onChange:e=>{P(e),em()}}),(0,t.jsx)(y.default,{showLeftIcon:!0,showClearIcon:!0,wrapperClassName:"w-[200px]",value:S,onChange:e=>eu(e.target.value),onClear:()=>eu("")})]})]}),(0,t.jsxs)("div",{className:(0,M.cn)("relative grid grow grid-cols-1 content-start gap-4 px-12 pt-2 sm:grid-cols-1 md:grid-cols-2 xl:grid-cols-4 2xl:grid-cols-5 2k:grid-cols-6",!eg&&"overflow-hidden"),children:[(i||c)&&(0,t.jsx)(eb,{ref:G,isLoading:c,onSuccess:er,selectedAppType:u,className:(0,M.cn)(!eg&&"z-10")}),ef?(0,t.jsx)(en,{count:6}):eg?eh.flatMap(e=>{let{data:t}=e;return t}).map(e=>(0,t.jsx)(es,{app:e,onRefresh:er},e.id)):(0,t.jsx)(eo,{}),J&&(0,t.jsx)(en,{count:3})]}),i&&(0,t.jsxs)("div",{className:`flex items-center justify-center gap-2 py-4 ${Y?"text-text-accent":"text-text-quaternary"}`,role:"region","aria-label":r("newApp.dropDSLToCreateApp",{ns:"app"}),children:[(0,t.jsx)(m.RiDragDropLine,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"system-xs-regular",children:r("newApp.dropDSLToCreateApp",{ns:"app"})})]}),!o.branding.enabled&&(0,t.jsx)(ep,{}),(0,t.jsx)(E,{}),(0,t.jsx)("div",{ref:el,className:"h-0",children:" "}),d&&(0,t.jsx)(ev,{type:"app",show:d})]}),$&&(0,t.jsx)(ej,{show:$,onClose:()=>{U(!1),q(void 0)},onSuccess:()=>{U(!1),q(void 0),er()},droppedFile:W})]})};e.s(["default",0,()=>{let{t:e}=(0,a.useTranslation)();(0,o.default)(e("menus.apps",{ns:"common"})),(0,n.useEducationInit)();let[m,x]=(0,s.useState)(void 0),h=m?.app,[g,f]=(0,s.useState)(!1),y=(0,s.useCallback)(()=>{f(!1)},[]),[b,v]=(0,s.useState)(!1),j=(0,s.useCallback)(()=>{v(!0)},[]),[C,w]=(0,s.useState)(0),[N,A]=(0,s.useState)(0),k=(0,s.useCallback)(()=>{w(e=>e+1),A(e=>e+1)},[]),[S,E]=(0,s.useState)(!1),{handleImportDSL:_,handleImportDSLConfirm:D,versions:M,isFetching:I}=(0,l.useImportDSL)(),T=(0,s.useCallback)(async()=>{await D({onSuccess:k})},[D,k]),L=async e=>{let{name:t,icon_type:s,icon:a,icon_background:n,description:r}=e;y();let{export_data:o}=await (0,p.fetchAppDetail)(h?.app.id),l={mode:i.DSLImportMode.YAML_CONTENT,yaml_content:o,name:t,icon_type:s,icon:a,icon_background:n,description:r};await _(l,{onSuccess:()=>{v(!1)},onPending:()=>{E(!0)}})};return(0,t.jsx)(r.default.Provider,{value:{currentApp:m,isShowTryAppPanel:g,setShowTryAppPanel:(e,t)=>{e?x(t):x(void 0),f(e)},controlHideCreateFromTemplatePanel:N},children:(0,t.jsxs)("div",{className:"relative flex h-0 shrink-0 grow flex-col overflow-y-auto bg-background-body",children:[(0,t.jsx)(eC,{controlRefreshList:C}),g&&(0,t.jsx)(u.default,{appId:m?.appId||"",app:m?.app,category:m?.app?.category,onClose:y,onCreate:j}),S&&(0,t.jsx)(c.default,{versions:M,onCancel:()=>E(!1),onConfirm:T,confirmDisabled:I}),b&&(0,t.jsx)(d.default,{appIconType:h?.app.icon_type||"emoji",appIcon:h?.app.icon||"",appIconBackground:h?.app.icon_background||"",appIconUrl:h?.app.icon_url,appName:h?.app.name||"",appDescription:h?.app.description||"",show:!0,onConfirm:L,confirmDisabled:I,onHide:()=>v(!1)})]})})}],51920)}]);