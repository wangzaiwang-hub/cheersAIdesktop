(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,237855,59101,773934,27808,33199,297162,e=>{"use strict";var t=e.i(377397),r=e.i(563199),l=e.i(837699),i=e.i(268255);e.i(152567);var o=e.i(408767),a=e.i(151094),s=e.i(648404),n=e.i(935139),c=e.i(391185);let u=/^(https?|ftp):\/\//;var d=e.i(471981),p=e.i(390622),m=e.i(124836),f=e.i(105845),g=e.i(326531),h=e.i(503144),x=e.i(137667),y=e.i(81828),b=e.i(128984),v=e.i(346563),w=e.i(639751);let j=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return(0,w.create)(r=>({files:e?[...e]:[],setFiles:e=>{r({files:e}),t?.(e)}}))},k=(0,i.createContext)(null);function C(e){let t=(0,i.useContext)(k);if(!t)throw Error("Missing FileContext.Provider in the tree");return(0,w.useStore)(t,e)}let N=()=>(0,i.useContext)(k),_=e=>{let{children:t,value:l,onChange:o}=e,a=(0,i.useRef)(void 0);return a.current||(a.current=j(l,o)),(0,i.useEffect)(()=>{!a.current||(0,v.isEqual)(l,a.current.getState().files)||a.current.setState({files:l?[...l]:[]})},[l]),(0,r.jsx)(k.Provider,{value:a.current,children:t})};e.s(["FileContextProvider",0,_,"useFileStore",0,N,"useStore",()=>C],59101);var T=e.i(223314);let F=e=>{let t=1024*Number(e?.image_file_size_limit)*1024||0xa00000,r=1024*Number(e?.file_size_limit)*1024||0xf00000,l=1024*Number(e?.audio_file_size_limit)*1024||0x3200000;return{imgSizeLimit:t,docSizeLimit:r,audioSizeLimit:l,videoSizeLimit:1024*Number(e?.video_file_size_limit)*1024||0x6400000,maxFileUploadLimit:Number(e?.workflow_file_upload_limit)||10}},L=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{t:r}=(0,o.useTranslation)(),{notify:l}=(0,x.useToastContext)(),a=N(),n=(0,g.useParams)(),{imgSizeLimit:c,docSizeLimit:u,audioSizeLimit:d,videoSizeLimit:v}=F(e.fileUploadConfig),w=(0,i.useCallback)((e,t)=>{switch(e){case p.SupportUploadFileTypes.image:if(t>c)return l({type:"error",message:r("fileUploader.uploadFromComputerLimit",{ns:"common",type:p.SupportUploadFileTypes.image,size:(0,b.formatFileSize)(c)})}),!1;return!0;case p.SupportUploadFileTypes.custom:case p.SupportUploadFileTypes.document:if(t>u)return l({type:"error",message:r("fileUploader.uploadFromComputerLimit",{ns:"common",type:p.SupportUploadFileTypes.document,size:(0,b.formatFileSize)(u)})}),!1;return!0;case p.SupportUploadFileTypes.audio:if(t>d)return l({type:"error",message:r("fileUploader.uploadFromComputerLimit",{ns:"common",type:p.SupportUploadFileTypes.audio,size:(0,b.formatFileSize)(d)})}),!1;return!0;case p.SupportUploadFileTypes.video:if(t>v)return l({type:"error",message:r("fileUploader.uploadFromComputerLimit",{ns:"common",type:p.SupportUploadFileTypes.video,size:(0,b.formatFileSize)(v)})}),!1;return!0;default:return!0}},[d,u,c,l,r,v]),j=(0,i.useCallback)(e=>{let{files:t,setFiles:r}=a.getState();r((0,f.produce)(t,t=>{t.push(e)}))},[a]),k=(0,i.useCallback)(e=>{let{files:t,setFiles:r}=a.getState();r((0,f.produce)(t,t=>{let r=t.findIndex(t=>t.id===e.id);r>-1&&(t[r]=e)}))},[a]),C=(0,i.useCallback)(e=>{let{files:t,setFiles:r}=a.getState();r(t.filter(t=>t.id!==e))},[a]),_=(0,i.useCallback)(e=>{let{files:t,setFiles:i}=a.getState(),o=t.findIndex(t=>t.id===e);if(o>-1){let e=t[o];i((0,f.produce)(t,e=>{e[o].progress=0})),(0,T.fileUpload)({file:e.originalFile,onProgressCallback:t=>{k({...e,progress:t})},onSuccessCallback:t=>{k({...e,uploadedId:t.id,progress:100})},onErrorCallback:t=>{l({type:"error",message:(0,T.getFileUploadErrorMessage)(t,r("fileUploader.uploadFromComputerUploadError",{ns:"common"}),r)}),k({...e,progress:-1})}},!!n.token)}},[a,l,r,k,n]),L=(0,i.useCallback)(e=>{let t=setInterval(()=>{let r=a.getState().files.find(t=>t.id===e);r&&r.progress<80&&r.progress>=0?k({...r,progress:r.progress+20}):clearTimeout(t)},200)},[a,k]),S=(0,i.useCallback)(t=>{let i=e.allowed_file_types,o={id:(0,h.v4)(),name:t,type:"",size:0,progress:0,transferMethod:s.TransferMethod.remote_url,supportFileType:"",url:t,isRemote:!0};j(o),L(o.id),(0,y.uploadRemoteFileInfo)(t,!!n.token).then(t=>{let a={...o,type:t.mime_type,size:t.size,progress:100,supportFileType:(0,T.getSupportFileType)(t.name,t.mime_type,i?.includes(p.SupportUploadFileTypes.custom)),uploadedId:t.id,url:t.url};(0,T.isAllowedFileExtension)(t.name,t.mime_type,e.allowed_file_types||[],e.allowed_file_extensions||[])||(l({type:"error",message:`${r("fileUploader.fileExtensionNotSupport",{ns:"common"})} ${a.type}`}),C(o.id)),w(a.supportFileType,a.size)?k(a):C(o.id)}).catch(()=>{l({type:"error",message:r("fileUploader.pasteFileLinkInvalid",{ns:"common"})}),C(o.id)})},[w,j,k,l,r,C,e?.allowed_file_types,e.allowed_file_extensions,L,n.token]),U=(0,i.useCallback)(m.noop,[]),R=(0,i.useCallback)(m.noop,[]),E=(0,i.useCallback)(()=>{let{setFiles:e}=a.getState();e([])},[a]),A=(0,i.useCallback)(i=>{if(!t&&!e.enabled)return void l({type:"error",message:r("fileUploader.uploadDisabled",{ns:"common"})});if(!(0,T.isAllowedFileExtension)(i.name,i.type,e.allowed_file_types||[],e.allowed_file_extensions||[]))return void l({type:"error",message:`${r("fileUploader.fileExtensionNotSupport",{ns:"common"})} ${i.type}`});let o=e.allowed_file_types;if(!w((0,T.getSupportFileType)(i.name,i.type,o?.includes(p.SupportUploadFileTypes.custom)),i.size))return;let a=new FileReader,c=i.type.startsWith("image");a.addEventListener("load",()=>{let e={id:(0,h.v4)(),name:i.name,type:i.type,size:i.size,progress:0,transferMethod:s.TransferMethod.local_file,supportFileType:(0,T.getSupportFileType)(i.name,i.type,o?.includes(p.SupportUploadFileTypes.custom)),originalFile:i,base64Url:c?a.result:""};j(e),(0,T.fileUpload)({file:e.originalFile,onProgressCallback:t=>{k({...e,progress:t})},onSuccessCallback:t=>{k({...e,uploadedId:t.id,progress:100})},onErrorCallback:t=>{l({type:"error",message:(0,T.getFileUploadErrorMessage)(t,r("fileUploader.uploadFromComputerUploadError",{ns:"common"}),r)}),k({...e,progress:-1})}},!!n.token)},!1),a.addEventListener("error",()=>{l({type:"error",message:r("fileUploader.uploadFromComputerReadError",{ns:"common"})})},!1),a.readAsDataURL(i)},[t,w,l,r,j,k,n.token,e?.allowed_file_types,e?.allowed_file_extensions,e?.enabled]),P=(0,i.useCallback)(e=>{let t=e.clipboardData?.files[0],r=e.clipboardData?.getData("text/plain");t&&!r&&(e.preventDefault(),A(t))},[A]),[z,M]=(0,i.useState)(!1),O=(0,i.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),M(!0)},[]),I=(0,i.useCallback)(e=>{e.preventDefault(),e.stopPropagation()},[]),D=(0,i.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),M(!1)},[]),$=(0,i.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),M(!1);let t=e.dataTransfer.files[0];t&&A(t)},[A]);return{handleAddFile:j,handleUpdateFile:k,handleRemoveFile:C,handleReUploadFile:_,handleLoadFileFromLink:S,handleLoadFileFromLinkSuccess:U,handleLoadFileFromLinkError:R,handleClearFiles:E,handleLocalFileUpload:A,handleClipboardPasteFile:P,isDragActive:z,handleDragFileEnter:O,handleDragFileOver:I,handleDragFileLeave:D,handleDropFile:$}};e.s(["useFile",0,L,"useFileSizeLimit",0,F],773934);let S=e=>{let{fileConfig:t}=e,l=C(e=>e.files),{handleLocalFileUpload:i}=L(t),o=t.allowed_file_types,a=(o?.includes(p.SupportUploadFileTypes.custom)?t.allowed_file_extensions||[]:(o?.map(e=>d.FILE_EXTS[e])||[]).flat().map(e=>`.${e}`)).join(",");return(0,r.jsx)("input",{className:"absolute inset-0 block w-full cursor-pointer text-[0] opacity-0 disabled:cursor-not-allowed",onClick:e=>e.target.value="",type:"file",onChange:e=>{let r=e.target.files;if(r)if(t.number_limits)for(let e=0;e<r.length;e++)e+1+l.length<=t.number_limits&&i(r[e]);else i(r[0])},accept:a,disabled:!!(t.number_limits&&l.length>=t?.number_limits),multiple:!!t.number_limits&&t.number_limits>1})},U=(0,i.memo)(e=>{let{showFromLink:t=!0,showFromLocal:s=!0,trigger:d,fileConfig:p}=e,{t:m}=(0,o.useTranslation)(),f=C(e=>e.files),[g,h]=(0,i.useState)(!1),[x,y]=(0,i.useState)(""),[b,v]=(0,i.useState)(!1),{handleLoadFileFromLink:w}=L(p),j=!!p.number_limits&&f.length>=p.number_limits;return(0,r.jsxs)(c.PortalToFollowElem,{placement:"top",offset:4,open:g,onOpenChange:h,children:[(0,r.jsx)(c.PortalToFollowElemTrigger,{onClick:()=>h(e=>!e),asChild:!0,children:d(g)}),(0,r.jsx)(c.PortalToFollowElemContent,{className:"z-[1001]",children:(0,r.jsxs)("div",{className:"w-[280px] rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur p-3 shadow-lg",children:[t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:(0,n.cn)("flex h-8 items-center rounded-lg border border-components-input-border-active bg-components-input-bg-active p-1 shadow-xs",b&&"border-components-input-border-destructive"),children:[(0,r.jsx)("input",{className:"system-sm-regular mr-0.5 block grow appearance-none bg-transparent px-1 outline-none",placeholder:m("fileUploader.pasteFileLinkInputPlaceholder",{ns:"common"})||"",value:x,onChange:e=>{v(!1),y(e.target.value.trim())},disabled:j}),(0,r.jsx)(a.default,{className:"shrink-0",size:"small",variant:"primary",disabled:!x||j,onClick:()=>{if(x){if(!u.test(x))return void v(!0);w(x),y("")}},children:m("operation.ok",{ns:"common"})})]}),b&&(0,r.jsx)("div",{className:"body-xs-regular mt-0.5 text-text-destructive",children:m("fileUploader.pasteFileLinkInvalid",{ns:"common"})})]}),t&&s&&(0,r.jsxs)("div",{className:"system-2xs-medium-uppercase flex h-7 items-center p-2 text-text-quaternary",children:[(0,r.jsx)("div",{className:"mr-2 h-px w-[93px] bg-gradient-to-l from-[rgba(16,24,40,0.08)]"}),"OR",(0,r.jsx)("div",{className:"ml-2 h-px w-[93px] bg-gradient-to-r from-[rgba(16,24,40,0.08)]"})]}),s&&(0,r.jsxs)(a.default,{className:"relative w-full",variant:"secondary-accent",disabled:j,children:[(0,r.jsx)(l.RiUploadCloud2Line,{className:"mr-1 h-4 w-4"}),m("fileUploader.uploadFromComputer",{ns:"common"}),(0,r.jsx)(S,{fileConfig:p})]})]})})]})});var R=e.i(387124);let E=e=>{let{isDisabled:t,fileConfig:c}=e,{t:u}=(0,o.useTranslation)(),d=C(e=>e.files),{handleRemoveFile:p,handleReUploadFile:m}=L(c),f=[{value:s.TransferMethod.local_file,label:u("fileUploader.uploadFromComputer",{ns:"common"}),icon:(0,r.jsx)(l.RiUploadCloud2Line,{className:"h-4 w-4"})},{value:s.TransferMethod.remote_url,label:u("fileUploader.pasteFileLink",{ns:"common"}),icon:(0,r.jsx)(l.RiLink,{className:"h-4 w-4"})}],g=(0,i.useCallback)((e,t)=>(0,r.jsxs)(a.default,{variant:"tertiary",className:(0,n.cn)("relative grow",t&&"bg-components-button-tertiary-bg-hover"),disabled:!!(c.number_limits&&d.length>=c.number_limits),children:[e.icon,(0,r.jsx)("span",{className:"ml-1",children:e.label}),e.value===s.TransferMethod.local_file&&(0,r.jsx)(S,{fileConfig:c})]},e.value),[c,d.length]),h=(0,i.useCallback)(e=>t=>g(e,t),[g]),x=(0,i.useCallback)(e=>e.value===s.TransferMethod.local_file&&c?.allowed_file_upload_methods?.includes(s.TransferMethod.local_file)?g(e):e.value===s.TransferMethod.remote_url&&c?.allowed_file_upload_methods?.includes(s.TransferMethod.remote_url)?(0,r.jsx)(U,{showFromLocal:!1,trigger:h(e),fileConfig:c},e.value):void 0,[g,h,c]);return(0,r.jsxs)("div",{children:[!t&&(0,r.jsx)("div",{className:"flex items-center space-x-1",children:f.map(x)}),(0,r.jsx)("div",{className:"mt-1 space-y-1",children:d.map(e=>(0,r.jsx)(R.default,{file:e,showDeleteAction:!t,showDownloadAction:!1,onRemove:()=>p(e.id),onReUpload:()=>m(e.id),canPreview:c.preview_config?.file_type_list?.includes(e.type),previewMode:c.preview_config?.mode},e.id))})]})};e.s(["default",0,e=>{let{value:t,onChange:l,fileConfig:i,isDisabled:o}=e;return(0,r.jsx)(_,{value:t,onChange:l,children:(0,r.jsx)(E,{isDisabled:o,fileConfig:i})})}],27808);var A=e.i(654313);let P=(0,i.memo)(e=>{let{fileConfig:t,readonly:o}=e,a=(0,i.useCallback)(e=>(0,r.jsx)(A.default,{size:"l",className:(0,n.cn)(e&&"bg-state-base-hover"),disabled:o,children:(0,r.jsx)(l.RiAttachmentLine,{className:"h-5 w-5"})}),[]);return o?a(!1):(0,r.jsx)(U,{trigger:a,fileConfig:t,showFromLocal:t?.allowed_file_upload_methods?.includes(s.TransferMethod.local_file),showFromLink:t?.allowed_file_upload_methods?.includes(s.TransferMethod.remote_url)})});e.s(["default",0,P],33199);var z=e.i(688393),M=e.i(15585);let O=e=>{let{url:t,title:i,onCancel:o}=e;return(0,M.useHotkeys)("esc",o),(0,z.createPortal)((0,r.jsxs)("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/80 p-8",onClick:e=>e.stopPropagation(),tabIndex:-1,children:[(0,r.jsx)("div",{children:(0,r.jsx)("audio",{controls:!0,title:i,autoPlay:!1,preload:"metadata",children:(0,r.jsx)("source",{type:"audio/mpeg",src:t,className:"max-h-full max-w-full"})})}),(0,r.jsx)("div",{className:"absolute right-6 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg bg-white/[0.08] backdrop-blur-[2px]",onClick:o,children:(0,r.jsx)(l.RiCloseLine,{className:"h-4 w-4 text-gray-500"})})]}),document.body)},I=(0,e.i(233697).default)(()=>e.A(201201),{loadableGenerated:{modules:[661305]},ssr:!1}),D=e=>{let{url:t,title:i,onCancel:o}=e;return(0,M.useHotkeys)("esc",o),(0,z.createPortal)((0,r.jsxs)("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/80 p-8",onClick:e=>e.stopPropagation(),tabIndex:-1,children:[(0,r.jsx)("div",{children:(0,r.jsx)("video",{controls:!0,title:i,autoPlay:!1,preload:"metadata",children:(0,r.jsx)("source",{type:"video/mp4",src:t,className:"max-h-full max-w-full"})})}),(0,r.jsx)("div",{className:"absolute right-6 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg bg-white/[0.08] backdrop-blur-[2px]",onClick:o,children:(0,r.jsx)(l.RiCloseLine,{className:"h-4 w-4 text-gray-500"})})]}),document.body)};e.i(36860);var $=e.i(47481),B=e.i(584186),K=e.i(618403);let W=e=>{let{file:o,showDeleteAction:s,showDownloadAction:c=!0,onRemove:u,onReUpload:d,canPreview:p}=e,{id:m,name:f,type:g,progress:h,url:x,base64Url:y,isRemote:v}=o,[w,j]=(0,i.useState)(""),k=(0,T.getFileExtension)(f,g,v),C=-1===h,N=x||y;!N&&o?.originalFile&&(N=URL.createObjectURL(o.originalFile.slice()).toString());let _=x?`${x}&as_attachment=true`:y;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:(0,n.cn)("group/file-item relative h-[68px] w-[144px] rounded-lg border-[0.5px] border-components-panel-border bg-components-card-bg p-2 shadow-xs",!C&&"hover:bg-components-card-bg-alt",C&&"border border-state-destructive-border bg-state-destructive-hover",C&&"bg-state-destructive-hover-alt hover:border-[0.5px] hover:border-state-destructive-border"),children:[s&&(0,r.jsx)(a.default,{className:"absolute -right-1.5 -top-1.5 z-[11] hidden h-5 w-5 rounded-full p-0 group-hover/file-item:flex",onClick:()=>u?.(m),children:(0,r.jsx)(l.RiCloseLine,{className:"h-4 w-4 text-components-button-secondary-text"})}),(0,r.jsx)("div",{className:"system-xs-medium mb-1 line-clamp-2 h-8 cursor-pointer break-all text-text-tertiary",title:f,onClick:()=>p&&j(N||""),children:f}),(0,r.jsxs)("div",{className:"relative flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"system-2xs-medium-uppercase flex items-center text-text-tertiary",children:[(0,r.jsx)(t.default,{size:"sm",type:(0,T.getFileAppearanceType)(f,g),className:"mr-1"}),k&&(0,r.jsxs)(r.Fragment,{children:[k,(0,r.jsx)("div",{className:"mx-1",children:"·"})]}),!!o.size&&(0,b.formatFileSize)(o.size)]}),c&&_&&(0,r.jsx)(A.default,{size:"m",className:"absolute -right-1 -top-1 hidden group-hover/file-item:flex",onClick:e=>{e.stopPropagation(),(0,K.downloadUrl)({url:_||"",fileName:f,target:"_blank"})},children:(0,r.jsx)(l.RiDownloadLine,{className:"h-3.5 w-3.5 text-text-tertiary"})}),h>=0&&!(0,T.fileIsUploaded)(o)&&(0,r.jsx)(B.default,{percentage:h,size:12,className:"shrink-0"}),C&&(0,r.jsx)($.ReplayLine,{className:"h-4 w-4 text-text-tertiary",onClick:()=>d?.(m)})]})]}),"audio"===g.split("/")[0]&&p&&w&&(0,r.jsx)(O,{title:f,url:w,onCancel:()=>j("")}),"video"===g.split("/")[0]&&p&&w&&(0,r.jsx)(D,{title:f,url:w,onCancel:()=>j("")}),"pdf"===g.split("/")[1]&&p&&w&&(0,r.jsx)(I,{url:w,onCancel:()=>{j("")}})]})};var H=e.i(998020),q=e.i(357e3);let X=e=>{let{file:t,showDeleteAction:o,showDownloadAction:s,canPreview:n,onRemove:c,onReUpload:u}=e,{id:d,progress:p,base64Url:m,url:f,name:g}=t,[h,x]=(0,i.useState)(""),y=f?`${f}&as_attachment=true`:m;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"group/file-image relative cursor-pointer",onClick:()=>n&&x(m||f||""),children:[o&&(0,r.jsx)(a.default,{className:"absolute -right-1.5 -top-1.5 z-[11] hidden h-5 w-5 rounded-full p-0 group-hover/file-image:flex",onClick:()=>c?.(d),children:(0,r.jsx)(l.RiCloseLine,{className:"h-4 w-4 text-components-button-secondary-text"})}),(0,r.jsx)(q.default,{className:"h-[68px] w-[68px] shadow-md",imageUrl:m||f||"",showDownloadAction:s}),p>=0&&!(0,T.fileIsUploaded)(t)&&(0,r.jsx)("div",{className:"absolute inset-0 z-10 flex items-center justify-center border-[2px] border-effects-image-frame bg-background-overlay-alt",children:(0,r.jsx)(B.default,{percentage:p,size:12,circleStrokeColor:"stroke-components-progress-white-border",circleFillColor:"fill-transparent",sectorFillColor:"fill-components-progress-white-progress"})}),-1===p&&(0,r.jsx)("div",{className:"absolute inset-0 z-10 flex items-center justify-center border-[2px] border-state-destructive-border bg-background-overlay-destructive",children:(0,r.jsx)($.ReplayLine,{className:"h-5 w-5",onClick:()=>u?.(d)})}),s&&(0,r.jsx)("div",{className:"absolute inset-0.5 z-10 hidden bg-background-overlay-alt bg-opacity-[0.3] group-hover/file-image:block",children:(0,r.jsx)("div",{className:"absolute bottom-0.5 right-0.5  flex h-6 w-6 items-center justify-center rounded-lg bg-components-actionbar-bg shadow-md",onClick:e=>{e.stopPropagation(),(0,K.downloadUrl)({url:y||"",fileName:g,target:"_blank"})},children:(0,r.jsx)(l.RiDownloadLine,{className:"h-4 w-4 text-text-tertiary"})})})]}),h&&n&&(0,r.jsx)(H.default,{title:g,url:h,onCancel:()=>x("")})]})},Y=e=>{let{className:t,files:l,onReUpload:i,onRemove:o,showDeleteAction:a=!0,showDownloadAction:s=!1,canPreview:c=!0}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex flex-wrap gap-2",t),children:l.map(e=>e.supportFileType===p.SupportUploadFileTypes.image?(0,r.jsx)(X,{file:e,showDeleteAction:a,showDownloadAction:s,onRemove:o,onReUpload:i,canPreview:c},e.id):(0,r.jsx)(W,{file:e,showDeleteAction:a,showDownloadAction:s,onRemove:o,onReUpload:i,canPreview:c},e.id))})};e.s(["FileList",0,Y,"FileListInChatInput",0,e=>{let{fileConfig:t}=e,l=C(e=>e.files),{handleRemoveFile:i,handleReUploadFile:o}=L(t);return(0,r.jsx)(Y,{files:l,onReUpload:o,onRemove:i})}],297162),e.s([],237855)},346563,e=>{"use strict";var t=e.i(978912);function r(e){if(!e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}var l=e.i(744277),i=e.i(91595),o=e.i(908421),a=e.i(482777),s=e.i(124836);function n(e,n){return function e(s,n,c,u,d,p,m){let f=m(s,n,c,u,d,p);if(void 0!==f)return f;if(typeof s==typeof n)switch(typeof s){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return s===n;case"number":return s===n||Object.is(s,n)}return function s(n,c,u,d){if(Object.is(n,c))return!0;let p=(0,i.getTag)(n),m=(0,i.getTag)(c);if(p===o.argumentsTag&&(p=o.objectTag),m===o.argumentsTag&&(m=o.objectTag),p!==m)return!1;switch(p){case o.stringTag:return n.toString()===c.toString();case o.numberTag:{let e=n.valueOf(),t=c.valueOf();return(0,a.eq)(e,t)}case o.booleanTag:case o.dateTag:case o.symbolTag:return Object.is(n.valueOf(),c.valueOf());case o.regexpTag:return n.source===c.source&&n.flags===c.flags;case o.functionTag:return n===c}let f=(u=u??new Map).get(n),g=u.get(c);if(null!=f&&null!=g)return f===c;u.set(n,c),u.set(c,n);try{switch(p){case o.mapTag:if(n.size!==c.size)return!1;for(let[t,r]of n.entries())if(!c.has(t)||!e(r,c.get(t),t,n,c,u,d))return!1;return!0;case o.setTag:{if(n.size!==c.size)return!1;let t=Array.from(n.values()),r=Array.from(c.values());for(let l=0;l<t.length;l++){let i=t[l],o=r.findIndex(t=>e(i,t,void 0,n,c,u,d));if(-1===o)return!1;r.splice(o,1)}return!0}case o.arrayTag:case o.uint8ArrayTag:case o.uint8ClampedArrayTag:case o.uint16ArrayTag:case o.uint32ArrayTag:case o.bigUint64ArrayTag:case o.int8ArrayTag:case o.int16ArrayTag:case o.int32ArrayTag:case o.bigInt64ArrayTag:case o.float32ArrayTag:case o.float64ArrayTag:if(void 0!==t.Buffer&&t.Buffer.isBuffer(n)!==t.Buffer.isBuffer(c)||n.length!==c.length)return!1;for(let t=0;t<n.length;t++)if(!e(n[t],c[t],t,n,c,u,d))return!1;return!0;case o.arrayBufferTag:if(n.byteLength!==c.byteLength)return!1;return s(new Uint8Array(n),new Uint8Array(c),u,d);case o.dataViewTag:if(n.byteLength!==c.byteLength||n.byteOffset!==c.byteOffset)return!1;return s(new Uint8Array(n),new Uint8Array(c),u,d);case o.errorTag:return n.name===c.name&&n.message===c.message;case o.objectTag:{if(!(s(n.constructor,c.constructor,u,d)||r(n)&&r(c)))return!1;let t=[...Object.keys(n),...(0,l.getSymbols)(n)],i=[...Object.keys(c),...(0,l.getSymbols)(c)];if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++){let l=t[r],i=n[l];if(!Object.hasOwn(c,l))return!1;let o=c[l];if(!e(i,o,l,n,c,u,d))return!1}return!0}default:return!1}}finally{u.delete(n),u.delete(c)}}(s,n,p,m)}(e,n,void 0,void 0,void 0,void 0,s.noop)}e.s(["isEqual",()=>n],346563)},15585,e=>{"use strict";var t=e.i(268255);function r(){return(r=Object.assign.bind()).apply(null,arguments)}e.i(563199);var l=["shift","alt","meta","mod","ctrl"],i={esc:"escape",return:"enter",".":"period",",":"comma","-":"slash"," ":"space","`":"backquote","#":"backslash","+":"bracketright",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function o(e){return(e&&i[e]||e||"").trim().toLowerCase().replace(/key|digit|numpad|arrow/,"")}function a(e,t){return void 0===t&&(t=","),e.split(t)}function s(e,t,i){void 0===t&&(t="+");var a=e.toLocaleLowerCase().split(t).map(function(e){return o(e)}),s={alt:a.includes("alt"),ctrl:a.includes("ctrl")||a.includes("control"),shift:a.includes("shift"),meta:a.includes("meta"),mod:a.includes("mod")},n=a.filter(function(e){return!l.includes(e)});return r({},s,{keys:n,description:i,hotkey:e})}"u">typeof document&&(document.addEventListener("keydown",function(e){void 0!==e.key&&u([o(e.key),o(e.code)])}),document.addEventListener("keyup",function(e){void 0!==e.key&&d([o(e.key),o(e.code)])})),"u">typeof window&&window.addEventListener("blur",function(){n.clear()});var n=new Set;function c(e){return Array.isArray(e)}function u(e){var t=Array.isArray(e)?e:[e];n.has("meta")&&n.forEach(function(e){return!l.includes(e)&&n.delete(e.toLowerCase())}),t.forEach(function(e){return n.add(e.toLowerCase())})}function d(e){var t=Array.isArray(e)?e:[e];"meta"===e?n.clear():t.forEach(function(e){return n.delete(e.toLowerCase())})}function p(e,t){void 0===t&&(t=!1);var r,l=e.target,i=e.composed,o=null;return(o=(r=l).tagName&&!r.tagName.startsWith("-")&&r.tagName.includes("-")&&i?e.composedPath()[0]&&e.composedPath()[0].tagName:l&&l.tagName,c(t))?!!(o&&t&&t.some(function(e){var t;return e.toLowerCase()===(null==(t=o)?void 0:t.toLowerCase())})):!!(o&&t&&t)}var m=function(e,t,r){void 0===r&&(r=!1);var l,i=t.alt,a=t.meta,s=t.mod,u=t.shift,d=t.ctrl,p=t.keys,m=e.key,f=e.code,g=e.ctrlKey,h=e.metaKey,x=e.shiftKey,y=e.altKey,b=o(f),v=m.toLowerCase();if(!(null!=p&&p.includes(b))&&!(null!=p&&p.includes(v))&&!["ctrl","control","unknown","meta","alt","shift","os"].includes(b))return!1;if(!r){if(!y===i&&"alt"!==v||!x===u&&"shift"!==v)return!1;if(s){if(!h&&!g)return!1}else if(!h===a&&"meta"!==v&&"os"!==v||!g===d&&"ctrl"!==v&&"control"!==v)return!1}return!!(p&&1===p.length&&(p.includes(v)||p.includes(b)))||(p?(void 0===l&&(l=","),(c(p)?p:p.split(l)).every(function(e){return n.has(e.trim().toLowerCase())})):!p||!1)},f=(0,t.createContext)(void 0),g=(0,t.createContext)({hotkeys:[],enabledScopes:[],toggleScope:function(){},enableScope:function(){},disableScope:function(){}}),h=function(e){e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation()},x="u">typeof window?t.useLayoutEffect:t.useEffect;function y(e,r,l,i){var n,y=(0,t.useState)(null),b=y[0],v=y[1],w=(0,t.useRef)(!1),j=l instanceof Array?i instanceof Array?void 0:i:l,k=c(e)?e.join(null==j?void 0:j.splitKey):e,C=l instanceof Array?l:i instanceof Array?i:void 0,N=(0,t.useCallback)(r,null!=C?C:[]),_=(0,t.useRef)(N);C?_.current=N:_.current=r;var T=(!function e(t,r){return t&&r&&"object"==typeof t&&"object"==typeof r?Object.keys(t).length===Object.keys(r).length&&Object.keys(t).reduce(function(l,i){return l&&e(t[i],r[i])},!0):t===r}((n=(0,t.useRef)(void 0)).current,j)&&(n.current=j),n.current),F=(0,t.useContext)(g).enabledScopes,L=(0,t.useContext)(f);return x(function(){var e;if((null==T?void 0:T.enabled)!==!1&&(e=null==T?void 0:T.scopes,0===F.length&&e?(console.warn('A hotkey has the "scopes" option set, however no active scopes were found. If you want to use the global scopes feature, you need to wrap your app in a <HotkeysProvider>'),!0):!e||F.some(function(t){return e.includes(t)})||F.includes("*"))){var t=function(e,t){var r;if(void 0===t&&(t=!1),!p(e,["input","textarea","select"])||p(e,null==T?void 0:T.enableOnFormTags)){if(null!==b){var l=b.getRootNode();if((l instanceof Document||l instanceof ShadowRoot)&&l.activeElement!==b&&!b.contains(l.activeElement))return void h(e)}(null==(r=e.target)||!r.isContentEditable||null!=T&&T.enableOnContentEditable)&&a(k,null==T?void 0:T.splitKey).forEach(function(r){var l,i,o,a=s(r,null==T?void 0:T.combinationKey);if(m(e,a,null==T?void 0:T.ignoreModifiers)||null!=(o=a.keys)&&o.includes("*")){if(null!=T&&null!=T.ignoreEventWhen&&T.ignoreEventWhen(e)||t&&w.current)return;if(("function"==typeof(l=null==T?void 0:T.preventDefault)&&l(e,a)||!0===l)&&e.preventDefault(),"function"==typeof(i=null==T?void 0:T.enabled)?!i(e,a):!0!==i&&void 0!==i)return void h(e);_.current(e,a),t||(w.current=!0)}})}},r=function(e){void 0!==e.key&&(u(o(e.code)),((null==T?void 0:T.keydown)===void 0&&(null==T?void 0:T.keyup)!==!0||null!=T&&T.keydown)&&t(e))},l=function(e){void 0!==e.key&&(d(o(e.code)),w.current=!1,null!=T&&T.keyup&&t(e,!0))},i=b||(null==j?void 0:j.document)||document;return i.addEventListener("keyup",l,null==j?void 0:j.eventListenerOptions),i.addEventListener("keydown",r,null==j?void 0:j.eventListenerOptions),L&&a(k,null==T?void 0:T.splitKey).forEach(function(e){return L.addHotkey(s(e,null==T?void 0:T.combinationKey,null==T?void 0:T.description))}),function(){i.removeEventListener("keyup",l,null==j?void 0:j.eventListenerOptions),i.removeEventListener("keydown",r,null==j?void 0:j.eventListenerOptions),L&&a(k,null==T?void 0:T.splitKey).forEach(function(e){return L.removeHotkey(s(e,null==T?void 0:T.combinationKey,null==T?void 0:T.description))})}}},[b,k,T,F]),v}e.s(["useHotkeys",()=>y])},998020,e=>{"use strict";var t=e.i(563199),r=e.i(837699),l=e.i(124836),i=e.i(915389),o=e.i(268255),a=e.i(688393),s=e.i(15585),n=e.i(137667),c=e.i(421001),u=e.i(618403);e.s(["default",0,e=>{let{url:d,title:p,onCancel:m,onPrev:f,onNext:g}=e,[h,x]=(0,o.useState)(1),[y,b]=(0,o.useState)({x:0,y:0}),[v,w]=(0,o.useState)(!1),j=(0,o.useRef)(null),k=(0,o.useRef)({x:0,y:0}),[C,N]=(0,o.useState)(!1),_=()=>{x(e=>Math.min(1.2*e,15))},T=()=>{x(e=>{let t=Math.max(e/1.2,.5);return 1===t&&b({x:0,y:0}),t})},F=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png",r=atob(e),l=[];for(let e=0;e<r.length;e+=512){let t=r.slice(e,e+512),i=Array.from({length:t.length});for(let e=0;e<t.length;e++)i[e]=t.charCodeAt(e);let o=new Uint8Array(i);l.push(o)}return new Blob(l,{type:t})},L=(0,o.useCallback)(()=>{(async()=>{try{let e=d.split(",")[1],t=F(e,"image/png");await navigator.clipboard.write([new ClipboardItem({[t.type]:t})]),N(!0),n.default.notify({type:"success",message:(0,i.t)("operation.imageCopied",{ns:"common"})})}catch(e){console.error("Failed to copy image:",e),(0,u.downloadUrl)({url:d,fileName:`${p}.png`}),n.default.notify({type:"info",message:(0,i.t)("operation.imageDownloaded",{ns:"common"})})}})()},[p,d]),S=(0,o.useCallback)(e=>{e.deltaY<0?_():T()},[]),U=(0,o.useCallback)(e=>{h>1&&(w(!0),k.current={x:e.clientX-y.x,y:e.clientY-y.y})},[h,y]),R=(0,o.useCallback)(e=>{if(v&&h>1){let t=e.clientX-k.current.x,r=e.clientY-k.current.y,l=j.current?.getBoundingClientRect(),i=j.current?.parentElement?.getBoundingClientRect();if(l&&i){let e=(l.width*h-i.width)/2,o=(l.height*h-i.height)/2;b({x:Math.max(-e,Math.min(e,t)),y:Math.max(-o,Math.min(o,r))})}}},[v,h]),E=(0,o.useCallback)(()=>{w(!1)},[]);return(0,o.useEffect)(()=>(document.addEventListener("mouseup",E),()=>{document.removeEventListener("mouseup",E)}),[E]),(0,s.useHotkeys)("esc",m),(0,s.useHotkeys)("up",_),(0,s.useHotkeys)("down",T),(0,s.useHotkeys)("left",f||l.noop),(0,s.useHotkeys)("right",g||l.noop),(0,a.createPortal)((0,t.jsxs)("div",{className:"image-preview-container fixed inset-0 z-[1000] flex items-center justify-center bg-black/80 p-8",onClick:e=>e.stopPropagation(),onWheel:S,onMouseDown:U,onMouseMove:R,onMouseUp:E,style:{cursor:h>1?"move":"default"},tabIndex:-1,children:[(0,t.jsx)("img",{ref:j,alt:p,src:(e=>{try{return btoa(atob(e))===e}catch{return!1}})(d)?`data:image/png;base64,${d}`:d,className:"max-h-full max-w-full",style:{transform:`scale(${h}) translate(${y.x}px, ${y.y}px)`,transition:v?"none":"transform 0.2s ease-in-out"}}),(0,t.jsx)(c.default,{popupContent:(0,i.t)("operation.copyImage",{ns:"common"}),children:(0,t.jsx)("div",{className:"absolute right-48 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg",onClick:L,children:C?(0,t.jsx)(r.RiFileCopyLine,{className:"h-4 w-4 text-green-500"}):(0,t.jsx)(r.RiFileCopyLine,{className:"h-4 w-4 text-gray-500"})})}),(0,t.jsx)(c.default,{popupContent:(0,i.t)("operation.zoomOut",{ns:"common"}),children:(0,t.jsx)("div",{className:"absolute right-40 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg",onClick:T,children:(0,t.jsx)(r.RiZoomOutLine,{className:"h-4 w-4 text-gray-500"})})}),(0,t.jsx)(c.default,{popupContent:(0,i.t)("operation.zoomIn",{ns:"common"}),children:(0,t.jsx)("div",{className:"absolute right-32 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg",onClick:_,children:(0,t.jsx)(r.RiZoomInLine,{className:"h-4 w-4 text-gray-500"})})}),(0,t.jsx)(c.default,{popupContent:(0,i.t)("operation.download",{ns:"common"}),children:(0,t.jsx)("div",{className:"absolute right-24 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg",onClick:()=>{d.startsWith("http")||d.startsWith("https")||d.startsWith("data:image")?(0,u.downloadUrl)({url:d,fileName:p,target:"_blank"}):n.default.notify({type:"error",message:`Unable to open image: ${d}`})},children:(0,t.jsx)(r.RiDownloadCloud2Line,{className:"h-4 w-4 text-gray-500"})})}),(0,t.jsx)(c.default,{popupContent:(0,i.t)("operation.openInNewTab",{ns:"common"}),children:(0,t.jsx)("div",{className:"absolute right-16 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg",onClick:()=>{if(d.startsWith("http")||d.startsWith("https"))window.open(d,"_blank");else if(d.startsWith("data:image")){let e=window.open();e?.document.write(`<img src="${d}" alt="${p}" />`)}else n.default.notify({type:"error",message:`Unable to open image: ${d}`})},children:(0,t.jsx)(r.RiAddBoxLine,{className:"h-4 w-4 text-gray-500"})})}),(0,t.jsx)(c.default,{popupContent:(0,i.t)("operation.cancel",{ns:"common"}),children:(0,t.jsx)("div",{className:"absolute right-6 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg bg-white/8 backdrop-blur-[2px]",onClick:m,children:(0,t.jsx)(r.RiCloseLine,{className:"h-4 w-4 text-gray-500"})})})]}),document.body)}])},357e3,e=>{"use strict";var t=e.i(563199),r=e.i(935139);e.s(["default",0,e=>{let{imageUrl:l,className:i,alt:o,onLoad:a,onError:s,showDownloadAction:n}=e;return(0,t.jsx)("div",{className:(0,r.cn)("border-[2px] border-effects-image-frame shadow-xs",i),children:(0,t.jsx)("img",{className:(0,r.cn)("h-full w-full object-cover",n&&"cursor-pointer"),alt:o||"Preview",onLoad:a,onError:s,src:l})})}])},47481,e=>{"use strict";var t=e.i(186571);e.s(["ReplayLine",()=>t.default])},584186,e=>{"use strict";var t=e.i(563199),r=e.i(268255),l=e.i(935139);let i=(0,r.memo)(e=>{let{className:r,percentage:i=0,size:o=12,circleStrokeWidth:a=1,circleStrokeColor:s="stroke-components-progress-brand-border",circleFillColor:n="fill-components-progress-brand-bg",sectorFillColor:c="fill-components-progress-brand-progress"}=e,u=o/2,d=o/2,p=i/101*360*Math.PI/180,m=d+u*Math.cos(p-Math.PI/2),f=d+u*Math.sin(p-Math.PI/2),g=`
    M ${d},${d}
    L ${d},${d-u}
    A ${u},${u} 0 ${+(i>50)} 1 ${m},${f}
    Z
  `;return(0,t.jsxs)("svg",{width:o+a,height:o+a,viewBox:`0 0 ${o+a} ${o+a}`,className:r,children:[(0,t.jsx)("circle",{className:(0,l.cn)(n,s),cx:d+a/2,cy:d+a/2,r:u,strokeWidth:a}),(0,t.jsx)("path",{className:(0,l.cn)(c),d:g,transform:`translate(${a/2}, ${a/2})`})]})});e.s(["default",0,i])},711284,e=>{"use strict";var t,r,l=((t={}).NewPage="new_page",t.CurrentPage="current_page",t),i=((r={}).moreLikeThis="moreLikeThis",r.opening="opening",r.suggested="suggested",r.text2speech="text2speech",r.speech2text="speech2text",r.citation="citation",r.moderation="moderation",r.file="file",r.annotationReply="annotationReply",r);e.s(["FeatureEnum",()=>i,"PreviewMode",()=>l])},387124,e=>{"use strict";var t=e.i(563199),r=e.i(837699),l=e.i(268255),i=e.i(654313),o=e.i(711284);e.i(36860);var a=e.i(47481),s=e.i(998020),n=e.i(584186),c=e.i(390622),u=e.i(935139),d=e.i(618403),p=e.i(128984),m=e.i(357e3),f=e.i(377397),g=e.i(223314);let h=(0,l.memo)(e=>{let{file:h,showDeleteAction:x,showDownloadAction:y=!0,onRemove:b,onReUpload:v,canPreview:w,previewMode:j=o.PreviewMode.CurrentPage}=e,{id:k,name:C,type:N,progress:_,supportFileType:T,base64Url:F,url:L,isRemote:S}=h,U=(0,g.getFileExtension)(C,N,S),R=T===c.SupportUploadFileTypes.image,[E,A]=(0,l.useState)("");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:(0,u.cn)("flex h-12 items-center rounded-lg border-[0.5px] border-components-panel-border bg-components-panel-on-panel-item-bg pr-3 shadow-xs",-1===_&&"border-state-destructive-border bg-state-destructive-hover",w&&j===o.PreviewMode.NewPage&&"cursor-pointer"),onClick:()=>{w&&j===o.PreviewMode.NewPage&&window.open(L||F||"","_blank")},children:[(0,t.jsxs)("div",{className:"flex h-12 w-12 items-center justify-center",children:[R&&(0,t.jsx)(m.default,{className:"h-8 w-8",imageUrl:F||L||""}),!R&&(0,t.jsx)(f.default,{type:(0,g.getFileAppearanceType)(C,N),size:"xl"})]}),(0,t.jsxs)("div",{className:"mr-1 w-0 grow",children:[(0,t.jsx)("div",{className:"system-xs-medium mb-0.5 flex items-center truncate text-text-secondary",title:h.name,children:(0,t.jsx)("div",{className:"truncate",children:C})}),(0,t.jsxs)("div",{className:"system-2xs-medium-uppercase flex items-center text-text-tertiary",children:[U&&(0,t.jsx)("span",{children:U.toLowerCase()}),U&&(0,t.jsx)("span",{className:"system-2xs-medium mx-1",children:"•"}),!!h.size&&(0,t.jsx)("span",{children:(0,p.formatFileSize)(h.size)})]})]}),(0,t.jsxs)("div",{className:"flex shrink-0 items-center",children:[_>=0&&!(0,g.fileIsUploaded)(h)&&(0,t.jsx)(n.default,{className:"mr-2.5",percentage:_}),-1===_&&(0,t.jsx)(i.default,{className:"mr-1",onClick:()=>v?.(k),children:(0,t.jsx)(a.ReplayLine,{className:"h-4 w-4 text-text-tertiary"})}),x&&(0,t.jsx)(i.default,{onClick:()=>b?.(k),children:(0,t.jsx)(r.RiDeleteBinLine,{className:"h-4 w-4"})}),w&&R&&(0,t.jsx)(i.default,{className:"mr-1",onClick:()=>A(L||""),children:(0,t.jsx)(r.RiEyeLine,{className:"h-4 w-4"})}),y&&(0,t.jsx)(i.default,{onClick:e=>{e.stopPropagation(),(0,d.downloadUrl)({url:L||F||"",fileName:C,target:"_blank"})},children:(0,t.jsx)(r.RiDownloadLine,{className:"h-4 w-4"})})]})]}),E&&w&&(0,t.jsx)(s.default,{title:C,url:E,onCancel:()=>A("")})]})});e.s(["default",0,h])}]);