(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,551193,e=>{"use strict";let t,a,l;var n=e.i(268255),s=e.i(198136),r=e.i(126765),i=e.i(243815),o=e.i(71216),u=e.i(741064),c=e.i(782165),d=e.i(775885),p=e.i(122783),f=e.i(944296),m=e.i(818805),g=e.i(135477),h=e.i(92054),x=e.i(329512),v=e.i(808534),y=e.i(268850),b=e.i(316688),F=e.i(652038),w=e.i(858023),S=e.i(869873),j=e.i(969350),k=e.i(425324),E=e.i(979845),I=e.i(692941),P=e.i(394149),T=e.i(794085),C=e.i(996978),N=e.i(455028),R=e.i(692558);function H(e){if(!e)return new Set;if("function"==typeof e)return new Set(e());let t=new Set;for(let a of e.current)a.current instanceof HTMLElement&&t.add(a.current);return t}var D=((t=D||{})[t.None=0]="None",t[t.InitialFocus=1]="InitialFocus",t[t.TabLock=2]="TabLock",t[t.FocusLock=4]="FocusLock",t[t.RestoreFocus=8]="RestoreFocus",t[t.AutoFocus=16]="AutoFocus",t);let $=Object.assign((0,w.forwardRefWithAs)(function(e,t){let a=(0,n.useRef)(null),l=(0,x.useSyncRefs)(a,t),{initialFocus:s,initialFocusFallback:u,containers:c,features:d=15,...p}=e;(0,h.useServerHandoffComplete)()||(d=0);let m=(0,f.useOwnerDocument)(a);!function(e,t){let{ownerDocument:a}=t,l=!!(8&e),s=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=(0,n.useRef)(C.history.slice());return(0,P.useWatch)((e,a)=>{let[l]=e,[n]=a;!0===n&&!1===l&&(0,R.microTask)(()=>{t.current.splice(0)}),!1===n&&!0===l&&(t.current=C.history.slice())},[e,C.history,t]),(0,o.useEvent)(()=>{var e;return null!=(e=t.current.find(e=>null!=e&&e.isConnected))?e:null})}(l);(0,P.useWatch)(()=>{l||(null==a?void 0:a.activeElement)===(null==a?void 0:a.body)&&(0,N.focusElement)(s())},[l]),(0,E.useOnUnmount)(()=>{l&&(0,N.focusElement)(s())})}(d,{ownerDocument:m});let g=function(e,t){let{ownerDocument:a,container:l,initialFocus:s,initialFocusFallback:r}=t,o=(0,n.useRef)(null),u=(0,i.useIsTopLayer)(!!(1&e),"focus-trap#initial-focus"),c=(0,k.useIsMounted)();return(0,P.useWatch)(()=>{if(0===e)return;if(!u){null!=r&&r.current&&(0,N.focusElement)(r.current);return}let t=l.current;t&&(0,R.microTask)(()=>{if(!c.current)return;let l=null==a?void 0:a.activeElement;if(null!=s&&s.current){if((null==s?void 0:s.current)===l){o.current=l;return}}else if(t.contains(l)){o.current=l;return}if(null!=s&&s.current)(0,N.focusElement)(s.current);else{if(16&e){if((0,N.focusIn)(t,N.Focus.First|N.Focus.AutoFocus)!==N.FocusResult.Error)return}else if((0,N.focusIn)(t,N.Focus.First)!==N.FocusResult.Error)return;if(null!=r&&r.current&&((0,N.focusElement)(r.current),(null==a?void 0:a.activeElement)===r.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}o.current=null==a?void 0:a.activeElement})},[r,u,e]),o}(d,{ownerDocument:m,container:a,initialFocus:s,initialFocusFallback:u});!function(e,t){let{ownerDocument:a,container:l,containers:n,previousActiveElement:s}=t,i=(0,k.useIsMounted)(),o=!!(4&e);(0,r.useEventListener)(null==a?void 0:a.defaultView,"focus",e=>{if(!o||!i.current)return;let t=H(n);l.current instanceof HTMLElement&&t.add(l.current);let a=s.current;if(!a)return;let r=e.target;r&&r instanceof HTMLElement?G(t,r)?(s.current=r,(0,N.focusElement)(r)):(e.preventDefault(),e.stopPropagation(),(0,N.focusElement)(a)):(0,N.focusElement)(s.current)},!0)}(d,{ownerDocument:m,container:a,containers:c,previousActiveElement:g});let v=(0,I.useTabDirection)(),y=(0,o.useEvent)(e=>{let t=a.current;t&&(0,F.match)(v.current,{[I.Direction.Forwards]:()=>{(0,N.focusIn)(t,N.Focus.First,{skipElements:[e.relatedTarget,u]})},[I.Direction.Backwards]:()=>{(0,N.focusIn)(t,N.Focus.Last,{skipElements:[e.relatedTarget,u]})}})}),b=(0,i.useIsTopLayer)(!!(2&d),"focus-trap#tab-lock"),S=(0,j.useDisposables)(),D=(0,n.useRef)(!1),$=(0,w.useRender)();return n.default.createElement(n.default.Fragment,null,b&&n.default.createElement(T.Hidden,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:y,features:T.HiddenFeatures.Focusable}),$({ourProps:{ref:l,onKeyDown(e){"Tab"==e.key&&(D.current=!0,S.requestAnimationFrame(()=>{D.current=!1}))},onBlur(e){if(!(4&d))return;let t=H(c);a.current instanceof HTMLElement&&t.add(a.current);let l=e.relatedTarget;l instanceof HTMLElement&&"true"!==l.dataset.headlessuiFocusGuard&&(G(t,l)||(D.current?(0,N.focusIn)(a.current,(0,F.match)(v.current,{[I.Direction.Forwards]:()=>N.Focus.Next,[I.Direction.Backwards]:()=>N.Focus.Previous})|N.Focus.WrapAround,{relativeTo:e.target}):e.target instanceof HTMLElement&&(0,N.focusElement)(e.target)))}},theirProps:p,defaultTag:"div",name:"FocusTrap"}),b&&n.default.createElement(T.Hidden,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:y,features:T.HiddenFeatures.Focusable}))}),{features:D});function G(e,t){for(let a of e)if(a.contains(t))return!0;return!1}var U=e.i(642330),M=e.i(157169),L=((a=L||{})[a.Open=0]="Open",a[a.Closed=1]="Closed",a),_=((l=_||{})[l.SetTitleId=0]="SetTitleId",l);let V={0:(e,t)=>e.titleId===t.id?e:{...e,titleId:t.id}},A=(0,n.createContext)(null);function O(e){let t=(0,n.useContext)(A);if(null===t){let t=Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,O),t}return t}function q(e,t){return(0,F.match)(t.type,V,e,t)}A.displayName="DialogContext";let W=(0,w.forwardRefWithAs)(function(e,t){let a=(0,n.useId)(),{id:l=`headlessui-dialog-${a}`,open:F,onClose:j,initialFocus:k,role:E="dialog",autoFocus:I=!0,__demoMode:P=!1,unmount:T=!1,...C}=e,N=(0,n.useRef)(!1);E="dialog"===E||"alertdialog"===E?E:(N.current||(N.current=!0,console.warn(`Invalid role [${E}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog");let R=(0,y.useOpenClosed)();void 0===F&&null!==R&&(F=(R&y.State.Open)===y.State.Open);let H=(0,n.useRef)(null),G=(0,x.useSyncRefs)(H,t),M=(0,f.useOwnerDocument)(H),L=+!F,[_,V]=(0,n.useReducer)(q,{titleId:null,descriptionId:null,panelRef:(0,n.createRef)()}),O=(0,o.useEvent)(()=>j(!1)),W=(0,o.useEvent)(e=>V({type:0,id:e})),K=!!(0,h.useServerHandoffComplete)()&&0===L,[Y,J]=(0,U.useNestedPortals)(),X=(0,m.useMainTreeNode)(),{resolveContainers:Q}=(0,m.useRootContainers)({mainTreeNode:X,portals:Y,defaultContainers:[{get current(){var Z;return null!=(Z=_.panelRef.current)?Z:H.current}}]}),ee=null!==R&&(R&y.State.Closing)===y.State.Closing;(0,u.useInertOthers)(!P&&!ee&&K,{allowed:(0,o.useEvent)(()=>{var e,t;return[null!=(t=null==(e=H.current)?void 0:e.closest("[data-headlessui-portal]"))?t:null]}),disallowed:(0,o.useEvent)(()=>{var e;return[null!=(e=null==X?void 0:X.closest("body > *:not(#headlessui-portal-root)"))?e:null]})}),(0,p.useOutsideClick)(K,Q,e=>{e.preventDefault(),O()}),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"u">typeof document?document.defaultView:null,a=arguments.length>2?arguments[2]:void 0,l=(0,i.useIsTopLayer)(e,"escape");(0,r.useEventListener)(t,"keydown",e=>{l&&(e.defaultPrevented||e.key===s.Keys.Escape&&a(e))})}(K,null==M?void 0:M.defaultView,e=>{e.preventDefault(),e.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur(),O()}),(0,g.useScrollLock)(!P&&!ee&&K,M,Q),(0,d.useOnDisappear)(K,H,O);let[et,ea]=(0,S.useDescriptions)(),el=(0,n.useMemo)(()=>[{dialogState:L,close:O,setTitleId:W,unmount:T},_],[L,_,O,W,T]),en=(0,n.useMemo)(()=>({open:0===L}),[L]),es={ref:G,id:l,role:E,tabIndex:-1,"aria-modal":P?void 0:0===L||void 0,"aria-labelledby":_.titleId,"aria-describedby":et,unmount:T},er=!function(){var e;let[t]=(0,n.useState)(()=>"u">typeof window&&"function"==typeof window.matchMedia?window.matchMedia("(pointer: coarse)"):null),[a,l]=(0,n.useState)(null!=(e=null==t?void 0:t.matches)&&e);return(0,c.useIsoMorphicEffect)(()=>{if(t)return t.addEventListener("change",e),()=>t.removeEventListener("change",e);function e(e){l(e.matches)}},[t]),a}(),ei=D.None;K&&!P&&(ei|=D.RestoreFocus,ei|=D.TabLock,I&&(ei|=D.AutoFocus),er&&(ei|=D.InitialFocus));let eo=(0,w.useRender)();return n.default.createElement(y.ResetOpenClosedProvider,null,n.default.createElement(b.ForcePortalRoot,{force:!0},n.default.createElement(U.Portal,null,n.default.createElement(A.Provider,{value:el},n.default.createElement(U.PortalGroup,{target:H},n.default.createElement(b.ForcePortalRoot,{force:!1},n.default.createElement(ea,{slot:en},n.default.createElement(J,null,n.default.createElement($,{initialFocus:k,initialFocusFallback:H,containers:Q,features:ei},n.default.createElement(v.CloseProvider,{value:O},eo({ourProps:es,theirProps:C,slot:en,defaultTag:B,features:z,visible:0===L,name:"Dialog"})))))))))))}),B="div",z=w.RenderFeatures.RenderStrategy|w.RenderFeatures.Static,K=(0,w.forwardRefWithAs)(function(e,t){let{transition:a=!1,open:l,...s}=e,r=(0,y.useOpenClosed)(),i=e.hasOwnProperty("open")||null!==r,o=e.hasOwnProperty("onClose");if(!i&&!o)throw Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!i)throw Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!o)throw Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!r&&"boolean"!=typeof e.open)throw Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${e.open}`);if("function"!=typeof e.onClose)throw Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${e.onClose}`);return(void 0!==l||a)&&!s.static?n.default.createElement(m.MainTreeProvider,null,n.default.createElement(M.Transition,{show:l,transition:a,unmount:s.unmount},n.default.createElement(W,{ref:t,...s}))):n.default.createElement(m.MainTreeProvider,null,n.default.createElement(W,{ref:t,open:l,...s}))}),Y=(0,w.forwardRefWithAs)(function(e,t){let a=(0,n.useId)(),{id:l=`headlessui-dialog-panel-${a}`,transition:s=!1,...r}=e,[{dialogState:i,unmount:u},c]=O("Dialog.Panel"),d=(0,x.useSyncRefs)(t,c.panelRef),p=(0,n.useMemo)(()=>({open:0===i}),[i]),f=(0,o.useEvent)(e=>{e.stopPropagation()}),m=s?M.TransitionChild:n.Fragment,g=(0,w.useRender)();return n.default.createElement(m,{...s?{unmount:u}:{}},g({ourProps:{ref:d,id:l,onClick:f},theirProps:r,slot:p,defaultTag:"div",name:"Dialog.Panel"}))}),J=(0,w.forwardRefWithAs)(function(e,t){let{transition:a=!1,...l}=e,[{dialogState:s,unmount:r}]=O("Dialog.Backdrop"),i=(0,n.useMemo)(()=>({open:0===s}),[s]),o=a?M.TransitionChild:n.Fragment,u=(0,w.useRender)();return n.default.createElement(o,{...a?{unmount:r}:{}},u({ourProps:{ref:t,"aria-hidden":!0},theirProps:l,slot:i,defaultTag:"div",name:"Dialog.Backdrop"}))}),X=(0,w.forwardRefWithAs)(function(e,t){let a=(0,n.useId)(),{id:l=`headlessui-dialog-title-${a}`,...s}=e,[{dialogState:r,setTitleId:i}]=O("Dialog.Title"),o=(0,x.useSyncRefs)(t);(0,n.useEffect)(()=>(i(l),()=>i(null)),[l,i]);let u=(0,n.useMemo)(()=>({open:0===r}),[r]);return(0,w.useRender)()({ourProps:{ref:o,id:l},theirProps:s,slot:u,defaultTag:"h2",name:"Dialog.Title"})}),Q=(S.Description,Object.assign(K,{Panel:Y,Title:X,Description:S.Description}));e.s(["Dialog",()=>Q,"DialogBackdrop",()=>J,"DialogPanel",()=>Y,"DialogTitle",()=>X],551193)},21151,e=>{"use strict";var t=e.i(563199),a=e.i(551193),l=e.i(157169),n=e.i(837699),s=e.i(124836),r=e.i(268255),i=e.i(935139);function o(e){let{className:o,wrapperClassName:u,containerClassName:c,isShow:d,onClose:p=s.noop,title:f,description:m,children:g,closable:h=!1,overflowVisible:x=!1,highPriority:v=!1,overlayOpacity:y=!1,clickOutsideNotClose:b=!1}=e;return(0,t.jsx)(l.Transition,{appear:!0,show:d,as:r.Fragment,children:(0,t.jsxs)(a.Dialog,{as:"div",className:(0,i.cn)("relative",v?"z-[1100]":"z-[60]",u),onClose:b?s.noop:p,children:[(0,t.jsx)(l.TransitionChild,{children:(0,t.jsx)("div",{className:(0,i.cn)("fixed inset-0",y?"bg-workflow-canvas-canvas-overlay":"bg-background-overlay","duration-300 ease-in data-[closed]:opacity-0","data-[enter]:opacity-100","data-[leave]:opacity-0")})}),(0,t.jsx)("div",{className:"fixed inset-0 overflow-y-auto",onClick:e=>{e.preventDefault(),e.stopPropagation()},children:(0,t.jsx)("div",{className:(0,i.cn)("flex min-h-full items-center justify-center p-4 text-center",c),children:(0,t.jsx)(l.TransitionChild,{children:(0,t.jsxs)(a.DialogPanel,{className:(0,i.cn)("relative w-full max-w-[480px] rounded-2xl bg-components-panel-bg p-6 text-left align-middle shadow-xl transition-all",x?"overflow-visible":"overflow-hidden","duration-100 ease-in data-[closed]:scale-95 data-[closed]:opacity-0","data-[enter]:scale-100 data-[enter]:opacity-100","data-[enter]:scale-95 data-[leave]:opacity-0",o),children:[!!f&&(0,t.jsx)(a.DialogTitle,{as:"h3",className:"title-2xl-semi-bold text-text-primary",children:f}),!!m&&(0,t.jsx)("div",{className:"body-md-regular mt-2 text-text-secondary",children:m}),h&&(0,t.jsx)("div",{className:"absolute right-6 top-6 z-10 flex h-5 w-5 items-center justify-center rounded-2xl hover:cursor-pointer hover:bg-state-base-hover",children:(0,t.jsx)(n.RiCloseLine,{className:"h-4 w-4 text-text-tertiary",onClick:e=>{e.stopPropagation(),p()}})}),g]})})})})]})})}e.s(["default",()=>o])},222573,e=>{"use strict";var t=e.i(268255),a=e.i(925521),l=e.i(711536);e.s(["default",0,()=>{let e=(0,l.useSelector)(e=>e.currentWorkspace);return{getIconUrl:(0,t.useCallback)(t=>`${a.API_PREFIX}/workspaces/current/plugin/icon?tenant_id=${e.id}&filename=${t}`,[e.id])}}])},465497,e=>{"use strict";var t=e.i(563199),a=e.i(935139);e.s(["SkeletonContainer",0,e=>{let{className:l,children:n,...s}=e;return(0,t.jsx)("div",{className:(0,a.cn)("flex flex-col gap-1",l),...s,children:n})},"SkeletonPoint",0,e=>{let{className:l,...n}=e;return(0,t.jsx)("div",{className:(0,a.cn)("text-xs font-medium text-text-quaternary",l),...n,children:"Â·"})},"SkeletonRectangle",0,e=>{let{className:l,children:n,...s}=e;return(0,t.jsx)("div",{className:(0,a.cn)("my-1 h-2 rounded-sm bg-text-quaternary opacity-20",l),...s,children:n})},"SkeletonRow",0,e=>{let{className:l,children:n,...s}=e;return(0,t.jsx)("div",{className:(0,a.cn)("flex items-center gap-2",l),...s,children:n})}])},508110,e=>{"use strict";var t=e.i(340801);e.s(["Mcp",()=>t.default])},523614,e=>{"use strict";var t=e.i(36503);e.s(["compareVersion",0,(e,a)=>t.default.compare(e,a),"getLatestVersion",0,e=>t.default.rsort(e)[0],"isEqualOrLaterThanVersion",0,(e,a)=>t.default.gte(e,a)])},908132,e=>{"use strict";var t=e.i(137667),a=e.i(925521),l=e.i(887460),n=e.i(523614);let s=e=>e.map(e=>({tag_name:e.tag_name,assets:e.assets.map(e=>({browser_download_url:e.browser_download_url,name:e.name}))}));e.s(["useGitHubReleases",0,()=>({fetchReleases:async(e,l)=>{try{if(a.GITHUB_ACCESS_TOKEN){let t=await fetch(`/repos/${e}/${l}/releases`),a=await t.json();if(200!==a.status)throw Error(a.data.message);return s(a.data)}{let t=await fetch(`https://api.github.com/repos/${e}/${l}/releases`);if(!t.ok)throw Error("Failed to fetch repository releases");let a=await t.json();return s(a)}}catch(e){return e instanceof Error?t.default.notify({type:"error",message:e.message}):t.default.notify({type:"error",message:"Failed to fetch repository releases"}),[]}},checkForUpdates:(e,t)=>{let a=!1,l={type:"info",message:"No new version available"};if(0===e.length)return l.type="error",l.message="Input releases is empty",{needUpdate:a,toastProps:l};let s=e.map(e=>e.tag_name),r=(0,n.getLatestVersion)(s);try{(a=1===(0,n.compareVersion)(r,t))&&(l.message=`New version available: ${r}`)}catch{a=!1,l.type="error",l.message="Fail to compare versions, please check the version format"}return{needUpdate:a,toastProps:l}}}),"useGitHubUpload",0,()=>({handleUpload:async(e,a,n,s)=>{try{let t=await (0,l.uploadGitHub)(e,a,n),r={manifest:t.manifest,unique_identifier:t.unique_identifier};return s&&s(r),r}catch(e){throw t.default.notify({type:"error",message:"Error uploading package"}),e}}})])},583926,e=>{"use strict";var t,a=e.i(563199),l=e.i(268255);e.i(152567);var n=e.i(408767),s=e.i(500536),r=e.i(151094),i=e.i(21151),o=e.i(365181),u=e.i(745754),c=e.i(228403),d=e.i(887460),p=e.i(157644),f=e.i(935139),m=e.i(137667),g=e.i(222573),h=e.i(944911);let x="autoUpdate.pluginDowngradeWarning",v=e=>{let{onCancel:t,onJustDowngrade:l,onExcludeAndDowngrade:s}=e,{t:i}=(0,n.useTranslation)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col items-start gap-2 self-stretch",children:[(0,a.jsx)("div",{className:"title-2xl-semi-bold text-text-primary",children:i(`${x}.title`,{ns:"plugin"})}),(0,a.jsx)("div",{className:"system-md-regular text-text-secondary",children:i(`${x}.description`,{ns:"plugin"})})]}),(0,a.jsxs)("div",{className:"mt-9 flex items-start justify-end space-x-2 self-stretch",children:[(0,a.jsx)(r.default,{variant:"secondary",onClick:()=>t(),children:i("newApp.Cancel",{ns:"app"})}),(0,a.jsx)(r.default,{variant:"secondary",destructive:!0,onClick:l,children:i(`${x}.downgrade`,{ns:"plugin"})}),(0,a.jsx)(r.default,{variant:"primary",onClick:s,children:i(`${x}.exclude`,{ns:"plugin"})})]})]})},y="upgrade";var b=((t=b||{}).notStarted="notStarted",t.upgrading="upgrading",t.installed="installed",t);let F=l.memo(e=>{let{payload:t,pluginId:x,onSave:b,onCancel:F,isShowDowngradeWarningModal:w}=e,{originalPackageInfo:S,targetPackageInfo:j}=t,{t:k}=(0,n.useTranslation)(),{getIconUrl:E}=(0,g.default)(),[I,P]=(0,l.useState)(S.payload.icon);(0,l.useEffect)(()=>{(async()=>{P(await E(S.payload.icon))})()},[S,E]);let{check:T,stop:C}=(0,u.default)(),[N,R]=(0,l.useState)("notStarted"),{handleRefetch:H}=(0,p.usePluginTaskList)(t.category),D=(0,l.useMemo)(()=>({notStarted:k(`${y}.upgrade`,{ns:"plugin"}),upgrading:k(`${y}.upgrading`,{ns:"plugin"}),installed:k(`${y}.close`,{ns:"plugin"})})[N],[k,N]),$=(0,l.useCallback)(async()=>{if("notStarted"===N){R("upgrading");try{let{all_installed:e,task_id:t}=await (0,d.updateFromMarketPlace)({original_plugin_unique_identifier:S.id,new_plugin_unique_identifier:j.id});if(e)return void b();H();let{status:a,error:l}=await T({taskId:t,pluginUniqueIdentifier:j.id});if(a===h.TaskStatus.failed)return void m.default.notify({type:"error",message:l});b()}catch(e){R("notStarted")}return}"installed"===N&&b()},[b,N,T,S.id,H,j.id]),{mutateAsync:G}=(0,p.useRemoveAutoUpgrade)(),U=(0,p.useInvalidateReferenceSettings)(),M=async()=>{x&&await G({plugin_id:x}),U(),$()},L=w&&"notStarted"===N;return(0,a.jsxs)(i.default,{isShow:!0,onClose:F,className:(0,f.cn)("min-w-[560px]",L&&"min-w-[640px]"),closable:!0,title:!L&&k(`${y}.${"installed"===N?"successfulTitle":"title"}`,{ns:"plugin"}),children:[L&&(0,a.jsx)(v,{onCancel:F,onJustDowngrade:$,onExcludeAndDowngrade:M}),!L&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"system-md-regular mb-2 mt-3 text-text-secondary",children:k(`${y}.description`,{ns:"plugin"})}),(0,a.jsx)("div",{className:"flex flex-wrap content-start items-start gap-1 self-stretch rounded-2xl bg-background-section-burn p-2",children:(0,a.jsx)(o.default,{installed:"installed"===N,payload:(0,c.pluginManifestToCardPluginProps)({...S.payload,icon:I}),className:"w-full",titleLeft:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(s.default,{className:"mx-1",size:"s",state:s.BadgeState.Warning,children:`${S.payload.version} -> ${j.version}`})})})}),(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2 self-stretch pt-5",children:["notStarted"===N&&(0,a.jsx)(r.default,{onClick:()=>{C(),F()},children:k("operation.cancel",{ns:"common"})}),(0,a.jsx)(r.default,{variant:"primary",loading:"upgrading"===N,onClick:$,disabled:"upgrading"===N,children:D})]})]})]})});e.s(["default",0,F],583926)},622085,e=>{"use strict";var t=e.i(563199),a=e.i(268255);e.i(152567);var l=e.i(408767),n=e.i(21151),s=e.i(137667),r=e.i(222573),i=e.i(935139),o=e.i(944911),u=e.i(568349),c=e.i(908132),d=e.i(664826),p=e.i(632717),f=e.i(228403),m=e.i(837699),g=e.i(151094),h=e.i(99649),x=e.i(887460),v=e.i(157644),y=e.i(365181),b=e.i(745754),F=e.i(292005);let w="installModal",S=e=>{let{updatePayload:n,uniqueIdentifier:s,payload:r,repoUrl:i,selectedVersion:u,selectedPackage:c,onBack:d,onStartToInstall:p,onInstalled:S,onFailed:j}=e,{t:k}=(0,l.useTranslation)(),E=r.version,I=r.plugin_id,{installedInfo:P,isLoading:T}=(0,h.default)({pluginIds:[I],enabled:!!I}),C=P?.[I],N=C?.installedVersion,R=!!N,[H,D]=a.useState(!1),{mutateAsync:$}=(0,v.useInstallPackageFromGitHub)(),{handleRefetch:G}=(0,v.usePluginTaskList)(r.category),{check:U}=(0,b.default)();(0,a.useEffect)(()=>{R&&s===C.uniqueIdentifier&&S()},[R]);let M=async()=>{if(!H){D(!0),p?.();try{let e,t,{owner:a,repo:l}=(0,f.parseGitHubUrl)(i);if(n){let{all_installed:r,task_id:i}=await (0,x.updateFromGitHub)(`${a}/${l}`,u,c,n.originalPackageInfo.id,s);e=i,t=r}else if(R){let{all_installed:n,task_id:r}=await (0,x.updateFromGitHub)(`${a}/${l}`,u,c,C.uniqueIdentifier,s);e=r,t=n}else{let{all_installed:n,task_id:r}=await $({repoUrl:`${a}/${l}`,selectedVersion:u,selectedPackage:c,uniqueIdentifier:s});e=r,t=n}if(t)return void S();G();let{status:r,error:d}=await U({taskId:e,pluginUniqueIdentifier:s});if(r===o.TaskStatus.failed)return void j(d);S(!0)}catch(e){if("string"==typeof e)return void j(e);j()}finally{D(!1)}}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"system-md-regular text-text-secondary",children:(0,t.jsx)("p",{children:k(`${w}.readyToInstall`,{ns:"plugin"})})}),(0,t.jsx)("div",{className:"flex flex-wrap content-start items-start gap-1 self-stretch rounded-2xl bg-background-section-burn p-2",children:(0,t.jsx)(y.default,{className:"w-full",payload:(0,f.pluginManifestToCardPluginProps)(r),titleLeft:!T&&(0,t.jsx)(F.default,{hasInstalled:R,installedVersion:N,toInstallVersion:E})})}),(0,t.jsxs)("div",{className:"mt-4 flex items-center justify-end gap-2 self-stretch",children:[!H&&(0,t.jsx)(g.default,{variant:"secondary",className:"min-w-[72px]",onClick:d,children:k("installModal.back",{ns:"plugin"})}),(0,t.jsxs)(g.default,{variant:"primary",className:"flex min-w-[72px] space-x-0.5",onClick:M,disabled:H||T,children:[H&&(0,t.jsx)(m.RiLoader2Line,{className:"h-4 w-4 animate-spin-slow"}),(0,t.jsx)("span",{children:k(`${w}.${H?"installing":"install"}`,{ns:"plugin"})})]})]})]})};var j=e.i(299951);let k="installFromGitHub",E=e=>{let{updatePayload:n,repoUrl:s,selectedVersion:r,versions:i,onSelectVersion:o,selectedPackage:u,packages:d,onSelectPackage:p,onUploaded:f,onFailed:m,onBack:h}=e,{t:x}=(0,l.useTranslation)(),v=!!n,[y,b]=a.useState(!1),{handleUpload:F}=(0,c.useGitHubUpload)(),w=async()=>{if(!y){b(!0);try{let e=s.replace("https://github.com/","");await F(e,r,u,e=>{f({uniqueIdentifier:e.unique_identifier,manifest:e.manifest})})}catch(e){e.response?.message?m(e.response?.message):m(x(`${k}.uploadFailed`,{ns:"plugin"}))}finally{b(!1)}}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("label",{htmlFor:"version",className:"flex flex-col items-start justify-center self-stretch text-text-secondary",children:(0,t.jsx)("span",{className:"system-sm-semibold",children:x(`${k}.selectVersion`,{ns:"plugin"})})}),(0,t.jsx)(j.PortalSelect,{value:r,onSelect:o,items:i,installedValue:n?.originalPackageInfo.version,placeholder:x(`${k}.selectVersionPlaceholder`,{ns:"plugin"})||"",popupClassName:"w-[512px] z-[1001]",triggerClassName:"text-components-input-text-filled"}),(0,t.jsx)("label",{htmlFor:"package",className:"flex flex-col items-start justify-center self-stretch text-text-secondary",children:(0,t.jsx)("span",{className:"system-sm-semibold",children:x(`${k}.selectPackage`,{ns:"plugin"})})}),(0,t.jsx)(j.PortalSelect,{value:u,onSelect:p,items:d,readonly:!r,placeholder:x(`${k}.selectPackagePlaceholder`,{ns:"plugin"})||"",popupClassName:"w-[512px] z-[1001]",triggerClassName:"text-components-input-text-filled"}),(0,t.jsxs)("div",{className:"mt-4 flex items-center justify-end gap-2 self-stretch",children:[!v&&(0,t.jsx)(g.default,{variant:"secondary",className:"min-w-[72px]",onClick:h,disabled:y,children:x("installModal.back",{ns:"plugin"})}),(0,t.jsx)(g.default,{variant:"primary",className:"min-w-[72px]",onClick:w,disabled:!r||!u||y,children:x("installModal.next",{ns:"plugin"})})]})]})},I=e=>{let{repoUrl:a,onChange:n,onNext:s,onCancel:r}=e,{t:i}=(0,l.useTranslation)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("label",{htmlFor:"repoUrl",className:"flex flex-col items-start justify-center self-stretch text-text-secondary",children:(0,t.jsx)("span",{className:"system-sm-semibold",children:i("installFromGitHub.gitHubRepo",{ns:"plugin"})})}),(0,t.jsx)("input",{type:"url",id:"repoUrl",name:"repoUrl",value:a,onChange:e=>n(e.target.value),className:"shadows-shadow-xs system-sm-regular flex grow items-center gap-[2px] self-stretch overflow-hidden text-ellipsis rounded-lg border border-components-input-border-active bg-components-input-bg-active p-2 text-components-input-text-filled",placeholder:"Please enter GitHub repo URL"}),(0,t.jsxs)("div",{className:"mt-4 flex items-center justify-end gap-2 self-stretch",children:[(0,t.jsx)(g.default,{variant:"secondary",className:"min-w-[72px]",onClick:r,children:i("installModal.cancel",{ns:"plugin"})}),(0,t.jsx)(g.default,{variant:"primary",className:"min-w-[72px]",onClick:s,disabled:!a.trim(),children:i("installModal.next",{ns:"plugin"})})]})]})},P="installFromGitHub";e.s(["default",0,e=>{let{updatePayload:m,onClose:g,onSuccess:h}=e,{t:x}=(0,l.useTranslation)(),{getIconUrl:v}=(0,r.default)(),{fetchReleases:y}=(0,c.useGitHubReleases)(),{refreshPluginList:b}=(0,p.default)(),{modalClassName:F,foldAnimInto:w,setIsInstalling:j,handleStartToInstall:k}=(0,d.default)(g),[T,C]=(0,a.useState)({step:m?o.InstallStepFromGitHub.selectPackage:o.InstallStepFromGitHub.setUrl,repoUrl:m?.originalPackageInfo?.repo?(0,f.convertRepoToUrl)(m.originalPackageInfo.repo):"",selectedVersion:"",selectedPackage:"",releases:m?m.originalPackageInfo.releases:[]}),[N,R]=(0,a.useState)(null),[H,D]=(0,a.useState)(null),[$,G]=(0,a.useState)(null),U=T.releases.map(e=>({value:e.tag_name,name:e.tag_name})),M=T.selectedVersion&&T.releases.find(e=>e.tag_name===T.selectedVersion)?.assets.map(e=>({value:e.name,name:e.name}))||[],L=(0,a.useCallback)(()=>T.step===o.InstallStepFromGitHub.installed?x(`${P}.installedSuccessfully`,{ns:"plugin"}):T.step===o.InstallStepFromGitHub.installFailed?x(`${P}.installFailed`,{ns:"plugin"}):m?x(`${P}.updatePlugin`,{ns:"plugin"}):x(`${P}.installPlugin`,{ns:"plugin"}),[T.step,x,m]),_=async()=>{let{isValid:e,owner:t,repo:a}=(0,f.parseGitHubUrl)(T.repoUrl);if(!e||!t||!a)return void s.default.notify({type:"error",message:x("error.inValidGitHubUrl",{ns:"plugin"})});try{let e=await y(t,a);e.length>0?C(t=>({...t,releases:e,step:o.InstallStepFromGitHub.selectPackage})):s.default.notify({type:"error",message:x("error.noReleasesFound",{ns:"plugin"})})}catch{s.default.notify({type:"error",message:x("error.fetchReleasesError",{ns:"plugin"})})}},V=async e=>{try{let t=await v(e.manifest.icon);D({...e.manifest,icon:t}),R(e.uniqueIdentifier),C(e=>({...e,step:o.InstallStepFromGitHub.readyToInstall}))}catch(e){G(e?.response?.message||x("installModal.installFailedDesc",{ns:"plugin"})),C(e=>({...e,step:(0,o.InstallStepFromGitHub.uploadFailed)}))}},A=(0,a.useCallback)(e=>{G(e),C(e=>({...e,step:o.InstallStepFromGitHub.uploadFailed}))},[]),O=(0,a.useCallback)(e=>{C(e=>({...e,step:o.InstallStepFromGitHub.installed})),e||b(H),j(!1),h()},[H,h,b,j]),q=(0,a.useCallback)(e=>{C(e=>({...e,step:o.InstallStepFromGitHub.installFailed})),j(!1),e&&G(e)},[j]),W=()=>{C(e=>{switch(e.step){case o.InstallStepFromGitHub.selectPackage:return{...e,step:o.InstallStepFromGitHub.setUrl};case o.InstallStepFromGitHub.readyToInstall:return{...e,step:o.InstallStepFromGitHub.selectPackage};default:return e}})};return(0,t.jsxs)(n.default,{isShow:!0,onClose:w,className:(0,i.cn)(F,`shadows-shadow-xl flex min-w-[560px] flex-col items-start rounded-2xl border-[0.5px]
        border-components-panel-border bg-components-panel-bg p-0`),closable:!0,children:[(0,t.jsx)("div",{className:"flex items-start gap-2 self-stretch pb-3 pl-6 pr-14 pt-6",children:(0,t.jsxs)("div",{className:"flex grow flex-col items-start gap-1",children:[(0,t.jsx)("div",{className:"title-2xl-semi-bold self-stretch text-text-primary",children:L()}),(0,t.jsx)("div",{className:"system-xs-regular self-stretch text-text-tertiary",children:![o.InstallStepFromGitHub.uploadFailed,o.InstallStepFromGitHub.installed,o.InstallStepFromGitHub.installFailed].includes(T.step)&&x("installFromGitHub.installNote",{ns:"plugin"})})]})}),[o.InstallStepFromGitHub.uploadFailed,o.InstallStepFromGitHub.installed,o.InstallStepFromGitHub.installFailed].includes(T.step)?(0,t.jsx)(u.default,{payload:H,isFailed:[o.InstallStepFromGitHub.uploadFailed,o.InstallStepFromGitHub.installFailed].includes(T.step),errMsg:$,onCancel:g}):(0,t.jsxs)("div",{className:`flex flex-col items-start justify-center self-stretch px-6 py-3 ${T.step===o.InstallStepFromGitHub.installed?"gap-2":"gap-4"}`,children:[T.step===o.InstallStepFromGitHub.setUrl&&(0,t.jsx)(I,{repoUrl:T.repoUrl,onChange:e=>C(t=>({...t,repoUrl:e})),onNext:_,onCancel:g}),T.step===o.InstallStepFromGitHub.selectPackage&&(0,t.jsx)(E,{updatePayload:m,repoUrl:T.repoUrl,selectedVersion:T.selectedVersion,versions:U,onSelectVersion:e=>C(t=>({...t,selectedVersion:e.value})),selectedPackage:T.selectedPackage,packages:M,onSelectPackage:e=>C(t=>({...t,selectedPackage:e.value})),onUploaded:V,onFailed:A,onBack:W}),T.step===o.InstallStepFromGitHub.readyToInstall&&(0,t.jsx)(S,{updatePayload:m,uniqueIdentifier:N,payload:H,repoUrl:T.repoUrl,selectedVersion:T.selectedVersion,selectedPackage:T.selectedPackage,onBack:W,onStartToInstall:k,onInstalled:O,onFailed:q})]})]})}],622085)},144226,e=>{"use strict";var t=e.i(563199),a=e.i(268255),l=e.i(944911),n=e.i(622085);let s=a.memo(e=>{let{payload:a,onSave:l,onCancel:s}=e;return(0,t.jsx)(n.default,{updatePayload:a,onClose:s,onSuccess:l})});var r=e.i(583926);let i=a.memo(e=>{let{type:a,marketPlace:n,github:i,onCancel:o,onSave:u}=e;return a===l.PluginSource.github?(0,t.jsx)(s,{payload:i,onSave:u,onCancel:o}):(0,t.jsx)(r.default,{payload:n,onSave:u,onCancel:o})});e.s(["default",0,i],144226)},43994,e=>{e.n(e.i(144226))}]);