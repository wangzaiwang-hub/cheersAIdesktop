(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,166607,e=>{e.v({codeBrowserIcon:"style-module__vuZ-gq__codeBrowserIcon",generateLogo:"style-module__vuZ-gq__generateLogo",refreshIcon:"style-module__vuZ-gq__refreshIcon",rotate:"style-module__vuZ-gq__rotate"})},476054,303084,e=>{"use strict";let t,s;var a,r,l,i,n,o=e.i(563199),d=e.i(726371),c=e.i(250755),p=e.i(326531),m=e.i(268255),u=e.i(908432),x=e.i(189299),h=e.i(249420),f=e.i(271743),v=e.i(935139),g=e.i(757198);e.i(905691);var y=e.i(706416),b=e.i(837699),w=e.i(233697);e.i(152567);var j=e.i(408767),N=e.i(339548),C=e.i(159639),A=e.i(151094),k=e.i(547105),E=e.i(772499),_=Object.defineProperty,M=Object.getOwnPropertySymbols,S=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,I=(e,t,s)=>t in e?_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,O=(e,t)=>{for(var s in t||(t={}))S.call(t,s)&&I(e,s,t[s]);if(M)for(var s of M(t))T.call(t,s)&&I(e,s,t[s]);return e},R=(e,t)=>{var s={};for(var a in e)S.call(e,a)&&0>t.indexOf(a)&&(s[a]=e[a]);if(null!=e&&M)for(var a of M(e))0>t.indexOf(a)&&T.call(e,a)&&(s[a]=e[a]);return s};(e=>{let t=class t{constructor(e,s,a,l){if(this.version=e,this.errorCorrectionLevel=s,this.modules=[],this.isFunction=[],e<t.MIN_VERSION||e>t.MAX_VERSION)throw RangeError("Version value out of range");if(l<-1||l>7)throw RangeError("Mask value out of range");this.size=4*e+17;let i=[];for(let e=0;e<this.size;e++)i.push(!1);for(let e=0;e<this.size;e++)this.modules.push(i.slice()),this.isFunction.push(i.slice());this.drawFunctionPatterns();const n=this.addEccAndInterleave(a);if(this.drawCodewords(n),-1==l){let e=1e9;for(let t=0;t<8;t++){this.applyMask(t),this.drawFormatBits(t);const s=this.getPenaltyScore();s<e&&(l=t,e=s),this.applyMask(t)}}r(0<=l&&l<=7),this.mask=l,this.applyMask(l),this.drawFormatBits(l),this.isFunction=[]}static encodeText(s,a){let r=e.QrSegment.makeSegments(s);return t.encodeSegments(r,a)}static encodeBinary(s,a){let r=e.QrSegment.makeBytes(s);return t.encodeSegments([r],a)}static encodeSegments(e,a){let l,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,p=!(arguments.length>5)||void 0===arguments[5]||arguments[5];if(!(t.MIN_VERSION<=o&&o<=d&&d<=t.MAX_VERSION)||c<-1||c>7)throw RangeError("Invalid value");for(l=o;;l++){let s=8*t.getNumDataCodewords(l,a),r=i.getTotalBits(e,l);if(r<=s){n=r;break}if(l>=d)throw RangeError("Data too long")}for(let e of[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH])p&&n<=8*t.getNumDataCodewords(l,e)&&(a=e);let m=[];for(let t of e)for(let e of(s(t.mode.modeBits,4,m),s(t.numChars,t.mode.numCharCountBits(l),m),t.getData()))m.push(e);r(m.length==n);let u=8*t.getNumDataCodewords(l,a);r(m.length<=u),s(0,Math.min(4,u-m.length),m),s(0,(8-m.length%8)%8,m),r(m.length%8==0);for(let e=236;m.length<u;e^=253)s(e,8,m);let x=[];for(;8*x.length<m.length;)x.push(0);return m.forEach((e,t)=>x[t>>>3]|=e<<7-(7&t)),new t(l,a,x,c)}getModule(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);let e=this.getAlignmentPatternPositions(),t=e.length;for(let s=0;s<t;s++)for(let a=0;a<t;a++)(0!=s||0!=a)&&(0!=s||a!=t-1)&&(s!=t-1||0!=a)&&this.drawAlignmentPattern(e[s],e[a]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){let t=this.errorCorrectionLevel.formatBits<<3|e,s=t;for(let e=0;e<10;e++)s=s<<1^(s>>>9)*1335;let l=(t<<10|s)^21522;r(l>>>15==0);for(let e=0;e<=5;e++)this.setFunctionModule(8,e,a(l,e));this.setFunctionModule(8,7,a(l,6)),this.setFunctionModule(8,8,a(l,7)),this.setFunctionModule(7,8,a(l,8));for(let e=9;e<15;e++)this.setFunctionModule(14-e,8,a(l,e));for(let e=0;e<8;e++)this.setFunctionModule(this.size-1-e,8,a(l,e));for(let e=8;e<15;e++)this.setFunctionModule(8,this.size-15+e,a(l,e));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let t=0;t<12;t++)e=e<<1^(e>>>11)*7973;let t=this.version<<12|e;r(t>>>18==0);for(let e=0;e<18;e++){let s=a(t,e),r=this.size-11+e%3,l=Math.floor(e/3);this.setFunctionModule(r,l,s),this.setFunctionModule(l,r,s)}}drawFinderPattern(e,t){for(let s=-4;s<=4;s++)for(let a=-4;a<=4;a++){let r=Math.max(Math.abs(a),Math.abs(s)),l=e+a,i=t+s;0<=l&&l<this.size&&0<=i&&i<this.size&&this.setFunctionModule(l,i,2!=r&&4!=r)}}drawAlignmentPattern(e,t){for(let s=-2;s<=2;s++)for(let a=-2;a<=2;a++)this.setFunctionModule(e+a,t+s,1!=Math.max(Math.abs(a),Math.abs(s)))}setFunctionModule(e,t,s){this.modules[t][e]=s,this.isFunction[t][e]=!0}addEccAndInterleave(e){let s=this.version,a=this.errorCorrectionLevel;if(e.length!=t.getNumDataCodewords(s,a))throw RangeError("Invalid argument");let l=t.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][s],i=t.ECC_CODEWORDS_PER_BLOCK[a.ordinal][s],n=Math.floor(t.getNumRawDataModules(s)/8),o=l-n%l,d=Math.floor(n/l),c=[],p=t.reedSolomonComputeDivisor(i);for(let s=0,a=0;s<l;s++){let r=e.slice(a,a+d-i+(s<o?0:1));a+=r.length;let l=t.reedSolomonComputeRemainder(r,p);s<o&&r.push(0),c.push(r.concat(l))}let m=[];for(let e=0;e<c[0].length;e++)c.forEach((t,s)=>{(e!=d-i||s>=o)&&m.push(t[e])});return r(m.length==n),m}drawCodewords(e){if(e.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw RangeError("Invalid argument");let s=0;for(let t=this.size-1;t>=1;t-=2){6==t&&(t=5);for(let r=0;r<this.size;r++)for(let l=0;l<2;l++){let i=t-l,n=(t+1&2)==0?this.size-1-r:r;!this.isFunction[n][i]&&s<8*e.length&&(this.modules[n][i]=a(e[s>>>3],7-(7&s)),s++)}}r(s==8*e.length)}applyMask(e){if(e<0||e>7)throw RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let s=0;s<this.size;s++){let a;switch(e){case 0:a=(s+t)%2==0;break;case 1:a=t%2==0;break;case 2:a=s%3==0;break;case 3:a=(s+t)%3==0;break;case 4:a=(Math.floor(s/3)+Math.floor(t/2))%2==0;break;case 5:a=s*t%2+s*t%3==0;break;case 6:a=(s*t%2+s*t%3)%2==0;break;case 7:a=((s+t)%2+s*t%3)%2==0;break;default:throw Error("Unreachable")}!this.isFunction[t][s]&&a&&(this.modules[t][s]=!this.modules[t][s])}}getPenaltyScore(){let e=0;for(let s=0;s<this.size;s++){let a=!1,r=0,l=[0,0,0,0,0,0,0];for(let i=0;i<this.size;i++)this.modules[s][i]==a?5==++r?e+=t.PENALTY_N1:r>5&&e++:(this.finderPenaltyAddHistory(r,l),a||(e+=this.finderPenaltyCountPatterns(l)*t.PENALTY_N3),a=this.modules[s][i],r=1);e+=this.finderPenaltyTerminateAndCount(a,r,l)*t.PENALTY_N3}for(let s=0;s<this.size;s++){let a=!1,r=0,l=[0,0,0,0,0,0,0];for(let i=0;i<this.size;i++)this.modules[i][s]==a?5==++r?e+=t.PENALTY_N1:r>5&&e++:(this.finderPenaltyAddHistory(r,l),a||(e+=this.finderPenaltyCountPatterns(l)*t.PENALTY_N3),a=this.modules[i][s],r=1);e+=this.finderPenaltyTerminateAndCount(a,r,l)*t.PENALTY_N3}for(let s=0;s<this.size-1;s++)for(let a=0;a<this.size-1;a++){let r=this.modules[s][a];r==this.modules[s][a+1]&&r==this.modules[s+1][a]&&r==this.modules[s+1][a+1]&&(e+=t.PENALTY_N2)}let s=0;for(let e of this.modules)s=e.reduce((e,t)=>e+ +!!t,s);let a=this.size*this.size,l=Math.ceil(Math.abs(20*s-10*a)/a)-1;return r(0<=l&&l<=9),r(0<=(e+=l*t.PENALTY_N4)&&e<=2568888),e}getAlignmentPatternPositions(){if(1==this.version)return[];{let e=Math.floor(this.version/7)+2,t=32==this.version?26:2*Math.ceil((4*this.version+4)/(2*e-2)),s=[6];for(let a=this.size-7;s.length<e;a-=t)s.splice(1,0,a);return s}}static getNumRawDataModules(e){if(e<t.MIN_VERSION||e>t.MAX_VERSION)throw RangeError("Version number out of range");let s=(16*e+128)*e+64;if(e>=2){let t=Math.floor(e/7)+2;s-=(25*t-10)*t-55,e>=7&&(s-=36)}return r(208<=s&&s<=29648),s}static getNumDataCodewords(e,s){return Math.floor(t.getNumRawDataModules(e)/8)-t.ECC_CODEWORDS_PER_BLOCK[s.ordinal][e]*t.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw RangeError("Degree out of range");let s=[];for(let t=0;t<e-1;t++)s.push(0);s.push(1);let a=1;for(let r=0;r<e;r++){for(let e=0;e<s.length;e++)s[e]=t.reedSolomonMultiply(s[e],a),e+1<s.length&&(s[e]^=s[e+1]);a=t.reedSolomonMultiply(a,2)}return s}static reedSolomonComputeRemainder(e,s){let a=s.map(e=>0);for(let r of e){let e=r^a.shift();a.push(0),s.forEach((s,r)=>a[r]^=t.reedSolomonMultiply(s,e))}return a}static reedSolomonMultiply(e,t){if(e>>>8!=0||t>>>8!=0)throw RangeError("Byte out of range");let s=0;for(let a=7;a>=0;a--)s=s<<1^(s>>>7)*285^(t>>>a&1)*e;return r(s>>>8==0),s}finderPenaltyCountPatterns(e){let t=e[1];r(t<=3*this.size);let s=t>0&&e[2]==t&&e[3]==3*t&&e[4]==t&&e[5]==t;return(s&&e[0]>=4*t&&e[6]>=t?1:0)+(s&&e[6]>=4*t&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,s){return e&&(this.finderPenaltyAddHistory(t,s),t=0),t+=this.size,this.finderPenaltyAddHistory(t,s),this.finderPenaltyCountPatterns(s)}finderPenaltyAddHistory(e,t){0==t[0]&&(e+=this.size),t.pop(),t.unshift(e)}};function s(e,t,s){if(t<0||t>31||e>>>t!=0)throw RangeError("Value out of range");for(let a=t-1;a>=0;a--)s.push(e>>>a&1)}function a(e,t){return(e>>>t&1)!=0}function r(e){if(!e)throw Error("Assertion error")}t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;let l=class e{constructor(e,t,s){if(this.mode=e,this.numChars=t,this.bitData=s,t<0)throw RangeError("Invalid argument");this.bitData=s.slice()}static makeBytes(t){let a=[];for(let e of t)s(e,8,a);return new e(e.Mode.BYTE,t.length,a)}static makeNumeric(t){if(!e.isNumeric(t))throw RangeError("String contains non-numeric characters");let a=[];for(let e=0;e<t.length;){let r=Math.min(t.length-e,3);s(parseInt(t.substring(e,e+r),10),3*r+1,a),e+=r}return new e(e.Mode.NUMERIC,t.length,a)}static makeAlphanumeric(t){let a;if(!e.isAlphanumeric(t))throw RangeError("String contains unencodable characters in alphanumeric mode");let r=[];for(a=0;a+2<=t.length;a+=2){let l=45*e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a));s(l+=e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a+1)),11,r)}return a<t.length&&s(e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a)),6,r),new e(e.Mode.ALPHANUMERIC,t.length,r)}static makeSegments(t){return""==t?[]:e.isNumeric(t)?[e.makeNumeric(t)]:e.isAlphanumeric(t)?[e.makeAlphanumeric(t)]:[e.makeBytes(e.toUtf8ByteArray(t))]}static makeEci(t){let a=[];if(t<0)throw RangeError("ECI assignment value out of range");if(t<128)s(t,8,a);else if(t<16384)s(2,2,a),s(t,14,a);else if(t<1e6)s(6,3,a),s(t,21,a);else throw RangeError("ECI assignment value out of range");return new e(e.Mode.ECI,0,a)}static isNumeric(t){return e.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return e.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(e,t){let s=0;for(let a of e){let e=a.mode.numCharCountBits(t);if(a.numChars>=1<<e)return 1/0;s+=4+e+a.bitData.length}return s}static toUtf8ByteArray(e){e=encodeURI(e);let t=[];for(let s=0;s<e.length;s++)"%"!=e.charAt(s)?t.push(e.charCodeAt(s)):(t.push(parseInt(e.substring(s+1,s+3),16)),s+=2);return t}};l.NUMERIC_REGEX=/^[0-9]*$/,l.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,l.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let i=l;e.QrSegment=l})(n||(n={})),r=(a=n||(n={})).QrCode||(a.QrCode={}),(t=class{constructor(e,t){this.ordinal=e,this.formatBits=t}}).LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),r.Ecc=t,i=(l=n||(n={})).QrSegment||(l.QrSegment={}),(s=class{constructor(e,t){this.modeBits=e,this.numBitsCharCount=t}numCharCountBits(e){return this.numBitsCharCount[Math.floor((e+7)/17)]}}).NUMERIC=new s(1,[10,12,14]),s.ALPHANUMERIC=new s(2,[9,11,13]),s.BYTE=new s(4,[8,16,16]),s.KANJI=new s(8,[8,10,12]),s.ECI=new s(7,[0,0,0]),i.Mode=s;var P=n,D={L:P.QrCode.Ecc.LOW,M:P.QrCode.Ecc.MEDIUM,Q:P.QrCode.Ecc.QUARTILE,H:P.QrCode.Ecc.HIGH},L="#FFFFFF",F="#000000";function z(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=[];return e.forEach(function(e,a){let r=null;e.forEach(function(l,i){if(!l&&null!==r){s.push(`M${r+t} ${a+t}h${i-r}v1H${r+t}z`),r=null;return}if(i===e.length-1){if(!l)return;null===r?s.push(`M${i+t},${a+t} h1v1H${i+t}z`):s.push(`M${r+t},${a+t} h${i+1-r}v1H${r+t}z`);return}l&&null===r&&(r=i)})}),s.join("")}function $(e,t){return e.slice().map((e,s)=>s<t.y||s>=t.y+t.h?e:e.map((e,s)=>(s<t.x||s>=t.x+t.w)&&e))}function B(e){let{value:t,level:s,minVersion:a,includeMargin:r,marginSize:l,imageSettings:i,size:n,boostLevel:o}=e,d=m.default.useMemo(()=>{let e=(Array.isArray(t)?t:[t]).reduce((e,t)=>(e.push(...P.QrSegment.makeSegments(t)),e),[]);return P.QrCode.encodeSegments(e,D[s],a,void 0,void 0,o)},[t,s,a,o]),{cells:c,margin:p,numCells:u,calculatedImageSettings:x}=m.default.useMemo(()=>{let e=d.getModules(),t=null!=l?Math.max(Math.floor(l),0):4*!!r,s=e.length+2*t,a=function(e,t,s,a){if(null==a)return null;let r=e.length+2*s,l=Math.floor(.1*t),i=r/t,n=(a.width||l)*i,o=(a.height||l)*i,d=null==a.x?e.length/2-n/2:a.x*i,c=null==a.y?e.length/2-o/2:a.y*i,p=null==a.opacity?1:a.opacity,m=null;if(a.excavate){let e=Math.floor(d),t=Math.floor(c),s=Math.ceil(n+d-e),a=Math.ceil(o+c-t);m={x:e,y:t,w:s,h:a}}return{x:d,y:c,h:o,w:n,excavation:m,opacity:p,crossOrigin:a.crossOrigin}}(e,n,t,i);return{cells:e,margin:t,numCells:s,calculatedImageSettings:a}},[d,n,i,r,l]);return{qrcode:d,margin:p,cells:c,numCells:u,calculatedImageSettings:x}}var U=function(){try{new Path2D().addPath(new Path2D)}catch(e){return!1}return!0}(),H=m.default.forwardRef(function(e,t){let{value:s,size:a=128,level:r="L",bgColor:l=L,fgColor:i=F,includeMargin:n=!1,minVersion:o=1,boostLevel:d,marginSize:c,imageSettings:p}=e,u=R(e,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:x}=u,h=R(u,["style"]),f=null==p?void 0:p.src,v=m.default.useRef(null),g=m.default.useRef(null),y=m.default.useCallback(e=>{v.current=e,"function"==typeof t?t(e):t&&(t.current=e)},[t]),[b,w]=m.default.useState(!1),{margin:j,cells:N,numCells:C,calculatedImageSettings:A}=B({value:s,level:r,minVersion:o,boostLevel:d,includeMargin:n,marginSize:c,imageSettings:p,size:a});m.default.useEffect(()=>{if(null!=v.current){let e=v.current,t=e.getContext("2d");if(!t)return;let s=N,r=g.current,n=null!=A&&null!==r&&r.complete&&0!==r.naturalHeight&&0!==r.naturalWidth;n&&null!=A.excavation&&(s=$(N,A.excavation));let o=window.devicePixelRatio||1;e.height=e.width=a*o;let d=a/C*o;t.scale(d,d),t.fillStyle=l,t.fillRect(0,0,C,C),t.fillStyle=i,U?t.fill(new Path2D(z(s,j))):N.forEach(function(e,s){e.forEach(function(e,a){e&&t.fillRect(a+j,s+j,1,1)})}),A&&(t.globalAlpha=A.opacity),n&&t.drawImage(r,A.x+j,A.y+j,A.w,A.h)}}),m.default.useEffect(()=>{w(!1)},[f]);let k=O({height:a,width:a},x),E=null;return null!=f&&(E=m.default.createElement("img",{src:f,key:f,style:{display:"none"},onLoad:()=>{w(!0)},ref:g,crossOrigin:null==A?void 0:A.crossOrigin})),m.default.createElement(m.default.Fragment,null,m.default.createElement("canvas",O({style:k,height:a,width:a,ref:y,role:"img"},h)),E)});H.displayName="QRCodeCanvas",m.default.forwardRef(function(e,t){let{value:s,size:a=128,level:r="L",bgColor:l=L,fgColor:i=F,includeMargin:n=!1,minVersion:o=1,boostLevel:d,title:c,marginSize:p,imageSettings:u}=e,x=R(e,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:h,cells:f,numCells:v,calculatedImageSettings:g}=B({value:s,level:r,minVersion:o,boostLevel:d,includeMargin:n,marginSize:p,imageSettings:u,size:a}),y=f,b=null;null!=u&&null!=g&&(null!=g.excavation&&(y=$(f,g.excavation)),b=m.default.createElement("image",{href:u.src,height:g.h,width:g.w,x:g.x+h,y:g.y+h,preserveAspectRatio:"none",opacity:g.opacity,crossOrigin:g.crossOrigin}));let w=z(y,h);return m.default.createElement("svg",O({height:a,width:a,viewBox:`0 0 ${v} ${v}`,ref:t,role:"img"},x),!!c&&m.default.createElement("title",null,c),m.default.createElement("path",{fill:l,d:`M0,0 h${v}v${v}H0z`,shapeRendering:"crispEdges"}),m.default.createElement("path",{fill:i,d:w,shapeRendering:"crispEdges"}),b)}).displayName="QRCodeSVG";var W=e.i(654313),V=e.i(421001),K=e.i(618403);let G=e=>{let{content:t}=e,{t:s}=(0,j.useTranslation)(),[a,r]=(0,m.useState)(!1),l=(0,m.useRef)(null);return(0,m.useEffect)(()=>{let e=e=>{l.current&&!l.current.contains(e.target)&&r(!1)};return a&&document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[a]),(0,o.jsx)(V.default,{popupContent:s("overview.appInfo.qrcode.title",{ns:"appOverview"})||"",children:(0,o.jsxs)("div",{className:"relative h-6 w-6",onClick:e=>{e.stopPropagation(),r(e=>!e)},children:[(0,o.jsx)(W.default,{children:(0,o.jsx)(b.RiQrCodeLine,{className:"h-4 w-4"})}),a&&(0,o.jsxs)("div",{ref:l,className:"absolute -right-8 top-8 z-10 flex w-[232px] flex-col items-center rounded-lg bg-components-panel-bg p-4 shadow-xs",onClick:e=>{e.stopPropagation()},children:[(0,o.jsx)(H,{size:160,value:t,className:"mb-2"}),(0,o.jsxs)("div",{className:"system-xs-regular flex items-center",children:[(0,o.jsx)("div",{className:"text-text-tertiary",children:s("overview.appInfo.qrcode.scan",{ns:"appOverview"})}),(0,o.jsx)("div",{className:"text-text-tertiary",children:"Â·"}),(0,o.jsx)("div",{className:"cursor-pointer text-text-accent-secondary",onClick:()=>{let e=l.current?.querySelector("canvas");e instanceof HTMLCanvasElement&&(0,K.downloadUrl)({url:e.toDataURL(),fileName:"qrcode.png"})},children:s("overview.appInfo.qrcode.download",{ns:"appOverview"})})]})]})]})})};var Q=e.i(260484),q=e.i(648883),Y=e.i(836340),X=e.i(390622),Z=e.i(711536),J=e.i(494268),ee=e.i(683257),et=e.i(752901),es=e.i(927897),ea=e.i(972282),er=e.i(387852),el=e.i(648404),ei=e.i(842090),en=e.i(168014),eo=e.i(203742);let ed=m.forwardRef(function(e,t){let{title:s,titleId:a,...r}=e;return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},r),s?m.createElement("title",{id:a},s):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"}))});var ec=e.i(21151);let ep={green:{text:"text-green-800",bg:"bg-green-100"},yellow:{text:"text-yellow-800",bg:"bg-yellow-100"},red:{text:"text-red-800",bg:"bg-red-100"},gray:{text:"text-gray-800",bg:"bg-gray-100"}};function em(e){let{children:t,color:s="green",className:a="",bordered:r=!1,hideBg:l=!1}=e;return(0,o.jsx)("div",{className:(0,v.cn)("inline-flex shrink-0 items-center rounded-md px-2.5 py-px text-xs leading-5",ep[s]?`${ep[s].text} ${ep[s].bg}`:"",r?"border-[1px]":"",l?"bg-transparent":"",a),children:t})}let eu=e=>{let{children:t}=e;return(0,o.jsx)("div",{className:"mr-3 flex h-7 w-7 shrink-0 items-center justify-center rounded-2xl bg-util-colors-blue-blue-50 text-text-accent",children:t})},ex=e=>{let{className:t}=e;return(0,o.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,o.jsx)("path",{d:"M5.80078 13.7109C5.80078 13.6406 5.73047 13.5703 5.625 13.5703C5.51953 13.5703 5.44922 13.6406 5.44922 13.7109C5.44922 13.7812 5.51953 13.8516 5.625 13.8164C5.73047 13.8164 5.80078 13.7812 5.80078 13.7109ZM4.71094 13.5352C4.71094 13.6055 4.78125 13.7109 4.88672 13.7109C4.95703 13.7461 5.0625 13.7109 5.09766 13.6406C5.09766 13.5703 5.0625 13.5 4.95703 13.4648C4.85156 13.4297 4.74609 13.4648 4.71094 13.5352ZM6.29297 13.5C6.1875 13.5 6.11719 13.5703 6.11719 13.6758C6.11719 13.7461 6.22266 13.7812 6.32812 13.7461C6.43359 13.7109 6.50391 13.6758 6.46875 13.6055C6.46875 13.5352 6.36328 13.4648 6.29297 13.5ZM8.57812 0C3.72656 0 0 3.72656 0 8.57812C0 12.4805 2.42578 15.8203 5.94141 17.0156C6.39844 17.0859 6.53906 16.8047 6.53906 16.5938C6.53906 16.3477 6.53906 15.1523 6.53906 14.4141C6.53906 14.4141 4.07812 14.9414 3.55078 13.3594C3.55078 13.3594 3.16406 12.3398 2.60156 12.0938C2.60156 12.0938 1.79297 11.5312 2.63672 11.5312C2.63672 11.5312 3.51562 11.6016 4.00781 12.4453C4.78125 13.8164 6.04688 13.4297 6.57422 13.1836C6.64453 12.6211 6.85547 12.2344 7.13672 11.9883C5.16797 11.7773 3.16406 11.4961 3.16406 8.12109C3.16406 7.13672 3.44531 6.67969 4.00781 6.04688C3.90234 5.80078 3.62109 4.88672 4.11328 3.65625C4.81641 3.44531 6.53906 4.60547 6.53906 4.60547C7.24219 4.39453 7.98047 4.32422 8.71875 4.32422C9.49219 4.32422 10.2305 4.39453 10.9336 4.60547C10.9336 4.60547 12.6211 3.41016 13.3594 3.65625C13.8516 4.88672 13.5352 5.80078 13.4648 6.04688C14.0273 6.67969 14.3789 7.13672 14.3789 8.12109C14.3789 11.4961 12.3047 11.7773 10.3359 11.9883C10.6523 12.2695 10.9336 12.7969 10.9336 13.6406C10.9336 14.8008 10.8984 16.2773 10.8984 16.5586C10.8984 16.8047 11.0742 17.0859 11.5312 16.9805C15.0469 15.8203 17.4375 12.4805 17.4375 8.57812C17.4375 3.72656 13.4648 0 8.57812 0ZM3.41016 12.1289C3.33984 12.1641 3.375 12.2695 3.41016 12.3398C3.48047 12.375 3.55078 12.4102 3.62109 12.375C3.65625 12.3398 3.65625 12.2344 3.58594 12.1641C3.51562 12.1289 3.44531 12.0938 3.41016 12.1289ZM3.02344 11.8477C2.98828 11.918 3.02344 11.9531 3.09375 11.9883C3.16406 12.0234 3.23438 12.0234 3.26953 11.9531C3.26953 11.918 3.23438 11.8828 3.16406 11.8477C3.09375 11.8125 3.05859 11.8125 3.02344 11.8477ZM4.14844 13.1133C4.11328 13.1484 4.11328 13.2539 4.21875 13.3242C4.28906 13.3945 4.39453 13.4297 4.42969 13.3594C4.46484 13.3242 4.46484 13.2188 4.39453 13.1484C4.32422 13.0781 4.21875 13.043 4.14844 13.1133ZM3.76172 12.5859C3.69141 12.6211 3.69141 12.7266 3.76172 12.7969C3.83203 12.8672 3.90234 12.9023 3.97266 12.8672C4.00781 12.832 4.00781 12.7266 3.97266 12.6562C3.90234 12.5859 3.83203 12.5508 3.76172 12.5859Z",fill:"#1F2A37"})})},eh="overview.appInfo.customize",ef=e=>{let{isShow:t,onClose:s,appId:a,api_base_url:r,mode:l}=e,{t:i}=(0,j.useTranslation)(),n=(0,ee.useDocLink)(),d=l===el.AppModeEnum.CHAT||l===el.AppModeEnum.ADVANCED_CHAT;return(0,o.jsxs)(ec.default,{title:i(`${eh}.title`,{ns:"appOverview"}),description:i(`${eh}.explanation`,{ns:"appOverview"}),isShow:t,onClose:s,className:"w-[640px] !max-w-2xl",closable:!0,children:[(0,o.jsxs)("div",{className:"mt-4 w-full rounded-lg border-[0.5px] border-components-panel-border px-6 py-5",children:[(0,o.jsxs)(em,{bordered:!0,hideBg:!0,className:"border-text-accent-secondary uppercase text-text-accent-secondary",children:[i(`${eh}.way`,{ns:"appOverview"})," ","1"]}),(0,o.jsx)("p",{className:"system-sm-medium my-2 text-text-secondary",children:i(`${eh}.way1.name`,{ns:"appOverview"})}),(0,o.jsxs)("div",{className:"flex py-4",children:[(0,o.jsx)(eu,{children:"1"}),(0,o.jsxs)("div",{className:"flex flex-col",children:[(0,o.jsx)("div",{className:"text-text-primary",children:i(`${eh}.way1.step1`,{ns:"appOverview"})}),(0,o.jsx)("div",{className:"mb-2 mt-1 text-xs text-text-tertiary",children:i(`${eh}.way1.step1Tip`,{ns:"appOverview"})}),(0,o.jsx)("a",{href:`https://github.com/langgenius/${d?"webapp-conversation":"webapp-text-generator"}`,target:"_blank",rel:"noopener noreferrer",children:(0,o.jsxs)(A.default,{children:[(0,o.jsx)(ex,{className:"mr-2 text-text-secondary"}),i(`${eh}.way1.step1Operation`,{ns:"appOverview"})]})})]})]}),(0,o.jsxs)("div",{className:"flex pt-4",children:[(0,o.jsx)(eu,{children:"2"}),(0,o.jsxs)("div",{className:"flex flex-col",children:[(0,o.jsx)("div",{className:"text-text-primary",children:i(`${eh}.way1.step2`,{ns:"appOverview"})}),(0,o.jsx)("div",{className:"mb-2 mt-1 text-xs text-text-tertiary",children:i(`${eh}.way1.step2Tip`,{ns:"appOverview"})}),(0,o.jsx)("a",{href:"https://vercel.com/docs/concepts/deployments/git/vercel-for-github",target:"_blank",rel:"noopener noreferrer",children:(0,o.jsxs)(A.default,{children:[(0,o.jsx)("div",{className:"mr-1.5 border-b-[12px] border-l-[7px] border-r-[7px] border-t-0 border-solid border-text-primary border-l-transparent border-r-transparent border-t-transparent"}),(0,o.jsx)("span",{children:i(`${eh}.way1.step2Operation`,{ns:"appOverview"})})]})})]})]}),(0,o.jsxs)("div",{className:"flex py-4",children:[(0,o.jsx)(eu,{children:"3"}),(0,o.jsxs)("div",{className:"flex w-full flex-col overflow-hidden",children:[(0,o.jsx)("div",{className:"text-text-primary",children:i(`${eh}.way1.step3`,{ns:"appOverview"})}),(0,o.jsx)("div",{className:"mb-2 mt-1 text-xs text-text-tertiary",children:i(`${eh}.way1.step3Tip`,{ns:"appOverview"})}),(0,o.jsxs)("pre",{className:"box-border select-text overflow-x-scroll rounded-lg border-[0.5px] border-components-panel-border bg-background-section px-4 py-3 text-xs font-medium text-text-secondary",children:["NEXT_PUBLIC_APP_ID=",`'${a}'`," ",(0,o.jsx)("br",{}),"NEXT_PUBLIC_APP_KEY=","'<Web API Key From Dify>'"," ",(0,o.jsx)("br",{}),"NEXT_PUBLIC_API_URL=",`'${r}'`]})]})]})]}),(0,o.jsxs)("div",{className:"mt-4 w-full rounded-lg border-[0.5px] border-components-panel-border px-6 py-5",children:[(0,o.jsxs)(em,{bordered:!0,hideBg:!0,className:"border-text-accent-secondary uppercase text-text-accent-secondary",children:[i(`${eh}.way`,{ns:"appOverview"})," ","2"]}),(0,o.jsx)("p",{className:"system-sm-medium my-2 text-text-secondary",children:i(`${eh}.way2.name`,{ns:"appOverview"})}),(0,o.jsxs)(A.default,{className:"mt-2",onClick:()=>window.open(n("/use-dify/publish/developing-with-apis"),"_blank"),children:[(0,o.jsx)("span",{className:"text-sm text-text-secondary",children:i(`${eh}.way2.operation`,{ns:"appOverview"})}),(0,o.jsx)(ed,{className:"ml-1 h-4 w-4 shrink-0 text-text-secondary"})]})]})]})};var ev=e.i(434571),eg=e.i(554327),ey=e.i(321734),eb=e.i(257899),ew=e.i(360972);e.i(432024);var ej=e.i(845255),eN=e.i(291631),eC=e.i(876359),eA=e.i(299951),ek=e.i(873517),eE=e.i(137667),e_=e.i(59375),eM=e.i(296124),eS=e.i(56971),eT=e.i(491234);let eI="overview.appInfo.settings",eO=m.memo(e=>{let{isChat:t,appInfo:s,isShow:a=!1,onClose:r,onSave:l}=e,{notify:i}=(0,eE.useToastContext)(),[n,d]=(0,m.useState)(!1),{title:c,icon_type:p,icon:u,icon_background:x,icon_url:h,description:f,chat_color_theme:y,chat_color_theme_inverted:w,copyright:N,privacy_policy:C,custom_disclaimer:k,default_language:E,show_workflow_steps:_,use_icon_as_answer_icon:M}=s.site,[S,T]=(0,m.useState)({title:c,desc:f,chatColorTheme:y,chatColorThemeInverted:w,copyright:N,copyrightSwitchValue:!!N,privacyPolicy:C,customDisclaimer:k,show_workflow_steps:_,use_icon_as_answer_icon:M,enable_sso:s.enable_sso}),[I,O]=(0,m.useState)(E),[R,P]=(0,m.useState)(!1),{t:D}=(0,j.useTranslation)(),[L,F]=(0,m.useState)(!1),[z,$]=(0,m.useState)("image"===p?{type:"image",url:h,fileId:u}:{type:"emoji",icon:u,background:x}),{enableBilling:B,plan:U,webappCopyrightEnabled:H}=(0,eS.useProviderContext)(),{setShowPricingModal:K,setShowAccountSettingModal:G}=(0,eM.useModalContext)(),q="sandbox"===U.type,Y=(0,m.useCallback)(()=>{q?K():G({payload:e_.ACCOUNT_SETTING_TAB.BILLING})},[q,G,K]);(0,m.useEffect)(()=>{T({title:c,desc:f,chatColorTheme:y,chatColorThemeInverted:w,copyright:N,copyrightSwitchValue:!!N,privacyPolicy:C,customDisclaimer:k,show_workflow_steps:_,use_icon_as_answer_icon:M,enable_sso:s.enable_sso}),O(E),$("image"===p?{type:"image",url:h,fileId:u}:{type:"emoji",icon:u,background:x})},[s,y,w,N,k,E,f,u,x,p,h,C,_,c,M]);let X=()=>{r(),setTimeout(()=>{d(!1)},200)},Z=async()=>{if(!S.title)return void i({type:"error",message:D("newApp.nameNotEmpty",{ns:"app"})});if(null!==S){var e,t;if(!(null===(e=S.chatColorTheme)||e?.length===0||/#([A-F0-9]{6})/i.test(e)))return void i({type:"error",message:D(`${eI}.invalidHexMessage`,{ns:"appOverview"})});if(!(null===(t=S.privacyPolicy)||t?.length===0||t.startsWith("http://")||t.startsWith("https://")))return void i({type:"error",message:D(`${eI}.invalidPrivacyPolicy`,{ns:"appOverview"})})}P(!0);let s={title:S.title,description:S.desc,default_language:I,chat_color_theme:S.chatColorTheme,chat_color_theme_inverted:S.chatColorThemeInverted,prompt_public:!1,copyright:H&&S.copyrightSwitchValue?S.copyright:"",privacy_policy:S.privacyPolicy,custom_disclaimer:S.customDisclaimer,icon_type:z.type,icon:"emoji"===z.type?z.icon:z.fileId,icon_background:"emoji"===z.type?z.background:void 0,show_workflow_steps:S.show_workflow_steps,use_icon_as_answer_icon:S.use_icon_as_answer_icon,enable_sso:S.enable_sso};await l?.(s),P(!1),X()},J=e=>t=>{let s;s="checkbox"===t.target.type?t.target.checked:t.target.value,T(t=>({...t,[e]:s}))};return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(ec.default,{isShow:a,closable:!1,onClose:X,className:"max-w-[520px] p-0",children:[(0,o.jsxs)("div",{className:"pb-3 pl-6 pr-5 pt-5",children:[(0,o.jsxs)("div",{className:"flex items-center gap-1",children:[(0,o.jsx)("div",{className:"title-2xl-semi-bold grow text-text-primary",children:D(`${eI}.title`,{ns:"appOverview"})}),(0,o.jsx)(W.default,{className:"shrink-0",onClick:X,children:(0,o.jsx)(b.RiCloseLine,{className:"h-4 w-4"})})]}),(0,o.jsx)("div",{className:"system-xs-regular mt-0.5 text-text-tertiary",children:(0,o.jsx)("span",{children:D(`${eI}.modalTip`,{ns:"appOverview"})})})]}),(0,o.jsxs)("div",{className:"space-y-5 px-6 py-3",children:[(0,o.jsxs)("div",{className:"flex gap-4",children:[(0,o.jsxs)("div",{className:"grow",children:[(0,o.jsx)("div",{className:(0,v.cn)("system-sm-semibold mb-1 py-1 text-text-secondary"),children:D(`${eI}.webName`,{ns:"appOverview"})}),(0,o.jsx)(eN.default,{className:"w-full",value:S.title,onChange:J("title"),placeholder:D("appNamePlaceholder",{ns:"app"})||""})]}),(0,o.jsx)(eb.default,{size:"xxl",onClick:()=>{F(!0)},className:"mt-2 cursor-pointer",iconType:z.type,icon:"image"===z.type?z.fileId:z.icon,background:"image"===z.type?void 0:z.background,imageUrl:"image"===z.type?z.url:void 0})]}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("div",{className:(0,v.cn)("system-sm-semibold py-1 text-text-secondary"),children:D(`${eI}.webDesc`,{ns:"appOverview"})}),(0,o.jsx)(ek.default,{className:"mt-1",value:S.desc,onChange:e=>{var t;return t=e.target.value,void T(e=>({...e,desc:t}))},placeholder:D(`${eI}.webDescPlaceholder`,{ns:"appOverview"})}),(0,o.jsx)("p",{className:(0,v.cn)("body-xs-regular pb-0.5 text-text-tertiary"),children:D(`${eI}.webDescTip`,{ns:"appOverview"})})]}),(0,o.jsx)(g.default,{className:"my-0 h-px"}),t&&(0,o.jsxs)("div",{className:"w-full",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("div",{className:(0,v.cn)("system-sm-semibold py-1 text-text-secondary"),children:D("answerIcon.title",{ns:"app"})}),(0,o.jsx)(Q.default,{defaultValue:S.use_icon_as_answer_icon,onChange:e=>T({...S,use_icon_as_answer_icon:e})})]}),(0,o.jsx)("p",{className:"body-xs-regular pb-0.5 text-text-tertiary",children:D("answerIcon.description",{ns:"app"})})]}),(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:(0,v.cn)("system-sm-semibold grow py-1 text-text-secondary"),children:D(`${eI}.language`,{ns:"appOverview"})}),(0,o.jsx)(eA.SimpleSelect,{wrapperClassName:"w-[200px]",items:eT.languages.filter(e=>e.supported),defaultValue:I,onSelect:e=>O(e.value),notClearable:!0})]}),t&&(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsxs)("div",{className:"grow",children:[(0,o.jsx)("div",{className:(0,v.cn)("system-sm-semibold py-1 text-text-secondary"),children:D(`${eI}.chatColorTheme`,{ns:"appOverview"})}),(0,o.jsx)("div",{className:"body-xs-regular pb-0.5 text-text-tertiary",children:D(`${eI}.chatColorThemeDesc`,{ns:"appOverview"})})]}),(0,o.jsxs)("div",{className:"shrink-0",children:[(0,o.jsx)(eN.default,{className:"mb-1 w-[200px]",value:S.chatColorTheme??"",onChange:J("chatColorTheme"),placeholder:"E.g #A020F0"}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("p",{className:(0,v.cn)("body-xs-regular text-text-tertiary"),children:D(`${eI}.chatColorThemeInverted`,{ns:"appOverview"})}),(0,o.jsx)(Q.default,{defaultValue:S.chatColorThemeInverted,onChange:e=>T({...S,chatColorThemeInverted:e})})]})]})]}),(0,o.jsxs)("div",{className:"w-full",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("div",{className:(0,v.cn)("system-sm-semibold py-1 text-text-secondary"),children:D(`${eI}.workflow.subTitle`,{ns:"appOverview"})}),(0,o.jsx)(Q.default,{disabled:s.mode!==el.AppModeEnum.WORKFLOW&&s.mode!==el.AppModeEnum.ADVANCED_CHAT,defaultValue:S.show_workflow_steps,onChange:e=>T({...S,show_workflow_steps:e})})]}),(0,o.jsx)("p",{className:"body-xs-regular pb-0.5 text-text-tertiary",children:D(`${eI}.workflow.showDesc`,{ns:"appOverview"})})]}),(0,o.jsx)(g.default,{className:"my-0 h-px"}),!n&&(0,o.jsxs)("div",{className:"flex cursor-pointer items-center",onClick:()=>d(!0),children:[(0,o.jsxs)("div",{className:"grow",children:[(0,o.jsx)("div",{className:(0,v.cn)("system-sm-semibold py-1 text-text-secondary"),children:D(`${eI}.more.entry`,{ns:"appOverview"})}),(0,o.jsxs)("p",{className:(0,v.cn)("body-xs-regular pb-0.5 text-text-tertiary"),children:[D(`${eI}.more.copyRightPlaceholder`,{ns:"appOverview"})," ","&"," ",D(`${eI}.more.privacyPolicyPlaceholder`,{ns:"appOverview"})]})]}),(0,o.jsx)(b.RiArrowRightSLine,{className:"ml-1 h-4 w-4 shrink-0 text-text-secondary"})]}),n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"w-full",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsxs)("div",{className:"flex grow items-center",children:[(0,o.jsx)("div",{className:(0,v.cn)("system-sm-semibold mr-1 py-1 text-text-secondary"),children:D(`${eI}.more.copyright`,{ns:"appOverview"})}),B&&q&&(0,o.jsx)("div",{className:"h-[18px] select-none",children:(0,o.jsxs)(eC.default,{size:"s",color:"blue",allowHover:!0,onClick:Y,children:[(0,o.jsx)(ej.SparklesSoft,{className:"flex h-3.5 w-3.5 items-center py-[1px] pl-[3px] text-components-premium-badge-indigo-text-stop-0"}),(0,o.jsx)("div",{className:"system-xs-medium",children:(0,o.jsx)("span",{className:"p-1",children:D("upgradeBtn.encourageShort",{ns:"billing"})})})]})})]}),(0,o.jsx)(V.default,{disabled:H,popupContent:(0,o.jsx)("div",{className:"w-[180px]",children:D(`${eI}.more.copyrightTooltip`,{ns:"appOverview"})}),asChild:!1,children:(0,o.jsx)(Q.default,{disabled:!H,defaultValue:S.copyrightSwitchValue,onChange:e=>T({...S,copyrightSwitchValue:e})})})]}),(0,o.jsx)("p",{className:"body-xs-regular pb-0.5 text-text-tertiary",children:D(`${eI}.more.copyrightTip`,{ns:"appOverview"})}),S.copyrightSwitchValue&&(0,o.jsx)(eN.default,{className:"mt-2 h-10",value:S.copyright,onChange:J("copyright"),placeholder:D(`${eI}.more.copyRightPlaceholder`,{ns:"appOverview"})})]}),(0,o.jsxs)("div",{className:"w-full",children:[(0,o.jsx)("div",{className:(0,v.cn)("system-sm-semibold py-1 text-text-secondary"),children:D(`${eI}.more.privacyPolicy`,{ns:"appOverview"})}),(0,o.jsx)("p",{className:(0,v.cn)("body-xs-regular pb-0.5 text-text-tertiary"),children:(0,o.jsx)(ey.Trans,{i18nKey:`${eI}.more.privacyPolicyTip`,ns:"appOverview",components:{privacyPolicyLink:(0,o.jsx)(eg.default,{href:"https://dify.ai/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-text-accent"})}})}),(0,o.jsx)(eN.default,{className:"mt-1",value:S.privacyPolicy,onChange:J("privacyPolicy"),placeholder:D(`${eI}.more.privacyPolicyPlaceholder`,{ns:"appOverview"})})]}),(0,o.jsxs)("div",{className:"w-full",children:[(0,o.jsx)("div",{className:(0,v.cn)("system-sm-semibold py-1 text-text-secondary"),children:D(`${eI}.more.customDisclaimer`,{ns:"appOverview"})}),(0,o.jsx)("p",{className:(0,v.cn)("body-xs-regular pb-0.5 text-text-tertiary"),children:D(`${eI}.more.customDisclaimerTip`,{ns:"appOverview"})}),(0,o.jsx)(ek.default,{className:"mt-1",value:S.customDisclaimer,onChange:J("customDisclaimer"),placeholder:D(`${eI}.more.customDisclaimerPlaceholder`,{ns:"appOverview"})})]})]})]}),(0,o.jsxs)("div",{className:"flex justify-end p-6 pt-5",children:[(0,o.jsx)(A.default,{className:"mr-2",onClick:X,children:D("operation.cancel",{ns:"common"})}),(0,o.jsx)(A.default,{variant:"primary",onClick:Z,loading:R,children:D("operation.save",{ns:"common"})})]}),L&&(0,o.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,o.jsx)(ew.default,{onSelect:e=>{$(e),F(!1)},onClose:()=>{$("image"===p?{type:"image",url:h,fileId:u}:{type:"emoji",icon:u,background:x}),F(!1)}})})]})})});var eR=e.i(166607);let eP=function(e){let{appInfo:t,isInPanel:s,cardType:a="webapp",customBgColor:r,triggerModeDisabled:l=!1,triggerModeMessage:i="",onChangeStatus:n,onSaveSiteConfig:d,onGenerateCode:c,className:u}=e,h=(0,p.useRouter)(),f=(0,p.usePathname)(),{isCurrentWorkspaceManager:v,isCurrentWorkspaceEditor:y}=(0,Z.useAppContext)(),{data:w}=(0,er.useAppWorkflow)(t.mode===el.AppModeEnum.WORKFLOW?t.id:""),N=(0,ee.useDocLink)(),_=(0,x.useStore)(e=>e.appDetail),M=(0,x.useStore)(e=>e.setAppDetail),[S,T]=(0,m.useState)(!1),[I,O]=(0,m.useState)(!1),[R,P]=(0,m.useState)(!1),[D,L]=(0,m.useState)(!1),[F,z]=(0,m.useState)(!1),[$,B]=(0,m.useState)(!1),{t:U}=(0,j.useTranslation)(),H=(0,J.useGlobalPublicStore)(e=>e.systemFeatures),{data:W}=(0,es.useAppWhiteListSubjects)(_?.id,H.webapp_auth.enabled&&_?.access_mode===et.AccessMode.SPECIFIC_GROUPS_MEMBERS),K=(0,m.useMemo)(()=>{let e={webapp:[{opName:U("overview.appInfo.launch",{ns:"appOverview"}),opIcon:b.RiExternalLinkLine}],api:[{opName:U("overview.apiInfo.doc",{ns:"appOverview"}),opIcon:b.RiBookOpenLine}],app:[]};return t.mode!==el.AppModeEnum.COMPLETION&&t.mode!==el.AppModeEnum.WORKFLOW&&e.webapp.push({opName:U("overview.appInfo.embedded.entry",{ns:"appOverview"}),opIcon:b.RiWindowLine}),e.webapp.push({opName:U("overview.appInfo.customize.entry",{ns:"appOverview"}),opIcon:b.RiPaintBrushLine}),y&&e.webapp.push({opName:U("overview.appInfo.settings.entry",{ns:"appOverview"}),opIcon:b.RiEqualizer2Line}),e},[y,t,U]),ed="webapp"===a,ec=ed?U("overview.appInfo.title",{ns:"appOverview"}):U("overview.apiInfo.title",{ns:"appOverview"}),ep=t.mode===el.AppModeEnum.WORKFLOW,em=ep&&!w?.graph,eu=w?.graph?.nodes?.some(e=>e.data.type===X.BlockEnum.Start),ex=ep&&!eu,eh=(ed?!y:!v)||em||ex||l,eg=!em&&!ex&&(ed?t.enable_site:t.enable_api),ey=em||ex,{app_base_url:eb,access_token:ew}=t.site??{},ej=t.mode!==el.AppModeEnum.COMPLETION&&t.mode!==el.AppModeEnum.WORKFLOW?el.AppModeEnum.CHAT:t.mode,eN=`${eb}${en.basePath}/${ej}/${ew}`,eC=t?.api_base_url,eA=async()=>{c&&(L(!0),await (0,ei.asyncRunSafe)(c()),L(!1))},[ek,eE]=(0,m.useState)(!0);(0,m.useEffect)(()=>{_&&W&&_.access_mode===et.AccessMode.SPECIFIC_GROUPS_MEMBERS&&W.groups?.length===0&&W.members?.length===0?eE(!1):eE(!0)},[W,_]);let e_=(0,m.useCallback)(()=>{_&&B(!0)},[_]),eM=(0,m.useCallback)(async()=>{try{let e=await (0,ea.fetchAppDetailDirect)({url:"/apps",id:_.id});M(e),B(!1)}catch(e){console.error("Failed to fetch app detail:",e)}},[_,M]);return(0,o.jsxs)("div",{className:`${s?"border-l-[0.5px] border-t":"border-[0.5px] shadow-xs"} w-full max-w-full rounded-xl border-effects-highlight ${u??""} ${ey?"h-12":""}`,children:[(0,o.jsxs)("div",{className:`${r??"bg-background-default"} relative rounded-xl ${l?"opacity-60":""}`,children:[l&&(i?(0,o.jsx)(V.default,{popupContent:i,popupClassName:"max-w-64 rounded-xl bg-components-panel-bg px-3 py-2 text-xs text-text-secondary shadow-lg",position:"right",children:(0,o.jsx)("div",{className:"absolute inset-0 z-10 cursor-not-allowed rounded-xl","aria-hidden":"true"})}):(0,o.jsx)("div",{className:"absolute inset-0 z-10 cursor-not-allowed rounded-xl","aria-hidden":"true"})),(0,o.jsxs)("div",{className:`flex w-full flex-col items-start justify-center gap-3 self-stretch p-3 ${ey?"border-0":"border-b-[0.5px] border-divider-subtle"}`,children:[(0,o.jsxs)("div",{className:"flex w-full items-center gap-3 self-stretch",children:[(0,o.jsx)(C.default,{iconType:a,icon:t.icon,icon_background:t.icon_background,name:ec,hideType:!0,type:ed?U("overview.appInfo.explanation",{ns:"appOverview"}):U("overview.apiInfo.explanation",{ns:"appOverview"})}),(0,o.jsxs)("div",{className:"flex shrink-0 items-center gap-1",children:[(0,o.jsx)(Y.default,{color:eg?"green":"yellow"}),(0,o.jsx)("div",{className:`${eg?"text-text-success":"text-text-warning"} system-xs-semibold-uppercase`,children:eg?U("overview.status.running",{ns:"appOverview"}):U("overview.status.disable",{ns:"appOverview"})})]}),(0,o.jsx)(V.default,{popupContent:eh?l&&i?i:em||ex?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"mb-1 text-xs font-normal text-text-secondary",children:U("overview.appInfo.enableTooltip.description",{ns:"appOverview"})}),(0,o.jsx)("div",{className:"cursor-pointer text-xs font-normal text-text-accent hover:underline",onClick:()=>window.open(N("/use-dify/nodes/user-input"),"_blank"),children:U("overview.appInfo.enableTooltip.learnMore",{ns:"appOverview"})})]}):"":"",position:"right",popupClassName:"w-58 max-w-60 rounded-xl bg-components-panel-bg px-3.5 py-3 shadow-lg",offset:24,children:(0,o.jsx)("div",{children:(0,o.jsx)(Q.default,{defaultValue:eg,onChange:n,disabled:eh})})})]}),!ey&&(0,o.jsxs)("div",{className:"flex flex-col items-start justify-center self-stretch",children:[(0,o.jsx)("div",{className:"system-xs-medium pb-1 text-text-tertiary",children:ed?U("overview.appInfo.accessibleAddress",{ns:"appOverview"}):U("overview.apiInfo.accessibleAddress",{ns:"appOverview"})}),(0,o.jsxs)("div",{className:"inline-flex h-9 w-full items-center gap-0.5 rounded-lg bg-components-input-bg-normal p-1 pl-2",children:[(0,o.jsx)("div",{className:"flex h-4 min-w-0 flex-1 items-start justify-start gap-2 px-1",children:(0,o.jsx)("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap text-xs font-medium text-text-secondary",children:ed?eN:eC})}),(0,o.jsx)(E.default,{content:ed?eN:eC,className:"!size-6"}),ed&&(0,o.jsx)(G,{content:ed?eN:eC}),ed&&(0,o.jsx)(g.default,{type:"vertical",className:"!mx-0.5 !h-3.5 shrink-0"}),F&&(0,o.jsx)(k.default,{type:"warning",title:U("overview.appInfo.regenerate",{ns:"appOverview"}),content:U("overview.appInfo.regenerateNotice",{ns:"appOverview"}),isShow:F,onConfirm:()=>{eA(),z(!1)},onCancel:()=>z(!1)}),ed&&v&&(0,o.jsx)(V.default,{popupContent:U("overview.appInfo.regenerate",{ns:"appOverview"})||"",children:(0,o.jsx)("div",{className:"h-6 w-6 cursor-pointer rounded-md hover:bg-state-base-hover",onClick:()=>z(!0),children:(0,o.jsx)("div",{className:`h-full w-full ${eR.default.refreshIcon} ${D?eR.default.generateLogo:""}`})})})]})]}),!ey&&ed&&H.webapp_auth.enabled&&_&&(0,o.jsxs)("div",{className:"flex flex-col items-start justify-center self-stretch",children:[(0,o.jsx)("div",{className:"system-xs-medium pb-1 text-text-tertiary",children:U("publishApp.title",{ns:"app"})}),(0,o.jsxs)("div",{className:"flex h-9 w-full cursor-pointer items-center gap-x-0.5  rounded-lg bg-components-input-bg-normal py-1 pl-2.5 pr-2",onClick:e_,children:[(0,o.jsxs)("div",{className:"flex grow items-center gap-x-1.5 pr-1",children:[_?.access_mode===et.AccessMode.ORGANIZATION&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(b.RiBuildingLine,{className:"h-4 w-4 shrink-0 text-text-secondary"}),(0,o.jsx)("p",{className:"system-sm-medium text-text-secondary",children:U("accessControlDialog.accessItems.organization",{ns:"app"})})]}),_?.access_mode===et.AccessMode.SPECIFIC_GROUPS_MEMBERS&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(b.RiLockLine,{className:"h-4 w-4 shrink-0 text-text-secondary"}),(0,o.jsx)("p",{className:"system-sm-medium text-text-secondary",children:U("accessControlDialog.accessItems.specific",{ns:"app"})})]}),_?.access_mode===et.AccessMode.PUBLIC&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(b.RiGlobalLine,{className:"h-4 w-4 shrink-0 text-text-secondary"}),(0,o.jsx)("p",{className:"system-sm-medium text-text-secondary",children:U("accessControlDialog.accessItems.anyone",{ns:"app"})})]}),_?.access_mode===et.AccessMode.EXTERNAL_MEMBERS&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(b.RiVerifiedBadgeLine,{className:"h-4 w-4 shrink-0 text-text-secondary"}),(0,o.jsx)("p",{className:"system-sm-medium text-text-secondary",children:U("accessControlDialog.accessItems.external",{ns:"app"})})]})]}),!ek&&(0,o.jsx)("p",{className:"system-xs-regular shrink-0 text-text-tertiary",children:U("publishApp.notSet",{ns:"app"})}),(0,o.jsx)("div",{className:"flex h-4 w-4 shrink-0 items-center justify-center",children:(0,o.jsx)(b.RiArrowRightSLine,{className:"h-4 w-4 text-text-quaternary"})})]})]})]}),!ey&&(0,o.jsxs)("div",{className:"flex items-center gap-1 self-stretch p-3",children:[!ed&&(0,o.jsx)(q.default,{appId:t.id}),K[a].map(e=>{let t=!!l||e.opName!==U("overview.appInfo.settings.entry",{ns:"appOverview"})&&!eg;return(0,o.jsx)(A.default,{className:"mr-1 min-w-[88px]",size:"small",variant:"ghost",onClick:(e=>{switch(e){case U("overview.appInfo.launch",{ns:"appOverview"}):return()=>{window.open(eN,"_blank")};case U("overview.appInfo.customize.entry",{ns:"appOverview"}):return()=>{P(!0)};case U("overview.appInfo.settings.entry",{ns:"appOverview"}):return()=>{T(!0)};case U("overview.appInfo.embedded.entry",{ns:"appOverview"}):return()=>{O(!0)};default:return()=>{let e=f.split("/");e.pop(),h.push(`${e.join("/")}/develop`)}}})(e.opName),disabled:t,children:(0,o.jsx)(V.default,{popupContent:U("overview.appInfo.preUseReminder",{ns:"appOverview"})??"",popupClassName:t?"mt-[-8px]":"!hidden",children:(0,o.jsxs)("div",{className:"flex items-center justify-center gap-[1px]",children:[(0,o.jsx)(e.opIcon,{className:"h-3.5 w-3.5"}),(0,o.jsx)("div",{className:`${eg||!t?"text-text-tertiary":"text-components-button-ghost-text-disabled"} system-xs-medium px-[3px]`,children:e.opName})]})})},e.opName)})]})]}),ed?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eO,{isChat:ej===el.AppModeEnum.CHAT,appInfo:t,isShow:S,onClose:()=>T(!1),onSave:d}),(0,o.jsx)(ev.default,{siteInfo:t.site,isShow:I,onClose:()=>O(!1),appBaseUrl:eb,accessToken:ew}),(0,o.jsx)(ef,{isShow:R,onClose:()=>P(!1),appId:t.id,api_base_url:t.api_base_url,mode:t.mode}),$&&(0,o.jsx)(eo.default,{app:_,onConfirm:eM,onClose:()=>{B(!1)}})]}):null]})};e.i(916131);var eD=e.i(584458),eL=e.i(120219),eF=e.i(845296),ez=e.i(154033),e$=e.i(819114);let eB=function(e){let{appInfo:t,onToggleResult:s}=e,{t:a}=(0,j.useTranslation)(),r=(0,ee.useDocLink)(),l=t.id,{isCurrentWorkspaceEditor:i}=(0,Z.useAppContext)(),{data:n,isLoading:d}=(0,ez.useAppTriggers)(l),{mutateAsync:c}=(0,ez.useUpdateTriggerStatus)(),p=(0,ez.useInvalidateAppTriggers)(),{data:u}=(0,e$.useAllTriggerPlugins)(),{setTriggerStatus:x,setTriggerStatuses:h}=(0,eF.useTriggerStatusStore)(),f=n?.data||[],v=f.length;m.useEffect(()=>{f.length>0&&h(f.reduce((e,t)=>(e[t.node_id]="enabled"===t.status?"enabled":"disabled",e),{}))},[f,h]);let g=async(e,t)=>{try{x(e.node_id,t?"enabled":"disabled"),await c({appId:l,triggerId:e.id,enableTrigger:t}),p(l),s?.(null)}catch(a){x(e.node_id,t?"disabled":"enabled"),s?.(a)}};return d?(0,o.jsx)("div",{className:"w-full max-w-full rounded-xl border-l-[0.5px] border-t border-effects-highlight",children:(0,o.jsx)("div",{className:"rounded-xl bg-background-default",children:(0,o.jsx)("div",{className:"flex w-full flex-col items-start justify-center gap-3 self-stretch border-b-[0.5px] border-divider-subtle p-3",children:(0,o.jsx)("div",{className:"h-6 w-full animate-pulse rounded bg-components-input-bg-normal"})})})}):(0,o.jsx)("div",{className:"w-full max-w-full rounded-xl border-l-[0.5px] border-t border-effects-highlight",children:(0,o.jsxs)("div",{className:"rounded-xl bg-background-default",children:[(0,o.jsx)("div",{className:"flex w-full flex-col items-start justify-center gap-3 self-stretch border-b-[0.5px] border-divider-subtle p-3",children:(0,o.jsx)("div",{className:"flex w-full items-center gap-3 self-stretch",children:(0,o.jsxs)("div",{className:"flex grow items-center",children:[(0,o.jsx)("div",{className:"mr-2 shrink-0 rounded-lg border-[0.5px] border-divider-subtle bg-util-colors-purple-purple-500 p-1 shadow-md",children:(0,o.jsx)(eD.TriggerAll,{className:"h-4 w-4 text-text-primary-on-surface"})}),(0,o.jsx)("div",{className:"group w-full",children:(0,o.jsx)("div",{className:"system-md-semibold min-w-0 overflow-hidden text-ellipsis break-normal text-text-secondary group-hover:text-text-primary",children:v>0?a("overview.triggerInfo.triggersAdded",{ns:"appOverview",count:v}):a("overview.triggerInfo.noTriggerAdded",{ns:"appOverview"})})})]})})}),v>0&&(0,o.jsx)("div",{className:"flex flex-col gap-2 p-3",children:f.map(e=>(0,o.jsxs)("div",{className:"flex w-full items-center gap-3",children:[(0,o.jsxs)("div",{className:"flex min-w-0 flex-1 items-center gap-2",children:[(0,o.jsx)("div",{className:"shrink-0",children:((e,t)=>{let s,a,{trigger_type:r,status:l,provider_name:i}=e;switch(r){case"trigger-webhook":default:s=X.BlockEnum.TriggerWebhook;break;case"trigger-schedule":s=X.BlockEnum.TriggerSchedule;break;case"trigger-plugin":s=X.BlockEnum.TriggerPlugin}if("trigger-plugin"===r&&i){let e=(t||[]).find(e=>(0,ei.canFindTool)(e.id,i)||e.id.includes(i)||e.name===i);a=e?.icon}return(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)(eL.default,{type:s,size:"md",toolIcon:a}),"enabled"===l?(0,o.jsx)("div",{className:"absolute -left-0.5 -top-0.5 h-1.5 w-1.5 rounded-sm border border-black/15 bg-green-500"}):(0,o.jsx)("div",{className:"absolute -left-0.5 -top-0.5 h-1.5 w-1.5 rounded-sm border border-components-badge-status-light-disabled-border-inner bg-components-badge-status-light-disabled-bg shadow-status-indicator-gray-shadow"})]})})(e,u||[])}),(0,o.jsx)("div",{className:"system-sm-medium min-w-0 flex-1 truncate text-text-secondary",children:e.title})]}),(0,o.jsx)("div",{className:"flex shrink-0 items-center",children:(0,o.jsx)("div",{className:`${"enabled"===e.status?"text-text-success":"text-text-warning"} system-xs-semibold-uppercase whitespace-nowrap`,children:"enabled"===e.status?a("overview.status.running",{ns:"appOverview"}):a("overview.status.disable",{ns:"appOverview"})})}),(0,o.jsx)("div",{className:"shrink-0",children:(0,o.jsx)(Q.default,{defaultValue:"enabled"===e.status,onChange:t=>g(e,t),disabled:!i})})]},e.id))}),0===v&&(0,o.jsx)("div",{className:"p-3",children:(0,o.jsxs)("div",{className:"system-xs-regular leading-4 text-text-tertiary",children:[a("overview.triggerInfo.triggerStatusDescription",{ns:"appOverview"})," ",(0,o.jsx)(eg.default,{href:r("/use-dify/nodes/trigger/overview"),target:"_blank",rel:"noopener noreferrer",className:"text-text-accent hover:underline",children:a("overview.triggerInfo.learnAboutTriggers",{ns:"appOverview"})})]})})]})})};var eU=e.i(449980);e.i(36860);var eH=e.i(508110);let eW=e=>{let{data:t,value:s,onChange:a}=e,{t:r}=(0,j.useTranslation)();return(0,o.jsxs)("div",{className:"space-y-0.5",children:[(0,o.jsxs)("div",{className:"flex h-6 items-center gap-2",children:[(0,o.jsx)("div",{className:"system-xs-medium text-text-secondary",children:t.label}),(0,o.jsx)("div",{className:"system-xs-medium text-text-quaternary",children:"Â·"}),(0,o.jsx)("div",{className:"system-xs-medium text-text-secondary",children:t.variable}),(0,o.jsx)("div",{className:"system-xs-medium text-text-tertiary",children:t.type})]}),(0,o.jsx)(ek.default,{className:"h-8 resize-none",value:s,placeholder:r("mcp.server.modal.parametersPlaceholder",{ns:"tools"}),onChange:e=>a(e.target.value)})]})},eV=e=>{let{appID:t,latestParams:s=[],data:a,show:r,onHide:l,appInfo:i}=e,{t:n}=(0,j.useTranslation)(),{mutateAsync:d,isPending:c}=(0,ez.useCreateMCPServer)(),{mutateAsync:p,isPending:u}=(0,ez.useUpdateMCPServer)(),x=(0,ez.useInvalidateMCPServerDetail)(),h=a?.description||i?.description||"",[f,y]=m.useState(h),[w,N]=m.useState(a?.parameters||{}),C=()=>{let e={};return s.map(t=>(e[t.variable]=w[t.variable],t)),e},k=async()=>{if(a){let e={appID:t,id:a.id,parameters:C()};e.description=f,await p(e),x(t),l()}else{let e={appID:t,parameters:C()};f.trim()&&(e.description=f),await d(e),x(t),l()}};return(0,o.jsxs)(ec.default,{isShow:r,onClose:l,className:(0,v.cn)("relative !max-w-[520px] !p-0"),children:[(0,o.jsx)("div",{className:"absolute right-5 top-5 z-10 cursor-pointer p-1.5",onClick:l,children:(0,o.jsx)(b.RiCloseLine,{className:"h-5 w-5 text-text-tertiary"})}),(0,o.jsx)("div",{className:"title-2xl-semi-bold relative p-6 pb-3 text-xl text-text-primary",children:n(a?"mcp.server.modal.editTitle":"mcp.server.modal.addTitle",{ns:"tools"})}),(0,o.jsxs)("div",{className:"space-y-5 px-6 py-3",children:[(0,o.jsxs)("div",{className:"space-y-0.5",children:[(0,o.jsxs)("div",{className:"flex h-6 items-center gap-1",children:[(0,o.jsx)("div",{className:"system-sm-medium text-text-secondary",children:n("mcp.server.modal.description",{ns:"tools"})}),(0,o.jsx)("div",{className:"system-xs-regular text-text-destructive-secondary",children:"*"})]}),(0,o.jsx)(ek.default,{className:"h-[96px] resize-none",value:f,placeholder:n("mcp.server.modal.descriptionPlaceholder",{ns:"tools"}),onChange:e=>y(e.target.value)})]}),s.length>0&&(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"mb-1 flex items-center gap-2",children:[(0,o.jsx)("div",{className:"system-xs-medium-uppercase shrink-0 text-text-primary",children:n("mcp.server.modal.parameters",{ns:"tools"})}),(0,o.jsx)(g.default,{type:"horizontal",className:"!m-0 !h-px grow bg-divider-subtle"})]}),(0,o.jsx)("div",{className:"body-xs-regular mb-2 text-text-tertiary",children:n("mcp.server.modal.parametersTip",{ns:"tools"})}),(0,o.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,o.jsx)(eW,{data:e,value:w[e.variable]||"",onChange:t=>{var s;return s=e.variable,void N(e=>({...e,[s]:t}))}},e.variable))})]})]}),(0,o.jsxs)("div",{className:"flex flex-row-reverse p-6 pt-5",children:[(0,o.jsx)(A.default,{disabled:!f||c||u,className:"ml-2",variant:"primary",onClick:k,children:n(a?"mcp.modal.save":"mcp.server.modal.confirm",{ns:"tools"})}),(0,o.jsx)(A.default,{onClick:l,children:n("mcp.modal.cancel",{ns:"tools"})})]})]})};var eK=e.i(562572),eG=e.i(214309);let eQ="basicAppConfig",eq=e=>{let{serverActivated:t}=e,{t:s}=(0,j.useTranslation)();return(0,o.jsxs)("div",{className:"flex items-center gap-1",children:[(0,o.jsx)(Y.default,{color:t?"green":"yellow"}),(0,o.jsx)("div",{className:(0,v.cn)("system-xs-semibold-uppercase",t?"text-text-success":"text-text-warning"),children:s(t?"overview.status.running":"overview.status.disable",{ns:"appOverview"})})]})},eY=e=>{let{serverURL:t,serverPublished:s,isCurrentWorkspaceManager:a,genLoading:r,onRegenerate:l}=e,{t:i}=(0,j.useTranslation)();return(0,o.jsxs)("div",{className:"flex flex-col items-start justify-center self-stretch",children:[(0,o.jsx)("div",{className:"system-xs-medium pb-1 text-text-tertiary",children:i("mcp.server.url",{ns:"tools"})}),(0,o.jsxs)("div",{className:"inline-flex h-9 w-full items-center gap-0.5 rounded-lg bg-components-input-bg-normal p-1 pl-2",children:[(0,o.jsx)("div",{className:"flex h-4 min-w-0 flex-1 items-start justify-start gap-2 px-1",children:(0,o.jsx)("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap text-xs font-medium text-text-secondary",children:t})}),s&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(E.default,{content:t,className:"!size-6"}),(0,o.jsx)(g.default,{type:"vertical",className:"!mx-0.5 !h-3.5 shrink-0"}),a&&(0,o.jsx)(V.default,{popupContent:i("overview.appInfo.regenerate",{ns:"appOverview"})||"",children:(0,o.jsx)("div",{className:"cursor-pointer rounded-md p-1 hover:bg-state-base-hover",onClick:l,children:(0,o.jsx)(b.RiLoopLeftLine,{className:(0,v.cn)("h-4 w-4 text-text-tertiary hover:text-text-secondary",r&&"animate-spin")})})})]})]})]})},eX=e=>{let{triggerModeMessage:t}=e;return t?(0,o.jsx)(V.default,{popupContent:t,popupClassName:"max-w-64 rounded-xl bg-components-panel-bg px-3 py-2 text-xs text-text-secondary shadow-lg",position:"right",children:(0,o.jsx)("div",{className:"absolute inset-0 z-10 cursor-not-allowed rounded-xl","aria-hidden":"true"})}):(0,o.jsx)("div",{className:"absolute inset-0 z-10 cursor-not-allowed rounded-xl","aria-hidden":"true"})},eZ=e=>{let{appInfo:t,triggerModeDisabled:s=!1,triggerModeMessage:a=""}=e,{t:r}=(0,j.useTranslation)(),l=(0,ee.useDocLink)(),i=t.id,{genLoading:n,isLoading:d,serverPublished:c,serverActivated:p,serverURL:u,detail:x,isCurrentWorkspaceManager:h,toggleDisabled:f,isMinimalState:g,appUnpublished:y,missingStartNode:w,showConfirmDelete:N,showMCPServerModal:C,latestParams:E,handleGenCode:_,handleStatusChange:M,handleServerModalHide:S,openConfirmDelete:T,closeConfirmDelete:I,openServerModal:O}=((e,t)=>{let s=e.id,a=(0,eG.useQueryClient)(),{mutateAsync:r}=(0,ez.useUpdateMCPServer)(),{mutateAsync:l,isPending:i}=(0,ez.useRefreshMCPServerCode)(),n=(0,ez.useInvalidateMCPServerDetail)(),{isCurrentWorkspaceManager:o,isCurrentWorkspaceEditor:d}=(0,Z.useAppContext)(),[c,p]=(0,m.useState)(!1),[u,x]=(0,m.useState)(!1),h=e?.mode===el.AppModeEnum.ADVANCED_CHAT||e?.mode===el.AppModeEnum.WORKFLOW,f=!h,v=e.mode===el.AppModeEnum.WORKFLOW,{data:g}=(0,er.useAppWorkflow)(h?s:""),{data:y={}}=(0,eK.useQuery)({queryKey:[eQ,s],queryFn:async()=>{let e=await (0,ea.fetchAppDetail)({url:"/apps",id:s});return e?.model_config||{}},enabled:f&&!!s}),{data:b}=(0,ez.useMCPServerDetail)(s),{id:w,status:j,server_code:N}=b??{},C=!!w,A=C?`${e.api_base_url.replace("/v1","")}/mcp/server/${N}/mcp`:"***********",k=h?!g?.graph:!y.updated_at,E=g?.graph?.nodes?.some(e=>e.data.type===X.BlockEnum.Start),_=v&&!E,M=(0,m.useMemo)(()=>f&&y?.user_input_form?y.user_input_form.map(e=>{let t=Object.keys(e)[0];return{...e[t],type:t||"text-input"}}):[],[y?.user_input_form,f]),S=(0,m.useMemo)(()=>{if(h){if(!g?.graph)return[];let e=g?.graph.nodes.find(e=>e.data.type===X.BlockEnum.Start);return e?.data.variables||[]}return M},[g,M,h]),T=(0,m.useCallback)(async()=>{await l(b?.id||""),n(s)},[l,b?.id,n,s]),I=(0,m.useCallback)(async e=>e&&!C?(x(!0),{activated:!1}):(await r({appID:s,id:w||"",description:b?.description||"",parameters:b?.parameters||{},status:e?"active":"inactive"}),n(s),{activated:e}),[C,r,s,w,b,n]),O=(0,m.useCallback)(e=>(x(!1),{shouldDeactivate:!e}),[]),R=(0,m.useCallback)(()=>p(!0),[]),P=(0,m.useCallback)(()=>p(!1),[]);return{genLoading:i,isLoading:!!h&&!g,serverPublished:C,serverActivated:"active"===j,serverURL:A,detail:b,isCurrentWorkspaceManager:o,toggleDisabled:!d||k||_||t,isMinimalState:k||_,appUnpublished:k,missingStartNode:_,showConfirmDelete:c,showMCPServerModal:u,latestParams:S,handleGenCode:T,handleStatusChange:I,handleServerModalHide:O,openConfirmDelete:R,closeConfirmDelete:P,openServerModal:(0,m.useCallback)(()=>x(!0),[]),invalidateBasicAppConfig:(0,m.useCallback)(()=>{a.invalidateQueries({queryKey:[eQ,s]})},[a,s])}})(t,s),[R,P]=(0,m.useState)(null),D=R??p,L=async e=>{P(e),!(await M(e)).activated&&e&&P(null)};if(d)return null;let F=function(e){let{toggleDisabled:t,appUnpublished:s,missingStartNode:a,triggerModeMessage:r,t:l,docLink:i}=e;return t?s?l("mcp.server.publishTip",{ns:"tools"}):a?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"mb-1 text-xs font-normal text-text-secondary",children:l("overview.appInfo.enableTooltip.description",{ns:"appOverview"})}),(0,o.jsx)("div",{className:"cursor-pointer text-xs font-normal text-text-accent hover:underline",onClick:()=>window.open(i("/use-dify/nodes/user-input"),"_blank"),children:l("overview.appInfo.enableTooltip.learnMore",{ns:"appOverview"})})]}):r||"":""}({toggleDisabled:f,appUnpublished:y,missingStartNode:w,triggerModeMessage:a,t:r,docLink:l});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:(0,v.cn)("w-full max-w-full rounded-xl border-l-[0.5px] border-t border-effects-highlight",g&&"h-12"),children:(0,o.jsxs)("div",{className:(0,v.cn)("relative rounded-xl bg-background-default",s&&"opacity-60"),children:[s&&(0,o.jsx)(eX,{triggerModeMessage:a}),(0,o.jsxs)("div",{className:(0,v.cn)("flex w-full flex-col items-start justify-center gap-3 self-stretch p-3",g?"border-0":"border-b-[0.5px] border-divider-subtle"),children:[(0,o.jsxs)("div",{className:"flex w-full items-center gap-3 self-stretch",children:[(0,o.jsxs)("div",{className:"flex grow items-center",children:[(0,o.jsx)("div",{className:"mr-2 shrink-0 rounded-lg border-[0.5px] border-divider-subtle bg-util-colors-blue-brand-blue-brand-500 p-1 shadow-md",children:(0,o.jsx)(eH.Mcp,{className:"h-4 w-4 text-text-primary-on-surface"})}),(0,o.jsx)("div",{className:"group w-full",children:(0,o.jsx)("div",{className:"system-md-semibold min-w-0 overflow-hidden text-ellipsis break-normal text-text-secondary group-hover:text-text-primary",children:r("mcp.server.title",{ns:"tools"})})})]}),(0,o.jsx)(eq,{serverActivated:p}),(0,o.jsx)(V.default,{popupContent:F,position:"right",popupClassName:"w-58 max-w-60 rounded-xl bg-components-panel-bg px-3.5 py-3 shadow-lg",offset:24,children:(0,o.jsx)("div",{children:(0,o.jsx)(Q.default,{defaultValue:D,onChange:L,disabled:f})})})]}),!g&&(0,o.jsx)(eY,{serverURL:u,serverPublished:c,isCurrentWorkspaceManager:h,genLoading:n,onRegenerate:T})]}),!g&&(0,o.jsx)("div",{className:"flex items-center gap-1 self-stretch p-3",children:(0,o.jsx)(A.default,{disabled:f,size:"small",variant:"ghost",onClick:O,children:(0,o.jsxs)("div",{className:"flex items-center justify-center gap-[1px]",children:[(0,o.jsx)(b.RiEditLine,{className:"h-3.5 w-3.5"}),(0,o.jsx)("div",{className:"system-xs-medium px-[3px] text-text-tertiary",children:r(c?"mcp.server.edit":"mcp.server.addDescription",{ns:"tools"})})]})})})]})}),C&&(0,o.jsx)(eV,{show:C,appID:i,data:c?x:void 0,latestParams:E,onHide:()=>{S(p),P(null)},appInfo:t}),N&&(0,o.jsx)(k.default,{type:"warning",title:r("overview.appInfo.regenerate",{ns:"appOverview"}),content:r("mcp.server.reGen",{ns:"tools"}),isShow:N,onConfirm:()=>{_(),I()},onCancel:I})]})};var eJ=e.i(925521);let e0=e=>{let{appId:t,isInPanel:s,className:a}=e,{t:r}=(0,j.useTranslation)(),{notify:l}=(0,N.useContext)(eE.ToastContext),i=(0,x.useStore)(e=>e.appDetail),n=(0,x.useStore)(e=>e.setAppDetail),d=i?.mode===el.AppModeEnum.WORKFLOW,c=s&&d,{data:p}=(0,er.useAppWorkflow)(d?i.id:""),u=(0,m.useMemo)(()=>!!d&&(p?(p.graph?.nodes||[]).some(e=>{let t=e.data?.type;return!!t&&(0,X.isTriggerNode)(t)}):null),[d,p]),h=!(!d||!1===u),f=(0,m.useCallback)(e=>(0,o.jsx)("div",{className:"flex flex-col gap-1",children:(0,o.jsx)("div",{className:"text-xs text-text-secondary",children:r("overview.disableTooltip.triggerMode",{ns:"appOverview",feature:e})})}),[r]),v=h?f(r("overview.appInfo.title",{ns:"appOverview"})):null,g=h?f(r("overview.apiInfo.title",{ns:"appOverview"})):null,y=h?f(r("mcp.server.title",{ns:"tools"})):null,b=async()=>{try{let e=await (0,ea.fetchAppDetail)({url:"/apps",id:t});n({...e})}catch(e){console.error(e)}},w=(e,t)=>{let s=e?"error":"success";t||="success"===s?"modifiedSuccessfully":"modifiedUnsuccessfully","success"===s&&b(),l({type:s,message:r(`actionMsg.${t}`,{ns:"common"})})},C=async e=>{let[s]=await (0,ei.asyncRunSafe)((0,ea.updateAppSiteStatus)({url:`/apps/${t}/site-enable`,body:{enable_site:e}}));w(s)},A=async e=>{let[s]=await (0,ei.asyncRunSafe)((0,ea.updateAppSiteStatus)({url:`/apps/${t}/api-enable`,body:{enable_api:e}}));w(s)},k=async e=>{let[s]=await (0,ei.asyncRunSafe)((0,ea.updateAppSiteConfig)({url:`/apps/${t}/site`,body:e}));s||localStorage.setItem(eJ.NEED_REFRESH_APP_LIST_KEY,"1"),w(s)},E=async()=>{let[e]=await (0,ei.asyncRunSafe)((0,ea.updateAppSiteAccessToken)({url:`/apps/${t}/site/access-token-reset`}));w(e,e?"generatedUnsuccessfully":"generatedSuccessfully")};if(!i)return(0,o.jsx)(eU.default,{});let _=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eP,{appInfo:i,cardType:"webapp",isInPanel:s,triggerModeDisabled:h,triggerModeMessage:v,onChangeStatus:C,onGenerateCode:E,onSaveSiteConfig:k}),(0,o.jsx)(eP,{cardType:"api",appInfo:i,isInPanel:s,triggerModeDisabled:h,triggerModeMessage:g,onChangeStatus:A}),s&&(0,o.jsx)(eZ,{appInfo:i,triggerModeDisabled:h,triggerModeMessage:y})]}),M=c?(0,o.jsx)(eB,{appInfo:i,onToggleResult:w}):null;return(0,o.jsxs)("div",{className:a||"mb-6 grid w-full grid-cols-1 gap-6 xl:grid-cols-2",children:[h&&M,_,!h&&M]})};var e1=e.i(157169);let e2=e=>{let{className:t,show:s,onClose:a,children:r}=e;return(0,o.jsxs)(e1.Transition,{show:s,as:"div",className:"absolute left-0 top-0 z-30 box-border h-full w-full p-2",children:[(0,o.jsx)(e1.TransitionChild,{children:(0,o.jsx)("div",{className:(0,v.cn)("absolute inset-0 left-0 w-full bg-app-detail-overlay-bg","duration-300 ease-in data-[closed]:opacity-0","data-[enter]:opacity-100","data-[leave]:opacity-0"),onClick:a})}),(0,o.jsx)(e1.TransitionChild,{children:(0,o.jsx)("div",{className:(0,v.cn)("absolute left-0 w-full border-r border-divider-burn bg-app-detail-bg","duration-100 ease-in data-[closed]:-translate-x-full","data-[enter]:translate-x-0 data-[enter]:duration-300 data-[enter]:ease-out","data-[leave]:-translate-x-full data-[leave]:duration-200 data-[leave]:ease-in",t),children:r})})]})};var e3=e.i(632815),e5=e.i(141696),e4=e.i(586871),e6=e.i(391185);let e8=[],e7=e=>{let{operations:t,primaryOperations:s,secondaryOperations:a,gap:r}=e,{t:l}=(0,j.useTranslation)(),[i,n]=(0,m.useState)([]),[d,c]=(0,m.useState)([]),[p,u]=(0,m.useState)(!1),x=(0,m.useRef)(null),h=(0,m.useCallback)(()=>{u(!0)},[u]),f=(0,m.useMemo)(()=>t||s||e8,[t,s]),v=(0,m.useMemo)(()=>t?e8:a||e8,[t,a]),g=f.filter(e=>"divider"!==e.type);(0,m.useEffect)(()=>{let e=(e,t)=>{let s=[...t,...v];t.length||s[0]?.type!=="divider"||s.shift(),n(e),c(s)},t=f.filter(e=>"divider"!==e.type);if(!t.length)return void e([],[]);let s=x.current,a=document.getElementById("more-measure");if(!s||!a)return;let l=0,i=s.clientWidth,o=a.clientWidth;if(0===i||0===o)return;let d=t.reduce((e,t)=>(e[t.id]=!1,e),{}),p=Array.from(s.children).slice(0,-1);for(let e=0;e<p.length;e++){let t=p[e],s=t.dataset.targetid;if(!s)break;let a=t.clientWidth;if(l+r+a+o<=i)d[s]=!0,l+=r+a;else{e===p.length-1&&l+a<=i?d[s]=!0:d[s]=!1;break}}e(t.filter(e=>d[e.id]),t.filter(e=>!d[e.id]))},[r,f,v]);let y=d.length>0;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{"aria-hidden":"true",ref:x,className:"pointer-events-none flex h-0 items-center self-stretch overflow-hidden",style:{gap:r},children:[g.map(e=>(0,o.jsxs)(A.default,{"data-targetid":e.id,size:"small",variant:"secondary",className:"gap-[1px]",tabIndex:-1,children:[(0,m.cloneElement)(e.icon,{className:"h-3.5 w-3.5 text-components-button-secondary-text"}),(0,o.jsx)("span",{className:"system-xs-medium text-components-button-secondary-text",children:e.title})]},e.id)),(0,o.jsxs)(A.default,{id:"more-measure",size:"small",variant:"secondary",className:"gap-[1px]",tabIndex:-1,children:[(0,o.jsx)(b.RiMoreLine,{className:"h-3.5 w-3.5 text-components-button-secondary-text"}),(0,o.jsx)("span",{className:"system-xs-medium text-components-button-secondary-text",children:l("operation.more",{ns:"common"})})]})]}),(0,o.jsxs)("div",{className:"flex items-center self-stretch overflow-hidden",style:{gap:r},children:[i.map(e=>(0,o.jsxs)(A.default,{"data-targetid":e.id,size:"small",variant:"secondary",className:"gap-[1px]",onClick:e.onClick,children:[(0,m.cloneElement)(e.icon,{className:"h-3.5 w-3.5 text-components-button-secondary-text"}),(0,o.jsx)("span",{className:"system-xs-medium text-components-button-secondary-text",children:e.title})]},e.id)),y&&(0,o.jsxs)(e6.PortalToFollowElem,{open:p,onOpenChange:u,placement:"bottom-end",offset:{mainAxis:4},children:[(0,o.jsx)(e6.PortalToFollowElemTrigger,{onClick:h,children:(0,o.jsxs)(A.default,{size:"small",variant:"secondary",className:"gap-[1px]",children:[(0,o.jsx)(b.RiMoreLine,{className:"h-3.5 w-3.5 text-components-button-secondary-text"}),(0,o.jsx)("span",{className:"system-xs-medium text-components-button-secondary-text",children:l("operation.more",{ns:"common"})})]})}),(0,o.jsx)(e6.PortalToFollowElemContent,{className:"z-[30]",children:(0,o.jsx)("div",{className:"flex min-w-[264px] flex-col rounded-[12px] border-[0.5px] border-components-panel-border bg-components-panel-bg-blur p-1 shadow-lg backdrop-blur-[5px]",children:d.map(e=>"divider"===e.type?(0,o.jsx)("div",{className:"my-1 h-px bg-divider-subtle"},e.id):(0,o.jsxs)("div",{className:"flex h-8 cursor-pointer items-center gap-x-1 rounded-lg p-1.5 hover:bg-state-base-hover",onClick:e.onClick,children:[(0,m.cloneElement)(e.icon,{className:"h-4 w-4 text-text-tertiary"}),(0,o.jsx)("span",{className:"system-md-regular text-text-secondary",children:e.title})]},e.id))})})]})]})]})},e9=(0,w.default)(()=>e.A(778712),{loadableGenerated:{modules:[339556]},ssr:!1}),te=(0,w.default)(()=>e.A(977869),{loadableGenerated:{modules:[23120]},ssr:!1}),tt=(0,w.default)(()=>e.A(274156),{loadableGenerated:{modules:[823278]},ssr:!1}),ts=(0,w.default)(()=>e.A(623391),{loadableGenerated:{modules:[920226]},ssr:!1}),ta=(0,w.default)(()=>e.A(8429),{loadableGenerated:{modules:[868879]},ssr:!1}),tr=(0,w.default)(()=>e.A(606117),{loadableGenerated:{modules:[356881]},ssr:!1}),tl=m.memo(e=>{let{expand:t,onlyShowDetail:s=!1,openState:a=!1,onDetailExpand:r}=e,{t:l}=(0,j.useTranslation)(),{notify:i}=(0,N.useContext)(eE.ToastContext),{replace:n}=(0,p.useRouter)(),{onPlanInfoChanged:d}=(0,eS.useProviderContext)(),c=(0,x.useStore)(e=>e.appDetail),u=(0,x.useStore)(e=>e.setAppDetail),h=(0,e3.useInvalidateAppList)(),[f,g]=(0,m.useState)(a),[y,w]=(0,m.useState)(!1),[C,k]=(0,m.useState)(!1),[E,_]=(0,m.useState)(!1),[M,S]=(0,m.useState)(!1),[T,I]=(0,m.useState)(!1),[O,R]=(0,m.useState)([]),[P,D]=(0,m.useState)(!1),L=(0,m.useCallback)(async e=>{let{name:t,icon_type:s,icon:a,icon_background:r,description:n,use_icon_as_answer_icon:o,max_active_requests:d}=e;if(c)try{let e=await (0,ea.updateAppInfo)({appID:c.id,name:t,icon_type:s,icon:a,icon_background:r,description:n,use_icon_as_answer_icon:o,max_active_requests:d});w(!1),i({type:"success",message:l("editDone",{ns:"app"})}),u(e)}catch{i({type:"error",message:l("editFailed",{ns:"app"})})}},[c,i,u,l]),F=async e=>{let{name:t,icon_type:s,icon:a,icon_background:r}=e;if(c)try{let e=await (0,ea.copyApp)({appID:c.id,name:t,icon_type:s,icon:a,icon_background:r,mode:c.mode});k(!1),i({type:"success",message:l("newApp.appCreated",{ns:"app"})}),localStorage.setItem(eJ.NEED_REFRESH_APP_LIST_KEY,"1"),d(),(0,e4.getRedirection)(!0,e,n)}catch{i({type:"error",message:l("newApp.appCreateFailed",{ns:"app"})})}},z=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(c)try{let{data:t}=await (0,ea.exportAppConfig)({appID:c.id,include:e}),s=new Blob([t],{type:"application/yaml"});(0,K.downloadBlob)({data:s,fileName:`${c.name}.yml`})}catch{i({type:"error",message:l("exportFailed",{ns:"app"})})}},$=async()=>{if(c){if(c.mode!==el.AppModeEnum.WORKFLOW&&c.mode!==el.AppModeEnum.ADVANCED_CHAT)return void z();D(!0)}},B=async()=>{if(c){D(!1);try{let e=((await (0,e5.fetchWorkflowDraft)(`/apps/${c.id}/workflows/draft`)).environment_variables||[]).filter(e=>"secret"===e.value_type);if(0===e.length)return void z();R(e)}catch{i({type:"error",message:l("exportFailed",{ns:"app"})})}}},U=(0,m.useCallback)(async()=>{if(c){try{await (0,ea.deleteApp)(c.id),i({type:"success",message:l("appDeleted",{ns:"app"})}),h(),d(),u(),n("/apps")}catch(e){i({type:"error",message:`${l("appDeleteFailed",{ns:"app"})}${"message"in e?`: ${e.message}`:""}`})}_(!1)}},[c,h,i,d,n,u,l]),{isCurrentWorkspaceEditor:H}=(0,Z.useAppContext)();if(!c)return null;let W=[{id:"edit",title:l("editApp",{ns:"app"}),icon:(0,o.jsx)(b.RiEditLine,{}),onClick:()=>{g(!1),r?.(!1),w(!0)}},{id:"duplicate",title:l("duplicate",{ns:"app"}),icon:(0,o.jsx)(b.RiFileCopy2Line,{}),onClick:()=>{g(!1),r?.(!1),k(!0)}},{id:"export",title:l("export",{ns:"app"}),icon:(0,o.jsx)(b.RiFileDownloadLine,{}),onClick:$}],V=[...c.mode===el.AppModeEnum.ADVANCED_CHAT||c.mode===el.AppModeEnum.WORKFLOW?[{id:"import",title:l("common.importDSL",{ns:"workflow"}),icon:(0,o.jsx)(b.RiFileUploadLine,{}),onClick:()=>{g(!1),r?.(!1),I(!0)}}]:[],{id:"divider-1",title:"",icon:(0,o.jsx)(o.Fragment,{}),onClick:()=>{},type:"divider"},{id:"delete",title:l("operation.delete",{ns:"common"}),icon:(0,o.jsx)(b.RiDeleteBinLine,{}),onClick:()=>{g(!1),r?.(!1),_(!0)}}],G=c.mode===el.AppModeEnum.COMPLETION||c.mode===el.AppModeEnum.CHAT?{id:"switch",title:l("switch",{ns:"app"}),icon:(0,o.jsx)(b.RiExchange2Line,{}),onClick:()=>{g(!1),r?.(!1),S(!0)}}:null;return(0,o.jsxs)("div",{children:[!s&&(0,o.jsx)("button",{type:"button",onClick:()=>{H&&g(e=>!e)},className:"block w-full",children:(0,o.jsxs)("div",{className:"flex flex-col gap-2 rounded-lg p-1 hover:bg-state-base-hover",children:[(0,o.jsxs)("div",{className:"flex items-center gap-1",children:[(0,o.jsx)("div",{className:(0,v.cn)(!t&&"ml-1"),children:(0,o.jsx)(eb.default,{size:t?"large":"small",iconType:c.icon_type,icon:c.icon,background:c.icon_background,imageUrl:c.icon_url})}),t&&(0,o.jsx)("div",{className:"ml-auto flex items-center justify-center rounded-md p-0.5",children:(0,o.jsx)("div",{className:"flex h-5 w-5 items-center justify-center",children:(0,o.jsx)(b.RiEqualizer2Line,{className:"h-4 w-4 text-text-tertiary"})})})]}),!t&&(0,o.jsx)("div",{className:"flex items-center justify-center",children:(0,o.jsx)("div",{className:"flex h-5 w-5 items-center justify-center rounded-md p-0.5",children:(0,o.jsx)(b.RiEqualizer2Line,{className:"h-4 w-4 text-text-tertiary"})})}),t&&(0,o.jsxs)("div",{className:"flex flex-col items-start gap-1",children:[(0,o.jsx)("div",{className:"flex w-full",children:(0,o.jsx)("div",{className:"system-md-semibold truncate whitespace-nowrap text-text-secondary",children:c.name})}),(0,o.jsx)("div",{className:"system-2xs-medium-uppercase whitespace-nowrap text-text-tertiary",children:c.mode===el.AppModeEnum.ADVANCED_CHAT?l("types.advanced",{ns:"app"}):c.mode===el.AppModeEnum.AGENT_CHAT?l("types.agent",{ns:"app"}):c.mode===el.AppModeEnum.CHAT?l("types.chatbot",{ns:"app"}):c.mode===el.AppModeEnum.COMPLETION?l("types.completion",{ns:"app"}):l("types.workflow",{ns:"app"})})]})]})}),(0,o.jsxs)(e2,{show:s?a:f,onClose:()=>{g(!1),r?.(!1)},className:"absolute bottom-2 left-2 top-2 flex w-[420px] flex-col rounded-2xl !p-0",children:[(0,o.jsxs)("div",{className:"flex shrink-0 flex-col items-start justify-center gap-3 self-stretch p-4",children:[(0,o.jsxs)("div",{className:"flex items-center gap-3 self-stretch",children:[(0,o.jsx)(eb.default,{size:"large",iconType:c.icon_type,icon:c.icon,background:c.icon_background,imageUrl:c.icon_url}),(0,o.jsxs)("div",{className:"flex flex-1 flex-col items-start justify-center overflow-hidden",children:[(0,o.jsx)("div",{className:"system-md-semibold w-full truncate text-text-secondary",children:c.name}),(0,o.jsx)("div",{className:"system-2xs-medium-uppercase text-text-tertiary",children:c.mode===el.AppModeEnum.ADVANCED_CHAT?l("types.advanced",{ns:"app"}):c.mode===el.AppModeEnum.AGENT_CHAT?l("types.agent",{ns:"app"}):c.mode===el.AppModeEnum.CHAT?l("types.chatbot",{ns:"app"}):c.mode===el.AppModeEnum.COMPLETION?l("types.completion",{ns:"app"}):l("types.workflow",{ns:"app"})})]})]}),c.description&&(0,o.jsx)("div",{className:"system-xs-regular overflow-wrap-anywhere max-h-[105px] w-full max-w-full overflow-y-auto whitespace-normal break-words text-text-tertiary",children:c.description}),(0,o.jsx)(e7,{gap:4,primaryOperations:W,secondaryOperations:V})]}),(0,o.jsx)(e0,{appId:c.id,isInPanel:!0,className:"flex flex-1 flex-col gap-2 overflow-auto px-2 py-1"}),G&&(0,o.jsx)("div",{className:"flex min-h-fit shrink-0 flex-col items-start justify-center gap-3 self-stretch pb-2",children:(0,o.jsxs)(A.default,{size:"medium",variant:"ghost",className:"gap-0.5",onClick:G.onClick,children:[G.icon,(0,o.jsx)("span",{className:"system-sm-medium text-text-tertiary",children:G.title})]})})]}),M&&(0,o.jsx)(e9,{inAppDetail:!0,show:M,appDetail:c,onClose:()=>S(!1),onSuccess:()=>S(!1)}),y&&(0,o.jsx)(te,{isEditModal:!0,appName:c.name,appIconType:c.icon_type,appIcon:c.icon,appIconBackground:c.icon_background,appIconUrl:c.icon_url,appDescription:c.description,appMode:c.mode,appUseIconAsAnswerIcon:c.use_icon_as_answer_icon,max_active_requests:c.max_active_requests??null,show:y,onConfirm:L,onHide:()=>w(!1)}),C&&(0,o.jsx)(tt,{appName:c.name,icon_type:c.icon_type,icon:c.icon,icon_background:c.icon_background,icon_url:c.icon_url,show:C,onConfirm:F,onHide:()=>k(!1)}),E&&(0,o.jsx)(ts,{title:l("deleteAppConfirmTitle",{ns:"app"}),content:l("deleteAppConfirmContent",{ns:"app"}),isShow:E,onConfirm:U,onCancel:()=>_(!1)}),T&&(0,o.jsx)(ta,{onCancel:()=>I(!1),onBackup:$}),O.length>0&&(0,o.jsx)(tr,{envList:O,onConfirm:z,onClose:()=>R([])}),P&&(0,o.jsx)(ts,{type:"info",isShow:P,title:l("sidebar.exportWarning",{ns:"workflow"}),content:l("sidebar.exportWarningDesc",{ns:"workflow"}),onConfirm:B,onCancel:()=>D(!1)})]})}),ti=m.memo(e=>{let t,{name:s,href:a,iconMap:r,mode:l="expand",disabled:i=!1}=e,n=(0,p.useSelectedLayoutSegment)(),d=("annotations"===(t=n?.toLowerCase())&&(t="logs"),t),c=a.toLowerCase().split("/")?.pop()===d,m=c?r.selected:r.normal,u=()=>(0,o.jsx)("div",{className:(0,v.cn)("expand"!==l&&"-ml-1"),children:(0,o.jsx)(m,{className:"h-4 w-4 shrink-0","aria-hidden":"true"})});return i?(0,o.jsxs)("button",{type:"button",disabled:!0,className:(0,v.cn)("system-sm-medium flex h-8 cursor-not-allowed items-center rounded-lg text-components-menu-item-text opacity-30 hover:bg-components-menu-item-bg-hover","pl-3 pr-1"),title:"collapse"===l?s:"","aria-disabled":!0,children:[u(),(0,o.jsx)("span",{className:(0,v.cn)("overflow-hidden whitespace-nowrap transition-all duration-200 ease-in-out","expand"===l?"ml-2 max-w-none opacity-100":"ml-0 max-w-0 opacity-0"),children:s})]},s):(0,o.jsxs)(eg.default,{href:a,className:(0,v.cn)(c?"system-sm-semibold border-b-[0.25px] border-l-[0.75px] border-r-[0.25px] border-t-[0.75px] border-effects-highlight-lightmode-off bg-components-menu-item-bg-active text-text-accent-light-mode-only":"system-sm-medium text-components-menu-item-text hover:bg-components-menu-item-bg-hover hover:text-components-menu-item-text-hover","flex h-8 items-center rounded-lg pl-3 pr-1"),title:"collapse"===l?s:"",children:[u(),(0,o.jsx)("span",{className:(0,v.cn)("overflow-hidden whitespace-nowrap transition-all duration-200 ease-in-out","expand"===l?"ml-2 max-w-none opacity-100":"ml-0 max-w-0 opacity-0"),children:s})]},s)}),tn=e=>{let{navigation:t}=e,{t:s}=(0,j.useTranslation)(),{isCurrentWorkspaceEditor:a}=(0,Z.useAppContext)(),r=(0,x.useStore)(e=>e.appDetail),[l,i]=(0,m.useState)(!1),[n,d]=(0,m.useState)(!1),c=(0,m.useRef)(n),p=(0,m.useCallback)(e=>{d(e),c.current=e},[d]),u=(0,m.useCallback)(()=>{p(!c.current)},[p]);return r?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"fixed left-2 top-2 z-20",children:(0,o.jsxs)(e6.PortalToFollowElem,{open:n,onOpenChange:p,placement:"bottom-start",offset:{mainAxis:-41},children:[(0,o.jsx)(e6.PortalToFollowElemTrigger,{onClick:u,children:(0,o.jsxs)("div",{className:(0,v.cn)("flex cursor-pointer items-center rounded-[10px] border-[0.5px] border-components-actionbar-border bg-components-actionbar-bg p-1 shadow-lg backdrop-blur-sm hover:bg-background-default-hover",n&&"bg-background-default-hover"),children:[(0,o.jsx)(eb.default,{size:"small",iconType:r.icon_type,icon:r.icon,background:r.icon_background,imageUrl:r.icon_url}),(0,o.jsx)(b.RiMenuLine,{className:"h-4 w-4 text-text-tertiary"})]})}),(0,o.jsx)(e6.PortalToFollowElemContent,{className:"z-[1000]",children:(0,o.jsxs)("div",{className:(0,v.cn)("w-[305px] rounded-xl border-[0.5px] border-components-panel-border bg-background-default-subtle shadow-lg"),children:[(0,o.jsx)("div",{className:"p-2",children:(0,o.jsxs)("div",{className:(0,v.cn)("flex flex-col gap-2 rounded-lg p-2 pb-2.5",a&&"cursor-pointer hover:bg-state-base-hover"),onClick:()=>{i(!0),p(!1)},children:[(0,o.jsxs)("div",{className:"flex items-center justify-between self-stretch",children:[(0,o.jsx)(eb.default,{size:"large",iconType:r.icon_type,icon:r.icon,background:r.icon_background,imageUrl:r.icon_url}),(0,o.jsx)("div",{className:"flex items-center justify-center rounded-md p-0.5",children:(0,o.jsx)("div",{className:"flex h-5 w-5 items-center justify-center",children:(0,o.jsx)(b.RiEqualizer2Line,{className:"h-4 w-4 text-text-tertiary"})})})]}),(0,o.jsxs)("div",{className:"flex flex-col items-start gap-1",children:[(0,o.jsx)("div",{className:"flex w-full",children:(0,o.jsx)("div",{className:"system-md-semibold truncate text-text-secondary",children:r.name})}),(0,o.jsx)("div",{className:"system-2xs-medium-uppercase text-text-tertiary",children:s(r.mode===el.AppModeEnum.ADVANCED_CHAT?"types.advanced":r.mode===el.AppModeEnum.AGENT_CHAT?"types.agent":r.mode===el.AppModeEnum.CHAT?"types.chatbot":r.mode===el.AppModeEnum.COMPLETION?"types.completion":"types.workflow",{ns:"app"})})]})]})}),(0,o.jsx)("div",{className:"px-4",children:(0,o.jsx)(g.default,{bgStyle:"gradient"})}),(0,o.jsx)("nav",{className:"space-y-0.5 px-3 pb-6 pt-4",children:t.map((e,t)=>(0,o.jsx)(ti,{mode:"expand",iconMap:{selected:e.selectedIcon,normal:e.icon},name:e.name,href:e.href},t))})]})})]})}),(0,o.jsx)("div",{className:"z-20",children:(0,o.jsx)(tl,{expand:!0,onlyShowDetail:!0,openState:l,onDetailExpand:i})})]}):null};var to=e.i(413159),td=e.i(216425),tc=e.i(621379),tp=e.i(227579),tm=e.i(211857),tu=e.i(225244),tx=e.i(722384),th=e.i(475390),tf=e.i(176891);let tv=m.memo(e=>{let{Icon:t,name:s,handleClick:a}=e;return(0,o.jsxs)("div",{className:"flex items-center gap-x-1 rounded-lg px-2 py-1.5 hover:bg-state-base-hover",onClick:e=>{e.preventDefault(),e.stopPropagation(),a?.()},children:[(0,o.jsx)(t,{className:"size-4 text-text-tertiary"}),(0,o.jsx)("span",{className:"system-md-regular px-1 text-text-secondary",children:s})]})}),tg=m.memo(e=>{let{showDelete:t,openRenameModal:s,handleExportPipeline:a,detectIsUsedByApp:r}=e,{t:l}=(0,j.useTranslation)(),i=(0,to.useDatasetDetailContextWithSelector)(e=>e.dataset?.runtime_mode);return(0,o.jsxs)("div",{className:"flex w-[200px] flex-col rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur shadow-lg shadow-shadow-shadow-5 backdrop-blur-[5px]",children:[(0,o.jsxs)("div",{className:"flex flex-col p-1",children:[(0,o.jsx)(tv,{Icon:b.RiEditLine,name:l("operation.edit",{ns:"common"}),handleClick:s}),"rag_pipeline"===i&&(0,o.jsx)(tv,{Icon:b.RiFileDownloadLine,name:l("operations.exportPipeline",{ns:"datasetPipeline"}),handleClick:a})]}),t&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(g.default,{type:"horizontal",className:"my-0 bg-divider-subtle"}),(0,o.jsx)("div",{className:"flex flex-col p-1",children:(0,o.jsx)(tv,{Icon:b.RiDeleteBinLine,name:l("operation.delete",{ns:"common"}),handleClick:r})})]})]})}),ty=m.memo(e=>{let{expand:t}=e,{t:s}=(0,j.useTranslation)(),{replace:a}=(0,p.useRouter)(),[r,l]=(0,m.useState)(!1),[i,n]=(0,m.useState)(!1),[d,c]=(0,m.useState)(""),[u,x]=(0,m.useState)(!1),h=(0,Z.useSelector)(e=>e.isCurrentWorkspaceDatasetOperator),f=(0,to.useDatasetDetailContextWithSelector)(e=>e.dataset),g=(0,m.useCallback)(()=>{l(e=>!e)},[]),y=(0,tu.useInvalidDatasetList)(),w=(0,tx.useInvalid)([...tu.datasetDetailQueryKeyPrefix,f.id]),N=(0,m.useCallback)(()=>{y(),w()},[w,y]),C=(0,m.useCallback)(()=>{n(!0),g()},[g]),{mutateAsync:A}=(0,th.useExportPipelineDSL)(),E=(0,m.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{pipeline_id:t,name:a}=f;if(t){g();try{let{data:s}=await A({pipelineId:t,include:e}),r=new Blob([s],{type:"application/yaml"});(0,K.downloadBlob)({data:r,fileName:`${a}.pipeline`})}catch{eE.default.notify({type:"error",message:s("exportFailed",{ns:"app"})})}}},[f,A,g,s]),_=(0,m.useCallback)(async()=>{try{let{is_using:e}=await (0,tm.checkIsUsedInApp)(f.id);c(e?s("datasetUsedByApp",{ns:"dataset"}):s("deleteDatasetConfirmContent",{ns:"dataset"})),x(!0)}catch(t){let e=await t.json();eE.default.notify({type:"error",message:e?.message||"Unknown error"})}finally{g()}},[f.id,g,s]),M=(0,m.useCallback)(async()=>{try{await (0,tm.deleteDataset)(f.id),eE.default.notify({type:"success",message:s("datasetDeleted",{ns:"dataset"})}),y(),a("/datasets")}finally{x(!1)}},[f.id,a,y,s]);return(0,o.jsxs)(e6.PortalToFollowElem,{open:r,onOpenChange:l,placement:t?"bottom-end":"right",offset:t?{mainAxis:4,crossAxis:10}:{mainAxis:4},children:[(0,o.jsx)(e6.PortalToFollowElemTrigger,{onClick:g,children:(0,o.jsx)(W.default,{className:(0,v.cn)(t?"size-8 rounded-lg":"size-6 rounded-md"),children:(0,o.jsx)(b.RiMoreFill,{className:"size-4"})})}),(0,o.jsx)(e6.PortalToFollowElemContent,{className:"z-[60]",children:(0,o.jsx)(tg,{showDelete:!h,openRenameModal:C,handleExportPipeline:E,detectIsUsedByApp:_})}),i&&(0,o.jsx)(tf.default,{show:i,dataset:f,onClose:()=>n(!1),onSuccess:N}),u&&(0,o.jsx)(k.default,{title:s("deleteDatasetConfirmTitle",{ns:"dataset"}),content:d,isShow:u,onConfirm:M,onCancel:()=>x(!1)})]})}),tb=m.memo(e=>{let{expand:t}=e,{t:s}=(0,j.useTranslation)(),a=(0,to.useDatasetDetailContextWithSelector)(e=>e.dataset),r=a.icon_info||{icon:"ð",icon_type:"emoji",icon_background:"#FFF4ED",icon_url:""},l="external"===a.provider,i=(0,m.useMemo)(()=>"rag_pipeline"===a.runtime_mode&&a.is_published,[a.runtime_mode,a.is_published]),{formatIndexingTechniqueAndMethod:n}=(0,td.useKnowledge)();return(0,o.jsxs)("div",{className:(0,v.cn)("relative flex flex-col",t?"":"p-1"),children:[t&&(0,o.jsx)(tp.default,{className:"-left-5 top-[-22px] opacity-15"}),(0,o.jsxs)("div",{className:"flex flex-col gap-2 p-2",children:[(0,o.jsxs)("div",{className:"flex items-center gap-1",children:[(0,o.jsx)("div",{className:(0,v.cn)(!t&&"-ml-1"),children:(0,o.jsx)(eb.default,{size:t?"large":"small",iconType:r.icon_type,icon:r.icon,background:r.icon_background,imageUrl:r.icon_url})}),t&&(0,o.jsx)("div",{className:"ml-auto",children:(0,o.jsx)(ty,{expand:!0})})]}),!t&&(0,o.jsx)("div",{className:"-mb-2 -mt-1 flex items-center justify-center",children:(0,o.jsx)(ty,{expand:!1})}),t&&(0,o.jsxs)("div",{className:"flex flex-col gap-y-1 pb-0.5",children:[(0,o.jsx)("div",{className:"system-md-semibold truncate text-text-secondary",title:a.name,children:a.name}),(0,o.jsxs)("div",{className:"system-2xs-medium-uppercase text-text-tertiary",children:[l&&s("externalTag",{ns:"dataset"}),!!(!l&&i&&a.doc_form&&a.indexing_technique)&&(0,o.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,o.jsx)("span",{children:s(`chunkingMode.${tc.DOC_FORM_TEXT[a.doc_form]}`,{ns:"dataset"})}),(0,o.jsx)("span",{children:n(a.indexing_technique,a.retrieval_model_dict?.search_method)})]})]}),!!a.description&&(0,o.jsx)("p",{className:"system-xs-regular line-clamp-3 text-text-tertiary first-letter:capitalize",children:a.description})]})]})]})});e.i(9633);var tw=e.i(189445),tj=e.i(606466);let tN=m.memo(e=>{let{apiEnabled:t}=e,{t:s}=(0,j.useTranslation)(),a=(0,to.useDatasetDetailContextWithSelector)(e=>e.dataset?.id),r=(0,to.useDatasetDetailContextWithSelector)(e=>e.mutateDatasetRes),{mutateAsync:l}=(0,tu.useEnableDatasetServiceApi)(),{mutateAsync:i}=(0,tu.useDisableDatasetServiceApi)(),n=(0,Z.useSelector)(e=>e.isCurrentWorkspaceManager),d=(0,tj.useDatasetApiAccessUrl)(),c=(0,m.useCallback)(async e=>{"success"===(e?(await l(a??"")).result:(await i(a??"")).result)&&r?.()},[a,l,r,i]);return(0,o.jsxs)("div",{className:"w-[208px] rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur shadow-lg",children:[(0,o.jsx)("div",{className:"p-1",children:(0,o.jsxs)("div",{className:"p-2",children:[(0,o.jsxs)("div",{className:"mb-1.5 flex justify-between",children:[(0,o.jsxs)("div",{className:"flex items-center gap-1",children:[(0,o.jsx)(Y.default,{className:"shrink-0",color:t?"green":"yellow"}),(0,o.jsx)("div",{className:(0,v.cn)("system-xs-semibold-uppercase",t?"text-text-success":"text-text-warning"),children:s(t?"serviceApi.enabled":"serviceApi.disabled",{ns:"dataset"})})]}),(0,o.jsx)(Q.default,{defaultValue:t,onChange:c,disabled:!n})]}),(0,o.jsx)("div",{className:"system-xs-regular text-text-tertiary",children:s("appMenus.apiAccessTip",{ns:"common"})})]})}),(0,o.jsx)("div",{className:"h-px bg-divider-subtle"}),(0,o.jsx)("div",{className:"p-1",children:(0,o.jsxs)(eg.default,{href:d,target:"_blank",rel:"noopener noreferrer",className:"flex h-8 items-center space-x-[7px] rounded-lg px-2 text-text-tertiary hover:bg-state-base-hover",children:[(0,o.jsx)(b.RiBookOpenLine,{className:"size-3.5 shrink-0"}),(0,o.jsx)("div",{className:"system-sm-regular grow truncate",children:s("overview.apiInfo.doc",{ns:"appOverview"})}),(0,o.jsx)(b.RiArrowRightUpLine,{className:"size-3.5 shrink-0"})]})})]})}),tC=m.memo(e=>{let{expand:t,apiEnabled:s}=e,{t:a}=(0,j.useTranslation)(),[r,l]=(0,m.useState)(!1);return(0,o.jsx)("div",{className:"p-3 pt-2",children:(0,o.jsxs)(e6.PortalToFollowElem,{open:r,onOpenChange:l,placement:"top-start",offset:{mainAxis:4,crossAxis:-4},children:[(0,o.jsx)(e6.PortalToFollowElemTrigger,{className:"w-full",onClick:()=>{l(!r)},children:(0,o.jsxs)("div",{className:(0,v.cn)("relative flex h-8 cursor-pointer items-center gap-2 rounded-lg border border-components-panel-border px-3",!t&&"w-8 justify-center",r?"bg-state-base-hover":"hover:bg-state-base-hover"),children:[(0,o.jsx)(tw.ApiAggregate,{className:"size-4 shrink-0 text-text-secondary"}),t&&(0,o.jsx)("div",{className:"system-sm-medium grow text-text-secondary",children:a("appMenus.apiAccess",{ns:"common"})}),(0,o.jsx)(Y.default,{className:(0,v.cn)("shrink-0",!t&&"absolute -right-px -top-px"),color:s?"green":"yellow"})]})}),(0,o.jsx)(e6.PortalToFollowElemContent,{className:"z-[10]",children:(0,o.jsx)(tN,{apiEnabled:s})})]})})}),tA={[el.AppModeEnum.CHAT]:"Chatbot",[el.AppModeEnum.COMPLETION]:"Completion",[el.AppModeEnum.AGENT_CHAT]:"Agent",[el.AppModeEnum.ADVANCED_CHAT]:"Chatflow",[el.AppModeEnum.WORKFLOW]:"Workflow"},tk=e=>{let{detail:t,isMobile:s}=e;return(0,o.jsxs)(eg.default,{className:(0,v.cn)("group/link-item flex h-8 w-full cursor-pointer items-center justify-between rounded-lg px-2 hover:bg-state-base-hover",s&&"justify-center"),href:`/app/${t?.id}/overview`,children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:(0,v.cn)("relative h-6 w-6 rounded-md"),children:(0,o.jsx)(eb.default,{size:"tiny",iconType:t.icon_type,icon:t.icon,background:t.icon_background,imageUrl:t.icon_url})}),!s&&(0,o.jsx)("div",{className:(0,v.cn)(" system-sm-medium ml-2 truncate text-text-primary"),children:t?.name||"--"})]}),(0,o.jsx)("div",{className:"system-2xs-medium-uppercase shrink-0 text-text-tertiary group-hover/link-item:hidden",children:tA[t.mode]}),(0,o.jsx)(b.RiArrowRightUpLine,{className:"hidden h-4 w-4 text-text-tertiary group-hover/link-item:block"})]})},tE=m.memo(e=>{let{relatedApps:t,isMobile:s}=e;return(0,o.jsx)("div",{className:"w-[320px] rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur p-1 shadow-lg backdrop-blur-[5px]",children:t.map((e,t)=>(0,o.jsx)(tk,{detail:e,isMobile:s},t))})}),t_=m.memo(()=>{let{t:e}=(0,j.useTranslation)(),t=(0,ee.useDocLink)();return(0,o.jsxs)("div",{className:"w-[240px] rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur p-4",children:[(0,o.jsx)("div",{className:"inline-flex rounded-lg border-[0.5px] border-components-panel-border-subtle bg-background-default-subtle p-2",children:(0,o.jsx)(b.RiApps2AddLine,{className:"size-4 text-text-tertiary"})}),(0,o.jsx)("div",{className:"my-2 text-xs text-text-tertiary",children:e("datasetMenus.emptyTip",{ns:"common"})}),(0,o.jsxs)("a",{className:"mt-2 inline-flex cursor-pointer items-center text-xs text-text-accent",href:t("/use-dify/knowledge/integrate-knowledge-within-application"),target:"_blank",rel:"noopener noreferrer",children:[(0,o.jsx)(b.RiBookOpenLine,{className:"mr-1 size-4 text-text-accent"}),e("datasetMenus.viewDoc",{ns:"common"})]})]})}),tM=m.memo(e=>{let{expand:t,documentCount:s,relatedApps:a}=e,{t:r}=(0,j.useTranslation)(),l=a?.total,i=a?.data&&a.data.length>0;return(0,o.jsxs)("div",{className:"flex items-center gap-x-0.5 p-2 pb-0",children:[(0,o.jsxs)("div",{className:"flex grow flex-col px-2 pb-1.5 pt-1",children:[(0,o.jsx)("div",{className:"system-md-semibold-uppercase text-text-secondary",children:s??"--"}),(0,o.jsx)("div",{className:"system-2xs-medium-uppercase text-text-tertiary",children:r("datasetMenus.documents",{ns:"common"})})]}),(0,o.jsx)("div",{className:"py-2 pl-0.5 pr-1.5",children:(0,o.jsx)(g.default,{className:"text-test-divider-regular h-full w-fit"})}),(0,o.jsxs)("div",{className:"flex grow flex-col px-2 pb-1.5 pt-1",children:[(0,o.jsx)("div",{className:"system-md-semibold-uppercase text-text-secondary",children:l??"--"}),(0,o.jsx)(V.default,{position:"top-start",noDecoration:!0,needsDelay:!0,popupContent:i?(0,o.jsx)(tE,{relatedApps:a.data,isMobile:!t}):(0,o.jsx)(t_,{}),children:(0,o.jsxs)("div",{className:"system-2xs-medium-uppercase flex cursor-pointer items-center gap-x-0.5 text-text-tertiary",children:[(0,o.jsx)("span",{children:r("datasetMenus.relatedApp",{ns:"common"})}),(0,o.jsx)(b.RiInformation2Line,{className:"size-3"})]})})]})]})}),tS=m.memo(e=>{let{relatedApps:t,documentCount:s,expand:a}=e,r=(0,to.useDatasetDetailContextWithSelector)(e=>e.dataset?.enable_api);return(0,o.jsxs)(o.Fragment,{children:[a&&(0,o.jsx)(tM,{expand:a,documentCount:s,relatedApps:t}),(0,o.jsx)(tC,{expand:a,apiEnabled:r??!1})]})});e.s(["default",0,tS],303084);let tT=e=>{let{navigation:t}=e,{t:s}=(0,j.useTranslation)(),a=(0,to.useDatasetDetailContextWithSelector)(e=>e.dataset),{data:r}=(0,tu.useDatasetRelatedApps)(a.id),[l,i]=(0,m.useState)(!1),n=(0,m.useRef)(l),d=(0,m.useCallback)(e=>{i(e),n.current=e},[i]),c=(0,m.useCallback)(()=>{d(!n.current)},[d]),p=a.icon_info||{icon:"ð",icon_type:"emoji",icon_background:"#FFF4ED",icon_url:""},u="external"===a.provider,{formatIndexingTechniqueAndMethod:x}=(0,td.useKnowledge)();return a?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"fixed left-2 top-2 z-20",children:(0,o.jsxs)(e6.PortalToFollowElem,{open:l,onOpenChange:d,placement:"bottom-start",offset:{mainAxis:-41},children:[(0,o.jsx)(e6.PortalToFollowElemTrigger,{onClick:c,children:(0,o.jsxs)("div",{className:(0,v.cn)("flex cursor-pointer items-center rounded-[10px] border-[0.5px] border-components-actionbar-border bg-components-actionbar-bg p-1 shadow-lg backdrop-blur-sm hover:bg-background-default-hover",l&&"bg-background-default-hover"),children:[(0,o.jsx)(eb.default,{size:"small",iconType:p.icon_type,icon:p.icon,background:p.icon_background,imageUrl:p.icon_url}),(0,o.jsx)(b.RiMenuLine,{className:"size-4 text-text-tertiary"})]})}),(0,o.jsx)(e6.PortalToFollowElemContent,{className:"z-50",children:(0,o.jsxs)("div",{className:"relative w-[216px] rounded-xl border-[0.5px] border-components-panel-border bg-background-default-subtle shadow-lg",children:[(0,o.jsx)(tp.default,{className:"-left-5 top-[-22px] opacity-15"}),(0,o.jsxs)("div",{className:"flex flex-col gap-y-2 p-4",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)(eb.default,{size:"medium",iconType:p.icon_type,icon:p.icon,background:p.icon_background,imageUrl:p.icon_url}),(0,o.jsx)(ty,{expand:!0})]}),(0,o.jsxs)("div",{className:"flex flex-col gap-y-1 pb-0.5",children:[(0,o.jsx)("div",{className:"system-md-semibold truncate text-text-secondary",title:a.name,children:a.name}),(0,o.jsxs)("div",{className:"system-2xs-medium-uppercase text-text-tertiary",children:[u&&s("externalTag",{ns:"dataset"}),!!(!u&&a.doc_form&&a.indexing_technique)&&(0,o.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,o.jsx)("span",{children:s(`chunkingMode.${tc.DOC_FORM_TEXT[a.doc_form]}`,{ns:"dataset"})}),(0,o.jsx)("span",{children:x(a.indexing_technique,a.retrieval_model_dict?.search_method)})]})]})]}),!!a.description&&(0,o.jsx)("p",{className:"system-xs-regular line-clamp-3 text-text-tertiary first-letter:capitalize",children:a.description})]}),(0,o.jsx)("div",{className:"px-4 py-2",children:(0,o.jsx)(g.default,{type:"horizontal",bgStyle:"gradient",className:"my-0 h-px bg-gradient-to-r from-divider-subtle to-background-gradient-mask-transparent"})}),(0,o.jsx)("nav",{className:"flex min-h-[200px] grow flex-col gap-y-0.5 px-3 py-2",children:t.map((e,t)=>(0,o.jsx)(ti,{mode:"expand",iconMap:{selected:e.selectedIcon,normal:e.icon},name:e.name,href:e.href,disabled:!!e.disabled},t))}),(0,o.jsx)(tS,{relatedApps:r,expand:!0,documentCount:a.document_count})]})})]})})}):null};var tI=e.i(194902);let tO=["ctrl","B"],tR=e=>{let{expand:t}=e,{t:s}=(0,j.useTranslation)();return(0,o.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,o.jsx)("span",{className:"system-xs-medium px-0.5 text-text-secondary",children:s(t?"sidebar.collapseSidebar":"sidebar.expandSidebar",{ns:"layout"})}),(0,o.jsx)(tI.default,{keys:tO,textColor:"secondary"})]})},tP=m.memo(e=>{let{expand:t,handleToggle:s,className:a}=e;return(0,o.jsx)(V.default,{popupContent:(0,o.jsx)(tR,{expand:t}),popupClassName:"p-1.5 rounded-lg",position:"right",children:(0,o.jsx)(A.default,{size:"small",onClick:s,className:(0,v.cn)("rounded-full px-1",a),children:t?(0,o.jsx)(b.RiArrowLeftSLine,{className:"size-4"}):(0,o.jsx)(b.RiArrowRightSLine,{className:"size-4"})})})}),tD=m.memo(e=>{let{navigation:t,extraInfo:s,iconType:a="app"}=e,{appSidebarExpand:r,setAppSidebarExpand:l}=(0,x.useStore)((0,u.useShallow)(e=>({appSidebarExpand:e.appSidebarExpand,setAppSidebarExpand:e.setAppSidebarExpand}))),i=m.useRef(null),n=(0,f.default)()===f.MediaType.mobile,b="expand"===r,w=(0,m.useCallback)(()=>{l("expand"===r?"collapse":"expand")},[r,l]),j=(0,d.useHover)(i),N=(0,p.usePathname)(),C=N.endsWith("/workflow"),A=N.endsWith("/pipeline"),k="true"===localStorage.getItem("workflow-canvas-maximize"),[E,_]=(0,m.useState)(k),{eventEmitter:M}=(0,h.useEventEmitterContextContext)();return(M?.useSubscription(e=>{e?.type==="workflow-canvas-maximize"&&_(e.payload)}),(0,m.useEffect)(()=>{r&&(localStorage.setItem("app-detail-collapse-or-expand",r),l(r))},[r,l]),(0,c.useKeyPress)(`${(0,y.getKeyboardKeyCodeBySystem)("ctrl")}.b`,e=>{e.preventDefault(),w()},{exactMatch:!0,useCapture:!0}),C&&E)?(0,o.jsx)("div",{className:"flex w-0 shrink-0",children:(0,o.jsx)(tn,{navigation:t})}):A&&E?(0,o.jsx)("div",{className:"flex w-0 shrink-0",children:(0,o.jsx)(tT,{navigation:t})}):(0,o.jsxs)("div",{ref:i,className:(0,v.cn)("flex shrink-0 flex-col border-r border-divider-burn bg-background-default-subtle transition-all",b?"w-[216px]":"w-14"),children:[(0,o.jsxs)("div",{className:(0,v.cn)("shrink-0",b?"p-2":"p-1"),children:["app"===a&&(0,o.jsx)(tl,{expand:b}),"app"!==a&&(0,o.jsx)(tb,{expand:b})]}),(0,o.jsxs)("div",{className:"relative px-4 py-2",children:[(0,o.jsx)(g.default,{type:"horizontal",bgStyle:b?"gradient":"solid",className:(0,v.cn)("my-0 h-px",b?"bg-gradient-to-r from-divider-subtle to-background-gradient-mask-transparent":"bg-divider-subtle")}),!n&&j&&(0,o.jsx)(tP,{className:"absolute -right-3 top-[-3.5px] z-20",expand:b,handleToggle:w})]}),(0,o.jsx)("nav",{className:(0,v.cn)("flex grow flex-col gap-y-0.5",b?"px-3 py-2":"p-3"),children:t.map((e,t)=>(0,o.jsx)(ti,{mode:r,iconMap:{selected:e.selectedIcon,normal:e.icon},name:e.name,href:e.href,disabled:!!e.disabled},t))}),"app"!==a&&s&&s(r)]})});e.s(["default",0,tD],476054)}]);