(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,260366,e=>{"use strict";var t=e.i(153412);e.s(["Csv",()=>t.default])},75518,e=>{"use strict";var t=e.i(563199),a=e.i(339548);let r=(0,a.createContext)({chatList:[],readonly:!1});e.s(["ChatContextProvider",0,e=>{let{children:a,readonly:s=!1,config:i,isResponding:n,chatList:l,showPromptLog:o,questionIcon:u,answerIcon:d,onSend:c,onRegenerate:p,onAnnotationEdited:m,onAnnotationAdded:f,onAnnotationRemoved:h,disableFeedback:v,onFeedback:g}=e;return(0,t.jsx)(r.Provider,{value:{config:i,readonly:s,isResponding:n,chatList:l||[],showPromptLog:o,questionIcon:u,answerIcon:d,onSend:c,onRegenerate:p,onAnnotationEdited:m,onAnnotationAdded:f,onAnnotationRemoved:h,disableFeedback:v,onFeedback:g},children:a})},"useChatContext",0,()=>(0,a.useContext)(r)])},992280,835633,926122,e=>{"use strict";var t=e.i(563199),a=e.i(807324);e.i(581367),e.i(233222);var r=e.i(131986);let s=e=>{let{ref:s,...i}=e;return(0,t.jsx)(a.default,{...i,ref:s,data:r.default})};s.displayName="MagicBox",e.s(["default",0,s],835633),e.i(235490),e.i(240899),e.i(739309),e.i(95787),e.i(660921),e.i(360506),e.i(588509);var i=e.i(720076);let n=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:i.default})};n.displayName="StopCircle",e.s(["default",0,n],926122),e.i(870896),e.s([],992280)},626506,296968,12570,606227,e=>{"use strict";var t=e.i(563199),a=e.i(807324);e.i(311691);var r=e.i(22334);let s=e=>{let{ref:s,...i}=e;return(0,t.jsx)(a.default,{...i,ref:s,data:r.default})};s.displayName="BezierCurve03",e.s(["default",0,s],296968),e.i(690011),e.i(629031);var i=e.i(998334);let n=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:i.default})};n.displayName="ImageIndentLeft",e.s(["default",0,n],12570),e.i(82197),e.i(453673);var l=e.i(818781);let o=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:l.default})};o.displayName="TypeSquare",e.s(["default",0,o],606227),e.s([],626506)},913978,e=>{"use strict";var t=e.i(268255);e.i(152567);var a=e.i(408767),r=e.i(137667),s=e.i(390622),i=e.i(648404);e.s(["useCheckInputsForms",0,()=>{let{t:e}=(0,a.useTranslation)(),{notify:n}=(0,r.useToastContext)();return{checkInputsForm:(0,t.useCallback)((t,a)=>{let r="",l=!1,o=a.filter(e=>{let{required:t,type:a}=e;return t&&a!==s.InputVarType.checkbox});return(o?.length&&o.forEach(e=>{let{variable:a,label:n,type:o}=e;if(!r&&!l&&(t[a]||(r=n),(o===s.InputVarType.singleFile||o===s.InputVarType.multiFiles)&&t[a])){let e=t[a];l=Array.isArray(e)?e.find(e=>e.transferMethod===i.TransferMethod.local_file&&!e.uploadedId):e.transferMethod===i.TransferMethod.local_file&&!e.uploadedId}}),r)?(n({type:"error",message:e("errorMessage.valueOfVarRequired",{ns:"appDebug",key:r})}),!1):!l||void n({type:"info",message:e("errorMessage.waitForFileUpload",{ns:"appDebug"})})},[n,e])}}])},933548,e=>{"use strict";var t=e.i(367916);e.s(["fetchAgentLogDetail",0,e=>{let{appID:a,params:r}=e;return(0,t.get)(`/apps/${a}/agent/logs`,{params:r})},"fetchChatMessages",0,e=>{let{url:a,params:r}=e;return(0,t.get)(a,{params:r})},"fetchRunDetail",0,e=>(0,t.get)(e),"fetchTracingList",0,e=>{let{url:a}=e;return(0,t.get)(a)},"updateLogMessageAnnotations",0,e=>{let{url:a,body:r}=e;return(0,t.post)(a,{body:r})},"updateLogMessageFeedbacks",0,e=>{let{url:a,body:r}=e;return(0,t.post)(a,{body:r})}])},955371,e=>{"use strict";var t,a=((t={}).python3="python3",t.javascript="javascript",t.json="json",t);e.s(["CodeLanguage",()=>a])},381086,e=>{"use strict";var t,a=((t={}).none="none",t.failBranch="fail-branch",t.defaultValue="default-value",t);e.s(["ErrorHandleTypeEnum",()=>a])},410893,e=>{"use strict";var t=e.i(797181);e.s(["ArrowUpRight",()=>t.default])},389600,e=>{"use strict";var t=e.i(498664);e.s(["Copy",()=>t.default])},394895,e=>{"use strict";var t=e.i(563199),a=e.i(837699),r=e.i(268255),s=e.i(654313),i=e.i(391185),n=e.i(935139);e.s(["default",0,e=>{let{items:l,onSelect:o,secondItems:u,renderTrigger:d,triggerProps:c,popupClassName:p,itemClassName:m,secondItemClassName:f}=e,[h,v]=(0,r.useState)(!1),g=e=>{v(!1),o(e)};return(0,t.jsxs)(i.PortalToFollowElem,{open:h,onOpenChange:v,placement:"bottom-end",children:[(0,t.jsx)(i.PortalToFollowElemTrigger,{onClick:()=>v(e=>!e),children:d?d(h):(0,t.jsx)(s.default,{...c,className:(0,n.cn)(h&&"bg-divider-regular",c?.className),children:(0,t.jsx)(a.RiMoreFill,{className:"h-4 w-4 text-text-tertiary"})})}),(0,t.jsx)(i.PortalToFollowElemContent,{className:p,children:(0,t.jsxs)("div",{className:"rounded-lg border-[0.5px] border-components-panel-border bg-components-panel-bg text-sm text-text-secondary shadow-lg",children:[!!l.length&&(0,t.jsx)("div",{className:"p-1",children:l.map(e=>(0,t.jsx)("div",{className:(0,n.cn)("flex h-8 cursor-pointer items-center rounded-lg px-3 hover:bg-components-panel-on-panel-item-bg-hover",m),onClick:()=>g(e),children:e.text},e.value))}),!!l.length&&!!u?.length&&(0,t.jsx)("div",{className:"h-px bg-divider-regular"}),!!u?.length&&(0,t.jsx)("div",{className:"p-1",children:u.map(e=>(0,t.jsx)("div",{className:(0,n.cn)("flex h-8 cursor-pointer items-center rounded-lg px-3 hover:bg-components-panel-on-panel-item-bg-hover",f),onClick:()=>g(e),children:e.text},e.value))})]})})]})}])},670977,e=>{"use strict";var t=e.i(479147);e.s(["ArrowDownRoundFill",()=>t.default])},149086,289751,219830,e=>{"use strict";var t,a=e.i(824627),r=e.i(268255),s=e.i(295978),i=e.i(773923),n=e.i(703440);let l=function(e){n.default&&!(0,i.isFunction)(e)&&console.error("useMemoizedFn expected parameter is a function, got ".concat(typeof e));var t=(0,r.useRef)(e);t.current=(0,r.useMemo)(function(){return e},[e]);var a=(0,r.useRef)(void 0);return a.current||(a.current=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return t.current.apply(this,e)}),a.current};e.s(["default",0,l],289751);let o=(t=r.useEffect,function(e,a){var s=(0,r.useRef)(!1);t(function(){return function(){s.current=!1}},[]),t(function(){if(s.current)return e();s.current=!0},a)});e.s(["default",0,o],219830);var u="AHOOKS_SYNC_STORAGE_EVENT_NAME";function d(e){return function(t,n){void 0===n&&(n={});var d,c=n.listenStorageChange,p=void 0!==c&&c,m=n.onError,f=void 0===m?function(e){console.error(e)}:m;try{d=e()}catch(e){f(e)}function h(){try{var e=null==d?void 0:d.getItem(t);if(e)return n.deserializer?n.deserializer(e):JSON.parse(e)}catch(e){f(e)}return(0,i.isFunction)(n.defaultValue)?n.defaultValue():n.defaultValue}var v=(0,a.__read)((0,r.useState)(h),2),g=v[0],x=v[1];o(function(){x(h())},[t]);var b=function(e){e.key===t&&e.storageArea===d&&x(h())};return(0,s.default)("storage",b,{enable:p}),(0,s.default)(u,function(e){b(e.detail)},{enable:p}),[g,l(function(e){var a=(0,i.isFunction)(e)?e(g):e;p||x(a);try{var r=void 0,s=null==d?void 0:d.getItem(t);(0,i.isUndef)(a)?(r=null,null==d||d.removeItem(t)):(r=n.serializer?n.serializer(a):JSON.stringify(a),null==d||d.setItem(t,r)),dispatchEvent(new CustomEvent(u,{detail:{key:t,newValue:r,oldValue:s,storageArea:d}}))}catch(e){f(e)}})]}}e.s(["createUseStorageState",()=>d],149086)},598500,e=>{e.v({avatar:"style-module__12l82a__avatar","dot-flashing":"style-module__12l82a__dot-flashing","dot-flashing-avatar":"style-module__12l82a__dot-flashing-avatar",text:"style-module__12l82a__text"})},925818,e=>{"use strict";var t=e.i(563199),a=e.i(268255),r=e.i(935139),s=e.i(598500);let i=a.memo(e=>{let{type:a}=e;return(0,t.jsx)("div",{className:(0,r.cn)(s.default["dot-flashing"],s.default[a])})});e.s(["default",0,i])},793359,e=>{"use strict";var t=e.i(925521),a=e.i(367916);e.s(["addAnnotation",0,(e,t)=>(0,a.post)(`apps/${e}/annotations`,{body:t}),"annotationBatchImport",0,e=>{let{url:t,body:r}=e;return(0,a.post)(t,{body:r},{bodyStringify:!1,deleteContentType:!0})},"checkAnnotationBatchImportProgress",0,e=>{let{jobID:t,appId:r}=e;return(0,a.get)(`/apps/${r}/annotations/batch-import-status/${t}`)},"clearAllAnnotations",0,e=>(0,a.del)(`apps/${e}/annotations`),"delAnnotation",0,(e,t)=>(0,a.del)(`apps/${e}/annotations/${t}`),"delAnnotations",0,(e,t)=>{let r=t.map(e=>`annotation_id=${e}`).join("&");return(0,a.del)(`/apps/${e}/annotations?${r}`)},"editAnnotation",0,(e,t,r)=>(0,a.post)(`apps/${e}/annotations/${t}`,{body:r}),"fetchAnnotationConfig",0,e=>(0,a.get)(`apps/${e}/annotation-setting`),"fetchAnnotationList",0,(e,t)=>(0,a.get)(`apps/${e}/annotations`,{params:t}),"fetchExportAnnotationList",0,e=>(0,a.get)(`apps/${e}/annotations/export`),"fetchHitHistoryList",0,(e,t,r)=>(0,a.get)(`apps/${e}/annotations/${t}/hit-histories`,{params:r}),"queryAnnotationJobStatus",0,(e,t,r)=>(0,a.get)(`apps/${e}/annotation-reply/${t}/status/${r}`),"updateAnnotationScore",0,(e,t,r)=>(0,a.post)(`apps/${e}/annotation-settings/${t}`,{body:{score_threshold:r}}),"updateAnnotationStatus",0,(e,r,s,i)=>{let n={score_threshold:i||t.ANNOTATION_DEFAULT.score_threshold};return s&&(n={...n,...s}),(0,a.post)(`apps/${e}/annotation-reply/${r}`,{body:n})}])},942064,e=>{e.v({textGradient:"style-module__26SqPa__textGradient"})},800727,73399,110604,977512,e=>{"use strict";var t=e.i(563199),a=e.i(268255);e.i(152567);var r=e.i(408767),s=e.i(56971),i=e.i(807324);e.i(570262),e.i(559670);var n=e.i(552918);let l=e=>{let{ref:a,...r}=e;return(0,t.jsx)(i.default,{...r,ref:a,data:n.default})};l.displayName="ChatBotSlim",e.s(["default",0,l],73399),e.i(289950);var o=e.i(158116);let u=e=>{let{ref:a,...r}=e;return(0,t.jsx)(i.default,{...r,ref:a,data:o.default})};u.displayName="MessageCheckRemove",e.s(["default",0,u],110604);var d=e.i(297082);let c=e=>{let{ref:a,...r}=e;return(0,t.jsx)(i.default,{...r,ref:a,data:d.default})};c.displayName="MessageFastPlus",e.s([],977512);var p=e.i(130208);let m=a.memo(e=>{let{className:a}=e,{t:i}=(0,r.useTranslation)(),{plan:n}=(0,s.useProviderContext)(),{usage:l,total:o}=n;return(0,t.jsx)(p.default,{className:a,Icon:c,name:i("annotatedResponse.quotaTitle",{ns:"billing"}),usage:l.annotatedResponse,total:o.annotatedResponse})});e.s(["default",0,m],800727)},105518,e=>{e.v({pauseIcon:"style-module__NualRa__pauseIcon",playIcon:"style-module__NualRa__playIcon"})},627449,e=>{"use strict";var t=e.i(563199),a=e.i(268255),r=e.i(789604),s=e.i(157169);let i=a.forwardRef(function(e,t){let{title:r,titleId:s,...i}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},i),r?a.createElement("title",{id:s},r):null,a.createElement("path",{fillRule:"evenodd",d:"M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z",clipRule:"evenodd"}))});var n=e.i(516457),l=e.i(837699),o=e.i(105845),u=e.i(326531);e.i(152567);var d=e.i(408767);function c(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e.replace(t,a)}var p=["[","]","{","}","(",")","|","/","-","\\"],m=[...p," ","_","."];RegExp(`[${m.map(function(e){return p.includes(e)?`\\${e}`:e}).join("")}]`,"g");var f=e.i(915389),h=e.i(153935),v=e.i(449980),g=e.i(421001),x=e.i(105518);let b=e=>{let{id:r,voice:s,value:i,className:n,isAudition:l}=e,[o,d]=(0,a.useState)("initial"),c=(0,u.useParams)(),p=(0,u.usePathname)(),m=e=>{switch(e){case"ended":case"paused":case"error":d("ended");break;case"loaded":d("loading");break;case"play":d("playing")}},b="",y=!1;c.token?(b="/text-to-audio",y=!0):c.appId&&(b=p.search("explore/installed")>-1?`/installed-apps/${c.appId}/text-to-audio`:`/apps/${c.appId}/text-to-audio`);let j=async()=>{"playing"===o||"loading"===o?(setTimeout(()=>d("paused"),1),h.AudioPlayerManager.getInstance().getAudioPlayer(b,y,r,i,s,m).pauseAudio()):(setTimeout(()=>d("loading"),1),h.AudioPlayerManager.getInstance().getAudioPlayer(b,y,r,i,s,m).playAudio())},N={initial:(0,f.t)("play",{ns:"appApi"}),ended:(0,f.t)("play",{ns:"appApi"}),paused:(0,f.t)("pause",{ns:"appApi"}),playing:(0,f.t)("playing",{ns:"appApi"}),loading:(0,f.t)("loading",{ns:"appApi"})}[o];return(0,t.jsx)("div",{className:`inline-flex items-center justify-center ${"loading"===o||"playing"===o?"mr-1":n}`,children:(0,t.jsx)(g.default,{popupContent:N,children:(0,t.jsx)("button",{type:"button",disabled:"loading"===o,className:`box-border flex h-6 w-6 cursor-pointer items-center justify-center ${l?"p-0.5":"rounded-md bg-white p-0"}`,onClick:j,children:"loading"===o?(0,t.jsx)("div",{className:"flex h-full w-full items-center justify-center rounded-md",children:(0,t.jsx)(v.default,{})}):(0,t.jsx)("div",{className:"flex h-full w-full items-center justify-center rounded-md hover:bg-gray-50",children:(0,t.jsx)("div",{className:`h-4 w-4 ${"playing"===o?x.default.pauseIcon:x.default.playIcon}`})})})})})};var y=e.i(987878),j=e.i(260484),N=e.i(491234),w=e.i(632815),C=e.i(648404),A=e.i(935139);let S=a.memo(e=>{let{onClose:p,onChange:m}=e,{t:f}=(0,d.useTranslation)(),h=(0,u.usePathname)().match(/\/app\/([^/]+)/),v=h?.length&&h[1]?h[1]:"",x=(0,y.useFeatures)(e=>e.features.text2speech),S=(0,y.useFeaturesStore)(),I=N.languages.find(e=>e.value===x?.language);N.languages&&!I&&(I=N.languages[0]);let T=I?.name||f("placeholder.select",{ns:"common"}),k=I?.value,{data:F}=(0,w.useAppVoices)(v,k),E=F?.find(e=>e.value===x?.voice);F&&!E&&(E=F[0]);let M=E?.name||f("placeholder.select",{ns:"common"}),D=e=>{let{features:t,setFeatures:a}=S.getState();a((0,o.produce)(t,t=>{t.text2speech={...t.text2speech,...e}})),m&&m()};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,t.jsx)("div",{className:"system-xl-semibold text-text-primary",children:f("voice.voiceSettings.title",{ns:"appDebug"})}),(0,t.jsx)("div",{className:"cursor-pointer p-1",onClick:p,children:(0,t.jsx)(l.RiCloseLine,{className:"h-4 w-4 text-text-tertiary"})})]}),(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsxs)("div",{className:"system-sm-semibold mb-1 flex items-center py-1 text-text-secondary",children:[f("voice.voiceSettings.language",{ns:"appDebug"}),(0,t.jsx)(g.default,{popupContent:(0,t.jsx)("div",{className:"w-[180px]",children:f("voice.voiceSettings.resolutionTooltip",{ns:"appDebug"}).split("\n").map(e=>(0,t.jsx)("div",{children:e},e))})})]}),(0,t.jsx)(r.Listbox,{value:I,onChange:e=>{D({language:String(e.value)})},children:(0,t.jsxs)("div",{className:"relative h-8",children:[(0,t.jsxs)(r.ListboxButton,{className:"h-full w-full cursor-pointer rounded-lg border-0 bg-components-input-bg-normal py-1.5 pl-3 pr-10 focus-visible:bg-state-base-hover focus-visible:outline-none group-hover:bg-state-base-hover sm:text-sm sm:leading-6",children:[(0,t.jsx)("span",{className:(0,A.cn)("block truncate text-left text-text-secondary",!I?.name&&"text-text-tertiary"),children:I?.name?f(`voice.language.${c(I?.value,"-","")}`,{ns:"common"}):T}),(0,t.jsx)("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:(0,t.jsx)(n.ChevronDownIcon,{className:"h-4 w-4 text-text-tertiary","aria-hidden":"true"})})]}),(0,t.jsx)(s.Transition,{as:a.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,t.jsx)(r.ListboxOptions,{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md border-[0.5px] border-components-panel-border bg-components-panel-bg px-1 py-1 text-base shadow-lg focus:outline-none sm:text-sm",children:N.languages.map(e=>(0,t.jsx)(r.ListboxOption,{className:"relative cursor-pointer select-none rounded-lg py-2 pl-3 pr-9 text-text-secondary hover:bg-state-base-hover data-[active]:bg-state-base-active",value:e,disabled:!1,children:a=>{let{selected:r}=a;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:(0,A.cn)("block",r&&"font-normal"),children:f(`voice.language.${c(e.value,"-","")}`,{ns:"common"})}),(r||e.value===x?.language)&&(0,t.jsx)("span",{className:(0,A.cn)("absolute inset-y-0 right-0 flex items-center pr-4 text-text-secondary"),children:(0,t.jsx)(i,{className:"h-4 w-4","aria-hidden":"true"})})]})}},e.value))})})]})})]}),(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("div",{className:"system-sm-semibold mb-1 py-1 text-text-secondary",children:f("voice.voiceSettings.voice",{ns:"appDebug"})}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(r.Listbox,{value:E??{},disabled:!I,onChange:e=>{D({voice:String(e.value)})},children:(0,t.jsxs)("div",{className:"relative h-8 grow",children:[(0,t.jsxs)(r.ListboxButton,{className:"h-full w-full cursor-pointer rounded-lg border-0 bg-components-input-bg-normal py-1.5 pl-3 pr-10 focus-visible:bg-state-base-hover focus-visible:outline-none group-hover:bg-state-base-hover sm:text-sm sm:leading-6",children:[(0,t.jsx)("span",{className:(0,A.cn)("block truncate text-left text-text-secondary",!E?.name&&"text-text-tertiary"),children:E?.name??M}),(0,t.jsx)("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:(0,t.jsx)(n.ChevronDownIcon,{className:"h-4 w-4 text-text-tertiary","aria-hidden":"true"})})]}),(0,t.jsx)(s.Transition,{as:a.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,t.jsx)(r.ListboxOptions,{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md border-[0.5px] border-components-panel-border bg-components-panel-bg px-1 py-1 text-base shadow-lg focus:outline-none sm:text-sm",children:F?.map(e=>(0,t.jsx)(r.ListboxOption,{className:"relative cursor-pointer select-none rounded-lg py-2 pl-3 pr-9 text-text-secondary hover:bg-state-base-hover data-[active]:bg-state-base-active",value:e,disabled:!1,children:a=>{let{selected:r}=a;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:(0,A.cn)("block",r&&"font-normal"),children:e.name}),(r||e.value===x?.voice)&&(0,t.jsx)("span",{className:(0,A.cn)("absolute inset-y-0 right-0 flex items-center pr-4 text-text-secondary"),children:(0,t.jsx)(i,{className:"h-4 w-4","aria-hidden":"true"})})]})}},e.value))})})]})}),I?.example&&(0,t.jsx)("div",{className:"h-8 shrink-0 rounded-lg bg-components-button-tertiary-bg p-1",children:(0,t.jsx)(b,{value:I?.example,isAudition:!0,voice:x?.voice,noCache:!0})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"system-sm-semibold mb-1 py-1 text-text-secondary",children:f("voice.voiceSettings.autoPlay",{ns:"appDebug"})}),(0,t.jsx)(j.default,{className:"shrink-0",defaultValue:x?.autoPlay===C.TtsAutoPlay.enabled,onChange:e=>{D({autoPlay:e?C.TtsAutoPlay.enabled:C.TtsAutoPlay.disabled})}})]})]})});var I=e.i(391185);let T=(0,a.memo)(e=>{let{open:a,onOpen:r,onChange:s,disabled:i,children:n,placementLeft:l=!0}=e;return(0,t.jsxs)(I.PortalToFollowElem,{open:a,onOpenChange:r,placement:l?"left":"top",offset:{mainAxis:l?32:4},children:[(0,t.jsx)(I.PortalToFollowElemTrigger,{className:"flex",onClick:()=>!i&&r(e=>!e),children:n}),(0,t.jsx)(I.PortalToFollowElemContent,{style:{zIndex:50},children:(0,t.jsx)("div",{className:"w-[360px] rounded-2xl border-[0.5px] border-components-panel-border bg-components-panel-bg p-4 shadow-2xl",children:(0,t.jsx)(S,{onClose:()=>r(!1),onChange:s})})})]})});e.s(["default",0,T],627449)},966391,888154,842826,399960,7551,455702,522822,420424,918033,232070,768974,e=>{"use strict";var t=e.i(563199),a=e.i(807324),r=e.i(981223);let s=e=>{let{ref:s,...i}=e;return(0,t.jsx)(a.default,{...i,ref:s,data:r.default})};s.displayName="Citations",e.s(["default",0,s],888154);var i=e.i(724524);let n=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:i.default})};n.displayName="ContentModeration",e.s(["default",0,n],842826);var l=e.i(893742);let o=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:l.default})};o.displayName="Document",e.s(["default",0,o],399960);var u=e.i(793080);let d=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:u.default})};d.displayName="FolderUpload",e.s(["default",0,d],7551);var c=e.i(751534);let p=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:c.default})};p.displayName="LoveMessage",e.s(["default",0,p],455702);var m=e.i(869072);let f=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:m.default})};f.displayName="MessageFast",e.s(["default",0,f],522822);var h=e.i(857137);let v=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:h.default})};v.displayName="Microphone01",e.s(["default",0,v],420424);var g=e.i(950261);let x=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:g.default})};x.displayName="TextToAudio",e.s(["default",0,x],918033);var b=e.i(217185);let y=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:b.default})};y.displayName="VirtualAssistant",e.s(["default",0,y],232070);var j=e.i(189137);let N=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:j.default})};N.displayName="Vision",e.s(["default",0,N],768974),e.s([],966391)},578757,e=>{"use strict";var t=e.i(888154);e.s(["Citations",()=>t.default])},289553,e=>{"use strict";var t=e.i(842826);e.s(["ContentModeration",()=>t.default])},575751,e=>{"use strict";var t=e.i(7551);e.s(["FolderUpload",()=>t.default])},854233,e=>{"use strict";var t=e.i(455702);e.s(["LoveMessage",()=>t.default])},606448,e=>{"use strict";var t=e.i(522822);e.s(["MessageFast",()=>t.default])},501630,e=>{"use strict";var t=e.i(420424);e.s(["Microphone01",()=>t.default])},539342,e=>{"use strict";var t=e.i(918033);e.s(["TextToAudio",()=>t.default])},208507,e=>{"use strict";var t=e.i(232070);e.s(["VirtualAssistant",()=>t.default])},600839,e=>{"use strict";var t=e.i(296776);e.s(["Notion",()=>t.default])},130208,e=>{"use strict";var t=e.i(563199),a=e.i(268255);e.i(152567);var r=e.i(408767),s=e.i(421001),i=e.i(935139),n=e.i(623244),l=e.i(910808);let o=a.memo(e=>{let{className:a,Icon:o,name:u,tooltip:d,usage:c,total:p,unit:m,unitPosition:f="suffix",resetHint:h,resetInDays:v,hideIcon:g=!1,storageMode:x=!1,storageThreshold:b=50,storageTooltip:y,isSandboxPlan:j=!1}=e,{t:N}=(0,r.useTranslation)(),w=x&&c<b,C=x&&j&&c>=b,A=c/p*100,S=p===n.NUM_INFINITE,I=S?N("plansCommon.unlimited",{ns:"billing"}):p;!S&&m&&"inline"===f&&(I=`${p}${m}`);let T=!!m&&!S&&"suffix"===f,k=h??("number"==typeof v?N("usagePage.resetsIn",{ns:"billing",count:v}):void 0),F=e=>x&&y?(0,t.jsx)(s.default,{popupContent:(0,t.jsx)("div",{className:"w-[200px]",children:y}),asChild:!1,children:(0,t.jsx)("div",{className:"cursor-default",children:e})}):e;return(0,t.jsxs)("div",{className:(0,i.cn)("flex flex-col gap-2 rounded-xl bg-components-panel-bg p-4",a),children:[!g&&o&&(0,t.jsx)(o,{className:"h-4 w-4 text-text-tertiary"}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("div",{className:"system-xs-medium text-text-tertiary",children:u}),d&&(0,t.jsx)(s.default,{popupContent:(0,t.jsx)("div",{className:"w-[180px]",children:d})})]}),(0,t.jsxs)("div",{className:"system-md-semibold flex items-center gap-1 text-text-primary",children:[F((()=>{if(x){if(C)return(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{children:b}),(0,t.jsx)("span",{className:"system-md-regular text-text-quaternary",children:"/"}),(0,t.jsxs)("span",{children:[b," ",m]})]});if(w)return(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsxs)("span",{children:["<"," ",b]}),!j&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"system-md-regular text-text-quaternary",children:"/"}),(0,t.jsx)("span",{children:I})]}),j&&(0,t.jsx)("span",{children:m})]})}return(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{children:c}),(0,t.jsx)("span",{className:"system-md-regular text-text-quaternary",children:"/"}),(0,t.jsx)("span",{children:I})]})})()),k?(0,t.jsx)("div",{className:"system-xs-regular ml-auto flex-1 text-right text-text-tertiary",children:k}):T?(0,t.jsx)("div",{className:"system-xs-medium ml-auto text-text-tertiary",children:m}):null]}),F((0,t.jsx)(l.default,{percent:w?0:A,color:C||A>=100?"bg-components-progress-error-progress":A>=80?"bg-components-progress-warning-progress":"bg-components-progress-bar-progress-solid",indeterminate:w,indeterminateFull:w&&j}))]})});e.s(["default",0,o])},34628,e=>{e.v({gridBg:"style-module__T68GKq__gridBg"})},325222,e=>{"use strict";var t=e.i(563199),a=e.i(935139),r=e.i(34628);e.s(["default",0,e=>{let{children:s,wrapperClassName:i,canvasClassName:n,gradientClassName:l}=e;return(0,t.jsxs)("div",{className:(0,a.cn)("relative bg-saas-background",i),children:[(0,t.jsx)("div",{className:(0,a.cn)("absolute inset-0 z-0 h-full w-full opacity-70",n,r.default.gridBg)}),(0,t.jsx)("div",{className:(0,a.cn)("absolute z-[1] h-full w-full rounded-lg bg-grid-mask-background",l)}),(0,t.jsx)("div",{className:"relative z-[2]",children:s})]})}])},511334,e=>{"use strict";function t(){return(t=Object.assign.bind()).apply(null,arguments)}e.s(["default",()=>t])},318680,e=>{"use strict";function t(e,t){if(null==e)return{};var a={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;a[r]=e[r]}return a}e.s(["default",()=>t])},666010,788666,e=>{"use strict";var t=e.i(875037),a=e.i(562572),r=e.i(621379);let s=new Set(["all",...r.DisplayStatusList.map(e=>e.toLowerCase())]),i={active:"available"},n={enabled:"available"},l=e=>{if(!e)return"all";let t=e.toLowerCase();return i[t]?i[t]:s.has(t)?t:"all"},o=e=>{let t=l(e);return"all"===t?"all":n[t]||t};e.s(["normalizeStatusForQuery",0,o,"sanitizeStatusValue",0,l],788666);var u=e.i(367916),d=e.i(211857),c=e.i(722384);let p="knowledge/document",m=[p,"documentList"],f=[p,"autoDisabledDocument"],h=e=>(Array.isArray(e)?e:[e]).map(e=>`document_id=${e}`).join("&"),v=e=>(0,t.useMutation)({mutationFn:t=>{let{datasetId:a,documentIds:r,documentId:s}=t;return(0,u.patch)(`/datasets/${a}/documents/status/${e}/batch?${h(s||r)}`)}}),g=[p,"documentDetail","withoutMetaData"];e.s(["useAutoDisabledDocuments",0,e=>(0,a.useQuery)({queryKey:[...f,e],queryFn:()=>(0,u.get)(`/datasets/${e}/auto-disable-logs`)}),"useDocumentArchive",0,()=>v(r.DocumentActionType.archive),"useDocumentBatchRetryIndex",0,()=>(0,t.useMutation)({mutationFn:e=>{let{datasetId:t,documentIds:a}=e;return(0,u.post)(`/datasets/${t}/retry`,{body:{document_ids:a}})}}),"useDocumentDelete",0,()=>(0,t.useMutation)({mutationFn:e=>{let{datasetId:t,documentIds:a,documentId:r}=e;return(0,u.del)(`/datasets/${t}/documents?${h(r||a)}`)}}),"useDocumentDetail",0,e=>{let{datasetId:t,documentId:r,params:s}=e;return(0,a.useQuery)({queryKey:[...g,"withoutMetaData",t,r,s],queryFn:()=>(0,u.get)(`/datasets/${t}/documents/${r}`,{params:s})})},"useDocumentDisable",0,()=>v(r.DocumentActionType.disable),"useDocumentDownload",0,()=>(0,t.useMutation)({mutationFn:e=>{let{datasetId:t,documentId:a}=e;if(!t||!a)throw Error("datasetId and documentId are required");return(0,d.fetchDocumentDownloadUrl)({datasetId:t,documentId:a})}}),"useDocumentDownloadZip",0,()=>(0,t.useMutation)({mutationFn:e=>{let{datasetId:t,documentIds:a}=e;if(!t||!a?.length)throw Error("datasetId and documentIds are required");return(0,d.downloadDocumentsZip)({datasetId:t,documentIds:a})}}),"useDocumentEnable",0,()=>v(r.DocumentActionType.enable),"useDocumentList",0,e=>{let{query:t,datasetId:r,refetchInterval:s}=e,{keyword:i,page:n,limit:l,sort:d,status:c}=t,p=o(c),f={keyword:i,page:n,limit:l};return d&&(f.sort=d),p&&"all"!==p&&(f.status=p),(0,a.useQuery)({queryKey:[...m,r,f],queryFn:()=>(0,u.get)(`/datasets/${r}/documents`,{params:f}),refetchInterval:s})},"useDocumentListKey",0,m,"useDocumentMetadata",0,e=>{let{datasetId:t,documentId:r,params:s}=e;return(0,a.useQuery)({queryKey:[...g,"onlyMetaData",t,r,s],queryFn:()=>(0,u.get)(`/datasets/${t}/documents/${r}`,{params:s})})},"useDocumentPause",0,()=>(0,t.useMutation)({mutationFn:e=>{let{datasetId:t,documentId:a}=e;if(!t||!a)throw Error("datasetId and documentId are required");return(0,d.pauseDocIndexing)({datasetId:t,documentId:a})}}),"useDocumentResume",0,()=>(0,t.useMutation)({mutationFn:e=>{let{datasetId:t,documentId:a}=e;if(!t||!a)throw Error("datasetId and documentId are required");return(0,d.resumeDocIndexing)({datasetId:t,documentId:a})}}),"useDocumentSummary",0,()=>(0,t.useMutation)({mutationFn:e=>{let{datasetId:t,documentIds:a,documentId:r}=e;return(0,u.post)(`/datasets/${t}/documents/generate-summary`,{body:{document_list:r?[r]:a}})}}),"useDocumentUnArchive",0,()=>v(r.DocumentActionType.unArchive),"useInvalidDisabledDocument",0,()=>(0,c.useInvalid)(f),"useInvalidDocumentDetail",0,()=>(0,c.useInvalid)(g),"useInvalidDocumentList",0,e=>(0,c.useInvalid)(e?[...m,e]:m),"useSyncDocument",0,()=>(0,t.useMutation)({mutationFn:e=>{let{datasetId:t,documentId:a}=e;return(0,u.get)(`/datasets/${t}/documents/${a}/notion/sync`)}}),"useSyncWebsite",0,()=>(0,t.useMutation)({mutationFn:e=>{let{datasetId:t,documentId:a}=e;return(0,u.get)(`/datasets/${t}/documents/${a}/website-sync`)}})],666010)},592366,e=>{"use strict";var t=e.i(563199),a=e.i(837699),r=e.i(268255),s=e.i(521632),i=e.i(271743),n=e.i(935139);let l=r.memo(e=>{let{isShow:l,onHide:o,dialogClassName:u="",dialogBackdropClassName:d="",panelClassName:c="",maxWidthClassName:p="!max-w-[640px]",height:m="calc(100vh - 72px)",contentClassName:f,headerClassName:h,title:v,titleDescription:g,body:x,foot:b,isShowMask:y,clickOutsideNotOpen:j=!0,positionCenter:N}=e,w=(0,r.useRef)(null),C=(0,i.default)()===i.MediaType.mobile;return l?(0,t.jsx)(s.default,{isOpen:l,clickOutsideNotOpen:j,onClose:o,footer:null,mask:C||y,positionCenter:N,dialogClassName:u,dialogBackdropClassName:d,panelClassName:(0,n.cn)("mx-2 mb-3 mt-16 rounded-xl !p-0 sm:mr-2",c,p),children:(0,t.jsxs)("div",{className:(0,n.cn)(f,"flex w-full flex-col rounded-xl border-[0.5px] border-divider-subtle bg-components-panel-bg shadow-xl"),style:{height:m},ref:w,children:[(0,t.jsxs)("div",{className:(0,n.cn)(h,"shrink-0 border-b border-divider-subtle py-4"),children:[(0,t.jsxs)("div",{className:"flex h-6 items-center justify-between pl-6 pr-5",children:[(0,t.jsx)("div",{className:"system-xl-semibold text-text-primary",children:v}),(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)("div",{onClick:o,className:"flex h-6 w-6 cursor-pointer items-center justify-center",children:(0,t.jsx)(a.RiCloseLine,{className:"h-4 w-4 text-text-tertiary"})})})]}),g&&(0,t.jsx)("div",{className:"system-xs-regular pl-6 pr-10 text-text-tertiary",children:g})]}),(0,t.jsx)("div",{className:"grow overflow-y-auto",children:x}),b&&(0,t.jsx)("div",{className:"shrink-0",children:b})]})}):null});e.s(["default",0,l])},619507,299075,e=>{"use strict";e.i(845780);var t=e.i(720315),a=e.i(949250);e.i(275225);var r=e.i(705405),s=e.i(390622),i=e.i(654537);let n=e=>({[i.PipelineInputVarType.number]:s.VarType.number,[i.PipelineInputVarType.singleFile]:s.VarType.file,[i.PipelineInputVarType.multiFiles]:s.VarType.arrayFile,[i.PipelineInputVarType.checkbox]:s.VarType.boolean})[e]||s.VarType.string;var l=e.i(192447);let o=e=>{let{getNodes:t}=(0,l.useStoreApi)().getState(),a=t(),r=a.find(t=>t.id===e),s=!!r?.data.isInIteration,i=!!r?.data.isInLoop,n=r?.parentId;return{node:r,isInIteration:s,isInLoop:i,parentNode:a.find(e=>e.id===n)}};e.s(["default",0,o],299075),e.s(["default",0,function(e){let{onlyLeafNodeVar:i,filterVar:l,hideEnv:u,hideChatVar:d,passedInAvailableNodes:c}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{onlyLeafNodeVar:!1,filterVar:()=>!0},{getTreeLeafNodes:p,getNodeById:m,getBeforeNodesInSameBranchIncludeParent:f}=(0,t.useWorkflow)(),{getNodeAvailableVars:h}=(0,a.useWorkflowVariables)(),v=(0,t.useIsChatMode)(),g=c||(i?p(e):f(e)),{parentNode:x}=o(e),b=m(e),y=(0,r.useStore)(e=>e.ragPipelineVariables),j=b?.data?.type===s.BlockEnum.DataSource,N=[];if(j){let t=y?.filter(t=>t.belong_to_node_id===e),a=t?.filter(t=>l({variable:t.variable,type:n(t.type),nodeId:e,isRagVariable:!0},["rag",e,t.variable]));a?.length&&N.push({nodeId:e,title:b.data?.title,vars:a.map(t=>({variable:`rag.${e}.${t.variable}`,type:n(t.type),description:t.label,isRagVariable:!0}))})}return{availableVars:[...h({parentNode:x,beforeNodes:g,isChatMode:v,filterVar:l,hideEnv:u,hideChatVar:d}),...N],availableNodes:g,availableNodesWithParent:[...g,...j?[b]:[]]}}],619507)},65932,(e,t,a)=>{"use strict";t.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;if(Array.isArray(t)){if((r=t.length)!=a.length)return!1;for(s=r;0!=s--;)if(!e(t[s],a[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(s=r;0!=s--;)if(!Object.prototype.hasOwnProperty.call(a,i[s]))return!1;for(s=r;0!=s--;){var r,s,i,n=i[s];if(!e(t[n],a[n]))return!1}return!0}return t!=t&&a!=a}},449448,e=>{"use strict";function t(e){return[...new Set(e)]}e.s(["uniq",()=>t])},534042,141167,e=>{"use strict";var t,a=((t={}).blue="blue",t.cyan="cyan",t.green="green",t.yellow="yellow",t.pink="pink",t.violet="violet",t);e.s(["NoteTheme",()=>a],141167);let r={[a.blue]:{outer:"border-util-colors-blue-blue-500",title:"bg-util-colors-blue-blue-100",bg:"bg-util-colors-blue-blue-50",border:"border-util-colors-blue-blue-300"},[a.cyan]:{outer:"border-util-colors-cyan-cyan-500",title:"bg-util-colors-cyan-cyan-100",bg:"bg-util-colors-cyan-cyan-50",border:"border-util-colors-cyan-cyan-300"},[a.green]:{outer:"border-util-colors-green-green-500",title:"bg-util-colors-green-green-100",bg:"bg-util-colors-green-green-50",border:"border-util-colors-green-green-300"},[a.yellow]:{outer:"border-util-colors-yellow-yellow-500",title:"bg-util-colors-yellow-yellow-100",bg:"bg-util-colors-yellow-yellow-50",border:"border-util-colors-yellow-yellow-300"},[a.pink]:{outer:"border-util-colors-pink-pink-500",title:"bg-util-colors-pink-pink-100",bg:"bg-util-colors-pink-pink-50",border:"border-util-colors-pink-pink-300"},[a.violet]:{outer:"border-util-colors-violet-violet-500",title:"bg-util-colors-violet-violet-100",bg:"bg-util-colors-violet-violet-100",border:"border-util-colors-violet-violet-300"}};e.s(["CUSTOM_NOTE_NODE",0,"custom-note","THEME_MAP",0,r],534042)},649538,e=>{"use strict";var t=e.i(918077);e.s(["ChevronRight",()=>t.default])},379636,e=>{"use strict";var t=e.i(737753);e.s(["GlobalVariable",()=>t.default])},981875,e=>{"use strict";var t,a=((t={}).conversation="conversation",t.environment="env",t.node="node",t.system="sys",t);e.s(["VarInInspectType",()=>a])},661734,535614,951875,189497,e=>{"use strict";var t=e.i(563199),a=e.i(807324),r=e.i(732056);let s=e=>{let{ref:s,...i}=e;return(0,t.jsx)(a.default,{...i,ref:s,data:r.default})};s.displayName="InputField",e.s(["default",0,s],535614);var i=e.i(181096);let n=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:i.default})};n.displayName="PipelineFill",e.s(["default",0,n],951875);var l=e.i(8717);let o=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:l.default})};o.displayName="PipelineLine",e.s(["default",0,o],189497),e.s([],661734)},505816,e=>{"use strict";var t=e.i(535614);e.s(["InputField",()=>t.default])},42241,45490,370546,268571,737753,479735,484655,3371,e=>{"use strict";var t=e.i(563199),a=e.i(807324),r=e.i(986823);let s=e=>{let{ref:s,...i}=e;return(0,t.jsx)(a.default,{...i,ref:s,data:r.default})};s.displayName="BubbleX",e.s(["default",0,s],45490),e.i(218459);var i=e.i(792257);let n=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:i.default})};n.displayName="DragHandle",e.s(["default",0,n],370546);var l=e.i(262909);let o=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:l.default})};o.displayName="Env",e.s(["default",0,o],268571);var u=e.i(341579);let d=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:u.default})};d.displayName="GlobalVariable",e.s(["default",0,d],737753);var c=e.i(274378);let p=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:c.default})};p.displayName="Icon3Dots",e.s(["default",0,p],479735);var m=e.i(641469);let f=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:m.default})};f.displayName="LongArrowLeft",e.s(["default",0,f],484655);var h=e.i(103751);let v=e=>{let{ref:r,...s}=e;return(0,t.jsx)(a.default,{...s,ref:r,data:h.default})};v.displayName="LongArrowRight",e.s(["default",0,v],3371),e.i(862712),e.i(234661),e.s([],42241)},825220,e=>{"use strict";var t=e.i(268571);e.s(["Env",()=>t.default])},678383,e=>{"use strict";var t=e.i(328960);e.s(["Variable02",()=>t.default])},226577,e=>{"use strict";var t=e.i(45490);e.s(["BubbleX",()=>t.default])},603198,866438,54010,645960,971481,95240,e=>{"use strict";var t=e.i(563199),a=e.i(268255),r=e.i(935139);e.i(42241);var s=e.i(226577),i=e.i(825220),n=e.i(379636);e.i(661734);var l=e.i(505816);e.i(39598);var o=e.i(678383);e.i(916131);var u=e.i(806436),d=e.i(959752),c=e.i(981875),p=e.i(963855);let m=(e,t,r)=>(0,a.useMemo)(()=>t?"text-text-warning":"loop"===r?"text-util-colors-cyan-cyan-500":(0,p.isENV)(e)||r===c.VarInInspectType.environment||"environment"===r?"text-util-colors-violet-violet-600":(0,p.isConversationVar)(e)||r===c.VarInInspectType.conversation||"conversation"===r?"text-util-colors-teal-teal-700":(0,p.isGlobalVar)(e)||r===c.VarInInspectType.system?"text-util-colors-orange-orange-600":"text-text-accent",[e,t,r]),f=(0,a.memo)(e=>{let{className:a,variables:d=[],variableCategory:m}=e,f="loop"===m?u.Loop:"rag"===m||(0,p.isRagVariableVar)(d)?l.InputField:(0,p.isENV)(d)||m===c.VarInInspectType.environment||"environment"===m?i.Env:(0,p.isConversationVar)(d)||m===c.VarInInspectType.conversation||"conversation"===m?s.BubbleX:(0,p.isGlobalVar)(d)||m===c.VarInInspectType.system?n.GlobalVariable:o.Variable02;return f&&(0,t.jsx)(f,{className:(0,r.cn)("size-3.5 shrink-0",a)})}),h=(0,a.memo)(e=>{let{isExceptionVariable:a,variableCategory:s,variables:i=[],className:n}=e,l=m(i,a,s);return(0,t.jsx)(f,{variables:i,variableCategory:s,className:(0,r.cn)(l,n)})});e.s(["default",0,h],866438);var v=e.i(837699),g=e.i(403861),x=e.i(421001);let b=(0,a.memo)(e=>{let s,i,n,{variables:l,className:o,notShowFullPath:u}=e,c=(s=d.VAR_SHOW_NAME_MAP[l.join(".")],i=l.slice(1).join("."),(0,p.isRagVariableVar)(l)&&(i=l.slice(2).join(".")),n=(0,a.useMemo)(()=>{i=l.slice(1).join("."),(0,p.isRagVariableVar)(l)&&(i=l.slice(2).join("."));let e=l.length,t=(0,p.isSystemVar)(l),a=u?l[e-1]:i;return`${t?"sys.":""}${a}`},[l,u]),s||n);return(0,t.jsx)("div",{className:(0,r.cn)("system-xs-medium truncate",o),title:c,children:c})});var y=e.i(120219);let j=(0,a.memo)(e=>{let{nodeType:a,nodeTitle:r}=e;return a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.VarBlockIcon,{type:a,className:"shrink-0 text-text-secondary"}),r&&(0,t.jsx)("div",{className:"system-xs-medium max-w-[60px] truncate text-text-secondary",title:r,children:r}),(0,t.jsx)("div",{className:"system-xs-regular shrink-0 text-divider-deep",children:"/"})]}):null}),N=(0,a.memo)(e=>{let{nodeType:a,nodeTitle:s,variables:i,variableType:n,className:l,errorMsg:o,onClick:u,isExceptionVariable:d,ref:c,notShowFullPath:h,rightSlot:y}=e,N=m(i,d),w=!((0,p.isENV)(i)||(0,p.isConversationVar)(i)||(0,p.isGlobalVar)(i)||(0,p.isRagVariableVar)(i));return(0,t.jsxs)("div",{className:(0,r.cn)("inline-flex h-6 max-w-full items-center space-x-0.5 rounded-md border-[0.5px] border-components-panel-border-subtle bg-components-badge-white-to-dark px-1.5 shadow-xs",l),onClick:u,ref:c,children:[w&&(0,t.jsx)(j,{nodeType:a,nodeTitle:s}),h&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.RiMoreLine,{className:"h-3 w-3 shrink-0 text-text-secondary"}),(0,t.jsx)("div",{className:"system-xs-regular shrink-0 text-divider-deep",children:"/"})]}),(0,t.jsx)(f,{variables:i,className:N}),(0,t.jsx)(b,{variables:i,className:(0,r.cn)(N),notShowFullPath:h}),!!n&&(0,t.jsx)("div",{className:"system-xs-regular shrink-0 text-text-tertiary",children:(0,g.capitalize)(n)}),!!o&&(0,t.jsx)(x.default,{popupContent:o,asChild:!0,children:(0,t.jsx)(v.RiErrorWarningFill,{className:"h-3 w-3 shrink-0 text-text-destructive"})}),y]})}),w=(0,a.memo)(e=>{let{isSelected:a,variables:s,errorMsg:i,...n}=e,{hoverBorderColor:l,hoverBgColor:o,selectedBorderColor:u,selectedBgColor:d}=i?{hoverBorderColor:"hover:border-state-destructive-active",hoverBgColor:"hover:bg-state-destructive-hover",selectedBorderColor:"!border-state-destructive-solid",selectedBgColor:"!bg-state-destructive-hover"}:(0,p.isENV)(s)?{hoverBorderColor:"hover:border-util-colors-violet-violet-100",hoverBgColor:"hover:bg-util-colors-violet-violet-50",selectedBorderColor:"border-util-colors-violet-violet-600",selectedBgColor:"bg-util-colors-violet-violet-50"}:(0,p.isConversationVar)(s)?{hoverBorderColor:"hover:border-util-colors-teal-teal-100",hoverBgColor:"hover:bg-util-colors-teal-teal-50",selectedBorderColor:"border-util-colors-teal-teal-600",selectedBgColor:"bg-util-colors-teal-teal-50"}:{hoverBorderColor:"hover:border-state-accent-alt",hoverBgColor:"hover:bg-state-accent-hover",selectedBorderColor:"border-state-accent-solid",selectedBgColor:"bg-state-accent-hover"};return(0,t.jsx)(N,{className:(0,r.cn)("h-[18px] space-x-[1px] rounded-[5px] px-1 shadow-xs",!a&&o,!a&&l,a&&"border",a&&u,a&&d),variables:s,errorMsg:i,...n})});e.s(["default",0,w],54010);let C=(0,a.memo)(e=>(0,t.jsx)(N,{className:(0,r.cn)("w-full space-x-[1px] bg-workflow-block-parma-bg px-1 shadow-none"),...e}));e.s(["default",0,C],645960);let A=(0,a.memo)(e=>(0,t.jsx)(N,{...e}));e.s(["default",0,A],971481);let S=(0,a.memo)(e=>(0,t.jsx)(N,{className:(0,r.cn)("h-[18px] space-x-[1px] rounded-[5px] px-1 shadow-xs"),...e}));e.s(["default",0,S],95240),e.s([],603198)},892081,e=>{"use strict";var t=e.i(393689),a=e.i(220431);let r=function(e){if(!e||!document.getRootNode)return document;var t,r=Array.isArray(e)?e:[e];return r.every(function(e){var t=(0,a.getTargetElement)(e);return!!t&&t.getRootNode()instanceof ShadowRoot})?(t=(0,a.getTargetElement)(r[0]))?t.getRootNode():document:document};var s=e.i(99878);function i(e,i,n){void 0===n&&(n="click");var l=(0,t.default)(e);(0,s.default)(function(){var e=function(e){(Array.isArray(i)?i:[i]).some(function(t){var r=(0,a.getTargetElement)(t);return!r||r.contains(e.target)})||l.current(e)},t=r(i),s=Array.isArray(n)?n:[n];return s.forEach(function(a){return t.addEventListener(a,e)}),function(){s.forEach(function(a){return t.removeEventListener(a,e)})}},Array.isArray(n)?n:[n],i)}e.s(["useClickAway",()=>i],892081)},863085,e=>{"use strict";var t=e.i(56505);e.s(["CheckCircle",()=>t.default])},765673,e=>{"use strict";var t=e.i(511334),a=e.i(318680),r=e.i(268255),s=r.useLayoutEffect,i=function(e){var t=r.default.useRef(e);return s(function(){t.current=e}),t},n=function(e,t){"function"==typeof e?e(t):e.current=t},l=function(e,t){var a=r.default.useRef();return r.default.useCallback(function(r){e.current=r,a.current&&n(a.current,null),a.current=t,t&&n(t,r)},[t])},o={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},u=function(e){Object.keys(o).forEach(function(t){e.style.setProperty(t,o[t],"important")})},d=null,c=function(e,t){var a=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?a+t.borderSize:a-t.paddingSize},p=function(){},m=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],f=!!document.documentElement.currentStyle,h=function(e){var t=window.getComputedStyle(e);if(null===t)return null;var a=m.reduce(function(e,a){return e[a]=t[a],e},{}),r=a.boxSizing;if(""===r)return null;f&&"border-box"===r&&(a.width=parseFloat(a.width)+parseFloat(a.borderRightWidth)+parseFloat(a.borderLeftWidth)+parseFloat(a.paddingRight)+parseFloat(a.paddingLeft)+"px");var s=parseFloat(a.paddingBottom)+parseFloat(a.paddingTop),i=parseFloat(a.borderBottomWidth)+parseFloat(a.borderTopWidth);return{sizingStyle:a,paddingSize:s,borderSize:i}};function v(e,t,a){var s=i(a);r.useLayoutEffect(function(){var a=function(e){return s.current(e)};if(e)return e.addEventListener(t,a),function(){return e.removeEventListener(t,a)}},[])}var g=function(e,t){v(document.body,"reset",function(a){e.current.form===a.target&&t(a)})},x=function(e){v(window,"resize",e)},b=function(e){v(document.fonts,"loadingdone",e)},y=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],j=r.forwardRef(function(e,s){var i=e.cacheMeasurements,n=e.maxRows,o=e.minRows,m=e.onChange,f=void 0===m?p:m,v=e.onHeightChange,j=void 0===v?p:v,N=(0,a.default)(e,y),w=void 0!==N.value,C=r.useRef(null),A=l(C,s),S=r.useRef(0),I=r.useRef(),T=function(){var e=C.current,t=i&&I.current?I.current:h(e);if(t){I.current=t;var a,r,s,l,p,m,f,v,g,x,b,y=(a=e.value||e.placeholder||"x",void 0===(r=o)&&(r=1),void 0===(s=n)&&(s=1/0),d||((d=document.createElement("textarea")).setAttribute("tabindex","-1"),d.setAttribute("aria-hidden","true"),u(d)),null===d.parentNode&&document.body.appendChild(d),l=t.paddingSize,p=t.borderSize,f=(m=t.sizingStyle).boxSizing,Object.keys(m).forEach(function(e){d.style[e]=m[e]}),u(d),d.value=a,v=c(d,t),d.value=a,v=c(d,t),d.value="x",x=(g=d.scrollHeight-l)*r,"border-box"===f&&(x=x+l+p),v=Math.max(x,v),b=g*s,"border-box"===f&&(b=b+l+p),[v=Math.min(b,v),g]),N=y[0],w=y[1];S.current!==N&&(S.current=N,e.style.setProperty("height",N+"px","important"),j(N,{rowHeight:w}))}};return r.useLayoutEffect(T),g(C,function(){if(!w){var e=C.current.value;requestAnimationFrame(function(){var t=C.current;t&&e!==t.value&&T()})}}),x(T),b(T),r.createElement("textarea",(0,t.default)({},N,{onChange:function(e){w||T(),f(e)},ref:A}))});e.s(["default",()=>j],765673)},153935,e=>{"use strict";var t=e.i(978912),a=e.i(137667),r=e.i(447301);class s{mediaSource;audio;audioContext;sourceBuffer;cacheBuffers=[];pauseTimer=null;msgId;msgContent=null;voice=void 0;isLoadData=!1;url;isPublic;callback;constructor(e,t,r,s,i,n){this.audioContext=new AudioContext,this.msgId=r,this.msgContent=s,this.url=e,this.isPublic=t,this.voice=i,this.callback=n;const l=window.ManagedMediaSource||window.MediaSource;l||a.default.notify({message:"Your browser does not support audio streaming, if you are using an iPhone, please update to iOS 17.1 or later.",type:"error"}),this.mediaSource=l?new l:null,this.audio=new Audio,this.setCallback(n),window.MediaSource||(this.audio.disableRemotePlayback=!0,this.audio.controls=!0),this.audio.src=this.mediaSource?URL.createObjectURL(this.mediaSource):"",this.audio.autoplay=!0,this.audioContext.createMediaElementSource(this.audio).connect(this.audioContext.destination),this.listenMediaSource("audio/mpeg")}resetMsgId(e){this.msgId=e}listenMediaSource(e){this.mediaSource?.addEventListener("sourceopen",()=>{this.sourceBuffer||(this.sourceBuffer=this.mediaSource?.addSourceBuffer(e))})}setCallback(e){this.callback=e,e&&(this.audio.addEventListener("ended",()=>{e("ended")},!1),this.audio.addEventListener("paused",()=>{e("paused")},!0),this.audio.addEventListener("loaded",()=>{e("loaded")},!0),this.audio.addEventListener("play",()=>{e("play")},!0),this.audio.addEventListener("timeupdate",()=>{e("timeupdate")},!0),this.audio.addEventListener("loadeddate",()=>{e("loadeddate")},!0),this.audio.addEventListener("canplay",()=>{e("canplay")},!0),this.audio.addEventListener("error",()=>{e("error")},!0))}async loadAudio(){try{let e=await (0,r.textToAudioStream)(this.url,this.isPublic?r.AppSourceType.webApp:r.AppSourceType.installedApp,{content_type:"audio/mpeg"},{message_id:this.msgId,streaming:!0,voice:this.voice,text:this.msgContent});200!==e.status&&(this.isLoadData=!1,this.callback&&this.callback("error"));let t=e.body.getReader();for(;;){let{value:e,done:a}=await t.read();if(a){this.receiveAudioData(e);break}this.receiveAudioData(e)}}catch{this.isLoadData=!1,this.callback?.("error")}}playAudio(){this.isLoadData?("suspended"===this.audioContext.state?this.audioContext.resume().then(e=>{this.audio.play(),this.callback?.("play")}):this.audio.ended&&(this.audio.play(),this.callback?.("play")),this.callback?.("play")):(this.isLoadData=!0,this.loadAudio())}theEndOfStream(){let e=setInterval(()=>{this.sourceBuffer?.updating||(this.mediaSource?.endOfStream(),clearInterval(e))},10)}finishStream(){let e=setInterval(()=>{if(this.cacheBuffers.length||(this.theEndOfStream(),clearInterval(e)),this.cacheBuffers.length&&!this.sourceBuffer?.updating){let e=this.cacheBuffers.shift();this.sourceBuffer?.appendBuffer(e)}},10)}async playAudioWithAudio(e){let a=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!e||!e.length)return void this.finishStream();let r=t.Buffer.from(e,"base64");this.receiveAudioData(new Uint8Array(r)),a&&(this.isLoadData=!0,this.audio.paused?this.audioContext.resume().then(e=>{this.audio.play(),this.callback?.("play")}):this.audio.ended?(this.audio.play(),this.callback?.("play")):this.audio.played||(this.audio.play(),this.callback?.("play")))}pauseAudio(){this.callback?.("paused"),this.audio.pause(),this.audioContext.suspend()}receiveAudioData(e){if(!e)return void this.finishStream();let t=this.byteArrayToArrayBuffer(e);if(!t.byteLength){this.mediaSource?.readyState==="open"&&this.finishStream();return}if(this.sourceBuffer?.updating)this.cacheBuffers.push(t);else if(this.cacheBuffers.length&&!this.sourceBuffer?.updating){this.cacheBuffers.push(t);let e=this.cacheBuffers.shift();this.sourceBuffer?.appendBuffer(e)}else this.sourceBuffer?.appendBuffer(t)}byteArrayToArrayBuffer(e){let t=new ArrayBuffer(e.length);return new Uint8Array(t).set(e),t}}class i{static instance;audioPlayers=null;msgId;static getInstance(){return i.instance||(i.instance=new i,this.instance=i.instance),i.instance}getAudioPlayer(e,t,a,r,i,n){if(this.msgId&&this.msgId===a&&this.audioPlayers)return this.audioPlayers.setCallback(n),this.audioPlayers;if(this.audioPlayers)try{this.audioPlayers.pauseAudio(),this.audioPlayers.cacheBuffers=[],this.audioPlayers.sourceBuffer?.abort()}catch{}return this.msgId=a,this.audioPlayers=new s(e,t,a,r,i,n),this.audioPlayers}resetMsgId(e){this.msgId=e,this.audioPlayers?.resetMsgId(e)}}e.s(["AudioPlayerManager",()=>i],153935)},987878,733437,e=>{"use strict";var t=e.i(268255),a=e.i(639751),r=e.i(563199),s=e.i(763989),i=e.i(648404);let n=(0,t.createContext)(null);function l(e){let r=(0,t.useContext)(n);if(!r)throw Error("Missing FeaturesContext.Provider in the tree");return(0,a.useStore)(r,e)}function o(){return(0,t.useContext)(n)}e.s(["FeaturesContext",0,n,"FeaturesProvider",0,e=>{let a,{children:l,...o}=e,u=(0,t.useRef)(void 0);return u.current||(a={features:{moreLikeThis:{enabled:!1},opening:{enabled:!1},suggested:{enabled:!1},text2speech:{enabled:!1},speech2text:{enabled:!1},citation:{enabled:!1},moderation:{enabled:!1},file:{image:{enabled:!1,detail:i.Resolution.high,number_limits:3,transfer_methods:[i.TransferMethod.local_file,i.TransferMethod.remote_url]}},annotationReply:{enabled:!1}}},u.current=(0,s.createStore)()(e=>({...a,...o,setFeatures:t=>e(()=>({features:t})),showFeaturesModal:!1,setShowFeaturesModal:t=>e(()=>({showFeaturesModal:t}))}))),(0,r.jsx)(n.Provider,{value:u.current,children:l})}],733437),e.s(["useFeatures",()=>l,"useFeaturesStore",()=>o],987878)}]);