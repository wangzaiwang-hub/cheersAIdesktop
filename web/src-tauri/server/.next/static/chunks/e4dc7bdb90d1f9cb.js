(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,676989,e=>{"use strict";var t,s=e.i(563199),a=e.i(417944),l=e.i(268255);e.i(152567);var n=e.i(408767),i=e.i(449980),r=e.i(878038),o=e.i(413159),d=e.i(56971),c=e.i(654537),u=e.i(652669),m=e.i(475390),p=e.i(443014),x=e.i(253807),h=((t={}).dataSource="dataSource",t.processDocuments="processDocuments",t.processingDocuments="processingDocuments",t);e.i(201987);var g=e.i(207331),f=e.i(648404);let b=(e,t)=>({related_id:e.id,name:e.name,type:e.type,size:e.size,extension:e.extension,mime_type:e.mime_type,url:"",transfer_method:f.TransferMethod.local_file,credential_id:t}),v=(e,t)=>{let{workspace_id:s,...a}=e;return{workspace_id:s,page:a,credential_id:t}},j=(e,t)=>({...e,credential_id:t}),y=(e,t,s)=>({bucket:t,id:e.id,name:e.name,type:e.type,credential_id:s});var w=e.i(390622),D=e.i(908432),N=e.i(621379),S=e.i(837699),k=e.i(554327),C=e.i(326531),T=e.i(151094),_=e.i(227579),P=e.i(935139);let R=l.memo(e=>{let{currentStep:t,steps:a}=e;return(0,s.jsx)("div",{className:"flex gap-x-1",children:a.map((e,a)=>(0,s.jsx)("div",{className:(0,P.cn)("h-1 w-1 rounded-lg bg-divider-solid",a===t-1&&"w-2 bg-state-accent-solid")},e.value))})}),I=l.memo(e=>{let{steps:t,title:a,currentStep:l}=e,{datasetId:n}=(0,C.useParams)();return(0,s.jsxs)("div",{className:"relative flex flex-col gap-y-0.5 pb-2 pt-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,s.jsx)("span",{className:"system-2xs-semibold-uppercase bg-pipeline-add-documents-title-bg bg-clip-text text-transparent",children:a}),(0,s.jsx)("span",{className:"system-2xs-regular text-divider-regular",children:"/"}),(0,s.jsx)(R,{steps:t,currentStep:l})]}),(0,s.jsx)("div",{className:"system-md-semibold text-text-primary",children:t[l-1]?.label}),l!==t.length&&(0,s.jsx)(k.default,{href:`/datasets/${n}/documents`,replace:!0,children:(0,s.jsx)(T.default,{variant:"secondary-accent",className:"absolute -left-11 top-3.5 size-9 rounded-full p-0",children:(0,s.jsx)(S.RiArrowLeftLine,{className:"size-5 "})})}),(0,s.jsx)(_.default,{className:"left-8 top-[-34px] opacity-20"})]})});var F=e.i(757198),L=e.i(742562),M=e.i(396094),z=e.i(867019),O=e.i(503607),E=e.i(199288),A=e.i(239216),W=e.i(324935);let $=l.memo(e=>{let{disabled:t,handleNextStep:a,showSelect:i=!1,totalOptions:r,selectedOptions:o,onSelectAll:d,tip:c=""}=e,{t:u}=(0,n.useTranslation)(),{datasetId:m}=(0,C.useParams)(),p=(0,l.useMemo)(()=>!!i&&void 0!==o&&void 0!==r&&o>0&&o<r,[i,o,r]),x=(0,l.useMemo)(()=>!!i&&void 0!==o&&void 0!==r&&o>0&&o===r,[i,o,r]);return(0,s.jsxs)("div",{className:"flex items-center gap-x-2 overflow-hidden",children:[i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex shrink-0 items-center gap-x-2 py-[3px] pl-4 pr-2",children:[(0,s.jsx)(W.default,{onCheck:d,indeterminate:p,checked:x}),(0,s.jsx)("span",{className:"system-sm-medium text-text-accent",children:u("operation.selectAll",{ns:"common"})})]}),c&&(0,s.jsx)("div",{title:c,className:"system-xs-regular max-w-full truncate text-text-tertiary",children:c})]}),(0,s.jsxs)("div",{className:"flex grow items-center justify-end gap-x-2",children:[(0,s.jsx)(k.default,{href:`/datasets/${m}/documents`,replace:!0,children:(0,s.jsx)(T.default,{variant:"ghost",className:"px-3 py-2",children:u("operation.cancel",{ns:"common"})})}),(0,s.jsxs)(T.default,{disabled:t,variant:"primary",onClick:a,className:"gap-x-0.5",children:[(0,s.jsx)("span",{className:"px-0.5",children:u("stepOne.button",{ns:"datasetCreation"})}),(0,s.jsx)(S.RiArrowRightLine,{className:"size-4"})]})]})]})}),B={xs:"w-4 h-4 rounded-[5px] shadow-xs",sm:"w-5 h-5 rounded-md shadow-xs",md:"w-6 h-6 rounded-lg shadow-md"},U=(0,l.memo)(e=>{let{size:t="sm",className:a,iconUrl:l}=e;return(0,s.jsx)("div",{className:(0,P.cn)("flex items-center justify-center shadow-none",B[t],a),children:(0,s.jsx)("div",{className:"h-full w-full shrink-0 rounded-md bg-cover bg-center",style:{backgroundImage:`url(${l})`}})})});var V=e.i(464747),q=e.i(168014);let H=l.memo(e=>{let{label:t,selected:a,nodeData:n,onClick:i}=e,r=(e=>{let{data:t,isSuccess:s}=(0,m.useDataSourceList)(!0);return(0,l.useMemo)(()=>{if(!s)return;let a=[...t||[]];a.forEach(e=>{let t=e.declaration.identity.icon;"string"!=typeof t||t.includes(q.basePath)||(e.declaration.identity.icon=`${q.basePath}${t}`)});let l=a.map(e=>(0,V.transformDataSourceToTool)(e));return l?.find(t=>t.plugin_id===e.plugin_id)?.icon},[e.plugin_id,t,s])})(n);return(0,s.jsxs)("div",{className:(0,P.cn)("flex cursor-pointer items-center gap-2 rounded-xl border border-components-option-card-option-border bg-components-option-card-option-bg p-3 shadow-shadow-shadow-3",a?"border-components-option-card-option-selected-border bg-components-option-card-option-selected-bg shadow-xs ring-[0.5px] ring-inset ring-components-option-card-option-selected-border":"hover:bg-components-option-card-bg-hover hover:border-components-option-card-option-border-hover hover:shadow-xs"),onClick:i,children:[(0,s.jsx)("div",{className:"flex size-8 shrink-0 items-center justify-center rounded-lg border-[0.5px] border-components-panel-border bg-background-default-dodge p-1.5",children:(0,s.jsx)(U,{iconUrl:r})}),(0,s.jsx)("div",{className:(0,P.cn)("system-sm-medium line-clamp-2 grow text-text-secondary",a&&"text-text-primary"),title:t,children:t})]})}),K=e=>{let t,{pipelineNodes:a,datasourceNodeId:n,onSelect:i}=e,r=(t=a.filter(e=>e.data.type===w.BlockEnum.DataSource),(0,l.useMemo)(()=>{let e=[];return t.forEach(t=>{let s=t.data.title;e.push({label:s,value:t.id,data:t.data})}),e},[t])),o=(0,l.useCallback)(e=>{let t=r.find(t=>t.value===e);t&&i({nodeId:t.value,nodeData:t.data})},[i,r]);return(0,l.useEffect)(()=>{r.length>0&&!n&&o(r[0].value)},[]),(0,s.jsx)("div",{className:"grid w-full grid-cols-4 gap-1",children:r.map(e=>(0,s.jsx)(H,{label:e.label,selected:n===e.value,nodeData:e.data,onClick:o.bind(null,e.value)},e.value))})},G=(0,l.memo)(e=>{let{datasource:t,datasourceType:a,pipelineNodes:l,supportBatchUpload:n,localFileListLength:i,isShowVectorSpaceFull:r,showSelect:o,totalOptions:d,selectedOptions:u,tip:m,nextBtnDisabled:p,onSelectDataSource:x,onCredentialChange:h,onSelectAll:g,onNextStep:f}=e,b=!n&&a===c.DatasourceType.localFile&&i>0;return(0,s.jsxs)("div",{className:"flex flex-col gap-y-5 pt-4",children:[(0,s.jsx)(K,{datasourceNodeId:t?.nodeId||"",onSelect:x,pipelineNodes:l}),a===c.DatasourceType.localFile&&(0,s.jsx)(M.default,{allowedExtensions:t.nodeData.fileExtensions||[],supportBatchUpload:n}),a===c.DatasourceType.onlineDocument&&(0,s.jsx)(z.default,{nodeId:t.nodeId,nodeData:t.nodeData,onCredentialChange:h}),a===c.DatasourceType.websiteCrawl&&(0,s.jsx)(E.default,{nodeId:t.nodeId,nodeData:t.nodeData,onCredentialChange:h}),a===c.DatasourceType.onlineDrive&&(0,s.jsx)(O.default,{nodeId:t.nodeId,nodeData:t.nodeData,onCredentialChange:h}),r&&(0,s.jsx)(L.default,{}),(0,s.jsx)($,{showSelect:o,totalOptions:d,selectedOptions:u,onSelectAll:g,disabled:p,handleNextStep:f,tip:m}),b&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.default,{type:"horizontal",className:"my-4 h-px bg-divider-subtle"}),(0,s.jsx)(A.default,{})]})]})});var Z=e.i(683257),J=e.i(394529),Q=e.i(421001),X=e.i(64369),Y=e.i(342687),ee=e.i(84366),et=e.i(943963),es=e.i(606466),ea=e.i(225244),el=e.i(666010),en=e.i(658547),ei=e.i(871182);e.i(698628);var er=e.i(127210),eo=e.i(552188);let ed=l.memo(e=>{let{sourceData:t,indexingType:a,retrievalMethod:i}=e,{t:r}=(0,n.useTranslation)(),o=(0,l.useCallback)(e=>{let s="-";return"mode"===e&&(s=t?.mode?t.mode===N.ProcessMode.general?r("embedding.custom",{ns:"datasetDocuments"}):`${r("embedding.hierarchical",{ns:"datasetDocuments"})} \xb7 ${t?.rules?.parent_mode==="paragraph"?r("parentMode.paragraph",{ns:"dataset"}):r("parentMode.fullDoc",{ns:"dataset"})}`:s),s},[t,r]);return(0,s.jsxs)("div",{className:"flex flex-col gap-1","data-testid":"rule-detail",children:[(0,s.jsx)(eo.FieldInfo,{label:r("embedding.mode",{ns:"datasetDocuments"}),displayedValue:o("mode")}),(0,s.jsx)(eo.FieldInfo,{label:r("stepTwo.indexMode",{ns:"datasetCreation"}),displayedValue:r(`stepTwo.${a===er.IndexingType.ECONOMICAL?"economical":"qualified"}`,{ns:"datasetCreation"}),valueIcon:(0,s.jsx)(en.default,{className:"size-4",src:a===er.IndexingType.ECONOMICAL?ei.indexMethodIcon.economical:ei.indexMethodIcon.high_quality,alt:""})}),(0,s.jsx)(eo.FieldInfo,{label:r("form.retrievalSetting.title",{ns:"datasetSettings"}),displayedValue:r(`retrieval.${a===er.IndexingType.ECONOMICAL?"keyword_search":i??"semantic_search"}.title`,{ns:"dataset"}),valueIcon:(0,s.jsx)(en.default,{className:"size-4",src:i===f.RETRIEVE_METHOD.fullText?ei.retrievalIcon.fullText:i===f.RETRIEVE_METHOD.hybrid?ei.retrievalIcon.hybrid:ei.retrievalIcon.vector,alt:""})})]})}),ec=e=>{let{datasetId:t,batchId:a,documents:i=[],indexingType:r,retrievalMethod:o}=e,{t:u}=(0,n.useTranslation)(),m=(0,C.useRouter)(),{enableBilling:p,plan:x}=(0,d.useProviderContext)(),[h,g]=(0,l.useState)([]),[f,b]=(0,l.useState)(!0),{mutateAsync:v}=(0,ea.useIndexingStatusBatch)({datasetId:t,batchId:a});(0,l.useEffect)(()=>{let e,t=async()=>{await v(void 0,{onSuccess:e=>{let t=e.data;g(t),t.every(e=>["completed","error","paused"].includes(e.indexing_status))&&b(!1)},onSettled:()=>{f&&(e=setTimeout(t,2500))}})};return t(),()=>{clearTimeout(e)}},[f]);let j=i[0],{data:y}=(0,ea.useProcessRule)(j.id),w=(0,el.useInvalidDocumentList)(),D=(0,es.useDatasetApiAccessUrl)(),N=(0,l.useMemo)(()=>!!h.length&&h.every(e=>["waiting"].includes(e?.indexing_status||"")),[h]),_=(0,l.useMemo)(()=>!!h.length&&h.some(e=>["indexing","splitting","parsing","cleaning"].includes(e?.indexing_status||"")),[h]),R=(0,l.useMemo)(()=>!!h.length&&h.every(e=>["completed","error","paused"].includes(e?.indexing_status||"")),[h]),I=e=>{let t=i.find(t=>t.id===e);return t?.name},L=e=>{let t=e.completed_segments||0,s=e.total_segments||0;if(0===s)return 0;let a=Math.round(100*t/s);return a>100?100:a},M=e=>{let t=i.find(t=>t.id===e);return t?.data_source_type},z=e=>["indexing","splitting","parsing","cleaning","waiting"].includes(e.indexing_status||"");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,s.jsxs)("div",{className:"system-md-semibold-uppercase flex items-center gap-x-1 text-text-secondary",children:[(N||_)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S.RiLoader2Fill,{className:"size-4 animate-spin"}),(0,s.jsx)("span",{children:u(N?"embedding.waiting":"embedding.processing",{ns:"datasetDocuments"})})]}),R&&u("embedding.completed",{ns:"datasetDocuments"})]}),p&&x.type!==Y.Plan.team&&(0,s.jsxs)("div",{className:"flex h-[52px] items-center gap-x-2 rounded-xl border-[0.5px] border-components-panel-border-subtle bg-components-panel-on-panel-item-bg p-2.5 pl-3 shadow-xs shadow-shadow-shadow-3",children:[(0,s.jsx)("div",{className:"flex shrink-0 items-center justify-center rounded-lg border-[0.5px] border-divider-subtle bg-util-colors-blue-brand-blue-brand-500 shadow-md shadow-shadow-shadow-5",children:(0,s.jsx)(S.RiAedFill,{className:"size-4 text-text-primary-on-surface"})}),(0,s.jsx)("div",{className:"system-md-medium grow text-text-primary",children:u("plansCommon.documentProcessingPriorityUpgrade",{ns:"billing"})}),(0,s.jsx)(ee.default,{loc:"knowledge-speed-up"})]}),(0,s.jsx)("div",{className:"flex flex-col gap-0.5 pb-2",children:h.map(e=>{var t;let a,l;return(0,s.jsxs)("div",{className:(0,P.cn)("relative h-[26px] overflow-hidden rounded-md bg-components-progress-bar-bg","error"===e.indexing_status&&"bg-state-destructive-hover-alt"),children:[z(e)&&(0,s.jsx)("div",{className:"absolute left-0 top-0 h-full min-w-0.5 border-r-[2px] border-r-components-progress-bar-progress-highlight bg-components-progress-bar-progress",style:{width:`${L(e)}%`}}),(0,s.jsxs)("div",{className:"z-[1] flex h-full items-center gap-1 pl-[6px] pr-2",children:[M(e.id)===c.DatasourceType.localFile&&(0,s.jsx)(et.default,{size:"sm",className:"shrink-0",name:I(e.id),extension:(a=I(e.id),a?.split(".").pop()||"txt")}),M(e.id)===c.DatasourceType.onlineDocument&&(0,s.jsx)(J.default,{className:"shrink-0",type:"page",src:(t=e.id,l=i.find(e=>e.id===t),l?.data_source_info.notion_page_icon)}),(0,s.jsxs)("div",{className:"flex w-0 grow items-center gap-1",title:I(e.id),children:[(0,s.jsx)("div",{className:"system-xs-medium truncate text-text-secondary",children:I(e.id)}),p&&(0,s.jsx)(X.default,{className:"ml-0"})]}),z(e)&&(0,s.jsx)("div",{className:"shrink-0 text-xs text-text-secondary",children:`${L(e)}%`}),"error"===e.indexing_status&&(0,s.jsx)(Q.default,{popupClassName:"px-4 py-[14px] max-w-60 body-xs-regular text-text-secondary border-[0.5px] border-components-panel-border rounded-xl",offset:4,popupContent:e.error,children:(0,s.jsx)("span",{children:(0,s.jsx)(S.RiErrorWarningFill,{className:"size-4 shrink-0 text-text-destructive"})})}),"completed"===e.indexing_status&&(0,s.jsx)(S.RiCheckboxCircleFill,{className:"size-4 shrink-0 text-text-success"})]})]},e.id)})}),(0,s.jsx)(F.default,{type:"horizontal",className:"my-0 bg-divider-subtle"}),(0,s.jsx)(ed,{sourceData:y,indexingType:r,retrievalMethod:o})]}),(0,s.jsxs)("div",{className:"mt-6 flex items-center gap-x-2 py-2",children:[(0,s.jsx)(k.default,{href:D,target:"_blank",rel:"noopener noreferrer",children:(0,s.jsxs)(T.default,{className:"w-fit gap-x-0.5 px-3",children:[(0,s.jsx)(S.RiTerminalBoxLine,{className:"size-4"}),(0,s.jsx)("span",{className:"px-0.5",children:"Access the API"})]})}),(0,s.jsxs)(T.default,{className:"w-fit gap-x-0.5 px-3",variant:"primary",onClick:()=>{w(),m.push(`/datasets/${t}/documents`)},children:[(0,s.jsx)("span",{className:"px-0.5",children:u("stepThree.navTo",{ns:"datasetCreation"})}),(0,s.jsx)(S.RiArrowRightLine,{className:"size-4 stroke-current stroke-1"})]})]})]})},eu=e=>{let{batchId:t,documents:a}=e,{t:l}=(0,n.useTranslation)(),i=(0,Z.useDocLink)(),r=(0,o.useDatasetDetailContextWithSelector)(e=>e.dataset?.id),d=(0,o.useDatasetDetailContextWithSelector)(e=>e.dataset?.indexing_technique),c=(0,o.useDatasetDetailContextWithSelector)(e=>e.dataset?.retrieval_model_dict?.search_method);return(0,s.jsxs)("div",{className:"flex h-full w-full justify-center overflow-hidden",children:[(0,s.jsx)("div",{className:"h-full w-3/5 overflow-y-auto pb-8 pt-10",children:(0,s.jsx)("div",{className:"max-w-[640px]",children:(0,s.jsx)(ec,{datasetId:r,batchId:t,documents:a,indexingType:d,retrievalMethod:c})})}),(0,s.jsx)("div",{className:"w-2/5 pr-8 pt-[88px]",children:(0,s.jsxs)("div",{className:"flex w-[328px] flex-col gap-3 rounded-xl bg-background-section p-6",children:[(0,s.jsx)("div",{className:"flex size-10 items-center justify-center rounded-[10px] bg-components-card-bg shadow-lg shadow-shadow-shadow-5",children:(0,s.jsx)(S.RiBookOpenLine,{className:"size-5 text-text-accent"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,s.jsx)("div",{className:"system-xl-semibold text-text-secondary",children:l("stepThree.sideTipTitle",{ns:"datasetCreation"})}),(0,s.jsx)("div",{className:"system-sm-regular text-text-tertiary",children:l("stepThree.sideTipContent",{ns:"datasetCreation"})}),(0,s.jsx)("a",{href:i("/use-dify/knowledge/knowledge-pipeline/authorize-data-source"),target:"_blank",rel:"noreferrer noopener",className:"system-sm-regular text-text-accent",children:l("addDocuments.stepThree.learnMore",{ns:"datasetPipeline"})})]})]})})]})},em=(0,l.memo)(e=>{let{batchId:t,documents:a}=e;return(0,s.jsx)(eu,{batchId:t,documents:a})});var ep=e.i(870676),ex=e.i(849225);let eh=l.memo(e=>{let{onBack:t,runDisabled:a,onProcess:l}=e,{t:i}=(0,n.useTranslation)();return(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(T.default,{variant:"secondary",onClick:t,className:"gap-x-0.5",children:[(0,s.jsx)(S.RiArrowLeftLine,{className:"size-4"}),(0,s.jsx)("span",{className:"px-0.5",children:i("operations.dataSource",{ns:"datasetPipeline"})})]}),(0,s.jsx)(T.default,{variant:"primary",disabled:a,onClick:l,children:i("operations.saveAndProcess",{ns:"datasetPipeline"})})]})});var eg=e.i(799889);let ef=l.memo(e=>{let{dataSourceNodeId:t,isRunning:a,onProcess:l,onPreview:n,onSubmit:i,onBack:r,ref:d}=e,{isFetchingParams:c,paramsConfig:u}=(e=>{let t=(0,o.useDatasetDetailContextWithSelector)(e=>e.dataset?.pipeline_id),{data:s,isFetching:a}=(0,m.usePublishedPipelineProcessingParams)({pipeline_id:t,node_id:e});return{paramsConfig:s,isFetchingParams:a}})(t),p=(0,ex.useInitialData)(u?.variables||[]),x=(0,ex.useConfigurations)(u?.variables||[]),h=(0,ep.generateZodSchema)(x);return(0,s.jsxs)("div",{className:"flex flex-col gap-y-4 pt-4",children:[(0,s.jsx)(eg.default,{ref:d,initialData:p,configurations:x,schema:h,onSubmit:i,onPreview:n,isRunning:a}),(0,s.jsx)(eh,{runDisabled:c||a,onBack:r,onProcess:l})]})}),eb=(0,l.memo)(e=>{let{formRef:t,dataSourceNodeId:a,isRunning:l,onProcess:n,onPreview:i,onSubmit:r,onBack:o}=e;return(0,s.jsx)(ef,{ref:t,dataSourceNodeId:a,isRunning:l,onProcess:n,onPreview:i,onSubmit:r,onBack:o})});var ev=e.i(378755),ej=e.i(128984),ey=e.i(465497);let ew=l.memo(()=>(0,s.jsxs)("div",{className:"flex h-full w-full flex-col gap-y-3 overflow-hidden bg-gradient-to-b from-components-panel-bg-transparent to-components-panel-bg px-6 py-5",children:[(0,s.jsxs)(ey.SkeletonContainer,{className:"w-full gap-0",children:[(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-3/5"})]}),(0,s.jsxs)(ey.SkeletonContainer,{className:"w-full gap-0",children:[(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-[70%]"})]}),(0,s.jsxs)(ey.SkeletonContainer,{className:"w-full gap-0",children:[(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-[56%]"})]}),(0,s.jsxs)(ey.SkeletonContainer,{className:"w-full gap-0",children:[(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-3/5"})]}),(0,s.jsxs)(ey.SkeletonContainer,{className:"w-full gap-0",children:[(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-3/5"})]}),(0,s.jsxs)(ey.SkeletonContainer,{className:"w-full gap-0",children:[(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-full"}),(0,s.jsx)(ey.SkeletonRectangle,{className:"my-1.5 w-1/2"})]})]})),eD=e=>{let{file:t,hidePreview:a}=e,{t:i}=(0,n.useTranslation)(),{data:r,isFetching:o}=(0,u.useFilePreview)(t.id||""),d=(0,l.useMemo)(()=>t?t.name.split(".").slice(0,-1).join():"",[t]);return(0,s.jsxs)("div",{className:"flex h-full w-full flex-col rounded-t-xl border-l border-t border-components-panel-border bg-background-default-lighter shadow-md shadow-shadow-shadow-5",children:[(0,s.jsxs)("div",{className:"flex gap-x-2 border-b border-divider-subtle pb-3 pl-6 pr-4 pt-4",children:[(0,s.jsxs)("div",{className:"flex grow flex-col gap-y-1",children:[(0,s.jsx)("div",{className:"system-2xs-semibold-uppercase text-text-accent",children:i("addDocuments.stepOne.preview",{ns:"datasetPipeline"})}),(0,s.jsx)("div",{className:"title-md-semi-bold text-tex-primary",children:`${d}.${t.extension||""}`}),(0,s.jsxs)("div",{className:"system-xs-medium flex items-center gap-x-1 text-text-tertiary",children:[(0,s.jsx)(et.default,{className:"size-3.5 shrink-0",name:t.name,extension:t.extension}),(0,s.jsx)("span",{className:"uppercase",children:t.extension}),(0,s.jsx)("span",{children:"·"}),(0,s.jsx)("span",{children:(0,ej.formatFileSize)(t.size)}),r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:"·"}),(0,s.jsx)("span",{children:`${(0,ej.formatNumberAbbreviated)(r.content.length)} ${i("addDocuments.characters",{ns:"datasetPipeline"})}`})]})]})]}),(0,s.jsx)("button",{type:"button",className:"flex h-8 w-8 shrink-0 items-center justify-center",onClick:a,children:(0,s.jsx)(S.RiCloseLine,{className:"size-[18px]"})})]}),o&&(0,s.jsx)("div",{className:"grow",children:(0,s.jsx)(ew,{})}),!o&&r&&(0,s.jsx)("div",{className:"body-md-regular grow overflow-hidden px-6 py-5 text-text-secondary",children:r.content})]})};e.i(432024);var eN=e.i(600839),eS=e.i(379415),ek=e.i(137667);let eC=e=>{let{currentPage:t,datasourceNodeId:a,hidePreview:i}=e,{t:r}=(0,n.useTranslation)(),[d,c]=(0,l.useState)(""),u=(0,o.useDatasetDetailContextWithSelector)(e=>e.dataset?.pipeline_id),{mutateAsync:x,isPending:h}=(0,m.usePreviewOnlineDocument)(),g=(0,p.useDataSourceStore)();return(0,l.useEffect)(()=>{let{currentCredentialId:e}=g.getState();x({workspaceID:t.workspace_id,pageID:t.page_id,pageType:t.type,pipelineId:u||"",datasourceNodeId:a,credentialId:e},{onSuccess(e){c(e.content)},onError(e){ek.default.notify({type:"error",message:e.message})}})},[t.page_id]),(0,s.jsxs)("div",{className:"flex h-full w-full flex-col rounded-t-xl border-l border-t border-components-panel-border bg-background-default-lighter shadow-md shadow-shadow-shadow-5",children:[(0,s.jsxs)("div",{className:"flex gap-x-2 border-b border-divider-subtle pb-3 pl-6 pr-4 pt-4",children:[(0,s.jsxs)("div",{className:"flex grow flex-col gap-y-1",children:[(0,s.jsx)("div",{className:"system-2xs-semibold-uppercase text-text-accent",children:r("addDocuments.stepOne.preview",{ns:"datasetPipeline"})}),(0,s.jsx)("div",{className:"title-md-semi-bold text-tex-primary",children:t?.page_name}),(0,s.jsxs)("div",{className:"system-xs-medium flex items-center gap-x-1 text-text-tertiary",children:[(0,s.jsx)(eN.Notion,{className:"size-3.5"}),(0,s.jsx)("span",{children:t.type}),(0,s.jsx)("span",{children:"·"}),(0,s.jsx)("span",{children:`${(0,ej.formatNumberAbbreviated)(d.length)} ${r("addDocuments.characters",{ns:"datasetPipeline"})}`})]})]}),(0,s.jsx)("button",{type:"button",className:"flex h-8 w-8 shrink-0 items-center justify-center",onClick:i,children:(0,s.jsx)(S.RiCloseLine,{className:"size-[18px]"})})]}),h&&(0,s.jsx)("div",{className:"grow",children:(0,s.jsx)(ew,{})}),!h&&d&&(0,s.jsx)("div",{className:"body-md-regular grow overflow-hidden px-6 py-5 text-text-secondary",children:(0,s.jsx)(eS.Markdown,{content:d})})]})},eT=e=>{let{currentWebsite:t,hidePreview:a}=e,{t:l}=(0,n.useTranslation)();return(0,s.jsxs)("div",{className:"flex h-full w-full flex-col rounded-t-xl border-l border-t border-components-panel-border bg-background-default-lighter shadow-md shadow-shadow-shadow-5",children:[(0,s.jsxs)("div",{className:"flex gap-x-2 border-b border-divider-subtle pb-3 pl-6 pr-4 pt-4",children:[(0,s.jsxs)("div",{className:"flex grow flex-col gap-y-1",children:[(0,s.jsx)("div",{className:"system-2xs-semibold-uppercase",children:l("addDocuments.stepOne.preview",{ns:"datasetPipeline"})}),(0,s.jsx)("div",{className:"title-md-semi-bold text-tex-primary",children:t.title}),(0,s.jsxs)("div",{className:"system-xs-medium flex gap-x-1  text-text-tertiary",children:[(0,s.jsx)(S.RiGlobalLine,{className:"size-3.5"}),(0,s.jsx)("span",{className:"uppercase",title:t.source_url,children:t.source_url}),(0,s.jsx)("span",{children:"·"}),(0,s.jsx)("span",{children:"·"}),(0,s.jsx)("span",{children:`${(0,ej.formatNumberAbbreviated)(t.markdown.length)} ${l("addDocuments.characters",{ns:"datasetPipeline"})}`})]})]}),(0,s.jsx)("button",{type:"button",className:"flex h-8 w-8 shrink-0 items-center justify-center",onClick:a,children:(0,s.jsx)(S.RiCloseLine,{className:"size-[18px]"})})]}),(0,s.jsx)("div",{className:"body-md-regular grow overflow-hidden px-6 py-5 text-text-secondary",children:t.markdown})]})},e_=(0,l.memo)(e=>{let{datasource:t,currentLocalFile:a,currentDocument:l,currentWebsite:n,hidePreviewLocalFile:i,hidePreviewOnlineDocument:r,hideWebsitePreview:o}=e;return(0,s.jsx)("div",{className:"h-full min-w-0 flex-1",children:(0,s.jsxs)("div",{className:"flex h-full flex-col pl-2 pt-2",children:[a&&(0,s.jsx)(eD,{file:a,hidePreview:i}),l&&(0,s.jsx)(eC,{datasourceNodeId:t.nodeId,currentPage:l,hidePreview:r}),n&&(0,s.jsx)(eT,{currentWebsite:n,hidePreview:o})]})})});e_.displayName="StepOnePreview";let eP=(0,l.memo)(e=>{let{datasourceType:t,localFileList:a,onlineDocuments:l,websitePages:n,selectedOnlineDriveFileList:i,isIdle:r,isPendingPreview:o,estimateData:d,onPreview:c,handlePreviewFileChange:u,handlePreviewOnlineDocumentChange:m,handlePreviewWebsitePageChange:p,handlePreviewOnlineDriveFileChange:x}=e;return(0,s.jsx)("div",{className:"h-full min-w-0 flex-1",children:(0,s.jsx)("div",{className:"flex h-full flex-col pl-2 pt-2",children:(0,s.jsx)(ev.default,{dataSourceType:t,localFiles:a.map(e=>e.file),onlineDocuments:l,websitePages:n,onlineDriveFiles:i,isIdle:r,isPending:o,estimateData:d,onPreview:c,handlePreviewFileChange:u,handlePreviewOnlineDocumentChange:m,handlePreviewWebsitePageChange:p,handlePreviewOnlineDriveFileChange:x})})})});eP.displayName="StepTwoPreview";let eR=()=>{let{t:e}=(0,n.useTranslation)(),t=(0,d.useProviderContextSelector)(e=>e.plan),x=(0,d.useProviderContextSelector)(e=>e.enableBilling),f=(0,o.useDatasetDetailContextWithSelector)(e=>e.dataset?.pipeline_id),w=(0,p.useDataSourceStore)(),[S,k]=(0,l.useState)(),[C,T]=(0,l.useState)(void 0),[_,P]=(0,l.useState)(""),[R,F]=(0,l.useState)([]),{data:L,isFetching:M}=(0,m.usePublishedPipelineInfo)(f||""),{data:z}=(0,u.useFileUploadConfig)(),O=(0,l.useMemo)(()=>z??{file_size_limit:15,batch_count_limit:5},[z]),{steps:E,currentStep:A,handleNextStep:W,handleBackStep:$}=(()=>{let{t:e}=(0,n.useTranslation)(),[t,s]=(0,l.useState)(1),a=(0,l.useCallback)(()=>{s(e=>e+1)},[]),i=(0,l.useCallback)(()=>{s(e=>e-1)},[]);return{steps:[{label:e("addDocuments.steps.chooseDatasource",{ns:"datasetPipeline"}),value:h.dataSource},{label:e("addDocuments.steps.processDocuments",{ns:"datasetPipeline"}),value:h.processDocuments},{label:e("addDocuments.steps.processingDocuments",{ns:"datasetPipeline"}),value:h.processingDocuments}],currentStep:t,handleNextStep:a,handleBackStep:i}})(),{localFileList:B,allFileLoaded:U,currentLocalFile:V,hidePreviewLocalFile:q}=(()=>{let{localFileList:e,currentLocalFile:t}=(0,p.useDataSourceStoreWithSelector)((0,D.useShallow)(e=>({localFileList:e.localFileList,currentLocalFile:e.currentLocalFile}))),s=(0,p.useDataSourceStore)(),a=(0,l.useMemo)(()=>e.length>0&&e.every(e=>e.file.id),[e]);return{localFileList:e,allFileLoaded:a,currentLocalFile:t,hidePreviewLocalFile:(0,l.useCallback)(()=>{let{setCurrentLocalFile:e}=s.getState();e(void 0)},[s])}})(),{currentWorkspace:H,onlineDocuments:K,currentDocument:Z,PagesMapAndSelectedPagesId:J,hidePreviewOnlineDocument:Q,clearOnlineDocumentData:X}=(()=>{let{documentsData:e,onlineDocuments:t,currentDocument:s}=(0,p.useDataSourceStoreWithSelector)((0,D.useShallow)(e=>({documentsData:e.documentsData,onlineDocuments:e.onlineDocuments,currentDocument:e.currentDocument}))),a=(0,p.useDataSourceStore)(),n=e[0],i=(0,l.useMemo)(()=>(e||[]).reduce((e,t)=>(t.pages.forEach(s=>{e[s.page_id]={...s,workspace_id:t.workspace_id}}),e),{}),[e]);return{currentWorkspace:n,onlineDocuments:t,currentDocument:s,PagesMapAndSelectedPagesId:i,hidePreviewOnlineDocument:(0,l.useCallback)(()=>{let{setCurrentDocument:e}=a.getState();e(void 0)},[a]),clearOnlineDocumentData:(0,l.useCallback)(()=>{let{setDocumentsData:e,setSearchValue:t,setSelectedPagesId:s,setOnlineDocuments:l,setCurrentDocument:n}=a.getState();e([]),t(""),s(new Set),l([]),n(void 0)},[a])}})(),{websitePages:Y,currentWebsite:ee,hideWebsitePreview:et,clearWebsiteCrawlData:es}=(()=>{let{websitePages:e,currentWebsite:t}=(0,p.useDataSourceStoreWithSelector)((0,D.useShallow)(e=>({websitePages:e.websitePages,currentWebsite:e.currentWebsite}))),s=(0,p.useDataSourceStore)();return{websitePages:e,currentWebsite:t,hideWebsitePreview:(0,l.useCallback)(()=>{let{setCurrentWebsite:e,setPreviewIndex:t}=s.getState();e(void 0),t(-1)},[s]),clearWebsiteCrawlData:(0,l.useCallback)(()=>{let{setStep:e,setCrawlResult:t,setWebsitePages:a,setPreviewIndex:l,setCurrentWebsite:n}=s.getState();e(N.CrawlStep.init),t(void 0),n(void 0),a([]),l(-1)},[s])}})(),{onlineDriveFileList:ea,selectedFileIds:el,selectedOnlineDriveFileList:en,clearOnlineDriveData:ei}=(()=>{let{onlineDriveFileList:e,selectedFileIds:t}=(0,p.useDataSourceStoreWithSelector)((0,D.useShallow)(e=>({onlineDriveFileList:e.onlineDriveFileList,selectedFileIds:e.selectedFileIds}))),s=(0,p.useDataSourceStore)(),a=(0,l.useMemo)(()=>t.map(t=>e.find(e=>e.id===t)),[e,t]);return{onlineDriveFileList:e,selectedFileIds:t,selectedOnlineDriveFileList:a,clearOnlineDriveData:(0,l.useCallback)(()=>{let{setOnlineDriveFileList:e,setBucket:t,setPrefix:a,setKeywords:l,setSelectedFileIds:n}=s.getState();e([]),t(""),a([]),l(""),n([])},[s])}})(),er=t.usage.vectorSpace>=t.total.vectorSpace,eo=!x||"sandbox"!==t.type,{datasourceType:ed,isShowVectorSpaceFull:ec,nextBtnDisabled:eu,showSelect:ep,totalOptions:ex,selectedOptions:eh,tip:eg}=(e=>{let{datasource:t,allFileLoaded:s,localFileListLength:a,onlineDocumentsLength:i,websitePagesLength:r,selectedFileIdsLength:o,onlineDriveFileList:d,isVectorSpaceFull:u,enableBilling:m,currentWorkspacePagesLength:p,fileUploadConfig:x}=e,{t:h}=(0,n.useTranslation)(),g=t?.nodeData.provider_type,f=(0,l.useMemo)(()=>!!t&&!!g&&({[c.DatasourceType.localFile]:s,[c.DatasourceType.onlineDocument]:i>0,[c.DatasourceType.websiteCrawl]:r>0,[c.DatasourceType.onlineDrive]:d.length>0})[g]&&u&&m,[t,g,s,i,r,d.length,u,m]),b=(0,l.useMemo)(()=>!t||!g||(({[c.DatasourceType.localFile]:f||0===a||!s,[c.DatasourceType.onlineDocument]:f||0===i,[c.DatasourceType.websiteCrawl]:f||0===r,[c.DatasourceType.onlineDrive]:f||0===o})[g]??!0),[t,g,f,a,s,i,r,o]),v=(0,l.useMemo)(()=>{if(g===c.DatasourceType.onlineDocument)return p>0;if(g===c.DatasourceType.onlineDrive){let e=d.filter(e=>"bucket"!==e.type);return!d.some(e=>"bucket"===e.type)&&e.length>0}return!1},[p,g,d]),j=(0,l.useMemo)(()=>g===c.DatasourceType.onlineDocument?p:g===c.DatasourceType.onlineDrive?d.filter(e=>"bucket"!==e.type).length:void 0,[p,g,d]),y=(0,l.useMemo)(()=>g===c.DatasourceType.onlineDocument?i:g===c.DatasourceType.onlineDrive?o:void 0,[g,i,o]),w=(0,l.useMemo)(()=>g===c.DatasourceType.onlineDocument?h("addDocuments.selectOnlineDocumentTip",{ns:"datasetPipeline",count:50}):g===c.DatasourceType.onlineDrive?h("addDocuments.selectOnlineDriveTip",{ns:"datasetPipeline",count:x.batch_count_limit,fileSize:x.file_size_limit}):"",[g,x.batch_count_limit,x.file_size_limit,h]);return{datasourceType:g,isShowVectorSpaceFull:f,nextBtnDisabled:b,showSelect:v,totalOptions:j,selectedOptions:y,tip:w}})({datasource:S,allFileLoaded:U,localFileListLength:B.length,onlineDocumentsLength:K.length,websitePagesLength:Y.length,selectedFileIdsLength:el.length,onlineDriveFileList:ea,isVectorSpaceFull:er,enableBilling:x,currentWorkspacePagesLength:H?.pages.length??0,fileUploadConfig:O}),[ef,{setTrue:ev,setFalse:ej}]=(0,a.useBoolean)(!1),ey=(0,l.useCallback)(()=>{if(!eo){let e={[c.DatasourceType.localFile]:B.length,[c.DatasourceType.onlineDocument]:K.length,[c.DatasourceType.websiteCrawl]:Y.length,[c.DatasourceType.onlineDrive]:el.length};if((ed?e[ed]:0)>1)return void ev()}W()},[ed,W,B.length,K.length,el.length,ev,eo,Y.length]),{isPreview:ew,formRef:eD,isIdle:eN,isPending:eS,onClickProcess:ek,onClickPreview:eC,handleSubmit:eT,handlePreviewFileChange:eR,handlePreviewOnlineDocumentChange:eI,handlePreviewWebsiteChange:eF,handlePreviewOnlineDriveFileChange:eL,handleSelectAll:eM,handleSwitchDataSource:ez,handleCredentialChange:eO}=(e=>{let{datasource:t,datasourceType:s,pipelineId:a,dataSourceStore:n,setEstimateData:i,setBatchId:r,setDocuments:o,handleNextStep:d,PagesMapAndSelectedPagesId:u,currentWorkspacePages:p,clearOnlineDocumentData:x,clearWebsiteCrawlData:h,clearOnlineDriveData:f,setDatasource:w}=e,D=(0,l.useRef)(!1),N=(0,l.useRef)(null),{mutateAsync:S,isIdle:k,isPending:C}=(0,m.useRunPublishedPipeline)(),T=(0,l.useCallback)(()=>{let{previewLocalFileRef:e,previewOnlineDocumentRef:t,previewWebsitePageRef:a,previewOnlineDriveFileRef:l,currentCredentialId:i,bucket:r}=n.getState(),o=[];return s===c.DatasourceType.localFile&&e.current&&o.push(b(e.current,i)),s===c.DatasourceType.onlineDocument&&t.current&&o.push(v(t.current,i)),s===c.DatasourceType.websiteCrawl&&a.current&&o.push(j(a.current,i)),s===c.DatasourceType.onlineDrive&&l.current&&o.push(y(l.current,r,i)),o},[n,s]),_=(0,l.useCallback)(()=>{let{currentCredentialId:e,localFileList:t,onlineDocuments:a,websitePages:l,bucket:i,selectedFileIds:r,onlineDriveFileList:o}=n.getState(),d=[];return s===c.DatasourceType.localFile&&t.forEach(t=>{d.push(b(t.file,e))}),s===c.DatasourceType.onlineDocument&&a.forEach(t=>{d.push(v(t,e))}),s===c.DatasourceType.websiteCrawl&&l.forEach(t=>{d.push(j(t,e))}),s===c.DatasourceType.onlineDrive&&r.forEach(t=>{let s=o.find(e=>e.id===t);s&&d.push(y(s,i,e))}),d},[n,s]),P=(0,l.useCallback)(async e=>{if(!t||!a)return;let l=T();await S({pipeline_id:a,inputs:e,start_node_id:t.nodeId,datasource_type:s,datasource_info_list:l,is_preview:!0},{onSuccess:e=>{i(e.data.outputs)}})},[t,a,s,T,S,i]),R=(0,l.useCallback)(async e=>{if(!t||!a)return;let l=_();await S({pipeline_id:a,inputs:e,start_node_id:t.nodeId,datasource_type:s,datasource_info_list:l,is_preview:!1},{onSuccess:e=>{r(e.batch||""),o(e.documents||[]),d(),(0,g.trackEvent)("dataset_document_added",{data_source_type:s,indexing_technique:"pipeline"})}})},[t,a,s,_,S,r,o,d]),I=(0,l.useCallback)(()=>{D.current=!1,N.current?.submit()},[]),F=(0,l.useCallback)(()=>{D.current=!0,N.current?.submit()},[]),L=(0,l.useCallback)(e=>{D.current?P(e):R(e)},[P,R]),M=(0,l.useCallback)(e=>{let{previewLocalFileRef:t}=n.getState();t.current=e,F()},[n,F]),z=(0,l.useCallback)(e=>{let{previewOnlineDocumentRef:t}=n.getState();t.current=e,F()},[n,F]),O=(0,l.useCallback)(e=>{let{previewWebsitePageRef:t}=n.getState();t.current=e,F()},[n,F]),E=(0,l.useCallback)(e=>{let{previewOnlineDriveFileRef:t}=n.getState();t.current=e,F()},[n,F]),A=(0,l.useCallback)(()=>{let{onlineDocuments:e,onlineDriveFileList:t,selectedFileIds:a,setOnlineDocuments:l,setSelectedFileIds:i,setSelectedPagesId:r}=n.getState();if(s===c.DatasourceType.onlineDocument){let t=p?.map(e=>e.page_id)||[];e.length<t.length?(l(Array.from(t).map(e=>u[e])),r(new Set(t))):(l([]),r(new Set))}if(s===c.DatasourceType.onlineDrive){let e=t.filter(e=>"bucket"!==e.type).map(e=>e.id);i(a.length<e.length?e:[])}},[u,p,n,s]),W=(0,l.useCallback)(e=>{let t=e.nodeData.provider_type,s={[c.DatasourceType.onlineDocument]:x,[c.DatasourceType.websiteCrawl]:h,[c.DatasourceType.onlineDrive]:f,[c.DatasourceType.localFile]:()=>{}};s[t]?.()},[x,f,h]);return{isPreview:D,formRef:N,isIdle:k,isPending:C,onClickProcess:I,onClickPreview:F,handleSubmit:L,handlePreviewFileChange:M,handlePreviewOnlineDocumentChange:z,handlePreviewWebsiteChange:O,handlePreviewOnlineDriveFileChange:E,handleSelectAll:A,handleSwitchDataSource:(0,l.useCallback)(e=>{let{setCurrentCredentialId:t,currentNodeIdRef:s}=n.getState();W(e),t(""),s.current=e.nodeId,w(e)},[W,n,w]),handleCredentialChange:(0,l.useCallback)(e=>{let{setCurrentCredentialId:s}=n.getState();t&&W(t),s(e)},[W,n,t])}})({datasource:S,datasourceType:ed,pipelineId:f,dataSourceStore:w,setEstimateData:T,setBatchId:P,setDocuments:F,handleNextStep:ey,PagesMapAndSelectedPagesId:J,currentWorkspacePages:H?.pages,clearOnlineDocumentData:X,clearWebsiteCrawlData:es,clearOnlineDriveData:ei,setDatasource:k});return M?(0,s.jsx)(i.default,{type:"app"}):(0,s.jsxs)("div",{className:"relative flex h-[calc(100vh-56px)] w-full min-w-[1024px] overflow-x-auto rounded-t-2xl border-t border-effects-highlight bg-background-default-subtle",children:[(0,s.jsx)("div",{className:"h-full min-w-0 flex-1",children:(0,s.jsxs)("div",{className:"flex h-full flex-col px-14",children:[(0,s.jsx)(I,{steps:E,title:e("addDocuments.title",{ns:"datasetPipeline"}),currentStep:A}),(0,s.jsxs)("div",{className:"grow overflow-y-auto",children:[1===A&&(0,s.jsx)(G,{datasource:S,datasourceType:ed,pipelineNodes:L?.graph.nodes||[],supportBatchUpload:eo,localFileListLength:B.length,isShowVectorSpaceFull:ec,showSelect:ep,totalOptions:ex,selectedOptions:eh,tip:eg,nextBtnDisabled:eu,onSelectDataSource:ez,onCredentialChange:eO,onSelectAll:eM,onNextStep:ey}),2===A&&(0,s.jsx)(eb,{formRef:eD,dataSourceNodeId:S.nodeId,isRunning:eS,onProcess:ek,onPreview:eC,onSubmit:eT,onBack:$}),3===A&&(0,s.jsx)(em,{batchId:_,documents:R})]})]})}),1===A&&(0,s.jsx)(e_,{datasource:S,currentLocalFile:V,currentDocument:Z,currentWebsite:ee,hidePreviewLocalFile:q,hidePreviewOnlineDocument:Q,hideWebsitePreview:et}),2===A&&(0,s.jsx)(eP,{datasourceType:ed,localFileList:B,onlineDocuments:K,websitePages:Y,selectedOnlineDriveFileList:en,isIdle:eN,isPendingPreview:eS&&ew.current,estimateData:C,onPreview:eC,handlePreviewFileChange:eR,handlePreviewOnlineDocumentChange:eI,handlePreviewWebsitePageChange:eF,handlePreviewOnlineDriveFileChange:eL}),ef&&(0,s.jsx)(r.default,{show:!0,onClose:ej,title:e("upgrade.uploadMultiplePages.title",{ns:"billing"}),description:e("upgrade.uploadMultiplePages.description",{ns:"billing"})})]})};e.s(["default",0,()=>(0,s.jsx)(x.default,{children:(0,s.jsx)(eR,{})})],676989)}]);