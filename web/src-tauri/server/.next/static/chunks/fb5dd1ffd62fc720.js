(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,863085,e=>{"use strict";var t=e.i(56505);e.s(["CheckCircle",()=>t.default])},592366,e=>{"use strict";var t=e.i(563199),r=e.i(837699),a=e.i(268255),i=e.i(521632),s=e.i(271743),l=e.i(935139);let n=a.memo(e=>{let{isShow:n,onHide:o,dialogClassName:u="",dialogBackdropClassName:d="",panelClassName:c="",maxWidthClassName:p="!max-w-[640px]",height:h="calc(100vh - 72px)",contentClassName:f,headerClassName:m,title:g,titleDescription:x,body:v,foot:b,isShowMask:y,clickOutsideNotOpen:j=!0,positionCenter:w}=e,_=(0,a.useRef)(null),S=(0,s.default)()===s.MediaType.mobile;return n?(0,t.jsx)(i.default,{isOpen:n,clickOutsideNotOpen:j,onClose:o,footer:null,mask:S||y,positionCenter:w,dialogClassName:u,dialogBackdropClassName:d,panelClassName:(0,l.cn)("mx-2 mb-3 mt-16 rounded-xl !p-0 sm:mr-2",c,p),children:(0,t.jsxs)("div",{className:(0,l.cn)(f,"flex w-full flex-col rounded-xl border-[0.5px] border-divider-subtle bg-components-panel-bg shadow-xl"),style:{height:h},ref:_,children:[(0,t.jsxs)("div",{className:(0,l.cn)(m,"shrink-0 border-b border-divider-subtle py-4"),children:[(0,t.jsxs)("div",{className:"flex h-6 items-center justify-between pl-6 pr-5",children:[(0,t.jsx)("div",{className:"system-xl-semibold text-text-primary",children:g}),(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)("div",{onClick:o,className:"flex h-6 w-6 cursor-pointer items-center justify-center",children:(0,t.jsx)(r.RiCloseLine,{className:"h-4 w-4 text-text-tertiary"})})})]}),x&&(0,t.jsx)("div",{className:"system-xs-regular pl-6 pr-10 text-text-tertiary",children:x})]}),(0,t.jsx)("div",{className:"grow overflow-y-auto",children:v}),b&&(0,t.jsx)("div",{className:"shrink-0",children:b})]})}):null});e.s(["default",0,n])},987878,733437,e=>{"use strict";var t=e.i(268255),r=e.i(639751),a=e.i(563199),i=e.i(763989),s=e.i(648404);let l=(0,t.createContext)(null);function n(e){let a=(0,t.useContext)(l);if(!a)throw Error("Missing FeaturesContext.Provider in the tree");return(0,r.useStore)(a,e)}function o(){return(0,t.useContext)(l)}e.s(["FeaturesContext",0,l,"FeaturesProvider",0,e=>{let r,{children:n,...o}=e,u=(0,t.useRef)(void 0);return u.current||(r={features:{moreLikeThis:{enabled:!1},opening:{enabled:!1},suggested:{enabled:!1},text2speech:{enabled:!1},speech2text:{enabled:!1},citation:{enabled:!1},moderation:{enabled:!1},file:{image:{enabled:!1,detail:s.Resolution.high,number_limits:3,transfer_methods:[s.TransferMethod.local_file,s.TransferMethod.remote_url]}},annotationReply:{enabled:!1}}},u.current=(0,i.createStore)()(e=>({...r,...o,setFeatures:t=>e(()=>({features:t})),showFeaturesModal:!1,setShowFeaturesModal:t=>e(()=>({showFeaturesModal:t}))}))),(0,a.jsx)(l.Provider,{value:u.current,children:n})}],733437),e.s(["useFeatures",()=>n,"useFeaturesStore",()=>o],987878)},153935,e=>{"use strict";var t=e.i(978912),r=e.i(137667),a=e.i(447301);class i{mediaSource;audio;audioContext;sourceBuffer;cacheBuffers=[];pauseTimer=null;msgId;msgContent=null;voice=void 0;isLoadData=!1;url;isPublic;callback;constructor(e,t,a,i,s,l){this.audioContext=new AudioContext,this.msgId=a,this.msgContent=i,this.url=e,this.isPublic=t,this.voice=s,this.callback=l;const n=window.ManagedMediaSource||window.MediaSource;n||r.default.notify({message:"Your browser does not support audio streaming, if you are using an iPhone, please update to iOS 17.1 or later.",type:"error"}),this.mediaSource=n?new n:null,this.audio=new Audio,this.setCallback(l),window.MediaSource||(this.audio.disableRemotePlayback=!0,this.audio.controls=!0),this.audio.src=this.mediaSource?URL.createObjectURL(this.mediaSource):"",this.audio.autoplay=!0,this.audioContext.createMediaElementSource(this.audio).connect(this.audioContext.destination),this.listenMediaSource("audio/mpeg")}resetMsgId(e){this.msgId=e}listenMediaSource(e){this.mediaSource?.addEventListener("sourceopen",()=>{this.sourceBuffer||(this.sourceBuffer=this.mediaSource?.addSourceBuffer(e))})}setCallback(e){this.callback=e,e&&(this.audio.addEventListener("ended",()=>{e("ended")},!1),this.audio.addEventListener("paused",()=>{e("paused")},!0),this.audio.addEventListener("loaded",()=>{e("loaded")},!0),this.audio.addEventListener("play",()=>{e("play")},!0),this.audio.addEventListener("timeupdate",()=>{e("timeupdate")},!0),this.audio.addEventListener("loadeddate",()=>{e("loadeddate")},!0),this.audio.addEventListener("canplay",()=>{e("canplay")},!0),this.audio.addEventListener("error",()=>{e("error")},!0))}async loadAudio(){try{let e=await (0,a.textToAudioStream)(this.url,this.isPublic?a.AppSourceType.webApp:a.AppSourceType.installedApp,{content_type:"audio/mpeg"},{message_id:this.msgId,streaming:!0,voice:this.voice,text:this.msgContent});200!==e.status&&(this.isLoadData=!1,this.callback&&this.callback("error"));let t=e.body.getReader();for(;;){let{value:e,done:r}=await t.read();if(r){this.receiveAudioData(e);break}this.receiveAudioData(e)}}catch{this.isLoadData=!1,this.callback?.("error")}}playAudio(){this.isLoadData?("suspended"===this.audioContext.state?this.audioContext.resume().then(e=>{this.audio.play(),this.callback?.("play")}):this.audio.ended&&(this.audio.play(),this.callback?.("play")),this.callback?.("play")):(this.isLoadData=!0,this.loadAudio())}theEndOfStream(){let e=setInterval(()=>{this.sourceBuffer?.updating||(this.mediaSource?.endOfStream(),clearInterval(e))},10)}finishStream(){let e=setInterval(()=>{if(this.cacheBuffers.length||(this.theEndOfStream(),clearInterval(e)),this.cacheBuffers.length&&!this.sourceBuffer?.updating){let e=this.cacheBuffers.shift();this.sourceBuffer?.appendBuffer(e)}},10)}async playAudioWithAudio(e){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!e||!e.length)return void this.finishStream();let a=t.Buffer.from(e,"base64");this.receiveAudioData(new Uint8Array(a)),r&&(this.isLoadData=!0,this.audio.paused?this.audioContext.resume().then(e=>{this.audio.play(),this.callback?.("play")}):this.audio.ended?(this.audio.play(),this.callback?.("play")):this.audio.played||(this.audio.play(),this.callback?.("play")))}pauseAudio(){this.callback?.("paused"),this.audio.pause(),this.audioContext.suspend()}receiveAudioData(e){if(!e)return void this.finishStream();let t=this.byteArrayToArrayBuffer(e);if(!t.byteLength){this.mediaSource?.readyState==="open"&&this.finishStream();return}if(this.sourceBuffer?.updating)this.cacheBuffers.push(t);else if(this.cacheBuffers.length&&!this.sourceBuffer?.updating){this.cacheBuffers.push(t);let e=this.cacheBuffers.shift();this.sourceBuffer?.appendBuffer(e)}else this.sourceBuffer?.appendBuffer(t)}byteArrayToArrayBuffer(e){let t=new ArrayBuffer(e.length);return new Uint8Array(t).set(e),t}}class s{static instance;audioPlayers=null;msgId;static getInstance(){return s.instance||(s.instance=new s,this.instance=s.instance),s.instance}getAudioPlayer(e,t,r,a,s,l){if(this.msgId&&this.msgId===r&&this.audioPlayers)return this.audioPlayers.setCallback(l),this.audioPlayers;if(this.audioPlayers)try{this.audioPlayers.pauseAudio(),this.audioPlayers.cacheBuffers=[],this.audioPlayers.sourceBuffer?.abort()}catch{}return this.msgId=r,this.audioPlayers=new i(e,t,r,a,s,l),this.audioPlayers}resetMsgId(e){this.msgId=e,this.audioPlayers?.resetMsgId(e)}}e.s(["AudioPlayerManager",()=>s],153935)},955371,e=>{"use strict";var t,r=((t={}).python3="python3",t.javascript="javascript",t.json="json",t);e.s(["CodeLanguage",()=>r])},381086,e=>{"use strict";var t,r=((t={}).none="none",t.failBranch="fail-branch",t.defaultValue="default-value",t);e.s(["ErrorHandleTypeEnum",()=>r])},410893,e=>{"use strict";var t=e.i(797181);e.s(["ArrowUpRight",()=>t.default])},389600,e=>{"use strict";var t=e.i(498664);e.s(["Copy",()=>t.default])},394895,e=>{"use strict";var t=e.i(563199),r=e.i(837699),a=e.i(268255),i=e.i(654313),s=e.i(391185),l=e.i(935139);e.s(["default",0,e=>{let{items:n,onSelect:o,secondItems:u,renderTrigger:d,triggerProps:c,popupClassName:p,itemClassName:h,secondItemClassName:f}=e,[m,g]=(0,a.useState)(!1),x=e=>{g(!1),o(e)};return(0,t.jsxs)(s.PortalToFollowElem,{open:m,onOpenChange:g,placement:"bottom-end",children:[(0,t.jsx)(s.PortalToFollowElemTrigger,{onClick:()=>g(e=>!e),children:d?d(m):(0,t.jsx)(i.default,{...c,className:(0,l.cn)(m&&"bg-divider-regular",c?.className),children:(0,t.jsx)(r.RiMoreFill,{className:"h-4 w-4 text-text-tertiary"})})}),(0,t.jsx)(s.PortalToFollowElemContent,{className:p,children:(0,t.jsxs)("div",{className:"rounded-lg border-[0.5px] border-components-panel-border bg-components-panel-bg text-sm text-text-secondary shadow-lg",children:[!!n.length&&(0,t.jsx)("div",{className:"p-1",children:n.map(e=>(0,t.jsx)("div",{className:(0,l.cn)("flex h-8 cursor-pointer items-center rounded-lg px-3 hover:bg-components-panel-on-panel-item-bg-hover",h),onClick:()=>x(e),children:e.text},e.value))}),!!n.length&&!!u?.length&&(0,t.jsx)("div",{className:"h-px bg-divider-regular"}),!!u?.length&&(0,t.jsx)("div",{className:"p-1",children:u.map(e=>(0,t.jsx)("div",{className:(0,l.cn)("flex h-8 cursor-pointer items-center rounded-lg px-3 hover:bg-components-panel-on-panel-item-bg-hover",f),onClick:()=>x(e),children:e.text},e.value))})]})})]})}])},670977,e=>{"use strict";var t=e.i(479147);e.s(["ArrowDownRoundFill",()=>t.default])},149086,289751,219830,e=>{"use strict";var t,r=e.i(824627),a=e.i(268255),i=e.i(295978),s=e.i(773923),l=e.i(703440);let n=function(e){l.default&&!(0,s.isFunction)(e)&&console.error("useMemoizedFn expected parameter is a function, got ".concat(typeof e));var t=(0,a.useRef)(e);t.current=(0,a.useMemo)(function(){return e},[e]);var r=(0,a.useRef)(void 0);return r.current||(r.current=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.current.apply(this,e)}),r.current};e.s(["default",0,n],289751);let o=(t=a.useEffect,function(e,r){var i=(0,a.useRef)(!1);t(function(){return function(){i.current=!1}},[]),t(function(){if(i.current)return e();i.current=!0},r)});e.s(["default",0,o],219830);var u="AHOOKS_SYNC_STORAGE_EVENT_NAME";function d(e){return function(t,l){void 0===l&&(l={});var d,c=l.listenStorageChange,p=void 0!==c&&c,h=l.onError,f=void 0===h?function(e){console.error(e)}:h;try{d=e()}catch(e){f(e)}function m(){try{var e=null==d?void 0:d.getItem(t);if(e)return l.deserializer?l.deserializer(e):JSON.parse(e)}catch(e){f(e)}return(0,s.isFunction)(l.defaultValue)?l.defaultValue():l.defaultValue}var g=(0,r.__read)((0,a.useState)(m),2),x=g[0],v=g[1];o(function(){v(m())},[t]);var b=function(e){e.key===t&&e.storageArea===d&&v(m())};return(0,i.default)("storage",b,{enable:p}),(0,i.default)(u,function(e){b(e.detail)},{enable:p}),[x,n(function(e){var r=(0,s.isFunction)(e)?e(x):e;p||v(r);try{var a=void 0,i=null==d?void 0:d.getItem(t);(0,s.isUndef)(r)?(a=null,null==d||d.removeItem(t)):(a=l.serializer?l.serializer(r):JSON.stringify(r),null==d||d.setItem(t,a)),dispatchEvent(new CustomEvent(u,{detail:{key:t,newValue:a,oldValue:i,storageArea:d}}))}catch(e){f(e)}})]}}e.s(["createUseStorageState",()=>d],149086)},511334,e=>{"use strict";function t(){return(t=Object.assign.bind()).apply(null,arguments)}e.s(["default",()=>t])},318680,e=>{"use strict";function t(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}e.s(["default",()=>t])},765673,e=>{"use strict";var t=e.i(511334),r=e.i(318680),a=e.i(268255),i=a.useLayoutEffect,s=function(e){var t=a.default.useRef(e);return i(function(){t.current=e}),t},l=function(e,t){"function"==typeof e?e(t):e.current=t},n=function(e,t){var r=a.default.useRef();return a.default.useCallback(function(a){e.current=a,r.current&&l(r.current,null),r.current=t,t&&l(t,a)},[t])},o={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},u=function(e){Object.keys(o).forEach(function(t){e.style.setProperty(t,o[t],"important")})},d=null,c=function(e,t){var r=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?r+t.borderSize:r-t.paddingSize},p=function(){},h=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],f=!!document.documentElement.currentStyle,m=function(e){var t=window.getComputedStyle(e);if(null===t)return null;var r=h.reduce(function(e,r){return e[r]=t[r],e},{}),a=r.boxSizing;if(""===a)return null;f&&"border-box"===a&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px");var i=parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),s=parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth);return{sizingStyle:r,paddingSize:i,borderSize:s}};function g(e,t,r){var i=s(r);a.useLayoutEffect(function(){var r=function(e){return i.current(e)};if(e)return e.addEventListener(t,r),function(){return e.removeEventListener(t,r)}},[])}var x=function(e,t){g(document.body,"reset",function(r){e.current.form===r.target&&t(r)})},v=function(e){g(window,"resize",e)},b=function(e){g(document.fonts,"loadingdone",e)},y=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],j=a.forwardRef(function(e,i){var s=e.cacheMeasurements,l=e.maxRows,o=e.minRows,h=e.onChange,f=void 0===h?p:h,g=e.onHeightChange,j=void 0===g?p:g,w=(0,r.default)(e,y),_=void 0!==w.value,S=a.useRef(null),C=n(S,i),T=a.useRef(0),N=a.useRef(),F=function(){var e=S.current,t=s&&N.current?N.current:m(e);if(t){N.current=t;var r,a,i,n,p,h,f,g,x,v,b,y=(r=e.value||e.placeholder||"x",void 0===(a=o)&&(a=1),void 0===(i=l)&&(i=1/0),d||((d=document.createElement("textarea")).setAttribute("tabindex","-1"),d.setAttribute("aria-hidden","true"),u(d)),null===d.parentNode&&document.body.appendChild(d),n=t.paddingSize,p=t.borderSize,f=(h=t.sizingStyle).boxSizing,Object.keys(h).forEach(function(e){d.style[e]=h[e]}),u(d),d.value=r,g=c(d,t),d.value=r,g=c(d,t),d.value="x",v=(x=d.scrollHeight-n)*a,"border-box"===f&&(v=v+n+p),g=Math.max(v,g),b=x*i,"border-box"===f&&(b=b+n+p),[g=Math.min(b,g),x]),w=y[0],_=y[1];T.current!==w&&(T.current=w,e.style.setProperty("height",w+"px","important"),j(w,{rowHeight:_}))}};return a.useLayoutEffect(F),x(S,function(){if(!_){var e=S.current.value;requestAnimationFrame(function(){var t=S.current;t&&e!==t.value&&F()})}}),v(F),b(F),a.createElement("textarea",(0,t.default)({},w,{onChange:function(e){_||F(),f(e)},ref:C}))});e.s(["default",()=>j],765673)},910605,e=>{"use strict";var t=e.i(27808);e.s(["FileUploaderInAttachmentWrapper",()=>t.default])},501912,449435,e=>{"use strict";var t=e.i(223751);e.s(["Link03",()=>t.default],501912);var r=e.i(563199),a=e.i(268255);e.i(152567);var i=e.i(408767),s=e.i(151094),l=e.i(648404);let n=/^(https?|ftp):\/\//;e.s(["default",0,e=>{let{onUpload:t,disabled:o}=e,{t:u}=(0,i.useTranslation)(),[d,c]=(0,a.useState)("");return(0,r.jsxs)("div",{className:"flex h-8 items-center rounded-lg border border-components-panel-border bg-components-panel-bg pl-1.5 pr-1 shadow-xs",children:[(0,r.jsx)("input",{type:"text",className:"mr-0.5 h-[18px] grow appearance-none bg-transparent px-1 text-[13px] text-text-primary outline-none",value:d,onChange:e=>c(e.target.value),placeholder:u("imageUploader.pasteImageLinkInputPlaceholder",{ns:"common"})||""}),(0,r.jsx)(s.default,{variant:"primary",size:"small",disabled:!d||o,onClick:()=>{o||t({type:l.TransferMethod.remote_url,_id:`${Date.now()}`,fileId:"",progress:n.test(d)?0:-1,url:d})},children:u("operation.ok",{ns:"common"})})]})}],449435)},538883,e=>{"use strict";var t=e.i(780887);e.s(["RefreshCcw01",()=>t.default])},189107,e=>{"use strict";var t=e.i(563199),r=e.i(268255);e.i(152567);var a=e.i(408767);e.i(47690);var i=e.i(501912);e.i(644896);var s=e.i(541983),l=e.i(391185),n=e.i(648404),o=e.i(330276),u=e.i(449435),d=e.i(837699);e.i(668763);var c=e.i(538883);e.i(793622);var p=e.i(259509),h=e.i(998020),f=e.i(421001),m=e.i(935139);let g=e=>{let{list:i,readonly:s,onRemove:l,onReUpload:o,onImageLinkLoadSuccess:u,onImageLinkLoadError:g}=e,{t:x}=(0,a.useTranslation)(),[v,b]=(0,r.useState)("");return(0,t.jsxs)("div",{className:"flex flex-wrap",children:[i.map(e=>(0,t.jsxs)("div",{className:"group relative mr-1 rounded-lg border-[0.5px] border-black/5",children:[e.type===n.TransferMethod.local_file&&100!==e.progress&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"absolute inset-0 z-[1] flex items-center justify-center bg-black/30",style:{left:e.progress>-1?`${e.progress}%`:0},children:-1===e.progress&&(0,t.jsx)(c.RefreshCcw01,{className:"h-5 w-5 text-white",onClick:()=>o?.(e._id)})}),e.progress>-1&&(0,t.jsxs)("span",{className:"absolute left-[50%] top-[50%] z-[1] translate-x-[-50%] translate-y-[-50%] text-sm text-white mix-blend-lighten",children:[e.progress,"%"]})]}),e.type===n.TransferMethod.remote_url&&100!==e.progress&&(0,t.jsxs)("div",{className:`
                  absolute inset-0 z-[1] flex items-center justify-center rounded-lg border
                  ${-1===e.progress?"border-[#DC6803] bg-[#FEF0C7]":"border-transparent bg-black/[0.16]"}
                `,children:[e.progress>-1&&(0,t.jsx)(d.RiLoader2Line,{className:"h-5 w-5 animate-spin text-white"}),-1===e.progress&&(0,t.jsx)(f.default,{popupContent:x("imageUploader.pasteImageLinkInvalid",{ns:"common"}),children:(0,t.jsx)(p.AlertTriangle,{className:"h-4 w-4 text-[#DC6803]"})})]}),(0,t.jsx)("img",{className:"h-16 w-16 cursor-pointer rounded-lg border-[0.5px] border-black/5 object-cover",alt:e.file?.name,onLoad:()=>{e.type===n.TransferMethod.remote_url&&u&&-1!==e.progress&&u(e._id)},onError:()=>{e.type===n.TransferMethod.remote_url&&g&&g(e._id)},src:e.type===n.TransferMethod.remote_url?e.url:e.base64Url,onClick:()=>100===e.progress&&b(e.type===n.TransferMethod.remote_url?e.url:e.base64Url)}),!s&&(0,t.jsx)("button",{type:"button",className:(0,m.cn)("absolute -right-[9px] -top-[9px] z-10 h-[18px] w-[18px] items-center justify-center","rounded-2xl shadow-lg hover:bg-state-base-hover",-1===e.progress?"flex":"hidden group-hover:flex"),onClick:()=>l?.(e._id),children:(0,t.jsx)(d.RiCloseLine,{className:"h-3 w-3 text-text-tertiary"})})]},e._id)),v&&(0,t.jsx)(h.default,{url:v,onCancel:()=>b(""),title:""})]})},x=e=>{let{children:a,onUpload:i,closePopover:s,limit:l,disabled:u}=e,[d,c]=(0,r.useState)(!1),{handleLocalFileUpload:p}=(0,o.useLocalFileUploader)({limit:l,onUpload:i,disabled:u});return(0,t.jsxs)("div",{className:"relative",onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:[a(d),(0,t.jsx)("input",{className:"absolute inset-0 block w-full cursor-pointer text-[0] opacity-0 disabled:cursor-not-allowed",onClick:e=>e.target.value="",type:"file",accept:n.ALLOW_FILE_EXTENSIONS.map(e=>`.${e}`).join(","),onChange:e=>{let t=e.target.files?.[0];t&&(p(t),s?.())},disabled:u})]})},v=e=>{let{onUpload:s,disabled:n}=e,{t:o}=(0,a.useTranslation)(),[d,c]=(0,r.useState)(!1);return(0,t.jsxs)(l.PortalToFollowElem,{open:d,onOpenChange:c,placement:"top-start",children:[(0,t.jsx)(l.PortalToFollowElemTrigger,{onClick:()=>{n||c(e=>!e)},children:(0,t.jsxs)("div",{className:`
          relative flex h-8 items-center justify-center rounded-lg bg-components-button-tertiary-bg px-3 text-xs text-text-tertiary hover:bg-components-button-tertiary-bg-hover
          ${n?"cursor-not-allowed":"cursor-pointer"}
        `,children:[(0,t.jsx)(i.Link03,{className:"mr-2 h-4 w-4"}),o("imageUploader.pasteImageLink",{ns:"common"})]})}),(0,t.jsx)(l.PortalToFollowElemContent,{className:"z-10",children:(0,t.jsx)("div",{className:"w-[320px] rounded-lg border-[0.5px] border-components-panel-border bg-components-panel-bg p-2 shadow-lg",children:(0,t.jsx)(u.default,{onUpload:e=>{c(!1),s(e)}})})})]})};e.s(["default",0,e=>{let{settings:i,onFilesChange:l,disabled:u}=e,{t:d}=(0,a.useTranslation)(),{files:c,onUpload:p,onRemove:h,onImageLinkLoadError:f,onImageLinkLoadSuccess:m,onReUpload:b}=(0,o.useImageFiles)();(0,r.useEffect)(()=>{l(c)},[c]);let y=(0,t.jsx)(x,{onUpload:p,disabled:c.length>=i.number_limits||u,limit:+i.image_file_size_limit,children:e=>(0,t.jsxs)("div",{className:`
            flex h-8 cursor-pointer items-center justify-center rounded-lg
            bg-components-button-tertiary-bg px-3 text-xs text-text-tertiary
            ${e&&"hover:bg-components-button-tertiary-bg-hover"}
          `,children:[(0,t.jsx)(s.ImagePlus,{className:"mr-2 h-4 w-4"}),d("imageUploader.uploadFromComputer",{ns:"common"})]})}),j=(0,t.jsx)(v,{onUpload:p,disabled:c.length>=i.number_limits||u});return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1",children:(0,t.jsx)(g,{list:c,onRemove:h,onReUpload:b,onImageLinkLoadError:f,onImageLinkLoadSuccess:m})}),(0,t.jsx)("div",{className:`grid gap-1 ${2===i.transfer_methods.length?"grid-cols-2":"grid-cols-1"}`,children:i.transfer_methods.map(e=>e===n.TransferMethod.local_file?(0,t.jsx)(r.Fragment,{children:y},n.TransferMethod.local_file):e===n.TransferMethod.remote_url?(0,t.jsx)(r.Fragment,{children:j},n.TransferMethod.remote_url):null)})]})}],189107)},371784,e=>{"use strict";var t=e.i(563199),r=e.i(268255);e.i(152567);var a=e.i(408767),i=e.i(324935);let s=r.memo(e=>{let{value:s,onChange:l,name:n,required:o,readonly:u}=e,{t:d}=(0,a.useTranslation)(),c=(0,r.useCallback)(()=>{l(!s)},[s,l]);return(0,t.jsxs)("div",{className:"flex h-6 items-center gap-2",children:[(0,t.jsx)(i.default,{className:"!h-4 !w-4",checked:!!s,onCheck:c,disabled:u}),(0,t.jsxs)("div",{className:"system-sm-medium flex items-center gap-1 text-text-secondary",children:[n,!o&&(0,t.jsx)("span",{className:"system-xs-regular text-text-tertiary",children:d("panel.optional",{ns:"workflow"})})]})]})});e.s(["default",0,s])},841054,e=>{"use strict";var t=e.i(268255),r=e.i(773923),a=e.i(703440);e.s(["default",0,function(e){a.default&&!(0,r.isFunction)(e)&&console.error('useMount: parameter `fn` expected to be a function, but got "'.concat(typeof e,'".')),(0,t.useEffect)(function(){var t=null==e?void 0:e();if(!t||"object"!=typeof t||"function"!=typeof t.then)return t},[])}])},285923,e=>{"use strict";var t=e.i(563199),r=e.i(837699),a=e.i(105845),i=e.i(268255);e.i(152567);var s=e.i(408767);e.i(237855);var l=e.i(910605);e.i(432024);var n=e.i(112757);e.i(42241);var o=e.i(226577);e.i(39598);var u=e.i(678383),d=e.i(189107),c=e.i(291631),p=e.i(471981),h=e.i(299951),f=e.i(873517),m=e.i(120219);e.i(491401);var g=e.i(585736),x=e.i(648404),v=e.i(935139),b=e.i(390622),y=e.i(955371),j=e.i(481162),w=e.i(417944),_=e.i(479419);let S=i.memo(e=>{let{value:r,onChange:a,title:s,headerRight:l,minHeight:n,onBlur:o,placeholder:u,readonly:d,isInNode:c}=e,[p,{setTrue:h,setFalse:f}]=(0,w.useBoolean)(!1),m=(0,i.useCallback)(()=>{f(),o?.()},[f,o]);return(0,t.jsx)("div",{children:(0,t.jsx)(_.default,{title:s,value:r,headerRight:l,isFocus:p,minHeight:n,isInNode:c,children:(0,t.jsx)("textarea",{value:r,onChange:e=>a(e.target.value),onFocus:h,onBlur:m,className:"h-full w-full resize-none border-none bg-transparent px-3 text-[13px] font-normal leading-[18px] text-gray-900 placeholder:text-gray-300 focus:outline-none",placeholder:u,readOnly:d})})})});var C=e.i(371784);let T=i.memo(e=>{let{payload:w,value:_,onChange:T,className:N,autoFocus:F,inStepRun:k=!1}=e,{t:E}=(0,s.useTranslation)(),{type:L}=w,I=(0,g.useHooksStore)(e=>e.configsMap?.fileSettings),R=i.useMemo(()=>{let e=w?.json_schema;return e?"string"==typeof e?e:JSON.stringify(e,null,2):""},[w]),M=(0,i.useCallback)(e=>t=>{T((0,a.produce)(_,r=>{r[e]=t}))},[_,T]),A=(0,i.useCallback)(e=>()=>{T((0,a.produce)(_,t=>{t.splice(e,1)}))},[_,T]),B=(()=>{if("object"==typeof w.label){let{nodeType:e,nodeName:r,variable:a,isChatVar:i}=w.label;return(0,t.jsxs)("div",{className:"flex h-full items-center",children:[!i&&(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-[1px]",children:(0,t.jsx)(m.VarBlockIcon,{type:e||b.BlockEnum.Start})}),(0,t.jsx)("div",{className:"mx-0.5 max-w-[150px] truncate text-xs font-medium text-gray-700",title:r,children:r}),(0,t.jsx)(n.Line3,{className:"mr-0.5"})]}),(0,t.jsxs)("div",{className:"flex items-center text-primary-600",children:[!i&&(0,t.jsx)(u.Variable02,{className:"h-3.5 w-3.5"}),i&&(0,t.jsx)(o.BubbleX,{className:"h-3.5 w-3.5 text-util-colors-teal-teal-700"}),(0,t.jsx)("div",{className:(0,v.cn)("ml-0.5 max-w-[150px] truncate text-xs font-medium",i&&"text-text-secondary"),title:a,children:a})]})]})}return""})(),U=L===b.InputVarType.checkbox,P=[b.InputVarType.contexts,b.InputVarType.iterator].includes(L),O=L===b.InputVarType.contexts,z=L===b.InputVarType.iterator,V=z&&w.isFileItem,W=(0,i.useMemo)(()=>"#files#"===w.variable?_?.[0]||[]:_?[_]:[],[w.variable,_]),D=(0,i.useCallback)(e=>{"#files#"===w.variable?T(e):e.length?T(e[0]):T(null)},[T,w.variable]);return(0,t.jsxs)("div",{className:(0,v.cn)(N),children:[!P&&!U&&(0,t.jsxs)("div",{className:"system-sm-semibold mb-1 flex h-6 items-center gap-1 text-text-secondary",children:[(0,t.jsx)("div",{className:"truncate",children:"object"==typeof w.label?B:w.label}),!0===w.hide?(0,t.jsx)("span",{className:"system-xs-regular text-text-tertiary",children:E("panel.optional_and_hidden",{ns:"workflow"})}):!w.required&&(0,t.jsx)("span",{className:"system-xs-regular text-text-tertiary",children:E("panel.optional",{ns:"workflow"})})]}),(0,t.jsxs)("div",{className:"grow",children:[L===b.InputVarType.textInput&&(0,t.jsx)(c.default,{value:_||"",onChange:e=>T(e.target.value),placeholder:"object"==typeof w.label?w.label.variable:w.label,autoFocus:F}),L===b.InputVarType.number&&(0,t.jsx)(c.default,{type:"number",value:_||"",onChange:e=>T(e.target.value),placeholder:"object"==typeof w.label?w.label.variable:w.label,autoFocus:F}),L===b.InputVarType.paragraph&&(0,t.jsx)(f.default,{value:_||"",onChange:e=>T(e.target.value),placeholder:"object"==typeof w.label?w.label.variable:w.label,autoFocus:F}),L===b.InputVarType.select&&(0,t.jsx)(h.default,{className:"w-full",defaultValue:_||w.default||"",items:w.options?.map(e=>({name:e,value:e}))||[],onSelect:e=>T(e.value),allowSearch:!1}),U&&(0,t.jsx)(C.default,{name:w.label,value:!!_,required:w.required,onChange:T}),L===b.InputVarType.json&&(0,t.jsx)(j.default,{value:_,title:(0,t.jsx)("span",{children:"JSON"}),language:y.CodeLanguage.json,onChange:T}),L===b.InputVarType.jsonObject&&(0,t.jsx)(j.default,{value:_,language:y.CodeLanguage.json,onChange:T,noWrapper:!0,className:"bg h-[80px] overflow-y-auto rounded-[10px] bg-components-input-bg-normal p-1",placeholder:(0,t.jsx)("div",{className:"whitespace-pre",children:R})}),L===b.InputVarType.singleFile&&(0,t.jsx)(l.FileUploaderInAttachmentWrapper,{value:W,onChange:D,fileConfig:{allowed_file_types:k&&(!w.allowed_file_types||0===w.allowed_file_types.length)?[b.SupportUploadFileTypes.image,b.SupportUploadFileTypes.document,b.SupportUploadFileTypes.audio,b.SupportUploadFileTypes.video]:w.allowed_file_types,allowed_file_extensions:k&&(!w.allowed_file_extensions||0===w.allowed_file_extensions.length)?[...p.FILE_EXTS[b.SupportUploadFileTypes.image],...p.FILE_EXTS[b.SupportUploadFileTypes.document],...p.FILE_EXTS[b.SupportUploadFileTypes.audio],...p.FILE_EXTS[b.SupportUploadFileTypes.video]]:w.allowed_file_extensions,allowed_file_upload_methods:k?[x.TransferMethod.local_file,x.TransferMethod.remote_url]:w.allowed_file_upload_methods,number_limits:1,fileUploadConfig:I?.fileUploadConfig}}),(L===b.InputVarType.multiFiles||V)&&(0,t.jsx)(l.FileUploaderInAttachmentWrapper,{value:_,onChange:e=>T(e),fileConfig:{allowed_file_types:(k||V)&&(!w.allowed_file_types||0===w.allowed_file_types.length)?[b.SupportUploadFileTypes.image,b.SupportUploadFileTypes.document,b.SupportUploadFileTypes.audio,b.SupportUploadFileTypes.video]:w.allowed_file_types,allowed_file_extensions:(k||V)&&(!w.allowed_file_extensions||0===w.allowed_file_extensions.length)?[...p.FILE_EXTS[b.SupportUploadFileTypes.image],...p.FILE_EXTS[b.SupportUploadFileTypes.document],...p.FILE_EXTS[b.SupportUploadFileTypes.audio],...p.FILE_EXTS[b.SupportUploadFileTypes.video]]:w.allowed_file_extensions,allowed_file_upload_methods:k||V?[x.TransferMethod.local_file,x.TransferMethod.remote_url]:w.allowed_file_upload_methods,number_limits:k||V?5:w.max_length,fileUploadConfig:I?.fileUploadConfig}}),L===b.InputVarType.files&&(0,t.jsx)(d.default,{settings:{...I,detail:I?.image?.detail||x.Resolution.high,transfer_methods:I?.allowed_file_upload_methods||[]},onFilesChange:e=>T(e.filter(e=>-1!==e.progress).map(e=>({type:"image",transfer_method:e.type,url:e.url,upload_file_id:e.fileId})))}),O&&(0,t.jsx)("div",{className:"space-y-2",children:(_||[]).map((e,a)=>(0,t.jsx)(j.default,{value:e,title:(0,t.jsx)("span",{children:"JSON"}),headerRight:_.length>1?(0,t.jsx)(r.RiDeleteBinLine,{onClick:A(a),className:"mr-1 h-3.5 w-3.5 cursor-pointer text-text-tertiary"}):void 0,language:y.CodeLanguage.json,onChange:M(a)},a))}),z&&!V&&(0,t.jsx)("div",{className:"space-y-2",children:(_||[]).map((e,a)=>(0,t.jsx)(S,{isInNode:!0,value:e,title:(0,t.jsxs)("span",{children:[E("variableConfig.content",{ns:"appDebug"})," ",a+1," "]}),onChange:M(a),headerRight:_.length>1?(0,t.jsx)(r.RiDeleteBinLine,{onClick:A(a),className:"mr-1 h-3.5 w-3.5 cursor-pointer text-text-tertiary"}):void 0},a))})]})]})});e.s(["default",0,T],285923)},194095,443523,e=>{"use strict";var t,r,a=e.i(268255);e.s(["useResizePanel",0,e=>{let{direction:t="both",triggerDirection:r="bottom-right",minWidth:i=-1/0,maxWidth:s=1/0,minHeight:l=-1/0,maxHeight:n=1/0,onResized:o,onResize:u}=e||{},d=(0,a.useRef)(null),c=(0,a.useRef)(null),p=(0,a.useRef)(0),h=(0,a.useRef)(0),f=(0,a.useRef)(0),m=(0,a.useRef)(0),g=(0,a.useRef)(!1),[x,v]=(0,a.useState)(()=>getComputedStyle(document.body).userSelect),b=(0,a.useCallback)(e=>{p.current=e.clientX,h.current=e.clientY,f.current=c.current?.offsetWidth||i,m.current=c.current?.offsetHeight||l,g.current=!0,v(getComputedStyle(document.body).userSelect),document.body.style.userSelect="none"},[i,l]),y=(0,a.useCallback)(e=>{if(g.current&&c.current){if("horizontal"===t||"both"===t){let t=e.clientX-p.current,a=0;"left"===r||"top-left"===r||"bottom-left"===r?a=f.current-t:("right"===r||"top-right"===r||"bottom-right"===r)&&(a=f.current+t),a<i&&(a=i),a>s&&(a=s),c.current.style.width=`${a}px`,u?.(a,0)}if("vertical"===t||"both"===t){let t=e.clientY-h.current,a=0;"top"===r||"top-left"===r||"top-right"===r?a=m.current-t:("bottom"===r||"bottom-left"===r||"bottom-right"===r)&&(a=m.current+t),a<l&&(a=l),a>n&&(a=n),c.current.style.height=`${a}px`,u?.(0,a)}}},[t,r,i,s,l,n,u]),j=(0,a.useCallback)(()=>{g.current=!1,document.body.style.userSelect=x,o&&c.current&&o(c.current.offsetWidth,c.current.offsetHeight)},[x,o]);return(0,a.useEffect)(()=>{let e=d.current;return e?.addEventListener("mousedown",b),document.addEventListener("mousemove",y),document.addEventListener("mouseup",j),()=>{e&&e.removeEventListener("mousedown",b),document.removeEventListener("mousemove",y)}},[b,y,j]),{triggerRef:d,containerRef:c}}],194095);var i=((t={}).Code="code",t.Preview="preview",t),s=((r={}).Markdown="markdown",r.Chunks="chunks",r);e.s(["CHUNK_SCHEMA_TYPES",0,["general_structure","parent_child_structure","qa_structure"],"EVENT_WORKFLOW_STOP",0,"WORKFLOW_STOP","PreviewType",()=>s,"ViewMode",()=>i],443523)}]);