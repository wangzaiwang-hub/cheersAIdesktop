(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,807801,e=>{"use strict";var t=e.i(367916);e.s(["bindTag",0,(e,a,s)=>(0,t.post)("/tag-bindings/create",{body:{tag_ids:e,target_id:a,type:s}}),"createTag",0,(e,a)=>(0,t.post)("/tags",{body:{name:e,type:a}}),"deleteTag",0,e=>(0,t.del)(`/tags/${e}`),"fetchTagList",0,e=>(0,t.get)("/tags",{params:{type:e}}),"unBindTag",0,(e,a,s)=>(0,t.post)("/tag-bindings/remove",{body:{tag_id:e,target_id:a,type:s}}),"updateTag",0,(e,a)=>(0,t.patch)(`/tags/${e}`,{body:{name:a}})])},933620,e=>{"use strict";var t=e.i(563199),a=e.i(837699),s=e.i(268255);e.i(152567);var n=e.i(408767),r=e.i(339548),i=e.i(21151),o=e.i(137667),d=e.i(807801),c=e.i(364203),l=e.i(38532),m=e.i(547105),u=e.i(421001),g=e.i(935139);let p=e=>{let{tag:i}=e,{t:p}=(0,n.useTranslation)(),{notify:x}=(0,r.useContext)(o.ToastContext),h=(0,c.useStore)(e=>e.tagList),y=(0,c.useStore)(e=>e.setTagList),[f,v]=(0,s.useState)(!1),[b,T]=(0,s.useState)(i.name),j=async(e,t)=>{if(t===i.name)return void v(!1);if(!t){x({type:"error",message:"tag name is empty"}),T(i.name),v(!1);return}try{let a=h.map(a=>a.id===e?{...a,name:t}:a);y([...a]),v(!1),await (0,d.updateTag)(e,t),x({type:"success",message:p("actionMsg.modifiedSuccessfully",{ns:"common"})}),T(t)}catch{x({type:"error",message:p("actionMsg.modifiedUnsuccessfully",{ns:"common"})}),T(i.name),y([...h.map(t=>t.id===e?{...t,name:t.name}:t)]),v(!1)}},[w,C]=(0,s.useState)(!1),[S,N]=(0,s.useState)(!1),k=async e=>{if(!S)try{N(!0),await (0,d.deleteTag)(e),x({type:"success",message:p("actionMsg.modifiedSuccessfully",{ns:"common"})});let t=h.filter(t=>t.id!==e);y([...t]),N(!1)}catch{x({type:"error",message:p("actionMsg.modifiedUnsuccessfully",{ns:"common"})}),N(!1)}},{run:L}=(0,l.useDebounceFn)(()=>{k(i.id)},{wait:200});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:(0,g.cn)("flex shrink-0 items-center gap-0.5 rounded-lg border border-components-panel-border py-1 pl-2 pr-1 text-sm leading-5 text-text-secondary"),children:[!f&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"text-sm leading-5 text-text-secondary",children:i.name}),(0,t.jsx)(u.default,{popupContent:(0,t.jsx)("div",{children:p("common.tagBound",{ns:"workflow"})}),needsDelay:!0,children:(0,t.jsx)("div",{className:"leading-4.5 shrink-0 px-1 text-sm font-medium text-text-tertiary",children:i.binding_count})}),(0,t.jsx)("div",{className:"group/edit shrink-0 cursor-pointer rounded-md p-1 hover:bg-state-base-hover",onClick:()=>v(!0),children:(0,t.jsx)(a.RiEditLine,{className:"h-3 w-3 text-text-tertiary group-hover/edit:text-text-secondary"})}),(0,t.jsx)("div",{className:"group/remove shrink-0 cursor-pointer rounded-md p-1 hover:bg-state-base-hover",onClick:()=>{i.binding_count?C(!0):L()},children:(0,t.jsx)(a.RiDeleteBinLine,{className:"h-3 w-3 text-text-tertiary group-hover/remove:text-text-secondary"})})]}),f&&(0,t.jsx)("input",{className:"shrink-0 appearance-none caret-primary-600 outline-none placeholder:text-text-quaternary",autoFocus:!0,value:b,onChange:e=>T(e.target.value),onKeyDown:e=>"Enter"===e.key&&j(i.id,b),onBlur:()=>j(i.id,b)})]}),(0,t.jsx)(m.default,{title:`${p("tag.delete",{ns:"common"})} "${i.name}"`,isShow:w,content:p("tag.deleteTip",{ns:"common"}),onConfirm:()=>{L(),C(!1)},onCancel:()=>C(!1)})]})};e.s(["default",0,e=>{let{show:l,type:m}=e,{t:u}=(0,n.useTranslation)(),{notify:g}=(0,r.useContext)(o.ToastContext),x=(0,c.useStore)(e=>e.tagList),h=(0,c.useStore)(e=>e.setTagList),y=(0,c.useStore)(e=>e.setShowTagManagementModal),f=async e=>{h(await (0,d.fetchTagList)(e))},[v,b]=(0,s.useState)(!1),[T,j]=(0,s.useState)(""),w=async()=>{if(T&&!v)try{b(!0);let e=await (0,d.createTag)(T,m);g({type:"success",message:u("tag.created",{ns:"common"})}),h([e,...x]),j(""),b(!1)}catch{g({type:"error",message:u("tag.failed",{ns:"common"})}),b(!1)}};return(0,s.useEffect)(()=>{f(m)},[m]),(0,t.jsxs)(i.default,{className:"!w-[600px] !max-w-[600px] rounded-xl px-8 py-6",isShow:l,onClose:()=>y(!1),children:[(0,t.jsx)("div",{className:"relative pb-2 text-xl font-semibold leading-[30px] text-text-primary",children:u("tag.manageTags",{ns:"common"})}),(0,t.jsx)("div",{className:"absolute right-4 top-4 cursor-pointer p-2",onClick:()=>y(!1),children:(0,t.jsx)(a.RiCloseLine,{className:"h-4 w-4 text-text-tertiary"})}),(0,t.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[(0,t.jsx)("input",{className:"w-[100px] shrink-0 appearance-none rounded-lg border border-dashed border-divider-regular bg-transparent px-2 py-1 text-sm leading-5 text-text-secondary caret-primary-600  outline-none placeholder:text-text-quaternary focus:border-solid",placeholder:u("tag.addNew",{ns:"common"})||"",autoFocus:!0,value:T,onChange:e=>j(e.target.value),onKeyDown:e=>"Enter"===e.key&&!e.nativeEvent.isComposing&&w(),onBlur:w}),x.map(e=>(0,t.jsx)(p,{tag:e},e.id))]})]})}],933620)},903565,e=>{e.n(e.i(933620))}]);