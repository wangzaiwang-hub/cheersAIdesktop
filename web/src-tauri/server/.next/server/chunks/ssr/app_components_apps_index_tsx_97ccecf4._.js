module.exports=[148402,a=>{"use strict";var b=a.i(608061),c=a.i(57843);a.i(752298);var d=a.i(693025),e=a.i(596078),f=a.i(750016),g=a.i(280342),h=a.i(374734),i=a.i(343837),j=a.i(808216),k=a.i(104383),l=a.i(73781),m=a.i(116507),n=a.i(429150),o=a.i(981133),p=a.i(860653),q=a.i(533306),r=a.i(666115),s=a.i(816134),t=a.i(14669),u=a.i(162962),v=a.i(302547),w=a.i(664358),x=a.i(18039),y=a.i(705134),z=a.i(724423),A=a.i(42550),B=a.i(763539);let C=()=>{let a=(0,q.useRouter)(),{t:e}=(0,d.useTranslation)(),[f,g]=(0,c.useState)(!0),h=(()=>{let{t:a}=(0,d.useTranslation)(),[b,e]=(0,c.useState)(null),f=(0,q.useSearchParams)(),g=f.get("provider_name"),h=f.get("payment_result");return(0,c.useEffect)(()=>{"anthropic"===g&&("succeeded"===h||"cancelled"===h)&&e({type:"succeeded"===h?"info":"warning",title:"succeeded"===h?a("actionMsg.paySucceeded",{ns:"common"}):a("actionMsg.payCancelled",{ns:"common"})})},[g,h,a]),b})(),i=(()=>{let a=(0,q.useRouter)(),[b,d]=(0,c.useState)(null),[e,f]=(0,c.useState)(!1),g=(0,q.useSearchParams)(),h=g.get("type"),i=g.get("code"),j=g.get("error"),{data:k}=(0,B.useNotionBinding)(i,e);return(0,c.useEffect)(()=>{k&&a.replace("/")},[k,a]),(0,c.useEffect)(()=>{"notion"===h&&(j?d({type:"warning",title:j}):i&&f(!0))},[h,i,j]),b})(),j=(()=>{let{t:a}=(0,d.useTranslation)(),[b,e]=(0,c.useState)(null),f=(0,q.useSearchParams)(),g=f.get("payment_type"),h=f.get("payment_result");return(0,c.useEffect)(()=>{"billing"===g&&("succeeded"===h||"cancelled"===h)&&e({type:"succeeded"===h?"info":"warning",title:"succeeded"===h?a("actionMsg.paySucceeded",{ns:"common"}):a("actionMsg.payCancelled",{ns:"common"})})},[g,h,a]),b})(),k=(0,c.useCallback)(()=>{g(!1),a.replace("/")},[a]),l=h||i||j;return l&&f?(0,b.jsx)(A.default,{isShow:!0,onCancel:k,onConfirm:k,showCancel:!1,type:"info"===l.type?"info":"warning",title:l.title,content:l.desc||"",confirmText:"info"===l.type&&e("operation.ok",{ns:"common"})||""}):null};var D=a.i(926261),E=a.i(954200),F=a.i(527344),G=a.i(639378),H=a.i(272510),I=a.i(355968),J=a.i(757801),K=a.i(234782),L=a.i(742929),M=a.i(114715),N=a.i(483664),O=a.i(375616),P=a.i(87208),Q=a.i(179062),R=a.i(190124),S=a.i(802066),T=a.i(24561),U=a.i(297392),V=a.i(760327),W=a.i(415464),X=a.i(499257);let Y=(0,p.default)(async()=>{},{loadableGenerated:{modules:[23120]},ssr:!1}),Z=(0,p.default)(async()=>{},{loadableGenerated:{modules:[823278]},ssr:!1}),$=(0,p.default)(async()=>{},{loadableGenerated:{modules:[339556]},ssr:!1}),_=(0,p.default)(async()=>{},{loadableGenerated:{modules:[920226]},ssr:!1}),aa=(0,p.default)(async()=>{},{loadableGenerated:{modules:[356881]},ssr:!1}),ab=(0,p.default)(async()=>{},{loadableGenerated:{modules:[351332]},ssr:!1}),ac=c.memo(({app:a,onRefresh:e})=>{let{t:f}=(0,d.useTranslation)(),{notify:g}=(0,G.useContext)(M.ToastContext),h=(0,z.useGlobalPublicStore)(a=>a.systemFeatures),{isCurrentWorkspaceEditor:i}=(0,y.useAppContext)(),{onPlanInfoChanged:k}=(0,O.useProviderContext)(),{push:l}=(0,q.useRouter)(),m=(0,P.useAsyncWindowOpen)(),[o,p]=(0,c.useState)(!1),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)([]),ac=(0,c.useCallback)(async()=>{try{await (0,S.deleteApp)(a.id),g({type:"success",message:f("appDeleted",{ns:"app"})}),e&&e(),k()}catch(a){g({type:"error",message:`${f("appDeleteFailed",{ns:"app"})}${"message"in a?`: ${a.message}`:""}`})}w(!1)},[a.id,g,k,e,f]),ad=(0,c.useCallback)(async({name:b,icon_type:c,icon:d,icon_background:h,description:i,use_icon_as_answer_icon:j,max_active_requests:k})=>{try{await (0,S.updateAppInfo)({appID:a.id,name:b,icon_type:c,icon:d,icon_background:h,description:i,use_icon_as_answer_icon:j,max_active_requests:k}),p(!1),g({type:"success",message:f("editDone",{ns:"app"})}),e&&e()}catch(a){g({type:"error",message:a.message||f("editFailed",{ns:"app"})})}},[a.id,g,e,f]),ae=async({name:b,icon_type:c,icon:d,icon_background:h})=>{try{let j=await (0,S.copyApp)({appID:a.id,name:b,icon_type:c,icon:d,icon_background:h,mode:a.mode});s(!1),g({type:"success",message:f("newApp.appCreated",{ns:"app"})}),localStorage.setItem(x.NEED_REFRESH_APP_LIST_KEY,"1"),e&&e(),k(),(0,U.getRedirection)(i,j,l)}catch{g({type:"error",message:f("newApp.appCreateFailed",{ns:"app"})})}},af=async(b=!1)=>{try{let{data:c}=await (0,S.exportAppConfig)({appID:a.id,include:b}),d=new Blob([c],{type:"application/yaml"});(0,V.downloadBlob)({data:d,fileName:`${a.name}.yml`})}catch{g({type:"error",message:f("exportFailed",{ns:"app"})})}},ag=async()=>{if(a.mode!==E.AppModeEnum.WORKFLOW&&a.mode!==E.AppModeEnum.ADVANCED_CHAT)return void af();try{let b=((await (0,T.fetchWorkflowDraft)(`/apps/${a.id}/workflows/draft`)).environment_variables||[]).filter(a=>"secret"===a.value_type);if(0===b.length)return void af();D(b)}catch{g({type:"error",message:f("exportFailed",{ns:"app"})})}},ah=(0,c.useCallback)(()=>{e&&e(),B(!1)},[e,B]),[ai,aj]=(0,c.useState)(a.tags);(0,c.useEffect)(()=>{aj(a.tags)},[a.tags]);let ak=(0,c.useMemo)(()=>{let b=(0,W.formatTime)({date:1e3*(a.updated_at||a.created_at),dateFormat:`${f("segment.dateTimeFormat",{ns:"datasetDocuments"})}`});return`${f("segment.editedAt",{ns:"datasetDocuments"})} ${b}`},[a.updated_at,a.created_at,f]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{onClick:b=>{b.preventDefault(),(0,U.getRedirection)(i,a,l)},className:"group relative col-span-1 inline-flex h-[160px] cursor-pointer flex-col rounded-xl border-[1px] border-solid border-components-card-border bg-components-card-bg shadow-sm transition-all duration-200 ease-in-out hover:shadow-lg",children:[(0,b.jsxs)("div",{className:"flex h-[66px] shrink-0 grow-0 items-center gap-3 px-[14px] pb-3 pt-[14px]",children:[(0,b.jsxs)("div",{className:"relative shrink-0",children:[(0,b.jsx)(I.default,{size:"large",iconType:a.icon_type,icon:a.icon,background:a.icon_background,imageUrl:a.icon_url}),(0,b.jsx)(H.AppTypeIcon,{type:a.mode,wrapperClassName:"absolute -bottom-0.5 -right-0.5 w-4 h-4 shadow-sm",className:"h-3 w-3"})]}),(0,b.jsxs)("div",{className:"w-0 grow py-[1px]",children:[(0,b.jsx)("div",{className:"flex items-center text-sm font-semibold leading-5 text-text-secondary",children:(0,b.jsx)("div",{className:"truncate",title:a.name,children:a.name})}),(0,b.jsxs)("div",{className:"flex items-center gap-1 text-[10px] font-medium leading-[18px] text-text-tertiary",children:[(0,b.jsx)("div",{className:"truncate",title:a.author_name,children:a.author_name}),(0,b.jsx)("div",{children:"Â·"}),(0,b.jsx)("div",{className:"truncate",title:ak,children:ak})]})]}),(0,b.jsxs)("div",{className:"flex h-5 w-5 shrink-0 items-center justify-center",children:[a.access_mode===Q.AccessMode.PUBLIC&&(0,b.jsx)(N.default,{asChild:!1,popupContent:f("accessItemsDescription.anyone",{ns:"app"}),children:(0,b.jsx)(n.RiGlobalLine,{className:"h-4 w-4 text-text-quaternary"})}),a.access_mode===Q.AccessMode.SPECIFIC_GROUPS_MEMBERS&&(0,b.jsx)(N.default,{asChild:!1,popupContent:f("accessItemsDescription.specific",{ns:"app"}),children:(0,b.jsx)(n.RiLockLine,{className:"h-4 w-4 text-text-quaternary"})}),a.access_mode===Q.AccessMode.ORGANIZATION&&(0,b.jsx)(N.default,{asChild:!1,popupContent:f("accessItemsDescription.organization",{ns:"app"}),children:(0,b.jsx)(n.RiBuildingLine,{className:"h-4 w-4 text-text-quaternary"})}),a.access_mode===Q.AccessMode.EXTERNAL_MEMBERS&&(0,b.jsx)(N.default,{asChild:!1,popupContent:f("accessItemsDescription.external",{ns:"app"}),children:(0,b.jsx)(n.RiVerifiedBadgeLine,{className:"h-4 w-4 text-text-quaternary"})})]})]}),(0,b.jsx)("div",{className:"title-wrapper h-[90px] px-[14px] text-xs leading-normal text-text-tertiary",children:(0,b.jsx)("div",{className:"line-clamp-2",title:a.description,children:a.description})}),(0,b.jsx)("div",{className:"absolute bottom-1 left-0 right-0 flex h-[42px] shrink-0 items-center pb-[6px] pl-[14px] pr-[6px] pt-1",children:i&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:(0,F.cn)("flex w-0 grow items-center gap-1"),onClick:a=>{a.stopPropagation(),a.preventDefault()},children:(0,b.jsx)("div",{className:"mr-[41px] w-full grow group-hover:!mr-0",children:(0,b.jsx)(L.default,{position:"bl",type:"app",targetID:a.id,value:ai.map(a=>a.id),selectedTags:ai,onCacheUpdate:aj,onChange:e})})}),(0,b.jsx)("div",{className:"mx-1 !hidden h-[14px] w-[1px] shrink-0 bg-divider-regular group-hover:!flex"}),(0,b.jsx)("div",{className:"!hidden shrink-0 group-hover:!flex",children:(0,b.jsx)(K.default,{htmlContent:(0,b.jsx)(c=>{let{data:d,isLoading:e}=(0,R.useGetUserCanAccessApp)({appId:a?.id,enabled:!!c?.open&&h.webapp_auth.enabled}),g=async()=>{c.onClose?.()},k=async a=>{a.stopPropagation(),c.onClick?.(),a.preventDefault(),p(!0)},l=async a=>{a.stopPropagation(),c.onClick?.(),a.preventDefault(),s(!0)},n=async a=>{a.stopPropagation(),c.onClick?.(),a.preventDefault(),ag()},o=async a=>{a.stopPropagation(),c.onClick?.(),a.preventDefault(),u(!0)},q=async a=>{a.stopPropagation(),c.onClick?.(),a.preventDefault(),w(!0)},r=async a=>{a.stopPropagation(),c.onClick?.(),a.preventDefault(),B(!0)},t=async b=>{b.stopPropagation(),c.onClick?.(),b.preventDefault();try{await m(async()=>{let{installed_apps:b}=await (0,j.fetchInstalledAppList)(a.id)||{};if(b?.length>0)return`${X.basePath}/explore/installed/${b[0].id}`;throw Error("No app found in Explore")},{onError:a=>{M.default.notify({type:"error",message:`${a.message||a}`})}})}catch(a){M.default.notify({type:"error",message:`${a.message||a}`})}};return(0,b.jsxs)("div",{className:"relative flex w-full flex-col py-1",onMouseLeave:g,children:[(0,b.jsx)("button",{type:"button",className:"mx-1 flex h-8 cursor-pointer items-center gap-2 rounded-lg px-3 hover:bg-state-base-hover",onClick:k,children:(0,b.jsx)("span",{className:"system-sm-regular text-text-secondary",children:f("editApp",{ns:"app"})})}),(0,b.jsx)(J.default,{className:"my-1"}),(0,b.jsx)("button",{type:"button",className:"mx-1 flex h-8 cursor-pointer items-center gap-2 rounded-lg px-3 hover:bg-state-base-hover",onClick:l,children:(0,b.jsx)("span",{className:"system-sm-regular text-text-secondary",children:f("duplicate",{ns:"app"})})}),(0,b.jsx)("button",{type:"button",className:"mx-1 flex h-8 cursor-pointer items-center gap-2 rounded-lg px-3 hover:bg-state-base-hover",onClick:n,children:(0,b.jsx)("span",{className:"system-sm-regular text-text-secondary",children:f("export",{ns:"app"})})}),(a.mode===E.AppModeEnum.COMPLETION||a.mode===E.AppModeEnum.CHAT)&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(J.default,{className:"my-1"}),(0,b.jsx)("button",{type:"button",className:"mx-1 flex h-8 cursor-pointer items-center rounded-lg px-3 hover:bg-state-base-hover",onClick:o,children:(0,b.jsx)("span",{className:"text-sm leading-5 text-text-secondary",children:f("switch",{ns:"app"})})})]}),!a.has_draft_trigger&&(h.webapp_auth.enabled?!(e||!d?.result)&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(J.default,{className:"my-1"}),(0,b.jsx)("button",{type:"button",className:"mx-1 flex h-8 cursor-pointer items-center gap-2 rounded-lg px-3 hover:bg-state-base-hover",onClick:t,children:(0,b.jsx)("span",{className:"system-sm-regular text-text-secondary",children:f("openInExplore",{ns:"app"})})})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(J.default,{className:"my-1"}),(0,b.jsx)("button",{type:"button",className:"mx-1 flex h-8 cursor-pointer items-center gap-2 rounded-lg px-3 hover:bg-state-base-hover",onClick:t,children:(0,b.jsx)("span",{className:"system-sm-regular text-text-secondary",children:f("openInExplore",{ns:"app"})})})]})),(0,b.jsx)(J.default,{className:"my-1"}),h.webapp_auth.enabled&&i&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{type:"button",className:"mx-1 flex h-8 cursor-pointer items-center rounded-lg px-3 hover:bg-state-base-hover",onClick:r,children:(0,b.jsx)("span",{className:"text-sm leading-5 text-text-secondary",children:f("accessControl",{ns:"app"})})}),(0,b.jsx)(J.default,{className:"my-1"})]}),(0,b.jsx)("button",{type:"button",className:"group mx-1 flex h-8 cursor-pointer items-center gap-2 rounded-lg px-3 py-[6px] hover:bg-state-destructive-hover",onClick:q,children:(0,b.jsx)("span",{className:"system-sm-regular text-text-secondary group-hover:text-text-destructive",children:f("operation.delete",{ns:"common"})})})]})},{}),position:"br",trigger:"click",btnElement:(0,b.jsx)("div",{className:"flex h-8 w-8 cursor-pointer items-center justify-center rounded-md",children:(0,b.jsx)(n.RiMoreFill,{className:"h-4 w-4 text-text-tertiary"})}),btnClassName:a=>(0,F.cn)(a?"!bg-state-base-hover !shadow-none":"!bg-transparent","h-8 w-8 rounded-md border-none !p-2 hover:!bg-state-base-hover"),popupClassName:a.mode===E.AppModeEnum.COMPLETION||a.mode===E.AppModeEnum.CHAT?"!w-[256px] translate-x-[-224px]":"!w-[216px] translate-x-[-128px]",className:"!z-20 h-fit"})})]})})]}),o&&(0,b.jsx)(Y,{isEditModal:!0,appName:a.name,appIconType:a.icon_type,appIcon:a.icon,appIconBackground:a.icon_background,appIconUrl:a.icon_url,appDescription:a.description,appMode:a.mode,appUseIconAsAnswerIcon:a.use_icon_as_answer_icon,max_active_requests:a.max_active_requests??null,show:o,onConfirm:ad,onHide:()=>p(!1)}),r&&(0,b.jsx)(Z,{appName:a.name,icon_type:a.icon_type,icon:a.icon,icon_background:a.icon_background,icon_url:a.icon_url,show:r,onConfirm:ae,onHide:()=>s(!1)}),t&&(0,b.jsx)($,{show:t,appDetail:a,onClose:()=>u(!1),onSuccess:()=>{e&&e(),u(!1)}}),v&&(0,b.jsx)(_,{title:f("deleteAppConfirmTitle",{ns:"app"}),content:f("deleteAppConfirmContent",{ns:"app"}),isShow:v,onConfirm:ac,onCancel:()=>w(!1)}),C.length>0&&(0,b.jsx)(aa,{envList:C,onConfirm:af,onClose:()=>D([])}),A&&(0,b.jsx)(ab,{app:a,onConfirm:ah,onClose:()=>B(!1)})]})});var ad=a.i(192875);let ae=c.memo(({count:a=6})=>(0,b.jsx)(b.Fragment,{children:Array.from({length:a}).map((a,c)=>(0,b.jsx)("div",{className:"h-[160px] rounded-xl border-[0.5px] border-components-card-border bg-components-card-bg p-4",children:(0,b.jsxs)(ad.SkeletonContainer,{className:"h-full",children:[(0,b.jsxs)(ad.SkeletonRow,{children:[(0,b.jsx)(ad.SkeletonRectangle,{className:"h-10 w-10 animate-pulse rounded-lg"}),(0,b.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,b.jsx)(ad.SkeletonRectangle,{className:"h-4 w-2/3 animate-pulse"}),(0,b.jsx)(ad.SkeletonRectangle,{className:"h-3 w-1/3 animate-pulse"})]})]}),(0,b.jsxs)("div",{className:"mt-4 flex flex-col gap-2",children:[(0,b.jsx)(ad.SkeletonRectangle,{className:"h-3 w-full animate-pulse"}),(0,b.jsx)(ad.SkeletonRectangle,{className:"h-3 w-4/5 animate-pulse"})]})]})},c))}));ae.displayName="AppCardSkeleton";let af=c.memo(()=>{let a=Array.from({length:36});return(0,b.jsx)(b.Fragment,{children:a.map((a,c)=>(0,b.jsx)("div",{className:"inline-flex h-[160px] rounded-xl bg-background-default-lighter"},c))})}),ag=c.memo(()=>{let{t:a}=(0,d.useTranslation)();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(af,{}),(0,b.jsx)("div",{className:"pointer-events-none absolute inset-0 z-20 flex items-center justify-center bg-gradient-to-t from-background-body to-transparent",children:(0,b.jsx)("span",{className:"system-md-medium text-text-tertiary",children:a("newApp.noAppsFound",{ns:"app"})})})]})});var ah=a.i(413192);let ai=c.memo(({href:a,children:c})=>(0,b.jsx)(ah.default,{className:"flex h-8 w-8 cursor-pointer items-center justify-center transition-opacity duration-200 ease-in-out hover:opacity-80",target:"_blank",rel:"noopener noreferrer",href:a,children:c})),aj=c.memo(()=>{let{t:a}=(0,d.useTranslation)();return(0,b.jsxs)("footer",{className:"relative shrink-0 grow-0 px-12 py-2",children:[(0,b.jsx)("h3",{className:"text-gradient text-xl font-semibold leading-tight",children:a("join",{ns:"app"})}),(0,b.jsx)("p",{className:"system-sm-regular mt-1 text-text-tertiary",children:a("communityIntro",{ns:"app"})}),(0,b.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,b.jsx)(ai,{href:"https://github.com/langgenius/dify",children:(0,b.jsx)(n.RiGithubFill,{className:"h-5 w-5 text-text-tertiary"})}),(0,b.jsx)(ai,{href:"https://discord.gg/FngNHpbcY7",children:(0,b.jsx)(n.RiDiscordFill,{className:"h-5 w-5 text-text-tertiary"})}),(0,b.jsx)(ai,{href:"https://forum.dify.ai",children:(0,b.jsx)(n.RiDiscussLine,{className:"h-5 w-5 text-text-tertiary"})})]})]})}),ak=function(){let[a,b]=(0,r.useQueryStates)({tagIDs:(0,r.parseAsArrayOf)(r.parseAsString,";"),keywords:r.parseAsString,isCreatedByMe:r.parseAsBoolean},{history:"push"}),d=(0,c.useMemo)(()=>({tagIDs:a.tagIDs??void 0,keywords:a.keywords||void 0,isCreatedByMe:a.isCreatedByMe??!1}),[a.isCreatedByMe,a.keywords,a.tagIDs]),e=(0,c.useCallback)(a=>{let c=a=>{let b={};return"tagIDs"in a&&(b.tagIDs=a.tagIDs&&a.tagIDs.length>0?a.tagIDs:null),"keywords"in a&&(b.keywords=a.keywords?a.keywords:null),"isCreatedByMe"in a&&(b.isCreatedByMe=!!a.isCreatedByMe||null),b};"function"==typeof a?b(b=>c(a({tagIDs:b.tagIDs??void 0,keywords:b.keywords||void 0,isCreatedByMe:b.isCreatedByMe??!1}))):b(c(a))},[b]);return(0,c.useMemo)(()=>({query:d,setQuery:e}),[d,e])};var al=a.i(689808);a.i(849888);var am=a.i(945577),an=a.i(886360),ao=a.i(779413);let ap=(0,p.default)(async()=>{},{loadableGenerated:{modules:[239024]},ssr:!1}),aq=(0,p.default)(async()=>{},{loadableGenerated:{modules:[457094]},ssr:!1}),ar=(0,p.default)(async()=>{},{loadableGenerated:{modules:[512728]},ssr:!1}),as=({ref:a,className:e,isLoading:g=!1,onSuccess:h,selectedAppType:i})=>{let{t:j}=(0,d.useTranslation)(),{onPlanInfoChanged:k}=(0,O.useProviderContext)(),l=(0,q.useSearchParams)(),{replace:m}=(0,q.useRouter)(),n=l.get("remoteInstallUrl")||void 0,[o,p]=(0,c.useState)(!1),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(!!n),v=(0,c.useMemo)(()=>{if(n)return al.CreateFromDSLModalTab.FROM_URL},[n]),w=(0,G.useContextSelector)(f.default,a=>a.controlHideCreateFromTemplatePanel);return(0,c.useEffect)(()=>{w>0&&p(!1)},[w]),(0,b.jsxs)("div",{ref:a,className:(0,F.cn)("relative col-span-1 inline-flex h-[160px] flex-col justify-between rounded-xl border-[0.5px] border-components-card-border bg-components-card-bg transition-opacity",g&&"pointer-events-none opacity-50",e),children:[(0,b.jsxs)("div",{className:"grow rounded-t-xl p-2",children:[(0,b.jsx)("div",{className:"px-6 pb-1 pt-2 text-xs font-medium leading-[18px] text-text-tertiary",children:j("createApp",{ns:"app"})}),(0,b.jsxs)("button",{type:"button",className:"mb-1 flex w-full cursor-pointer items-center rounded-lg px-6 py-[7px] text-[13px] font-medium leading-[18px] text-text-tertiary hover:bg-state-base-hover hover:text-text-secondary",onClick:()=>s(!0),children:[(0,b.jsx)(an.FilePlus01,{className:"mr-2 h-4 w-4 shrink-0"}),j("newApp.startFromBlank",{ns:"app"})]}),(0,b.jsxs)("button",{type:"button",className:"flex w-full cursor-pointer items-center rounded-lg px-6 py-[7px] text-[13px] font-medium leading-[18px] text-text-tertiary hover:bg-state-base-hover hover:text-text-secondary",onClick:()=>p(!0),children:[(0,b.jsx)(ao.FilePlus02,{className:"mr-2 h-4 w-4 shrink-0"}),j("newApp.startFromTemplate",{ns:"app"})]}),(0,b.jsxs)("button",{type:"button",onClick:()=>u(!0),className:"flex w-full cursor-pointer items-center rounded-lg px-6 py-[7px] text-[13px] font-medium leading-[18px] text-text-tertiary hover:bg-state-base-hover hover:text-text-secondary",children:[(0,b.jsx)(am.FileArrow01,{className:"mr-2 h-4 w-4 shrink-0"}),j("importDSL",{ns:"app"})]})]}),r&&(0,b.jsx)(ap,{show:r,onClose:()=>s(!1),onSuccess:()=>{k(),h&&h()},onCreateFromTemplate:()=>{p(!0),s(!1)},defaultAppMode:"all"!==i?i:void 0}),o&&(0,b.jsx)(aq,{show:o,onClose:()=>p(!1),onSuccess:()=>{k(),h&&h()},onCreateFromBlank:()=>{s(!0),p(!1)}}),t&&(0,b.jsx)(ar,{show:t,onClose:()=>{u(!1),n&&m("/")},activeTab:v,dslUrl:n,onSuccess:()=>{k(),h&&h()}})]})};as.displayName="CreateAppCard";let at=c.memo(as);E.AppModeEnum.WORKFLOW,E.AppModeEnum.ADVANCED_CHAT,E.AppModeEnum.CHAT,E.AppModeEnum.AGENT_CHAT,E.AppModeEnum.COMPLETION;let au=(0,p.default)(async()=>{},{loadableGenerated:{modules:[903565]},ssr:!1}),av=(0,p.default)(async()=>{},{loadableGenerated:{modules:[512728]},ssr:!1}),aw=({controlRefreshList:a=0})=>{let{t:e}=(0,d.useTranslation)(),{systemFeatures:f}=(0,z.useGlobalPublicStore)(),g=(0,q.useRouter)(),{isCurrentWorkspaceEditor:h,isCurrentWorkspaceDatasetOperator:i,isLoadingCurrentWorkspace:j}=(0,y.useAppContext)(),k=(0,v.useStore)(a=>a.showTagManagementModal),[l,m]=(0,r.useQueryState)("category",r.parseAsString.withDefault("all").withOptions({history:"push"})),{query:{tagIDs:p=[],keywords:A="",isCreatedByMe:B=!1},setQuery:G}=ak(),[H,I]=(0,c.useState)(B),[J,K]=(0,c.useState)(p),[L,M]=(0,c.useState)(A),N=(0,c.useRef)(null),O=(0,c.useRef)(null),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)(),T=(0,c.useCallback)(a=>{G(b=>({...b,keywords:a}))},[G]),U=(0,c.useCallback)(a=>{G(b=>({...b,tagIDs:a}))},[G]),{dragging:V}=(({onDSLFileDropped:a,containerRef:b,enabled:d=!0})=>{let[e,f]=(0,c.useState)(!1),g=a=>{a.preventDefault(),a.stopPropagation(),a.dataTransfer?.types.includes("Files")&&f(!0)},h=a=>{a.preventDefault(),a.stopPropagation()},i=a=>{a.preventDefault(),a.stopPropagation(),null!==a.relatedTarget&&b.current?.contains(a.relatedTarget)||f(!1)},j=b=>{if(b.preventDefault(),b.stopPropagation(),f(!1),!b.dataTransfer)return;let c=Array.from(b.dataTransfer.files);if(0===c.length)return;let d=c[0];(d.name.toLowerCase().endsWith(".yaml")||d.name.toLowerCase().endsWith(".yml"))&&a(d)};return(0,c.useEffect)(()=>{if(!d)return;let a=b.current;return a&&(a.addEventListener("dragenter",g),a.addEventListener("dragover",h),a.addEventListener("dragleave",i),a.addEventListener("drop",j)),()=>{a&&(a.removeEventListener("dragenter",g),a.removeEventListener("dragover",h),a.removeEventListener("dragleave",i),a.removeEventListener("drop",j))}},[b,d]),{dragging:!!d&&e}})({onDSLFileDropped:(0,c.useCallback)(a=>{S(a),Q(!0)},[]),containerRef:O,enabled:h}),W={page:1,limit:30,name:L,tag_ids:p,is_created_by_me:H,..."all"!==l?{mode:l}:{}},{data:X,isLoading:Y,isFetching:Z,isFetchingNextPage:$,fetchNextPage:_,hasNextPage:aa,error:ab,refetch:ad}=(0,D.useInfiniteAppList)(W,{enabled:!i});(0,c.useEffect)(()=>{a>0&&ad()},[a]);let af=(0,c.useRef)(null),ah=[{value:"all",text:e("types.all",{ns:"app"}),icon:(0,b.jsx)(n.RiApps2Line,{className:"mr-1 h-[14px] w-[14px]"})},{value:E.AppModeEnum.WORKFLOW,text:e("types.workflow",{ns:"app"}),icon:(0,b.jsx)(n.RiExchange2Line,{className:"mr-1 h-[14px] w-[14px]"})},{value:E.AppModeEnum.ADVANCED_CHAT,text:e("types.advanced",{ns:"app"}),icon:(0,b.jsx)(n.RiMessage3Line,{className:"mr-1 h-[14px] w-[14px]"})},{value:E.AppModeEnum.CHAT,text:e("types.chatbot",{ns:"app"}),icon:(0,b.jsx)(n.RiMessage3Line,{className:"mr-1 h-[14px] w-[14px]"})},{value:E.AppModeEnum.AGENT_CHAT,text:e("types.agent",{ns:"app"}),icon:(0,b.jsx)(n.RiRobot3Line,{className:"mr-1 h-[14px] w-[14px]"})},{value:E.AppModeEnum.COMPLETION,text:e("types.completion",{ns:"app"}),icon:(0,b.jsx)(n.RiFile4Line,{className:"mr-1 h-[14px] w-[14px]"})}];(0,c.useEffect)(()=>{"1"===localStorage.getItem(x.NEED_REFRESH_APP_LIST_KEY)&&(localStorage.removeItem(x.NEED_REFRESH_APP_LIST_KEY),ad())},[ad]),(0,c.useEffect)(()=>{if(i)return g.replace("/datasets")},[g,i]),(0,c.useEffect)(()=>{let a;if(i)return;let b=aa??!0;if(ab){a&&a.disconnect();return}if(af.current&&O.current){let c=Math.max(100,Math.min(.2*O.current.clientHeight,200));(a=new IntersectionObserver(a=>{!a[0].isIntersecting||Y||$||ab||!b||_()},{root:O.current,rootMargin:`${c}px`,threshold:.1})).observe(af.current)}return()=>a?.disconnect()},[Y,$,_,ab,aa,i]);let{run:ai}=(0,o.useDebounceFn)(()=>{M(A)},{wait:500}),al=a=>{T(a),ai()},{run:am}=(0,o.useDebounceFn)(()=>{U(J)},{wait:500}),an=(0,c.useCallback)(()=>{let a=!H;I(a),G(b=>({...b,isCreatedByMe:a}))},[H,G]),ao=X?.pages??[],ap=(ao[0]?.total??0)>0,aq=Y||Z&&0===ao.length;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{ref:O,className:"relative flex h-0 shrink-0 grow flex-col overflow-y-auto bg-background-body",children:[V&&(0,b.jsx)("div",{className:"absolute inset-0 z-50 m-0.5 rounded-2xl border-2 border-dashed border-components-dropzone-border-accent bg-[rgba(21,90,239,0.14)] p-2"}),(0,b.jsxs)("div",{className:"sticky top-0 z-10 flex flex-wrap items-center justify-between gap-y-2 bg-background-body px-12 pb-5 pt-7",children:[(0,b.jsx)(t.default,{value:l,onChange:m,options:ah}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(w.default,{className:"mr-2",label:e("showMyCreatedAppsOnly",{ns:"app"}),isChecked:H,onChange:an}),(0,b.jsx)(u.default,{type:"app",value:J,onChange:a=>{K(a),am()}}),(0,b.jsx)(s.default,{showLeftIcon:!0,showClearIcon:!0,wrapperClassName:"w-[200px]",value:A,onChange:a=>al(a.target.value),onClear:()=>al("")})]})]}),(0,b.jsxs)("div",{className:(0,F.cn)("relative grid grow grid-cols-1 content-start gap-4 px-12 pt-2 sm:grid-cols-1 md:grid-cols-2 xl:grid-cols-4 2xl:grid-cols-5 2k:grid-cols-6",!ap&&"overflow-hidden"),children:[(h||j)&&(0,b.jsx)(at,{ref:N,isLoading:j,onSuccess:ad,selectedAppType:l,className:(0,F.cn)(!ap&&"z-10")}),aq?(0,b.jsx)(ae,{count:6}):ap?ao.flatMap(({data:a})=>a).map(a=>(0,b.jsx)(ac,{app:a,onRefresh:ad},a.id)):(0,b.jsx)(ag,{}),$&&(0,b.jsx)(ae,{count:3})]}),h&&(0,b.jsxs)("div",{className:`flex items-center justify-center gap-2 py-4 ${V?"text-text-accent":"text-text-quaternary"}`,role:"region","aria-label":e("newApp.dropDSLToCreateApp",{ns:"app"}),children:[(0,b.jsx)(n.RiDragDropLine,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"system-xs-regular",children:e("newApp.dropDSLToCreateApp",{ns:"app"})})]}),!f.branding.enabled&&(0,b.jsx)(aj,{}),(0,b.jsx)(C,{}),(0,b.jsx)("div",{ref:af,className:"h-0",children:" "}),k&&(0,b.jsx)(au,{type:"app",show:k})]}),P&&(0,b.jsx)(av,{show:P,onClose:()=>{Q(!1),S(void 0)},onSuccess:()=>{Q(!1),S(void 0),ad()},droppedFile:R})]})};a.s(["default",0,()=>{let{t:a}=(0,d.useTranslation)();(0,g.default)(a("menus.apps",{ns:"common"})),(0,e.useEducationInit)();let[n,o]=(0,c.useState)(void 0),p=n?.app,[q,r]=(0,c.useState)(!1),s=(0,c.useCallback)(()=>{r(!1)},[]),[t,u]=(0,c.useState)(!1),v=(0,c.useCallback)(()=>{u(!0)},[]),[w,x]=(0,c.useState)(0),[y,z]=(0,c.useState)(0),A=(0,c.useCallback)(()=>{x(a=>a+1),z(a=>a+1)},[]),[B,C]=(0,c.useState)(!1),{handleImportDSL:D,handleImportDSLConfirm:E,versions:F,isFetching:G}=(0,h.useImportDSL)(),H=(0,c.useCallback)(async()=>{await E({onSuccess:A})},[E,A]),I=async({name:a,icon_type:b,icon:c,icon_background:d,description:e})=>{s();let{export_data:f}=await (0,j.fetchAppDetail)(p?.app.id),g={mode:i.DSLImportMode.YAML_CONTENT,yaml_content:f,name:a,icon_type:b,icon:c,icon_background:d,description:e};await D(g,{onSuccess:()=>{u(!1)},onPending:()=>{C(!0)}})};return(0,b.jsx)(f.default.Provider,{value:{currentApp:n,isShowTryAppPanel:q,setShowTryAppPanel:(a,b)=>{a?o(b):o(void 0),r(a)},controlHideCreateFromTemplatePanel:y},children:(0,b.jsxs)("div",{className:"relative flex h-0 shrink-0 grow flex-col overflow-y-auto bg-background-body",children:[(0,b.jsx)(aw,{controlRefreshList:w}),q&&(0,b.jsx)(m.default,{appId:n?.appId||"",app:n?.app,category:n?.app?.category,onClose:s,onCreate:v}),B&&(0,b.jsx)(k.default,{versions:F,onCancel:()=>C(!1),onConfirm:H,confirmDisabled:G}),t&&(0,b.jsx)(l.default,{appIconType:p?.app.icon_type||"emoji",appIcon:p?.app.icon||"",appIconBackground:p?.app.icon_background||"",appIconUrl:p?.app.icon_url,appName:p?.app.name||"",appDescription:p?.app.description||"",show:!0,onConfirm:I,confirmDisabled:G,onHide:()=>u(!1)})]})})}],148402)}];

//# sourceMappingURL=app_components_apps_index_tsx_97ccecf4._.js.map