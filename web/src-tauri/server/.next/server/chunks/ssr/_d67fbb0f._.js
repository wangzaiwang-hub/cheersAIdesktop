module.exports=[280342,a=>{"use strict";var b=a.i(57843),c={SVG:"image/svg+xml",ICO:"image/x-icon",GIF:"image/gif",PNG:"image/png"};let d=function(a){(0,b.useEffect)(function(){if(a){var b=a.split("."),d=b[b.length-1].toLocaleUpperCase(),e=document.querySelector("link[rel*='icon']")||document.createElement("link");e.type=c[d],e.href=a,e.rel="shortcut icon",document.getElementsByTagName("head")[0].appendChild(e)}},[a])};var e=a.i(240944),f=a.i(446855),g={restoreOnUnmount:!1};let h=function(a,c){void 0===c&&(c=g);var d=(0,b.useRef)(f.default?document.title:"");(0,b.useEffect)(function(){document.title=a},[a]),(0,e.default)(function(){c.restoreOnUnmount&&(document.title=d.current)})};var i=a.i(724423),j=a.i(499257);function k(a){let c=(0,i.useIsSystemFeaturesPending)(),e=(0,i.useGlobalPublicStore)(a=>a.systemFeatures),f=a?`${a} - `:"",g="",k="";!1===c&&(e.branding.enabled?(g=`${f}${e.branding.application_title}`,k=e.branding.favicon):(g=`${f}Dify`,k=`${j.basePath}/favicon.ico`)),h(g),(0,b.useEffect)(()=>{let a=null;return e.branding.favicon&&(document.querySelectorAll("link[rel='icon'], link[rel='shortcut icon'], link[rel='apple-touch-icon'], link[rel='mask-icon']").forEach(a=>a.parentNode?.removeChild(a)),(a=document.createElement("link")).rel="apple-touch-icon",a.href=e.branding.favicon,document.head.appendChild(a)),()=>{a?.remove()}},[e.branding.favicon]),d(k)}a.s(["default",()=>k],280342)},858877,a=>{"use strict";a.s(["addFileInfos",0,(a,b)=>a&&b?a.map(a=>a.files&&a.files?.length>0?{...a,message_files:a.files.map(a=>b.find(b=>b.id===a))}:a):a,"sortAgentSorts",0,a=>{if(!a||a.some(a=>void 0===a.position))return a;let b=[...a];return b.sort((a,b)=>a.position-b.position),b}])},213228,a=>{"use strict";var b=a.i(608061),c=a.i(57843),d=a.i(527344);let e=c.memo(({items:a,value:c,itemClassName:e,itemWrapClassName:f,activeItemClassName:g,onChange:h})=>{let i=({id:a,name:i,icon:j,extra:k,disabled:l})=>(0,b.jsxs)("div",{className:(0,d.cn)("system-md-semibold relative flex cursor-pointer items-center border-b-2 border-transparent pb-2 pt-2.5",a===c?(0,d.cn)("border-components-tab-active text-text-primary",g):"text-text-tertiary",l&&"cursor-not-allowed opacity-30",f),onClick:()=>!l&&h(a),children:[j||"",(0,b.jsx)("div",{className:(0,d.cn)("ml-2",e),children:i}),k||""]},a);return(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"flex space-x-4",children:a.filter(a=>!a.isRight).map(i)}),(0,b.jsx)("div",{className:"flex space-x-4",children:a.filter(a=>a.isRight).map(i)})]})});a.s(["default",0,e])},365866,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(57843);a.i(752298);var e=a.i(693025),f=a.i(175809),g=a.i(909795),h=a.i(632789),i=a.i(105249),j=a.i(751161),k=a.i(524526),l=a.i(970039),m=a.i(843990),n=a.i(28877);a.i(76955);var o=a.i(257898),p=a.i(939714),q=a.i(481366),r=a.i(28959),s=a.i(997472),t=a.i(252813),u=a.i(136403),v=a.i(844299),w=a.i(527344);let x=d.memo(({showBackButton:a=!1,collection:x,isBuiltIn:y=!0,isModel:z=!0,toolName:A,setting:B={},readonly:C,onHide:D,onSave:E,credentialId:F,onAuthorizationItemClick:G})=>{let H,I=(0,t.useLocale)(),J=(0,u.getLanguage)(I),{t:K}=(0,e.useTranslation)(),L=x.tools,M=L?.length>0,[N,O]=(0,d.useState)(!M),[P,Q]=(0,d.useState)(M?L:[]),R=P.find(a=>a.name===A),S=R?(0,s.toolParametersToFormSchemas)(R.parameters):[],T=S.filter(a=>"llm"===a.form),U=S.filter(a=>"llm"!==a.form),V=U.length>0,[W,X]=(0,d.useState)(B),[Y,Z]=(0,d.useState)("info"),$="info"===Y;(0,d.useEffect)(()=>{x&&!M&&(async()=>{O(!0);try{let a=await new Promise(a=>{!async function(){z?a(await (0,v.fetchModelToolList)(x.name)):y?a(await (0,v.fetchBuiltInToolList)(x.name)):x.type===r.CollectionType.workflow?a(await (0,v.fetchWorkflowToolList)(x.id)):a(await (0,v.fetchCustomToolList)(x.name))}()});Q(a)}catch{}O(!1)})()},[x?.name,x?.id,x?.type]),(0,d.useEffect)(()=>{Z(!C&&V?"setting":"info")},[V]);let _=(H=!0,U.forEach(a=>{a.required&&!W[a.name]&&(H=!1)}),H),aa=(0,b.jsx)("div",{className:"",children:T.length>0&&(0,b.jsx)("div",{className:"space-y-1 py-2",children:T.map((a,c)=>{var d;return(0,b.jsxs)("div",{className:"py-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"code-sm-semibold text-text-secondary",children:a.label[J]}),(0,b.jsx)("div",{className:"system-xs-regular text-text-tertiary",children:"number-input"===(d=a.type)?K("setBuiltInTools.number",{ns:"tools"}):"text-input"===d?K("setBuiltInTools.string",{ns:"tools"}):"checkbox"===d?"boolean":"file"===d?K("setBuiltInTools.file",{ns:"tools"}):d}),a.required&&(0,b.jsx)("div",{className:"system-xs-medium text-text-warning-secondary",children:K("setBuiltInTools.required",{ns:"tools"})})]}),a.human_description&&(0,b.jsx)("div",{className:"system-xs-regular mt-0.5 text-text-tertiary",children:a.human_description?.[J]})]},c)})})}),ab=(0,b.jsx)(k.default,{value:W,onChange:X,formSchemas:U,isEditMode:!1,showOnVariableMap:{},validating:!1,readonly:C});return(0,b.jsx)(h.default,{isOpen:!0,clickOutsideNotOpen:!1,onClose:D,footer:null,mask:!1,positionCenter:!1,panelClassName:(0,w.cn)("mb-2 mr-2 mt-[64px] !w-[420px] !max-w-[420px] justify-start rounded-2xl border-[0.5px] border-components-panel-border !bg-components-panel-bg !p-0 shadow-xl"),children:(0,b.jsxs)(b.Fragment,{children:[N&&(0,b.jsx)(i.default,{type:"app"}),!N&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"relative border-b border-divider-subtle p-4 pb-3",children:[(0,b.jsx)("div",{className:"absolute right-3 top-3",children:(0,b.jsx)(f.default,{onClick:D,children:(0,b.jsx)(c.RiCloseLine,{className:"h-4 w-4"})})}),a&&(0,b.jsxs)("div",{className:"system-xs-semibold-uppercase mb-2 flex cursor-pointer items-center gap-1 text-text-accent-secondary",onClick:D,children:[(0,b.jsx)(c.RiArrowLeftLine,{className:"h-4 w-4"}),K("detailPanel.operation.back",{ns:"plugin"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(l.default,{size:"tiny",className:"h-6 w-6",src:x.icon}),(0,b.jsx)(n.default,{packageNameClassName:"w-auto",orgName:x.author,packageName:x.name.split("/").pop()||""})]}),(0,b.jsx)("div",{className:"system-md-semibold mt-1 text-text-primary",children:R?.label[J]}),!!R?.description[J]&&(0,b.jsx)(m.default,{className:"mb-2 mt-3 h-auto",text:R.description[J],descriptionLineRows:2}),x.allow_delete&&x.type===r.CollectionType.builtIn&&(0,b.jsx)(p.PluginAuthInAgent,{pluginPayload:{provider:x.name,category:o.AuthCategory.tool,providerType:x.type,detail:x},credentialId:F,onAuthorizationItemClick:G})]}),(0,b.jsx)("div",{className:"h-full",children:(0,b.jsxs)("div",{className:"flex h-full flex-col",children:[V&&!C?(0,b.jsx)(j.default,{className:"mt-1 shrink-0 px-4",itemClassName:"py-3",noBorderBottom:!0,value:Y,onChange:a=>{Z(a)},options:[{value:"info",text:K("setBuiltInTools.parameters",{ns:"tools"})},{value:"setting",text:K("setBuiltInTools.setting",{ns:"tools"})}]}):(0,b.jsx)("div",{className:"system-sm-semibold-uppercase p-4 pb-1 text-text-primary",children:K("setBuiltInTools.parameters",{ns:"tools"})}),(0,b.jsxs)("div",{className:"h-0 grow overflow-y-auto px-4",children:[$?aa:ab,!C&&!$&&(0,b.jsxs)("div",{className:"flex shrink-0 justify-end space-x-2 rounded-b-[10px] bg-components-panel-bg py-2",children:[(0,b.jsx)(g.default,{className:"flex h-8 items-center !px-3 !text-[13px] font-medium ",onClick:D,children:K("operation.cancel",{ns:"common"})}),(0,b.jsx)(g.default,{className:"flex h-8 items-center !px-3 !text-[13px] font-medium",variant:"primary",disabled:!_,onClick:()=>E?.(W),children:K("operation.save",{ns:"common"})})]})]}),(0,b.jsx)(q.ReadmeEntrance,{pluginDetail:x,className:"mt-auto"})]})})]})]})})});a.s(["default",0,x])},411171,a=>{"use strict";var b=a.i(546232),c=a.i(446855),d=(0,b.createUseStorageState)(function(){return c.default?localStorage:void 0});a.s(["useLocalStorageState",0,d],411171)},664358,a=>{"use strict";var b=a.i(608061),c=a.i(57843),d=a.i(168799),e=a.i(483664),f=a.i(527344);let g=c.memo(({className:a="",isChecked:c,onChange:g,label:h,labelClassName:i,tooltip:j,testId:k})=>(0,b.jsxs)("label",{className:(0,f.cn)(a,"flex h-7 items-center space-x-2"),children:[(0,b.jsx)(d.default,{checked:c,onCheck:()=>g(!c),id:k}),(0,b.jsx)("div",{className:(0,f.cn)("text-sm font-normal text-text-secondary",i),children:h}),j&&(0,b.jsx)(e.default,{popupContent:(0,b.jsx)("div",{className:"w-[200px]",children:j}),triggerClassName:"ml-0.5 w-4 h-4"})]}));a.s(["default",0,g])},190124,a=>{"use strict";var b=a.i(516758),c=a.i(848636),d=a.i(528698),e=a.i(749249),f=a.i(724423),g=a.i(41511),h=a.i(692520);let i="access-control";a.s(["useAppWhiteListSubjects",0,(a,b)=>(0,d.useQuery)({queryKey:[i,"app-whitelist-subjects",a],queryFn:()=>(0,g.get)(`/enterprise/webapp/app/subjects?appId=${a}`),enabled:!!a&&b,staleTime:0,gcTime:0}),"useGetUserCanAccessApp",0,({appId:a,isInstalledApp:b=!0,enabled:c})=>{let e=(0,f.useGlobalPublicStore)(a=>a.systemFeatures);return(0,d.useQuery)({queryKey:[i,"user-can-access-app",a,e.webapp_auth.enabled,b],queryFn:()=>e.webapp_auth.enabled?(0,h.getUserCanAccess)(a,b):{result:!0},enabled:void 0!==c?c:!!a,staleTime:0,gcTime:0})},"useSearchForWhiteListCandidates",0,(a,c)=>(0,b.useInfiniteQuery)({queryKey:[i,"app-whitelist-candidates",a],queryFn:({pageParam:b})=>{let c=new URLSearchParams;return Object.keys(a).forEach(b=>{a[b]&&c.append(b,`${a[b]}`)}),c.append("pageNumber",`${b}`),(0,g.get)(`/enterprise/webapp/app/subject/search?${new URLSearchParams(c).toString()}`)},initialPageParam:1,getNextPageParam:a=>{if(a.hasMore)return a.currPage+1},gcTime:0,staleTime:0,enabled:c}),"useUpdateAccessMode",0,()=>{let a=(0,e.useQueryClient)();return(0,c.useMutation)({mutationKey:[i,"update-access-mode"],mutationFn:a=>(0,g.post)("/enterprise/webapp/app/access-mode",{body:a}),onSuccess:()=>{a.invalidateQueries({queryKey:[i,"app-whitelist-subjects"]})}})}])},70854,a=>{"use strict";var b=a.i(57843);a.i(752298);var c=a.i(693025);a.s(["useKnowledge",0,()=>{let{t:a}=(0,c.useTranslation)(),d=(0,b.useCallback)(b=>a(`indexingTechnique.${b}`,{ns:"dataset"}),[a]),e=(0,b.useCallback)((b,c)=>c?a("indexingMethod.invertedIndex",{ns:"dataset"}):a(`indexingMethod.${b}`,{ns:"dataset"}),[a]),f=(0,b.useCallback)((a,b)=>{let c=d(a);return b&&(c+=` \xb7 ${e(b,"economy"===a)}`),c},[d,e]);return{formatIndexingTechnique:d,formatIndexingMethod:e,formatIndexingTechniqueAndMethod:f}}])},463963,a=>{"use strict";var b=a.i(639378),c=a.i(878590);class d{chatColorTheme;chatColorThemeInverted;primaryColor="#1C64F2";backgroundHeaderColorStyle="backgroundImage: linear-gradient(to right, #2563eb, #0ea5e9)";headerBorderBottomStyle="";colorFontOnHeaderStyle="color: white";colorPathOnHeader="text-text-primary-on-surface";backgroundButtonDefaultColorStyle="backgroundColor: #1C64F2";roundedBackgroundColorStyle="backgroundColor: rgb(245 248 255)";chatBubbleColorStyle="";constructor(a=null,b=!1){this.chatColorTheme=a,this.chatColorThemeInverted=b,this.configCustomColor(),this.configInvertedColor()}configCustomColor(){null!==this.chatColorTheme&&""!==this.chatColorTheme&&(this.primaryColor=this.chatColorTheme??"#1C64F2",this.backgroundHeaderColorStyle=`backgroundColor: ${this.primaryColor}`,this.backgroundButtonDefaultColorStyle=`backgroundColor: ${this.primaryColor}; color: ${this.colorFontOnHeaderStyle};`,this.roundedBackgroundColorStyle=`backgroundColor: ${(0,c.hexToRGBA)(this.primaryColor,.05)}`,this.chatBubbleColorStyle=`backgroundColor: ${(0,c.hexToRGBA)(this.primaryColor,.15)}`)}configInvertedColor(){this.chatColorThemeInverted&&(this.backgroundHeaderColorStyle="backgroundColor: #ffffff",this.colorFontOnHeaderStyle=`color: ${this.primaryColor}`,this.headerBorderBottomStyle="borderBottom: 1px solid #ccc",this.colorPathOnHeader=this.primaryColor)}}let e=(0,b.createContext)(new class{_theme;buildChecker=!1;get theme(){return void 0===this._theme&&(this._theme=new d),this._theme}buildTheme(a=null,b=!1){this.buildChecker?(this.theme?.chatColorTheme!==a||this.theme?.chatColorThemeInverted!==b)&&(this._theme=new d(a,b),this.buildChecker=!0):(this._theme=new d(a,b),this.buildChecker=!0)}});a.s(["useThemeContext",0,()=>(0,b.useContext)(e)])},24561,a=>{"use strict";var b=a.i(41511),c=a.i(314576);a.i(494261);var d=a.i(735310);let e=async(a,d,e)=>(0,b.get)(`${(0,c.getFlowPrefix)(a)}/${d}/workflows/draft/variables`,{params:{page:e,limit:100}}),f=async(a,b)=>{let{items:c,total:d}=await e(a,b,1);if(d<=100)return c;let f=Math.ceil(d/100),g=[];for(let c=2;c<=f;c++)g.push(e(a,b,c));return(await Promise.all(g)).forEach(({items:a})=>{c.push(...a)}),c},g=async(a,d,e)=>{let{items:f}=await (0,b.get)(`${(0,c.getFlowPrefix)(a)}/${d}/workflows/draft/nodes/${e}/variables`);return f};a.s(["fetchAllInspectVars",0,f,"fetchNodeDefault",0,(a,c,d={})=>(0,b.get)(`apps/${a}/workflows/default-workflow-block-configs/${c}`,{params:{q:JSON.stringify(d)}}),"fetchNodeInspectVars",0,g,"fetchNodesDefaultConfigs",0,a=>(0,b.get)(a),"fetchPipelineNodeDefault",0,(a,c,d={})=>(0,b.get)(`rag/pipelines/${a}/workflows/default-workflow-block-configs/${c}`,{params:{q:JSON.stringify(d)}}),"fetchPublishedWorkflow",0,a=>(0,b.get)(a),"fetchWorkflowDraft",0,a=>(0,b.get)(a,{},{silent:!0}),"getIterationSingleNodeRunUrl",0,(a,b,d,e)=>`${(0,c.getFlowPrefix)(a)}/${d}/${b?"advanced-chat/":""}workflows/draft/iteration/nodes/${e}/run`,"getLoopSingleNodeRunUrl",0,(a,b,d,e)=>`${(0,c.getFlowPrefix)(a)}/${d}/${b?"advanced-chat/":""}workflows/draft/loop/nodes/${e}/run`,"singleNodeRun",0,(a,d,e,f)=>(0,b.post)(`${(0,c.getFlowPrefix)(a)}/${d}/workflows/draft/nodes/${e}/run`,{body:f}),"stopWorkflowRun",0,a=>(0,b.post)(a),"syncWorkflowDraft",0,({url:a,params:c})=>{let e=(a=>{let{graph:b}=a;if(!b?.nodes?.length)return a;let c=b.nodes.map(a=>{let b=(a=>{let b=a.data;if(!b||b.type!==d.BlockEnum.TriggerPlugin)return a;let c={type:d.BlockEnum.TriggerPlugin,title:b.title??"",desc:b.desc??"",plugin_id:b.plugin_id??"",provider_id:b.provider_id??"",event_name:b.event_name??"",subscription_id:b.subscription_id??"",plugin_unique_identifier:b.plugin_unique_identifier??"",event_parameters:"object"==typeof b.event_parameters&&null!==b.event_parameters?b.event_parameters:{}};return{...a,data:c}})(a);if(b.data?.type===d.BlockEnum.Start&&Array.isArray(b.data.variables)){let a={...b,data:{...b.data}};return a.data.variables=b.data.variables.map(a=>{if(a&&"json_object"===a.type&&"string"==typeof a.json_schema)try{let b=JSON.parse(a.json_schema);return{...a,json_schema:b}}catch{}return a}),a}return b});return{...a,graph:{...b,nodes:c}}})(c);return(0,b.post)(a,{body:e},{silent:!0})}],24561)},415464,a=>{"use strict";var b=a.i(435133),c=a.i(127406);b.default.extend(c.default),a.s(["formatTime",0,({date:a,dateFormat:c})=>(0,b.default)(a).format(c),"getDaysUntilEndOfMonth",0,(a=(0,b.default)())=>{let c=(0,b.default)(a).startOf("day");return Math.max((0,b.default)(a).endOf("month").startOf("day").diff(c,"day"),0)},"isAfter",0,(a,c)=>(0,b.default)(a).isAfter((0,b.default)(c))])},198038,a=>{"use strict";var b=a.i(57843),c=a.i(429264),d=a.i(936557);a.s(["default",0,function(a){d.default&&!(0,c.isFunction)(a)&&console.error('useMount: parameter `fn` expected to be a function, but got "'.concat(typeof a,'".')),(0,b.useEffect)(function(){var b=null==a?void 0:a();if(!b||"object"!=typeof b||"function"!=typeof b.then)return b},[])}])},26354,a=>{"use strict";a.i(858364),a.s([])},87208,a=>{"use strict";var b=a.i(57843);a.s(["useAsyncWindowOpen",0,()=>(0,b.useCallback)(async(a,b)=>{let{immediateUrl:c,target:d="_blank",features:e,onError:f}=b??{},g=e?`${e},noopener,noreferrer`:"noopener,noreferrer";if(c){let a=window.open(c,d,g);if(!a)return void f?.(Error("Failed to open new window"));try{a.opener=null}catch{}return}let h=window.open("about:blank",d,e);if(!h)return void f?.(Error("Failed to open new window"));try{h.opener=null}catch{}try{let b=await a();if(b){h.location.href=b;return}h.close(),f?.(Error("No url resolved for new window"))}catch(a){h.close(),f?.(a instanceof Error?a:Error(String(a)))}},[])])},934176,a=>{"use strict";var b=a.i(999590);a.s(["Tag01",()=>b.default])},14669,a=>{"use strict";var b=a.i(608061),c=a.i(527344);a.s(["default",0,({className:a,value:d,onChange:e,options:f})=>(0,b.jsx)("div",{className:(0,c.cn)(a,"relative flex"),children:f.map(a=>(0,b.jsxs)("div",{onClick:()=>e(a.value),className:(0,c.cn)("mr-1 flex h-[32px] cursor-pointer items-center rounded-lg border-[0.5px] border-transparent px-3 py-[7px] text-[13px] font-medium leading-[18px] text-text-tertiary hover:bg-state-base-hover",d===a.value&&"border-components-main-nav-nav-button-border bg-state-base-hover text-components-main-nav-nav-button-text-active shadow-xs"),children:[a.icon,a.text]},a.value))})])},596078,a=>{"use strict";var b=a.i(981133),c=a.i(411171),d=a.i(435133),e=a.i(971335),f=a.i(127406),g=a.i(533306),h=a.i(57843),i=a.i(933887),j=a.i(705134),k=a.i(29255),l=a.i(375616),m=a.i(800034),n=a.i(263477);d.default.extend(f.default),d.default.extend(e.default);let o=(a,b)=>{if(!a||!b)return!1;let c=(0,d.default)().tz(b).startOf("day"),e=d.default.unix(a).tz(b).startOf("day");return c.isSame(e)||c.isAfter(e)};a.s(["useEducation",0,()=>{let{mutateAsync:a,isPending:c,data:d}=(0,m.useEducationAutocomplete)(),[e,f]=(0,h.useState)([]),g=(0,h.useCallback)(b=>{b.keywords&&a(b).then(a=>{let c=b.page||0,d=a.data;c>0?f(a=>[...a||[],...d]):f(d)})},[a]),{run:i}=(0,b.useDebounceFn)(a=>{g(a)},{wait:300});return{schools:e,setSchools:f,querySchoolsWithDebounced:i,handleUpdateSchools:g,isLoading:c,hasNext:d?.has_next}},"useEducationInit",0,()=>{let a=(0,k.useModalContextSelector)(a=>a.setShowAccountSettingModal),b=(0,k.useModalContextSelector)(a=>a.setShowEducationExpireNoticeModal),d=localStorage.getItem(n.EDUCATION_VERIFYING_LOCALSTORAGE_ITEM),e=(0,g.useSearchParams)().get("action");(({onNotice:a})=>{let{userProfile:{timezone:b}}=(0,j.useAppContext)(),{educationAccountExpireAt:d,allowRefreshEducationVerify:e,isLoadingEducationAccountInfo:f}=(0,l.useProviderContext)(),[g,i]=(0,c.useLocalStorageState)("education-reverify-prev-expire-at",{defaultValue:0}),[k,m]=(0,c.useLocalStorageState)("education-reverify-has-noticed",{defaultValue:!1}),[n,p]=(0,c.useLocalStorageState)("education-expired-has-noticed",{defaultValue:!1});return(0,h.useEffect)(()=>{if(!f&&b&&e){let c=o(d,b),e=g!==d;e&&(i(d),m(!1),p(!1)),!e&&(c?n:k)||(a({expireAt:d,expired:c}),c?p(!0):m(!0))}},[e,b]),o(d,b)})({onNotice:a=>{b({payload:a})}});let f=(0,g.useRouter)(),{mutateAsync:p}=(0,m.useEducationVerify)(),q=async()=>{let{token:a}=await p();a&&f.push(`/education-apply?token=${a}`)};(0,h.useEffect)(()=>{("yes"===d||e===n.EDUCATION_VERIFY_URL_SEARCHPARAMS_ACTION)&&(a({payload:i.ACCOUNT_SETTING_TAB.BILLING}),e===n.EDUCATION_VERIFY_URL_SEARCHPARAMS_ACTION&&localStorage.setItem(n.EDUCATION_VERIFYING_LOCALSTORAGE_ITEM,"yes")),e===n.EDUCATION_RE_VERIFY_ACTION&&q()},[a,d,e])}])},302547,a=>{"use strict";let b=(0,a.i(282791).create)(a=>({tagList:[],setTagList:b=>a(()=>({tagList:b})),showTagManagementModal:!1,setShowTagManagementModal:b=>a(()=>({showTagManagementModal:b}))}));a.s(["useStore",0,b])},546614,a=>{"use strict";var b=a.i(198038);a.s(["useMount",()=>b.default])},199516,a=>{"use strict";var b=a.i(41511);a.s(["bindTag",0,(a,c,d)=>(0,b.post)("/tag-bindings/create",{body:{tag_ids:a,target_id:c,type:d}}),"createTag",0,(a,c)=>(0,b.post)("/tags",{body:{name:a,type:c}}),"deleteTag",0,a=>(0,b.del)(`/tags/${a}`),"fetchTagList",0,a=>(0,b.get)("/tags",{params:{type:a}}),"unBindTag",0,(a,c,d)=>(0,b.post)("/tag-bindings/remove",{body:{tag_id:a,target_id:c,type:d}}),"updateTag",0,(a,c)=>(0,b.patch)(`/tags/${a}`,{body:{name:c}})])},162962,742929,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(981133),e=a.i(546614),f=a.i(57843);a.i(752298);var g=a.i(693025);a.i(284909);var h=a.i(934176),i=a.i(232082);a.i(622666);var j=a.i(332945);a.i(658335);var k=a.i(555766),l=a.i(816134),m=a.i(825319),n=a.i(199516),o=a.i(527344),p=a.i(302547);a.s(["default",0,({type:a,value:q,onChange:r})=>{let{t:s}=(0,g.useTranslation)(),[t,u]=(0,f.useState)(!1),v=(0,p.useStore)(a=>a.tagList),w=(0,p.useStore)(a=>a.setTagList),x=(0,p.useStore)(a=>a.setShowTagManagementModal),[y,z]=(0,f.useState)(""),[A,B]=(0,f.useState)(""),{run:C}=(0,d.useDebounceFn)(()=>{B(y)},{wait:500}),D=a=>{z(a),C()},E=(0,f.useMemo)(()=>v.filter(b=>b.type===a&&b.name.includes(A)),[a,v,A]),F=(0,f.useMemo)(()=>v.find(a=>a.id===q[0]),[q,v]);return(0,e.useMount)(()=>{(0,n.fetchTagList)(a).then(a=>{w(a)})}),(0,b.jsx)(m.PortalToFollowElem,{open:t,onOpenChange:u,placement:"bottom-start",offset:4,children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(m.PortalToFollowElemTrigger,{onClick:()=>u(a=>!a),className:"block",children:(0,b.jsxs)("div",{className:(0,o.cn)("flex h-8 cursor-pointer select-none items-center gap-1 rounded-lg border-[0.5px] border-transparent bg-components-input-bg-normal px-2",!t&&!!q.length&&"shadow-xs",t&&!!q.length&&"shadow-xs"),children:[(0,b.jsx)("div",{className:"p-[1px]",children:(0,b.jsx)(h.Tag01,{className:"h-3.5 w-3.5 text-text-tertiary"})}),(0,b.jsxs)("div",{className:"text-[13px] leading-[18px] text-text-secondary",children:[!q.length&&s("tag.placeholder",{ns:"common"}),!!q.length&&F?.name]}),q.length>1&&(0,b.jsx)("div",{className:"text-xs font-medium leading-[18px] text-text-tertiary",children:`+${q.length-1}`}),!q.length&&(0,b.jsx)("div",{className:"p-[1px]",children:(0,b.jsx)(c.RiArrowDownSLine,{className:"h-3.5 w-3.5 text-text-tertiary"})}),!!q.length&&(0,b.jsx)("div",{className:"group/clear cursor-pointer p-[1px]",onClick:a=>{a.stopPropagation(),r([])},children:(0,b.jsx)(k.XCircle,{className:"h-3.5 w-3.5 text-text-tertiary group-hover/clear:text-text-secondary"})})]})}),(0,b.jsx)(m.PortalToFollowElemContent,{className:"z-[1002]",children:(0,b.jsxs)("div",{className:"relative w-[240px] rounded-lg border-[0.5px] border-components-panel-border bg-components-panel-bg-blur shadow-lg backdrop-blur-[5px]",children:[(0,b.jsx)("div",{className:"p-2",children:(0,b.jsx)(l.default,{showLeftIcon:!0,showClearIcon:!0,value:y,onChange:a=>D(a.target.value),onClear:()=>D("")})}),(0,b.jsxs)("div",{className:"max-h-72 overflow-auto p-1",children:[E.map(a=>(0,b.jsxs)("div",{className:"flex cursor-pointer select-none items-center gap-2 rounded-lg py-[6px] pl-3 pr-2 hover:bg-state-base-hover",onClick:()=>{q.includes(a.id)?r(q.filter(b=>b!==a.id)):r([...q,a.id])},children:[(0,b.jsx)("div",{title:a.name,className:"grow truncate text-sm leading-5 text-text-tertiary",children:a.name}),q.includes(a.id)&&(0,b.jsx)(j.Check,{className:"h-4 w-4 shrink-0 text-text-secondary"})]},a.id)),!E.length&&(0,b.jsxs)("div",{className:"flex flex-col items-center gap-1 p-3",children:[(0,b.jsx)(i.Tag03,{className:"h-6 w-6 text-text-tertiary"}),(0,b.jsx)("div",{className:"text-xs leading-[14px] text-text-tertiary",children:s("tag.noTag",{ns:"common"})})]})]}),(0,b.jsx)("div",{className:"border-t-[0.5px] border-divider-regular"}),(0,b.jsx)("div",{className:"p-1",children:(0,b.jsxs)("div",{className:"flex cursor-pointer select-none items-center gap-2 rounded-lg py-[6px] pl-3 pr-2 hover:bg-state-base-hover",onClick:()=>{x(!0),u(!1)},children:[(0,b.jsx)(i.Tag03,{className:"h-4 w-4 text-text-tertiary"}),(0,b.jsx)("div",{className:"grow truncate text-sm leading-5 text-text-secondary",children:s("tag.manageTags",{ns:"common"})})]})})]})})]})})}],162962);var q=a.i(234782),r=a.i(314608),s=a.i(111089),t=a.i(639378),u=a.i(168799),v=a.i(757801),w=a.i(114715);let x=f.memo(a=>{let{t:d}=(0,g.useTranslation)(),{notify:e}=(0,t.useContext)(w.ToastContext),{targetID:h,type:i,value:j,selectedTags:k,onCacheUpdate:m,onChange:o,onCreate:q}=a,x=(0,p.useStore)(a=>a.tagList),y=(0,p.useStore)(a=>a.setTagList),z=(0,p.useStore)(a=>a.setShowTagManagementModal),[A,B]=(0,f.useState)(j),[C,D]=(0,f.useState)(""),E=a=>{D(a)},F=(0,f.useMemo)(()=>x.every(a=>a.type===i&&a.name!==C),[i,x,C]),G=(0,f.useMemo)(()=>k.filter(a=>a.name.includes(C)),[C,k]),H=(0,f.useMemo)(()=>x.filter(a=>a.type===i&&!j.includes(a.id)&&a.name.includes(C)),[i,x,j,C]),[I,J]=(0,f.useState)(!1),K=async()=>{if(C&&!I)try{J(!0);let a=await (0,n.createTag)(C,i);e({type:"success",message:d("tag.created",{ns:"common"})}),y([...x,a]),D(""),J(!1),q()}catch{e({type:"error",message:d("tag.failed",{ns:"common"})}),J(!1)}},L=async a=>{try{await (0,n.bindTag)(a,h,i),e({type:"success",message:d("actionMsg.modifiedSuccessfully",{ns:"common"})})}catch{e({type:"error",message:d("actionMsg.modifiedUnsuccessfully",{ns:"common"})})}},M=async a=>{try{await (0,n.unBindTag)(a,h,i),e({type:"success",message:d("actionMsg.modifiedSuccessfully",{ns:"common"})})}catch{e({type:"error",message:d("actionMsg.modifiedUnsuccessfully",{ns:"common"})})}},N=a=>{A.includes(a.id)?B(A.filter(b=>b!==a.id)):B([...A,a.id])},O=(0,f.useMemo)(()=>j.length===A.length&&j.every(a=>A.includes(a))&&A.every(a=>j.includes(a)),[j,A]);return(0,r.useUnmount)(()=>{if(!O){let a,b,c;a=A.filter(a=>!j.includes(a)),b=j.filter(a=>!A.includes(a)),m(x.filter(a=>A.includes(a.id))),c=[],a.length&&c.push(L(a)),b.length&&c.push(...b.map(a=>M(a))),Promise.all(c).finally(()=>{o&&o()})}}),(0,b.jsxs)("div",{className:"relative w-full rounded-lg border-[0.5px] border-components-panel-border bg-components-panel-bg-blur",children:[(0,b.jsx)("div",{className:"p-2 pb-1",children:(0,b.jsx)(l.default,{showLeftIcon:!0,showClearIcon:!0,value:C,placeholder:d("tag.selectorPlaceholder",{ns:"common"})||"",onChange:a=>E(a.target.value),onClear:()=>E("")})}),C&&F&&(0,b.jsx)("div",{className:"p-1",children:(0,b.jsxs)("div",{className:"flex cursor-pointer items-center gap-x-1 rounded-lg px-2 py-1.5 hover:bg-state-base-hover",onClick:K,children:[(0,b.jsx)(c.RiAddLine,{className:"h-4 w-4 text-text-tertiary"}),(0,b.jsxs)("div",{className:"system-md-regular grow truncate px-1 text-text-secondary",children:[`${d("tag.create",{ns:"common"})} `,(0,b.jsx)("span",{className:"system-md-medium",children:`'${C}'`})]})]})}),C&&F&&H.length>0&&(0,b.jsx)(v.default,{type:"horizontal",className:"my-0 h-px bg-divider-subtle"}),(H.length>0||G.length>0)&&(0,b.jsxs)("div",{className:"max-h-[232px] overflow-y-auto p-1",children:[G.map(a=>(0,b.jsxs)("div",{className:"flex cursor-pointer items-center gap-x-1 rounded-lg px-2 py-1.5 hover:bg-state-base-hover",onClick:()=>N(a),children:[(0,b.jsx)(u.default,{className:"shrink-0",checked:A.includes(a.id),onCheck:s.noop}),(0,b.jsx)("div",{title:a.name,className:"system-md-regular grow truncate px-1 text-text-secondary",children:a.name})]},a.id)),H.map(a=>(0,b.jsxs)("div",{className:"flex cursor-pointer items-center gap-x-1 rounded-lg px-2 py-1.5 hover:bg-state-base-hover",onClick:()=>N(a),children:[(0,b.jsx)(u.default,{className:"shrink-0",checked:A.includes(a.id),onCheck:s.noop}),(0,b.jsx)("div",{title:a.name,className:"system-md-regular grow truncate px-1 text-text-secondary",children:a.name})]},a.id))]}),!C&&!H.length&&!G.length&&(0,b.jsx)("div",{className:"p-1",children:(0,b.jsxs)("div",{className:"flex flex-col items-center gap-y-1 p-3",children:[(0,b.jsx)(c.RiPriceTag3Line,{className:"h-6 w-6 text-text-quaternary"}),(0,b.jsx)("div",{className:"system-xs-regular text-text-tertiary",children:d("tag.noTag",{ns:"common"})})]})}),(0,b.jsx)(v.default,{type:"horizontal",className:"my-0 h-px bg-divider-subtle"}),(0,b.jsx)("div",{className:"p-1",children:(0,b.jsxs)("div",{className:"flex cursor-pointer items-center gap-x-1 rounded-lg px-2 py-1.5 hover:bg-state-base-hover",onClick:()=>z(!0),children:[(0,b.jsx)(c.RiPriceTag3Line,{className:"h-4 w-4 text-text-tertiary"}),(0,b.jsx)("div",{className:"system-md-regular grow truncate px-1 text-text-secondary",children:d("tag.manageTags",{ns:"common"})})]})})]})}),y=f.memo(({tags:a})=>{let{t:d}=(0,g.useTranslation)();return(0,b.jsx)("div",{className:"flex w-full cursor-pointer items-center gap-1 overflow-hidden rounded-lg p-1 hover:bg-state-base-hover",children:a.length?(0,b.jsx)(b.Fragment,{children:a.map((a,d)=>(0,b.jsxs)("div",{className:"flex items-center gap-x-0.5 rounded-[5px] border border-divider-deep bg-components-badge-bg-dimm px-[5px] py-[3px]",children:[(0,b.jsx)(c.RiPriceTag3Line,{className:"h-3 w-3 shrink-0 text-text-quaternary"}),(0,b.jsx)("div",{className:"system-2xs-medium-uppercase text-nowrap text-text-tertiary",children:a})]},d))}):(0,b.jsxs)("div",{className:"flex items-center gap-x-0.5 rounded-[5px] border border-dashed border-divider-deep bg-components-badge-bg-dimm px-[5px] py-[3px]",children:[(0,b.jsx)(c.RiPriceTag3Line,{className:"h-3 w-3 shrink-0 text-text-quaternary"}),(0,b.jsx)("div",{className:"system-2xs-medium-uppercase text-nowrap text-text-tertiary",children:d("tag.addTag",{ns:"common"})})]})})});a.s(["default",0,({targetID:a,isPopover:c=!0,position:d,type:e,value:g,selectedTags:h,onCacheUpdate:i,onChange:j,minWidth:k})=>{let l=(0,p.useStore)(a=>a.tagList),m=(0,p.useStore)(a=>a.setTagList),r=(0,f.useCallback)(async()=>{m(await (0,n.fetchTagList)(e))},[m,e]),s=(0,f.useMemo)(()=>h?.length?h.filter(a=>l.find(b=>b.id===a.id)).map(a=>a.name):[],[h,l]);return(0,b.jsx)(b.Fragment,{children:c&&(0,b.jsx)(q.default,{htmlContent:(0,b.jsx)(x,{type:e,targetID:a,value:g,selectedTags:h,onCacheUpdate:i,onChange:j,onCreate:r}),position:d,trigger:"click",btnElement:(0,b.jsx)(y,{tags:s}),btnClassName:a=>(0,o.cn)(a?"!bg-state-base-hover !text-text-secondary":"!bg-transparent","!w-full !border-0 !p-0 !text-text-tertiary hover:!bg-state-base-hover hover:!text-text-secondary"),popupClassName:(0,o.cn)("!w-full !ring-0",k&&"!min-w-80"),className:"!z-20 h-fit !w-full"})})}],742929)},69419,a=>{a.v(a=>Promise.resolve().then(()=>a(9575)))}];

//# sourceMappingURL=_d67fbb0f._.js.map