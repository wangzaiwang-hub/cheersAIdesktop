module.exports=[968659,a=>{"use strict";var b=a.i(57843);function c(){return(c=Object.assign.bind()).apply(null,arguments)}a.i(608061);var d=["shift","alt","meta","mod","ctrl"],e={esc:"escape",return:"enter",".":"period",",":"comma","-":"slash"," ":"space","`":"backquote","#":"backslash","+":"bracketright",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function f(a){return(a&&e[a]||a||"").trim().toLowerCase().replace(/key|digit|numpad|arrow/,"")}function g(a,b){return void 0===b&&(b=","),a.split(b)}function h(a,b,e){void 0===b&&(b="+");var g=a.toLocaleLowerCase().split(b).map(function(a){return f(a)}),h={alt:g.includes("alt"),ctrl:g.includes("ctrl")||g.includes("control"),shift:g.includes("shift"),meta:g.includes("meta"),mod:g.includes("mod")},i=g.filter(function(a){return!d.includes(a)});return c({},h,{keys:i,description:e,hotkey:a})}"u">typeof document&&(document.addEventListener("keydown",function(a){void 0!==a.key&&k([f(a.key),f(a.code)])}),document.addEventListener("keyup",function(a){void 0!==a.key&&l([f(a.key),f(a.code)])}));var i=new Set;function j(a){return Array.isArray(a)}function k(a){var b=Array.isArray(a)?a:[a];i.has("meta")&&i.forEach(function(a){return!d.includes(a)&&i.delete(a.toLowerCase())}),b.forEach(function(a){return i.add(a.toLowerCase())})}function l(a){var b=Array.isArray(a)?a:[a];"meta"===a?i.clear():b.forEach(function(a){return i.delete(a.toLowerCase())})}function m(a,b){void 0===b&&(b=!1);var c,d=a.target,e=a.composed,f=null;return(f=(c=d).tagName&&!c.tagName.startsWith("-")&&c.tagName.includes("-")&&e?a.composedPath()[0]&&a.composedPath()[0].tagName:d&&d.tagName,j(b))?!!(f&&b&&b.some(function(a){var b;return a.toLowerCase()===(null==(b=f)?void 0:b.toLowerCase())})):!!(f&&b&&b)}var n=function(a,b,c){void 0===c&&(c=!1);var d,e=b.alt,g=b.meta,h=b.mod,k=b.shift,l=b.ctrl,m=b.keys,n=a.key,o=a.code,p=a.ctrlKey,q=a.metaKey,r=a.shiftKey,s=a.altKey,t=f(o),u=n.toLowerCase();if(!(null!=m&&m.includes(t))&&!(null!=m&&m.includes(u))&&!["ctrl","control","unknown","meta","alt","shift","os"].includes(t))return!1;if(!c){if(!s===e&&"alt"!==u||!r===k&&"shift"!==u)return!1;if(h){if(!q&&!p)return!1}else if(!q===g&&"meta"!==u&&"os"!==u||!p===l&&"ctrl"!==u&&"control"!==u)return!1}return!!(m&&1===m.length&&(m.includes(u)||m.includes(t)))||(m?(void 0===d&&(d=","),(j(m)?m:m.split(d)).every(function(a){return i.has(a.trim().toLowerCase())})):!m||!1)},o=(0,b.createContext)(void 0),p=(0,b.createContext)({hotkeys:[],enabledScopes:[],toggleScope:function(){},enableScope:function(){},disableScope:function(){}}),q=function(a){a.stopPropagation(),a.preventDefault(),a.stopImmediatePropagation()},r=b.useEffect;function s(a,c,d,e){var i,s=(0,b.useState)(null),t=s[0],u=s[1],v=(0,b.useRef)(!1),w=d instanceof Array?e instanceof Array?void 0:e:d,x=j(a)?a.join(null==w?void 0:w.splitKey):a,y=d instanceof Array?d:e instanceof Array?e:void 0,z=(0,b.useCallback)(c,null!=y?y:[]),A=(0,b.useRef)(z);y?A.current=z:A.current=c;var B=(!function a(b,c){return b&&c&&"object"==typeof b&&"object"==typeof c?Object.keys(b).length===Object.keys(c).length&&Object.keys(b).reduce(function(d,e){return d&&a(b[e],c[e])},!0):b===c}((i=(0,b.useRef)(void 0)).current,w)&&(i.current=w),i.current),C=(0,b.useContext)(p).enabledScopes,D=(0,b.useContext)(o);return r(function(){var a;if((null==B?void 0:B.enabled)!==!1&&(a=null==B?void 0:B.scopes,0===C.length&&a?(console.warn('A hotkey has the "scopes" option set, however no active scopes were found. If you want to use the global scopes feature, you need to wrap your app in a <HotkeysProvider>'),!0):!a||C.some(function(b){return a.includes(b)})||C.includes("*"))){var b=function(a,b){var c;if(void 0===b&&(b=!1),!m(a,["input","textarea","select"])||m(a,null==B?void 0:B.enableOnFormTags)){if(null!==t){var d=t.getRootNode();if((d instanceof Document||d instanceof ShadowRoot)&&d.activeElement!==t&&!t.contains(d.activeElement))return void q(a)}(null==(c=a.target)||!c.isContentEditable||null!=B&&B.enableOnContentEditable)&&g(x,null==B?void 0:B.splitKey).forEach(function(c){var d,e,f,g=h(c,null==B?void 0:B.combinationKey);if(n(a,g,null==B?void 0:B.ignoreModifiers)||null!=(f=g.keys)&&f.includes("*")){if(null!=B&&null!=B.ignoreEventWhen&&B.ignoreEventWhen(a)||b&&v.current)return;if(("function"==typeof(d=null==B?void 0:B.preventDefault)&&d(a,g)||!0===d)&&a.preventDefault(),"function"==typeof(e=null==B?void 0:B.enabled)?!e(a,g):!0!==e&&void 0!==e)return void q(a);A.current(a,g),b||(v.current=!0)}})}},c=function(a){void 0!==a.key&&(k(f(a.code)),((null==B?void 0:B.keydown)===void 0&&(null==B?void 0:B.keyup)!==!0||null!=B&&B.keydown)&&b(a))},d=function(a){void 0!==a.key&&(l(f(a.code)),v.current=!1,null!=B&&B.keyup&&b(a,!0))},e=t||(null==w?void 0:w.document)||document;return e.addEventListener("keyup",d,null==w?void 0:w.eventListenerOptions),e.addEventListener("keydown",c,null==w?void 0:w.eventListenerOptions),D&&g(x,null==B?void 0:B.splitKey).forEach(function(a){return D.addHotkey(h(a,null==B?void 0:B.combinationKey,null==B?void 0:B.description))}),function(){e.removeEventListener("keyup",d,null==w?void 0:w.eventListenerOptions),e.removeEventListener("keydown",c,null==w?void 0:w.eventListenerOptions),D&&g(x,null==B?void 0:B.splitKey).forEach(function(a){return D.removeHotkey(h(a,null==B?void 0:B.combinationKey,null==B?void 0:B.description))})}}},[t,x,B,C]),u}a.s(["useHotkeys",()=>s])},527858,a=>{"use strict";var b=a.i(608061),c=a.i(527344);a.s(["default",0,({imageUrl:a,className:d,alt:e,onLoad:f,onError:g,showDownloadAction:h})=>(0,b.jsx)("div",{className:(0,c.cn)("border-[2px] border-effects-image-frame shadow-xs",d),children:(0,b.jsx)("img",{className:(0,c.cn)("h-full w-full object-cover",h&&"cursor-pointer"),alt:e||"Preview",onLoad:f,onError:g,src:a})})])},734766,a=>{"use strict";var b=a.i(763043);a.s(["ReplayLine",()=>b.default])},744383,a=>{"use strict";var b=a.i(608061),c=a.i(57843),d=a.i(527344);let e=(0,c.memo)(({className:a,percentage:c=0,size:e=12,circleStrokeWidth:f=1,circleStrokeColor:g="stroke-components-progress-brand-border",circleFillColor:h="fill-components-progress-brand-bg",sectorFillColor:i="fill-components-progress-brand-progress"})=>{let j=e/2,k=e/2,l=c/101*360*Math.PI/180,m=k+j*Math.cos(l-Math.PI/2),n=k+j*Math.sin(l-Math.PI/2),o=`
    M ${k},${k}
    L ${k},${k-j}
    A ${j},${j} 0 ${+(c>50)} 1 ${m},${n}
    Z
  `;return(0,b.jsxs)("svg",{width:e+f,height:e+f,viewBox:`0 0 ${e+f} ${e+f}`,className:a,children:[(0,b.jsx)("circle",{className:(0,d.cn)(h,g),cx:k+f/2,cy:k+f/2,r:j,strokeWidth:f}),(0,b.jsx)("path",{className:(0,d.cn)(i),d:o,transform:`translate(${f/2}, ${f/2})`})]})});a.s(["default",0,e])},291093,a=>{"use strict";a.s(["AUDIO_SIZE_LIMIT",0,0x3200000,"FILE_SIZE_LIMIT",0,0xf00000,"FILE_URL_REGEX",0,/^(https?|ftp):\/\//,"IMG_SIZE_LIMIT",0,0xa00000,"MAX_FILE_UPLOAD_LIMIT",0,10,"VIDEO_SIZE_LIMIT",0,0x6400000])},217553,a=>{"use strict";function b(a){if(!a||"object"!=typeof a)return!1;let b=Object.getPrototypeOf(a);return(null===b||b===Object.prototype||null===Object.getPrototypeOf(b))&&"[object Object]"===Object.prototype.toString.call(a)}var c=a.i(342557),d=a.i(633980),e=a.i(123739),f=a.i(960337),g=a.i(111089);function h(a,h){return function a(g,h,i,j,k,l,m){let n=m(g,h,i,j,k,l);if(void 0!==n)return n;if(typeof g==typeof h)switch(typeof g){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return g===h;case"number":return g===h||Object.is(g,h)}return function g(h,i,j,k){if(Object.is(h,i))return!0;let l=(0,d.getTag)(h),m=(0,d.getTag)(i);if(l===e.argumentsTag&&(l=e.objectTag),m===e.argumentsTag&&(m=e.objectTag),l!==m)return!1;switch(l){case e.stringTag:return h.toString()===i.toString();case e.numberTag:{let a=h.valueOf(),b=i.valueOf();return(0,f.eq)(a,b)}case e.booleanTag:case e.dateTag:case e.symbolTag:return Object.is(h.valueOf(),i.valueOf());case e.regexpTag:return h.source===i.source&&h.flags===i.flags;case e.functionTag:return h===i}let n=(j=j??new Map).get(h),o=j.get(i);if(null!=n&&null!=o)return n===i;j.set(h,i),j.set(i,h);try{switch(l){case e.mapTag:if(h.size!==i.size)return!1;for(let[b,c]of h.entries())if(!i.has(b)||!a(c,i.get(b),b,h,i,j,k))return!1;return!0;case e.setTag:{if(h.size!==i.size)return!1;let b=Array.from(h.values()),c=Array.from(i.values());for(let d=0;d<b.length;d++){let e=b[d],f=c.findIndex(b=>a(e,b,void 0,h,i,j,k));if(-1===f)return!1;c.splice(f,1)}return!0}case e.arrayTag:case e.uint8ArrayTag:case e.uint8ClampedArrayTag:case e.uint16ArrayTag:case e.uint32ArrayTag:case e.bigUint64ArrayTag:case e.int8ArrayTag:case e.int16ArrayTag:case e.int32ArrayTag:case e.bigInt64ArrayTag:case e.float32ArrayTag:case e.float64ArrayTag:if("u">typeof Buffer&&Buffer.isBuffer(h)!==Buffer.isBuffer(i)||h.length!==i.length)return!1;for(let b=0;b<h.length;b++)if(!a(h[b],i[b],b,h,i,j,k))return!1;return!0;case e.arrayBufferTag:if(h.byteLength!==i.byteLength)return!1;return g(new Uint8Array(h),new Uint8Array(i),j,k);case e.dataViewTag:if(h.byteLength!==i.byteLength||h.byteOffset!==i.byteOffset)return!1;return g(new Uint8Array(h),new Uint8Array(i),j,k);case e.errorTag:return h.name===i.name&&h.message===i.message;case e.objectTag:{if(!(g(h.constructor,i.constructor,j,k)||b(h)&&b(i)))return!1;let d=[...Object.keys(h),...(0,c.getSymbols)(h)],e=[...Object.keys(i),...(0,c.getSymbols)(i)];if(d.length!==e.length)return!1;for(let b=0;b<d.length;b++){let c=d[b],e=h[c];if(!Object.hasOwn(i,c))return!1;let f=i[c];if(!a(e,f,c,h,i,j,k))return!1}return!0}default:return!1}}finally{j.delete(h),j.delete(i)}}(g,h,l,m)}(a,h,void 0,void 0,void 0,void 0,g.noop)}a.s(["isEqual",()=>h],217553)},183763,312224,220583,675694,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(57843);a.i(752298);var e=a.i(693025),f=a.i(909795),g=a.i(825319),h=a.i(527344),i=a.i(291093),j=a.i(938409),k=a.i(735310),l=a.i(111089),m=a.i(494261),n=a.i(533306),o=a.i(44348),p=a.i(114715),q=a.i(9575),r=a.i(954200),s=a.i(573912),t=a.i(217553),u=a.i(282791);let v=(0,d.createContext)(null);function w(a){let b=(0,d.useContext)(v);if(!b)throw Error("Missing FileContext.Provider in the tree");return(0,u.useStore)(b,a)}let x=()=>(0,d.useContext)(v);a.s(["FileContextProvider",0,({children:a,value:c,onChange:e})=>{let f=(0,d.useRef)(void 0);return f.current||(f.current=((a=[],b)=>(0,u.create)(c=>({files:a?[...a]:[],setFiles:a=>{c({files:a}),b?.(a)}})))(c,e)),(0,d.useEffect)(()=>{!f.current||(0,t.isEqual)(c,f.current.getState().files)||f.current.setState({files:c?[...c]:[]})},[c]),(0,b.jsx)(v.Provider,{value:f.current,children:a})},"useFileStore",0,x,"useStore",()=>w],312224);var y=a.i(818386);let z=a=>{let b=1024*Number(a?.image_file_size_limit)*1024||i.IMG_SIZE_LIMIT,c=1024*Number(a?.file_size_limit)*1024||i.FILE_SIZE_LIMIT,d=1024*Number(a?.audio_file_size_limit)*1024||i.AUDIO_SIZE_LIMIT;return{imgSizeLimit:b,docSizeLimit:c,audioSizeLimit:d,videoSizeLimit:1024*Number(a?.video_file_size_limit)*1024||i.VIDEO_SIZE_LIMIT,maxFileUploadLimit:Number(a?.workflow_file_upload_limit)||i.MAX_FILE_UPLOAD_LIMIT}},A=(a,b=!0)=>{let{t:c}=(0,e.useTranslation)(),{notify:f}=(0,p.useToastContext)(),g=x(),h=(0,n.useParams)(),{imgSizeLimit:i,docSizeLimit:j,audioSizeLimit:t,videoSizeLimit:u}=z(a.fileUploadConfig),v=(0,d.useCallback)((a,b)=>{switch(a){case k.SupportUploadFileTypes.image:if(b>i)return f({type:"error",message:c("fileUploader.uploadFromComputerLimit",{ns:"common",type:k.SupportUploadFileTypes.image,size:(0,s.formatFileSize)(i)})}),!1;return!0;case k.SupportUploadFileTypes.custom:case k.SupportUploadFileTypes.document:if(b>j)return f({type:"error",message:c("fileUploader.uploadFromComputerLimit",{ns:"common",type:k.SupportUploadFileTypes.document,size:(0,s.formatFileSize)(j)})}),!1;return!0;case k.SupportUploadFileTypes.audio:if(b>t)return f({type:"error",message:c("fileUploader.uploadFromComputerLimit",{ns:"common",type:k.SupportUploadFileTypes.audio,size:(0,s.formatFileSize)(t)})}),!1;return!0;case k.SupportUploadFileTypes.video:if(b>u)return f({type:"error",message:c("fileUploader.uploadFromComputerLimit",{ns:"common",type:k.SupportUploadFileTypes.video,size:(0,s.formatFileSize)(u)})}),!1;return!0;default:return!0}},[t,j,i,f,c,u]),w=(0,d.useCallback)(a=>{let{files:b,setFiles:c}=g.getState();c((0,m.produce)(b,b=>{b.push(a)}))},[g]),A=(0,d.useCallback)(a=>{let{files:b,setFiles:c}=g.getState();c((0,m.produce)(b,b=>{let c=b.findIndex(b=>b.id===a.id);c>-1&&(b[c]=a)}))},[g]),B=(0,d.useCallback)(a=>{let{files:b,setFiles:c}=g.getState();c(b.filter(b=>b.id!==a))},[g]),C=(0,d.useCallback)(a=>{let{files:b,setFiles:d}=g.getState(),e=b.findIndex(b=>b.id===a);if(e>-1){let a=b[e];d((0,m.produce)(b,a=>{a[e].progress=0})),(0,y.fileUpload)({file:a.originalFile,onProgressCallback:b=>{A({...a,progress:b})},onSuccessCallback:b=>{A({...a,uploadedId:b.id,progress:100})},onErrorCallback:b=>{f({type:"error",message:(0,y.getFileUploadErrorMessage)(b,c("fileUploader.uploadFromComputerUploadError",{ns:"common"}),c)}),A({...a,progress:-1})}},!!h.token)}},[g,f,c,A,h]),D=(0,d.useCallback)(a=>{let b=setInterval(()=>{let c=g.getState().files.find(b=>b.id===a);c&&c.progress<80&&c.progress>=0?A({...c,progress:c.progress+20}):clearTimeout(b)},200)},[g,A]),E=(0,d.useCallback)(b=>{let d=a.allowed_file_types,e={id:(0,o.v4)(),name:b,type:"",size:0,progress:0,transferMethod:r.TransferMethod.remote_url,supportFileType:"",url:b,isRemote:!0};w(e),D(e.id),(0,q.uploadRemoteFileInfo)(b,!!h.token).then(b=>{let g={...e,type:b.mime_type,size:b.size,progress:100,supportFileType:(0,y.getSupportFileType)(b.name,b.mime_type,d?.includes(k.SupportUploadFileTypes.custom)),uploadedId:b.id,url:b.url};(0,y.isAllowedFileExtension)(b.name,b.mime_type,a.allowed_file_types||[],a.allowed_file_extensions||[])||(f({type:"error",message:`${c("fileUploader.fileExtensionNotSupport",{ns:"common"})} ${g.type}`}),B(e.id)),v(g.supportFileType,g.size)?A(g):B(e.id)}).catch(()=>{f({type:"error",message:c("fileUploader.pasteFileLinkInvalid",{ns:"common"})}),B(e.id)})},[v,w,A,f,c,B,a?.allowed_file_types,a.allowed_file_extensions,D,h.token]),F=(0,d.useCallback)(l.noop,[]),G=(0,d.useCallback)(l.noop,[]),H=(0,d.useCallback)(()=>{let{setFiles:a}=g.getState();a([])},[g]),I=(0,d.useCallback)(d=>{if(!b&&!a.enabled)return void f({type:"error",message:c("fileUploader.uploadDisabled",{ns:"common"})});if(!(0,y.isAllowedFileExtension)(d.name,d.type,a.allowed_file_types||[],a.allowed_file_extensions||[]))return void f({type:"error",message:`${c("fileUploader.fileExtensionNotSupport",{ns:"common"})} ${d.type}`});let e=a.allowed_file_types;if(!v((0,y.getSupportFileType)(d.name,d.type,e?.includes(k.SupportUploadFileTypes.custom)),d.size))return;let g=new FileReader,i=d.type.startsWith("image");g.addEventListener("load",()=>{let a={id:(0,o.v4)(),name:d.name,type:d.type,size:d.size,progress:0,transferMethod:r.TransferMethod.local_file,supportFileType:(0,y.getSupportFileType)(d.name,d.type,e?.includes(k.SupportUploadFileTypes.custom)),originalFile:d,base64Url:i?g.result:""};w(a),(0,y.fileUpload)({file:a.originalFile,onProgressCallback:b=>{A({...a,progress:b})},onSuccessCallback:b=>{A({...a,uploadedId:b.id,progress:100})},onErrorCallback:b=>{f({type:"error",message:(0,y.getFileUploadErrorMessage)(b,c("fileUploader.uploadFromComputerUploadError",{ns:"common"}),c)}),A({...a,progress:-1})}},!!h.token)},!1),g.addEventListener("error",()=>{f({type:"error",message:c("fileUploader.uploadFromComputerReadError",{ns:"common"})})},!1),g.readAsDataURL(d)},[b,v,f,c,w,A,h.token,a?.allowed_file_types,a?.allowed_file_extensions,a?.enabled]),J=(0,d.useCallback)(a=>{let b=a.clipboardData?.files[0],c=a.clipboardData?.getData("text/plain");b&&!c&&(a.preventDefault(),I(b))},[I]),[K,L]=(0,d.useState)(!1),M=(0,d.useCallback)(a=>{a.preventDefault(),a.stopPropagation(),L(!0)},[]),N=(0,d.useCallback)(a=>{a.preventDefault(),a.stopPropagation()},[]),O=(0,d.useCallback)(a=>{a.preventDefault(),a.stopPropagation(),L(!1)},[]),P=(0,d.useCallback)(a=>{a.preventDefault(),a.stopPropagation(),L(!1);let b=a.dataTransfer.files[0];b&&I(b)},[I]);return{handleAddFile:w,handleUpdateFile:A,handleRemoveFile:B,handleReUploadFile:C,handleLoadFileFromLink:E,handleLoadFileFromLinkSuccess:F,handleLoadFileFromLinkError:G,handleClearFiles:H,handleLocalFileUpload:I,handleClipboardPasteFile:J,isDragActive:K,handleDragFileEnter:M,handleDragFileOver:N,handleDragFileLeave:O,handleDropFile:P}};a.s(["useFile",0,A,"useFileSizeLimit",0,z],220583);let B=({fileConfig:a})=>{let c=w(a=>a.files),{handleLocalFileUpload:d}=A(a),e=a.allowed_file_types,f=(e?.includes(k.SupportUploadFileTypes.custom)?a.allowed_file_extensions||[]:(e?.map(a=>j.FILE_EXTS[a])||[]).flat().map(a=>`.${a}`)).join(",");return(0,b.jsx)("input",{className:"absolute inset-0 block w-full cursor-pointer text-[0] opacity-0 disabled:cursor-not-allowed",onClick:a=>a.target.value="",type:"file",onChange:b=>{let e=b.target.files;if(e)if(a.number_limits)for(let b=0;b<e.length;b++)b+1+c.length<=a.number_limits&&d(e[b]);else d(e[0])},accept:f,disabled:!!(a.number_limits&&c.length>=a?.number_limits),multiple:!!a.number_limits&&a.number_limits>1})};a.s(["default",0,B],675694);let C=(0,d.memo)(({showFromLink:a=!0,showFromLocal:j=!0,trigger:k,fileConfig:l})=>{let{t:m}=(0,e.useTranslation)(),n=w(a=>a.files),[o,p]=(0,d.useState)(!1),[q,r]=(0,d.useState)(""),[s,t]=(0,d.useState)(!1),{handleLoadFileFromLink:u}=A(l),v=!!l.number_limits&&n.length>=l.number_limits;return(0,b.jsxs)(g.PortalToFollowElem,{placement:"top",offset:4,open:o,onOpenChange:p,children:[(0,b.jsx)(g.PortalToFollowElemTrigger,{onClick:()=>p(a=>!a),asChild:!0,children:k(o)}),(0,b.jsx)(g.PortalToFollowElemContent,{className:"z-[1001]",children:(0,b.jsxs)("div",{className:"w-[280px] rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur p-3 shadow-lg",children:[a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:(0,h.cn)("flex h-8 items-center rounded-lg border border-components-input-border-active bg-components-input-bg-active p-1 shadow-xs",s&&"border-components-input-border-destructive"),children:[(0,b.jsx)("input",{className:"system-sm-regular mr-0.5 block grow appearance-none bg-transparent px-1 outline-none",placeholder:m("fileUploader.pasteFileLinkInputPlaceholder",{ns:"common"})||"",value:q,onChange:a=>{t(!1),r(a.target.value.trim())},disabled:v}),(0,b.jsx)(f.default,{className:"shrink-0",size:"small",variant:"primary",disabled:!q||v,onClick:()=>{if(q){if(!i.FILE_URL_REGEX.test(q))return void t(!0);u(q),r("")}},children:m("operation.ok",{ns:"common"})})]}),s&&(0,b.jsx)("div",{className:"body-xs-regular mt-0.5 text-text-destructive",children:m("fileUploader.pasteFileLinkInvalid",{ns:"common"})})]}),a&&j&&(0,b.jsxs)("div",{className:"system-2xs-medium-uppercase flex h-7 items-center p-2 text-text-quaternary",children:[(0,b.jsx)("div",{className:"mr-2 h-px w-[93px] bg-gradient-to-l from-[rgba(16,24,40,0.08)]"}),"OR",(0,b.jsx)("div",{className:"ml-2 h-px w-[93px] bg-gradient-to-r from-[rgba(16,24,40,0.08)]"})]}),j&&(0,b.jsxs)(f.default,{className:"relative w-full",variant:"secondary-accent",disabled:v,children:[(0,b.jsx)(c.RiUploadCloud2Line,{className:"mr-1 h-4 w-4"}),m("fileUploader.uploadFromComputer",{ns:"common"}),(0,b.jsx)(B,{fileConfig:l})]})]})})]})});a.s(["default",0,C],183763)},74801,a=>{"use strict";var b,c,d=((b={}).NewPage="new_page",b.CurrentPage="current_page",b),e=((c={}).moreLikeThis="moreLikeThis",c.opening="opening",c.suggested="suggested",c.text2speech="text2speech",c.speech2text="speech2text",c.citation="citation",c.moderation="moderation",c.file="file",c.annotationReply="annotationReply",c);a.s(["FeatureEnum",()=>e,"PreviewMode",()=>d])},530007,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(111089),e=a.i(934402),f=a.i(57843),g=a.i(555237),h=a.i(968659),i=a.i(114715),j=a.i(483664),k=a.i(760327);a.s(["default",0,({url:a,title:l,onCancel:m,onPrev:n,onNext:o})=>{let[p,q]=(0,f.useState)(1),[r,s]=(0,f.useState)({x:0,y:0}),[t,u]=(0,f.useState)(!1),v=(0,f.useRef)(null),w=(0,f.useRef)({x:0,y:0}),[x,y]=(0,f.useState)(!1),z=()=>{q(a=>Math.min(1.2*a,15))},A=()=>{q(a=>{let b=Math.max(a/1.2,.5);return 1===b&&s({x:0,y:0}),b})},B=(0,f.useCallback)(()=>{(async()=>{try{let b=a.split(",")[1],c=((a,b="image/png")=>{let c=atob(a),d=[];for(let a=0;a<c.length;a+=512){let b=c.slice(a,a+512),e=Array.from({length:b.length});for(let a=0;a<b.length;a++)e[a]=b.charCodeAt(a);let f=new Uint8Array(e);d.push(f)}return new Blob(d,{type:b})})(b,"image/png");await navigator.clipboard.write([new ClipboardItem({[c.type]:c})]),y(!0),i.default.notify({type:"success",message:(0,e.t)("operation.imageCopied",{ns:"common"})})}catch(b){console.error("Failed to copy image:",b),(0,k.downloadUrl)({url:a,fileName:`${l}.png`}),i.default.notify({type:"info",message:(0,e.t)("operation.imageDownloaded",{ns:"common"})})}})()},[l,a]),C=(0,f.useCallback)(a=>{a.deltaY<0?z():A()},[]),D=(0,f.useCallback)(a=>{p>1&&(u(!0),w.current={x:a.clientX-r.x,y:a.clientY-r.y})},[p,r]),E=(0,f.useCallback)(a=>{if(t&&p>1){let b=a.clientX-w.current.x,c=a.clientY-w.current.y,d=v.current?.getBoundingClientRect(),e=v.current?.parentElement?.getBoundingClientRect();if(d&&e){let a=(d.width*p-e.width)/2,f=(d.height*p-e.height)/2;s({x:Math.max(-a,Math.min(a,b)),y:Math.max(-f,Math.min(f,c))})}}},[t,p]),F=(0,f.useCallback)(()=>{u(!1)},[]);return(0,f.useEffect)(()=>(document.addEventListener("mouseup",F),()=>{document.removeEventListener("mouseup",F)}),[F]),(0,h.useHotkeys)("esc",m),(0,h.useHotkeys)("up",z),(0,h.useHotkeys)("down",A),(0,h.useHotkeys)("left",n||d.noop),(0,h.useHotkeys)("right",o||d.noop),(0,g.createPortal)((0,b.jsxs)("div",{className:"image-preview-container fixed inset-0 z-[1000] flex items-center justify-center bg-black/80 p-8",onClick:a=>a.stopPropagation(),onWheel:C,onMouseDown:D,onMouseMove:E,onMouseUp:F,style:{cursor:p>1?"move":"default"},tabIndex:-1,children:[(0,b.jsx)("img",{ref:v,alt:l,src:(a=>{try{return btoa(atob(a))===a}catch{return!1}})(a)?`data:image/png;base64,${a}`:a,className:"max-h-full max-w-full",style:{transform:`scale(${p}) translate(${r.x}px, ${r.y}px)`,transition:t?"none":"transform 0.2s ease-in-out"}}),(0,b.jsx)(j.default,{popupContent:(0,e.t)("operation.copyImage",{ns:"common"}),children:(0,b.jsx)("div",{className:"absolute right-48 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg",onClick:B,children:x?(0,b.jsx)(c.RiFileCopyLine,{className:"h-4 w-4 text-green-500"}):(0,b.jsx)(c.RiFileCopyLine,{className:"h-4 w-4 text-gray-500"})})}),(0,b.jsx)(j.default,{popupContent:(0,e.t)("operation.zoomOut",{ns:"common"}),children:(0,b.jsx)("div",{className:"absolute right-40 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg",onClick:A,children:(0,b.jsx)(c.RiZoomOutLine,{className:"h-4 w-4 text-gray-500"})})}),(0,b.jsx)(j.default,{popupContent:(0,e.t)("operation.zoomIn",{ns:"common"}),children:(0,b.jsx)("div",{className:"absolute right-32 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg",onClick:z,children:(0,b.jsx)(c.RiZoomInLine,{className:"h-4 w-4 text-gray-500"})})}),(0,b.jsx)(j.default,{popupContent:(0,e.t)("operation.download",{ns:"common"}),children:(0,b.jsx)("div",{className:"absolute right-24 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg",onClick:()=>{a.startsWith("http")||a.startsWith("https")||a.startsWith("data:image")?(0,k.downloadUrl)({url:a,fileName:l,target:"_blank"}):i.default.notify({type:"error",message:`Unable to open image: ${a}`})},children:(0,b.jsx)(c.RiDownloadCloud2Line,{className:"h-4 w-4 text-gray-500"})})}),(0,b.jsx)(j.default,{popupContent:(0,e.t)("operation.openInNewTab",{ns:"common"}),children:(0,b.jsx)("div",{className:"absolute right-16 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg",onClick:()=>{if(a.startsWith("http")||a.startsWith("https"))window.open(a,"_blank");else if(a.startsWith("data:image")){let b=window.open();b?.document.write(`<img src="${a}" alt="${l}" />`)}else i.default.notify({type:"error",message:`Unable to open image: ${a}`})},children:(0,b.jsx)(c.RiAddBoxLine,{className:"h-4 w-4 text-gray-500"})})}),(0,b.jsx)(j.default,{popupContent:(0,e.t)("operation.cancel",{ns:"common"}),children:(0,b.jsx)("div",{className:"absolute right-6 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg bg-white/8 backdrop-blur-[2px]",onClick:m,children:(0,b.jsx)(c.RiCloseLine,{className:"h-4 w-4 text-gray-500"})})})]}),document.body)}])},516465,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(57843),e=a.i(175809),f=a.i(74801);a.i(10035);var g=a.i(734766),h=a.i(530007),i=a.i(744383),j=a.i(735310),k=a.i(527344),l=a.i(760327),m=a.i(573912),n=a.i(527858),o=a.i(780442),p=a.i(818386);let q=(0,d.memo)(({file:a,showDeleteAction:q,showDownloadAction:r=!0,onRemove:s,onReUpload:t,canPreview:u,previewMode:v=f.PreviewMode.CurrentPage})=>{let{id:w,name:x,type:y,progress:z,supportFileType:A,base64Url:B,url:C,isRemote:D}=a,E=(0,p.getFileExtension)(x,y,D),F=A===j.SupportUploadFileTypes.image,[G,H]=(0,d.useState)("");return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:(0,k.cn)("flex h-12 items-center rounded-lg border-[0.5px] border-components-panel-border bg-components-panel-on-panel-item-bg pr-3 shadow-xs",-1===z&&"border-state-destructive-border bg-state-destructive-hover",u&&v===f.PreviewMode.NewPage&&"cursor-pointer"),onClick:()=>{u&&v===f.PreviewMode.NewPage&&window.open(C||B||"","_blank")},children:[(0,b.jsxs)("div",{className:"flex h-12 w-12 items-center justify-center",children:[F&&(0,b.jsx)(n.default,{className:"h-8 w-8",imageUrl:B||C||""}),!F&&(0,b.jsx)(o.default,{type:(0,p.getFileAppearanceType)(x,y),size:"xl"})]}),(0,b.jsxs)("div",{className:"mr-1 w-0 grow",children:[(0,b.jsx)("div",{className:"system-xs-medium mb-0.5 flex items-center truncate text-text-secondary",title:a.name,children:(0,b.jsx)("div",{className:"truncate",children:x})}),(0,b.jsxs)("div",{className:"system-2xs-medium-uppercase flex items-center text-text-tertiary",children:[E&&(0,b.jsx)("span",{children:E.toLowerCase()}),E&&(0,b.jsx)("span",{className:"system-2xs-medium mx-1",children:"•"}),!!a.size&&(0,b.jsx)("span",{children:(0,m.formatFileSize)(a.size)})]})]}),(0,b.jsxs)("div",{className:"flex shrink-0 items-center",children:[z>=0&&!(0,p.fileIsUploaded)(a)&&(0,b.jsx)(i.default,{className:"mr-2.5",percentage:z}),-1===z&&(0,b.jsx)(e.default,{className:"mr-1",onClick:()=>t?.(w),children:(0,b.jsx)(g.ReplayLine,{className:"h-4 w-4 text-text-tertiary"})}),q&&(0,b.jsx)(e.default,{onClick:()=>s?.(w),children:(0,b.jsx)(c.RiDeleteBinLine,{className:"h-4 w-4"})}),u&&F&&(0,b.jsx)(e.default,{className:"mr-1",onClick:()=>H(C||""),children:(0,b.jsx)(c.RiEyeLine,{className:"h-4 w-4"})}),r&&(0,b.jsx)(e.default,{onClick:a=>{a.stopPropagation(),(0,l.downloadUrl)({url:C||B||"",fileName:x,target:"_blank"})},children:(0,b.jsx)(c.RiDownloadLine,{className:"h-4 w-4"})})]})]}),G&&u&&(0,b.jsx)(h.default,{title:x,url:G,onCancel:()=>H("")})]})});a.s(["default",0,q])},3626,917307,183841,236431,a=>{"use strict";var b=a.i(780442),c=a.i(608061),d=a.i(429150),e=a.i(57843);a.i(752298);var f=a.i(693025),g=a.i(909795),h=a.i(954200),i=a.i(527344),j=a.i(183763),k=a.i(675694),l=a.i(220583),m=a.i(312224),n=a.i(516465);let o=({isDisabled:a,fileConfig:b})=>{let{t:o}=(0,f.useTranslation)(),p=(0,m.useStore)(a=>a.files),{handleRemoveFile:q,handleReUploadFile:r}=(0,l.useFile)(b),s=[{value:h.TransferMethod.local_file,label:o("fileUploader.uploadFromComputer",{ns:"common"}),icon:(0,c.jsx)(d.RiUploadCloud2Line,{className:"h-4 w-4"})},{value:h.TransferMethod.remote_url,label:o("fileUploader.pasteFileLink",{ns:"common"}),icon:(0,c.jsx)(d.RiLink,{className:"h-4 w-4"})}],t=(0,e.useCallback)((a,d)=>(0,c.jsxs)(g.default,{variant:"tertiary",className:(0,i.cn)("relative grow",d&&"bg-components-button-tertiary-bg-hover"),disabled:!!(b.number_limits&&p.length>=b.number_limits),children:[a.icon,(0,c.jsx)("span",{className:"ml-1",children:a.label}),a.value===h.TransferMethod.local_file&&(0,c.jsx)(k.default,{fileConfig:b})]},a.value),[b,p.length]),u=(0,e.useCallback)(a=>b=>t(a,b),[t]),v=(0,e.useCallback)(a=>a.value===h.TransferMethod.local_file&&b?.allowed_file_upload_methods?.includes(h.TransferMethod.local_file)?t(a):a.value===h.TransferMethod.remote_url&&b?.allowed_file_upload_methods?.includes(h.TransferMethod.remote_url)?(0,c.jsx)(j.default,{showFromLocal:!1,trigger:u(a),fileConfig:b},a.value):void 0,[t,u,b]);return(0,c.jsxs)("div",{children:[!a&&(0,c.jsx)("div",{className:"flex items-center space-x-1",children:s.map(v)}),(0,c.jsx)("div",{className:"mt-1 space-y-1",children:p.map(d=>(0,c.jsx)(n.default,{file:d,showDeleteAction:!a,showDownloadAction:!1,onRemove:()=>q(d.id),onReUpload:()=>r(d.id),canPreview:b.preview_config?.file_type_list?.includes(d.type),previewMode:b.preview_config?.mode},d.id))})]})};a.s(["default",0,({value:a,onChange:b,fileConfig:d,isDisabled:e})=>(0,c.jsx)(m.FileContextProvider,{value:a,onChange:b,children:(0,c.jsx)(o,{isDisabled:e,fileConfig:d})})],917307);var p=a.i(175809);let q=(0,e.memo)(({fileConfig:a,readonly:b})=>{let f=(0,e.useCallback)(a=>(0,c.jsx)(p.default,{size:"l",className:(0,i.cn)(a&&"bg-state-base-hover"),disabled:b,children:(0,c.jsx)(d.RiAttachmentLine,{className:"h-5 w-5"})}),[]);return b?f(!1):(0,c.jsx)(j.default,{trigger:f,fileConfig:a,showFromLocal:a?.allowed_file_upload_methods?.includes(h.TransferMethod.local_file),showFromLink:a?.allowed_file_upload_methods?.includes(h.TransferMethod.remote_url)})});a.s(["default",0,q],183841);var r=a.i(555237),s=a.i(968659);let t=({url:a,title:b,onCancel:e})=>((0,s.useHotkeys)("esc",e),(0,r.createPortal)((0,c.jsxs)("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/80 p-8",onClick:a=>a.stopPropagation(),tabIndex:-1,children:[(0,c.jsx)("div",{children:(0,c.jsx)("audio",{controls:!0,title:b,autoPlay:!1,preload:"metadata",children:(0,c.jsx)("source",{type:"audio/mpeg",src:a,className:"max-h-full max-w-full"})})}),(0,c.jsx)("div",{className:"absolute right-6 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg bg-white/[0.08] backdrop-blur-[2px]",onClick:e,children:(0,c.jsx)(d.RiCloseLine,{className:"h-4 w-4 text-gray-500"})})]}),document.body)),u=(0,a.i(860653).default)(async()=>{},{loadableGenerated:{modules:[661305]},ssr:!1}),v=({url:a,title:b,onCancel:e})=>((0,s.useHotkeys)("esc",e),(0,r.createPortal)((0,c.jsxs)("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/80 p-8",onClick:a=>a.stopPropagation(),tabIndex:-1,children:[(0,c.jsx)("div",{children:(0,c.jsx)("video",{controls:!0,title:b,autoPlay:!1,preload:"metadata",children:(0,c.jsx)("source",{type:"video/mp4",src:a,className:"max-h-full max-w-full"})})}),(0,c.jsx)("div",{className:"absolute right-6 top-6 flex h-8 w-8 cursor-pointer items-center justify-center rounded-lg bg-white/[0.08] backdrop-blur-[2px]",onClick:e,children:(0,c.jsx)(d.RiCloseLine,{className:"h-4 w-4 text-gray-500"})})]}),document.body));a.i(10035);var w=a.i(734766),x=a.i(744383),y=a.i(760327),z=a.i(573912),A=a.i(818386);let B=({file:a,showDeleteAction:f,showDownloadAction:h=!0,onRemove:j,onReUpload:k,canPreview:l})=>{let{id:m,name:n,type:o,progress:q,url:r,base64Url:s,isRemote:B}=a,[C,D]=(0,e.useState)(""),E=(0,A.getFileExtension)(n,o,B),F=-1===q,G=r||s;!G&&a?.originalFile&&(G=URL.createObjectURL(a.originalFile.slice()).toString());let H=r?`${r}&as_attachment=true`:s;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:(0,i.cn)("group/file-item relative h-[68px] w-[144px] rounded-lg border-[0.5px] border-components-panel-border bg-components-card-bg p-2 shadow-xs",!F&&"hover:bg-components-card-bg-alt",F&&"border border-state-destructive-border bg-state-destructive-hover",F&&"bg-state-destructive-hover-alt hover:border-[0.5px] hover:border-state-destructive-border"),children:[f&&(0,c.jsx)(g.default,{className:"absolute -right-1.5 -top-1.5 z-[11] hidden h-5 w-5 rounded-full p-0 group-hover/file-item:flex",onClick:()=>j?.(m),children:(0,c.jsx)(d.RiCloseLine,{className:"h-4 w-4 text-components-button-secondary-text"})}),(0,c.jsx)("div",{className:"system-xs-medium mb-1 line-clamp-2 h-8 cursor-pointer break-all text-text-tertiary",title:n,onClick:()=>l&&D(G||""),children:n}),(0,c.jsxs)("div",{className:"relative flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"system-2xs-medium-uppercase flex items-center text-text-tertiary",children:[(0,c.jsx)(b.default,{size:"sm",type:(0,A.getFileAppearanceType)(n,o),className:"mr-1"}),E&&(0,c.jsxs)(c.Fragment,{children:[E,(0,c.jsx)("div",{className:"mx-1",children:"·"})]}),!!a.size&&(0,z.formatFileSize)(a.size)]}),h&&H&&(0,c.jsx)(p.default,{size:"m",className:"absolute -right-1 -top-1 hidden group-hover/file-item:flex",onClick:a=>{a.stopPropagation(),(0,y.downloadUrl)({url:H||"",fileName:n,target:"_blank"})},children:(0,c.jsx)(d.RiDownloadLine,{className:"h-3.5 w-3.5 text-text-tertiary"})}),q>=0&&!(0,A.fileIsUploaded)(a)&&(0,c.jsx)(x.default,{percentage:q,size:12,className:"shrink-0"}),F&&(0,c.jsx)(w.ReplayLine,{className:"h-4 w-4 text-text-tertiary",onClick:()=>k?.(m)})]})]}),"audio"===o.split("/")[0]&&l&&C&&(0,c.jsx)(t,{title:n,url:C,onCancel:()=>D("")}),"video"===o.split("/")[0]&&l&&C&&(0,c.jsx)(v,{title:n,url:C,onCancel:()=>D("")}),"pdf"===o.split("/")[1]&&l&&C&&(0,c.jsx)(u,{url:C,onCancel:()=>{D("")}})]})};var C=a.i(735310),D=a.i(530007),E=a.i(527858);let F=({file:a,showDeleteAction:b,showDownloadAction:f,canPreview:h,onRemove:i,onReUpload:j})=>{let{id:k,progress:l,base64Url:m,url:n,name:o}=a,[p,q]=(0,e.useState)(""),r=n?`${n}&as_attachment=true`:m;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"group/file-image relative cursor-pointer",onClick:()=>h&&q(m||n||""),children:[b&&(0,c.jsx)(g.default,{className:"absolute -right-1.5 -top-1.5 z-[11] hidden h-5 w-5 rounded-full p-0 group-hover/file-image:flex",onClick:()=>i?.(k),children:(0,c.jsx)(d.RiCloseLine,{className:"h-4 w-4 text-components-button-secondary-text"})}),(0,c.jsx)(E.default,{className:"h-[68px] w-[68px] shadow-md",imageUrl:m||n||"",showDownloadAction:f}),l>=0&&!(0,A.fileIsUploaded)(a)&&(0,c.jsx)("div",{className:"absolute inset-0 z-10 flex items-center justify-center border-[2px] border-effects-image-frame bg-background-overlay-alt",children:(0,c.jsx)(x.default,{percentage:l,size:12,circleStrokeColor:"stroke-components-progress-white-border",circleFillColor:"fill-transparent",sectorFillColor:"fill-components-progress-white-progress"})}),-1===l&&(0,c.jsx)("div",{className:"absolute inset-0 z-10 flex items-center justify-center border-[2px] border-state-destructive-border bg-background-overlay-destructive",children:(0,c.jsx)(w.ReplayLine,{className:"h-5 w-5",onClick:()=>j?.(k)})}),f&&(0,c.jsx)("div",{className:"absolute inset-0.5 z-10 hidden bg-background-overlay-alt bg-opacity-[0.3] group-hover/file-image:block",children:(0,c.jsx)("div",{className:"absolute bottom-0.5 right-0.5  flex h-6 w-6 items-center justify-center rounded-lg bg-components-actionbar-bg shadow-md",onClick:a=>{a.stopPropagation(),(0,y.downloadUrl)({url:r||"",fileName:o,target:"_blank"})},children:(0,c.jsx)(d.RiDownloadLine,{className:"h-4 w-4 text-text-tertiary"})})})]}),p&&h&&(0,c.jsx)(D.default,{title:o,url:p,onCancel:()=>q("")})]})},G=({className:a,files:b,onReUpload:d,onRemove:e,showDeleteAction:f=!0,showDownloadAction:g=!1,canPreview:h=!0})=>(0,c.jsx)("div",{className:(0,i.cn)("flex flex-wrap gap-2",a),children:b.map(a=>a.supportFileType===C.SupportUploadFileTypes.image?(0,c.jsx)(F,{file:a,showDeleteAction:f,showDownloadAction:g,onRemove:e,onReUpload:d,canPreview:h},a.id):(0,c.jsx)(B,{file:a,showDeleteAction:f,showDownloadAction:g,onRemove:e,onReUpload:d,canPreview:h},a.id))});a.s(["FileList",0,G,"FileListInChatInput",0,({fileConfig:a})=>{let b=(0,m.useStore)(a=>a.files),{handleRemoveFile:d,handleReUploadFile:e}=(0,l.useFile)(a);return(0,c.jsx)(G,{files:b,onReUpload:e,onRemove:d})}],236431),a.s([],3626)}];

//# sourceMappingURL=_daa7aa88._.js.map