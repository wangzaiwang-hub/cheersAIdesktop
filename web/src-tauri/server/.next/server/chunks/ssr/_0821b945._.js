module.exports=[463963,a=>{"use strict";var b=a.i(639378),c=a.i(878590);class d{chatColorTheme;chatColorThemeInverted;primaryColor="#1C64F2";backgroundHeaderColorStyle="backgroundImage: linear-gradient(to right, #2563eb, #0ea5e9)";headerBorderBottomStyle="";colorFontOnHeaderStyle="color: white";colorPathOnHeader="text-text-primary-on-surface";backgroundButtonDefaultColorStyle="backgroundColor: #1C64F2";roundedBackgroundColorStyle="backgroundColor: rgb(245 248 255)";chatBubbleColorStyle="";constructor(a=null,b=!1){this.chatColorTheme=a,this.chatColorThemeInverted=b,this.configCustomColor(),this.configInvertedColor()}configCustomColor(){null!==this.chatColorTheme&&""!==this.chatColorTheme&&(this.primaryColor=this.chatColorTheme??"#1C64F2",this.backgroundHeaderColorStyle=`backgroundColor: ${this.primaryColor}`,this.backgroundButtonDefaultColorStyle=`backgroundColor: ${this.primaryColor}; color: ${this.colorFontOnHeaderStyle};`,this.roundedBackgroundColorStyle=`backgroundColor: ${(0,c.hexToRGBA)(this.primaryColor,.05)}`,this.chatBubbleColorStyle=`backgroundColor: ${(0,c.hexToRGBA)(this.primaryColor,.15)}`)}configInvertedColor(){this.chatColorThemeInverted&&(this.backgroundHeaderColorStyle="backgroundColor: #ffffff",this.colorFontOnHeaderStyle=`color: ${this.primaryColor}`,this.headerBorderBottomStyle="borderBottom: 1px solid #ccc",this.colorPathOnHeader=this.primaryColor)}}let e=(0,b.createContext)(new class{_theme;buildChecker=!1;get theme(){return void 0===this._theme&&(this._theme=new d),this._theme}buildTheme(a=null,b=!1){this.buildChecker?(this.theme?.chatColorTheme!==a||this.theme?.chatColorThemeInverted!==b)&&(this._theme=new d(a,b),this.buildChecker=!0):(this._theme=new d(a,b),this.buildChecker=!0)}});a.s(["useThemeContext",0,()=>(0,b.useContext)(e)])},190124,a=>{"use strict";var b=a.i(516758),c=a.i(848636),d=a.i(528698),e=a.i(749249),f=a.i(724423),g=a.i(41511),h=a.i(692520);let i="access-control";a.s(["useAppWhiteListSubjects",0,(a,b)=>(0,d.useQuery)({queryKey:[i,"app-whitelist-subjects",a],queryFn:()=>(0,g.get)(`/enterprise/webapp/app/subjects?appId=${a}`),enabled:!!a&&b,staleTime:0,gcTime:0}),"useGetUserCanAccessApp",0,({appId:a,isInstalledApp:b=!0,enabled:c})=>{let e=(0,f.useGlobalPublicStore)(a=>a.systemFeatures);return(0,d.useQuery)({queryKey:[i,"user-can-access-app",a,e.webapp_auth.enabled,b],queryFn:()=>e.webapp_auth.enabled?(0,h.getUserCanAccess)(a,b):{result:!0},enabled:void 0!==c?c:!!a,staleTime:0,gcTime:0})},"useSearchForWhiteListCandidates",0,(a,c)=>(0,b.useInfiniteQuery)({queryKey:[i,"app-whitelist-candidates",a],queryFn:({pageParam:b})=>{let c=new URLSearchParams;return Object.keys(a).forEach(b=>{a[b]&&c.append(b,`${a[b]}`)}),c.append("pageNumber",`${b}`),(0,g.get)(`/enterprise/webapp/app/subject/search?${new URLSearchParams(c).toString()}`)},initialPageParam:1,getNextPageParam:a=>{if(a.hasMore)return a.currPage+1},gcTime:0,staleTime:0,enabled:c}),"useUpdateAccessMode",0,()=>{let a=(0,e.useQueryClient)();return(0,c.useMutation)({mutationKey:[i,"update-access-mode"],mutationFn:a=>(0,g.post)("/enterprise/webapp/app/access-mode",{body:a}),onSuccess:()=>{a.invalidateQueries({queryKey:[i,"app-whitelist-subjects"]})}})}])},858877,a=>{"use strict";a.s(["addFileInfos",0,(a,b)=>a&&b?a.map(a=>a.files&&a.files?.length>0?{...a,message_files:a.files.map(a=>b.find(b=>b.id===a))}:a):a,"sortAgentSorts",0,a=>{if(!a||a.some(a=>void 0===a.position))return a;let b=[...a];return b.sort((a,b)=>a.position-b.position),b}])},684714,a=>{"use strict";var b=a.i(917307);a.s(["FileUploaderInAttachmentWrapper",()=>b.default])},532655,a=>{"use strict";var b=a.i(608061),c=a.i(57843);a.i(752298);var d=a.i(693025),e=a.i(168799);let f=c.memo(({value:a,onChange:f,name:g,required:h,readonly:i})=>{let{t:j}=(0,d.useTranslation)(),k=(0,c.useCallback)(()=>{f(!a)},[a,f]);return(0,b.jsxs)("div",{className:"flex h-6 items-center gap-2",children:[(0,b.jsx)(e.default,{className:"!h-4 !w-4",checked:!!a,onCheck:k,disabled:i}),(0,b.jsxs)("div",{className:"system-sm-medium flex items-center gap-1 text-text-secondary",children:[g,!h&&(0,b.jsx)("span",{className:"system-xs-regular text-text-tertiary",children:j("panel.optional",{ns:"workflow"})})]})]})});a.s(["default",0,f])},754457,401378,a=>{"use strict";var b=a.i(608061),c=a.i(57843);a.i(752298);var d=a.i(693025);a.i(622666);var e=a.i(411219),e=e;a.i(701836);var f=a.i(157133),g=a.i(825319),h=a.i(954200),i=a.i(305381),j=a.i(909795);let k=/^(https?|ftp):\/\//,l=({onUpload:a,disabled:e})=>{let{t:f}=(0,d.useTranslation)(),[g,i]=(0,c.useState)("");return(0,b.jsxs)("div",{className:"flex h-8 items-center rounded-lg border border-components-panel-border bg-components-panel-bg pl-1.5 pr-1 shadow-xs",children:[(0,b.jsx)("input",{type:"text",className:"mr-0.5 h-[18px] grow appearance-none bg-transparent px-1 text-[13px] text-text-primary outline-none",value:g,onChange:a=>i(a.target.value),placeholder:f("imageUploader.pasteImageLinkInputPlaceholder",{ns:"common"})||""}),(0,b.jsx)(j.default,{variant:"primary",size:"small",disabled:!g||e,onClick:()=>{e||a({type:h.TransferMethod.remote_url,_id:`${Date.now()}`,fileId:"",progress:k.test(g)?0:-1,url:g})},children:f("operation.ok",{ns:"common"})})]})};var m=a.i(429150);a.i(943046);var n=a.i(604364);a.s(["RefreshCcw01",()=>n.default],401378);var n=n;a.i(955696);var o=a.i(2496),p=a.i(530007),q=a.i(483664),r=a.i(527344);let s=({list:a,readonly:e,onRemove:f,onReUpload:g,onImageLinkLoadSuccess:i,onImageLinkLoadError:j})=>{let{t:k}=(0,d.useTranslation)(),[l,s]=(0,c.useState)("");return(0,b.jsxs)("div",{className:"flex flex-wrap",children:[a.map(a=>(0,b.jsxs)("div",{className:"group relative mr-1 rounded-lg border-[0.5px] border-black/5",children:[a.type===h.TransferMethod.local_file&&100!==a.progress&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"absolute inset-0 z-[1] flex items-center justify-center bg-black/30",style:{left:a.progress>-1?`${a.progress}%`:0},children:-1===a.progress&&(0,b.jsx)(n.default,{className:"h-5 w-5 text-white",onClick:()=>g?.(a._id)})}),a.progress>-1&&(0,b.jsxs)("span",{className:"absolute left-[50%] top-[50%] z-[1] translate-x-[-50%] translate-y-[-50%] text-sm text-white mix-blend-lighten",children:[a.progress,"%"]})]}),a.type===h.TransferMethod.remote_url&&100!==a.progress&&(0,b.jsxs)("div",{className:`
                  absolute inset-0 z-[1] flex items-center justify-center rounded-lg border
                  ${-1===a.progress?"border-[#DC6803] bg-[#FEF0C7]":"border-transparent bg-black/[0.16]"}
                `,children:[a.progress>-1&&(0,b.jsx)(m.RiLoader2Line,{className:"h-5 w-5 animate-spin text-white"}),-1===a.progress&&(0,b.jsx)(q.default,{popupContent:k("imageUploader.pasteImageLinkInvalid",{ns:"common"}),children:(0,b.jsx)(o.AlertTriangle,{className:"h-4 w-4 text-[#DC6803]"})})]}),(0,b.jsx)("img",{className:"h-16 w-16 cursor-pointer rounded-lg border-[0.5px] border-black/5 object-cover",alt:a.file?.name,onLoad:()=>{a.type===h.TransferMethod.remote_url&&i&&-1!==a.progress&&i(a._id)},onError:()=>{a.type===h.TransferMethod.remote_url&&j&&j(a._id)},src:a.type===h.TransferMethod.remote_url?a.url:a.base64Url,onClick:()=>100===a.progress&&s(a.type===h.TransferMethod.remote_url?a.url:a.base64Url)}),!e&&(0,b.jsx)("button",{type:"button",className:(0,r.cn)("absolute -right-[9px] -top-[9px] z-10 h-[18px] w-[18px] items-center justify-center","rounded-2xl shadow-lg hover:bg-state-base-hover",-1===a.progress?"flex":"hidden group-hover:flex"),onClick:()=>f?.(a._id),children:(0,b.jsx)(m.RiCloseLine,{className:"h-3 w-3 text-text-tertiary"})})]},a._id)),l&&(0,b.jsx)(p.default,{url:l,onCancel:()=>s(""),title:""})]})},t=({children:a,onUpload:d,closePopover:e,limit:f,disabled:g})=>{let[j,k]=(0,c.useState)(!1),{handleLocalFileUpload:l}=(0,i.useLocalFileUploader)({limit:f,onUpload:d,disabled:g});return(0,b.jsxs)("div",{className:"relative",onMouseEnter:()=>k(!0),onMouseLeave:()=>k(!1),children:[a(j),(0,b.jsx)("input",{className:"absolute inset-0 block w-full cursor-pointer text-[0] opacity-0 disabled:cursor-not-allowed",onClick:a=>a.target.value="",type:"file",accept:h.ALLOW_FILE_EXTENSIONS.map(a=>`.${a}`).join(","),onChange:a=>{let b=a.target.files?.[0];b&&(l(b),e?.())},disabled:g})]})},u=({onUpload:a,disabled:f})=>{let{t:h}=(0,d.useTranslation)(),[i,j]=(0,c.useState)(!1);return(0,b.jsxs)(g.PortalToFollowElem,{open:i,onOpenChange:j,placement:"top-start",children:[(0,b.jsx)(g.PortalToFollowElemTrigger,{onClick:()=>{f||j(a=>!a)},children:(0,b.jsxs)("div",{className:`
          relative flex h-8 items-center justify-center rounded-lg bg-components-button-tertiary-bg px-3 text-xs text-text-tertiary hover:bg-components-button-tertiary-bg-hover
          ${f?"cursor-not-allowed":"cursor-pointer"}
        `,children:[(0,b.jsx)(e.default,{className:"mr-2 h-4 w-4"}),h("imageUploader.pasteImageLink",{ns:"common"})]})}),(0,b.jsx)(g.PortalToFollowElemContent,{className:"z-10",children:(0,b.jsx)("div",{className:"w-[320px] rounded-lg border-[0.5px] border-components-panel-border bg-components-panel-bg p-2 shadow-lg",children:(0,b.jsx)(l,{onUpload:b=>{j(!1),a(b)}})})})]})};a.s(["default",0,({settings:a,onFilesChange:e,disabled:g})=>{let{t:j}=(0,d.useTranslation)(),{files:k,onUpload:l,onRemove:m,onImageLinkLoadError:n,onImageLinkLoadSuccess:o,onReUpload:p}=(0,i.useImageFiles)();(0,c.useEffect)(()=>{e(k)},[k]);let q=(0,b.jsx)(t,{onUpload:l,disabled:k.length>=a.number_limits||g,limit:+a.image_file_size_limit,children:a=>(0,b.jsxs)("div",{className:`
            flex h-8 cursor-pointer items-center justify-center rounded-lg
            bg-components-button-tertiary-bg px-3 text-xs text-text-tertiary
            ${a&&"hover:bg-components-button-tertiary-bg-hover"}
          `,children:[(0,b.jsx)(f.ImagePlus,{className:"mr-2 h-4 w-4"}),j("imageUploader.uploadFromComputer",{ns:"common"})]})}),r=(0,b.jsx)(u,{onUpload:l,disabled:k.length>=a.number_limits||g});return(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1",children:(0,b.jsx)(s,{list:k,onRemove:m,onReUpload:p,onImageLinkLoadError:n,onImageLinkLoadSuccess:o})}),(0,b.jsx)("div",{className:`grid gap-1 ${2===a.transfer_methods.length?"grid-cols-2":"grid-cols-1"}`,children:a.transfer_methods.map(a=>a===h.TransferMethod.local_file?(0,b.jsx)(c.Fragment,{children:q},h.TransferMethod.local_file):a===h.TransferMethod.remote_url?(0,b.jsx)(c.Fragment,{children:r},h.TransferMethod.remote_url):null)})]})}],754457)},213228,a=>{"use strict";var b=a.i(608061),c=a.i(57843),d=a.i(527344);let e=c.memo(({items:a,value:c,itemClassName:e,itemWrapClassName:f,activeItemClassName:g,onChange:h})=>{let i=({id:a,name:i,icon:j,extra:k,disabled:l})=>(0,b.jsxs)("div",{className:(0,d.cn)("system-md-semibold relative flex cursor-pointer items-center border-b-2 border-transparent pb-2 pt-2.5",a===c?(0,d.cn)("border-components-tab-active text-text-primary",g):"text-text-tertiary",l&&"cursor-not-allowed opacity-30",f),onClick:()=>!l&&h(a),children:[j||"",(0,b.jsx)("div",{className:(0,d.cn)("ml-2",e),children:i}),k||""]},a);return(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"flex space-x-4",children:a.filter(a=>!a.isRight).map(i)}),(0,b.jsx)("div",{className:"flex space-x-4",children:a.filter(a=>a.isRight).map(i)})]})});a.s(["default",0,e])},411171,a=>{"use strict";var b=a.i(546232),c=a.i(446855),d=(0,b.createUseStorageState)(function(){return c.default?localStorage:void 0});a.s(["useLocalStorageState",0,d],411171)},393621,a=>{"use strict";var b=a.i(608061),c=a.i(57843);a.i(752298);var d=a.i(693025),e=a.i(527344);let f=c.memo(({code:a=404,isUnknownReason:c,unknownReason:f,className:g})=>{let{t:h}=(0,d.useTranslation)();return(0,b.jsxs)("div",{className:(0,e.cn)("flex h-screen w-screen items-center justify-center",g),children:[(0,b.jsx)("h1",{className:"mr-5 h-[50px] shrink-0 pr-5 text-[24px] font-medium leading-[50px]",style:{borderRight:"1px solid rgba(0,0,0,.3)"},children:a}),(0,b.jsx)("div",{className:"text-sm",children:f||h(c?"common.appUnknownError":"common.appUnavailable",{ns:"share"})})]})});a.s(["default",0,f])}];

//# sourceMappingURL=_0821b945._.js.map