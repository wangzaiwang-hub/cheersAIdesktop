module.exports=[858364,a=>{"use strict";var b=a.i(608061),c=a.i(57843),d=a.i(218050),e=a.i(954200);let f=(0,c.createContext)(null);a.s(["FeaturesContext",0,f,"FeaturesProvider",0,({children:a,...g})=>{let h,i=(0,c.useRef)(void 0);return i.current||(h={features:{moreLikeThis:{enabled:!1},opening:{enabled:!1},suggested:{enabled:!1},text2speech:{enabled:!1},speech2text:{enabled:!1},citation:{enabled:!1},moderation:{enabled:!1},file:{image:{enabled:!1,detail:e.Resolution.high,number_limits:3,transfer_methods:[e.TransferMethod.local_file,e.TransferMethod.remote_url]}},annotationReply:{enabled:!1}}},i.current=(0,d.createStore)()(a=>({...h,...g,setFeatures:b=>a(()=>({features:b})),showFeaturesModal:!1,setShowFeaturesModal:b=>a(()=>({showFeaturesModal:b}))}))),(0,b.jsx)(f.Provider,{value:i.current,children:a})}],858364)},133824,a=>{"use strict";var b=a.i(57843),c=a.i(282791),d=a.i(858364);function e(a){let e=(0,b.useContext)(d.FeaturesContext);if(!e)throw Error("Missing FeaturesContext.Provider in the tree");return(0,c.useStore)(e,a)}function f(){return(0,b.useContext)(d.FeaturesContext)}a.s(["useFeatures",()=>e,"useFeaturesStore",()=>f])},41548,a=>{"use strict";var b=a.i(114715),c=a.i(692520);class d{mediaSource;audio;audioContext;sourceBuffer;cacheBuffers=[];pauseTimer=null;msgId;msgContent=null;voice=void 0;isLoadData=!1;url;isPublic;callback;constructor(a,c,d,e,f,g){this.audioContext=new AudioContext,this.msgId=d,this.msgContent=e,this.url=a,this.isPublic=c,this.voice=f,this.callback=g;const h=window.ManagedMediaSource||window.MediaSource;h||b.default.notify({message:"Your browser does not support audio streaming, if you are using an iPhone, please update to iOS 17.1 or later.",type:"error"}),this.mediaSource=h?new h:null,this.audio=new Audio,this.setCallback(g),window.MediaSource||(this.audio.disableRemotePlayback=!0,this.audio.controls=!0),this.audio.src=this.mediaSource?URL.createObjectURL(this.mediaSource):"",this.audio.autoplay=!0,this.audioContext.createMediaElementSource(this.audio).connect(this.audioContext.destination),this.listenMediaSource("audio/mpeg")}resetMsgId(a){this.msgId=a}listenMediaSource(a){this.mediaSource?.addEventListener("sourceopen",()=>{this.sourceBuffer||(this.sourceBuffer=this.mediaSource?.addSourceBuffer(a))})}setCallback(a){this.callback=a,a&&(this.audio.addEventListener("ended",()=>{a("ended")},!1),this.audio.addEventListener("paused",()=>{a("paused")},!0),this.audio.addEventListener("loaded",()=>{a("loaded")},!0),this.audio.addEventListener("play",()=>{a("play")},!0),this.audio.addEventListener("timeupdate",()=>{a("timeupdate")},!0),this.audio.addEventListener("loadeddate",()=>{a("loadeddate")},!0),this.audio.addEventListener("canplay",()=>{a("canplay")},!0),this.audio.addEventListener("error",()=>{a("error")},!0))}async loadAudio(){try{let a=await (0,c.textToAudioStream)(this.url,this.isPublic?c.AppSourceType.webApp:c.AppSourceType.installedApp,{content_type:"audio/mpeg"},{message_id:this.msgId,streaming:!0,voice:this.voice,text:this.msgContent});200!==a.status&&(this.isLoadData=!1,this.callback&&this.callback("error"));let b=a.body.getReader();for(;;){let{value:a,done:c}=await b.read();if(c){this.receiveAudioData(a);break}this.receiveAudioData(a)}}catch{this.isLoadData=!1,this.callback?.("error")}}playAudio(){this.isLoadData?("suspended"===this.audioContext.state?this.audioContext.resume().then(a=>{this.audio.play(),this.callback?.("play")}):this.audio.ended&&(this.audio.play(),this.callback?.("play")),this.callback?.("play")):(this.isLoadData=!0,this.loadAudio())}theEndOfStream(){let a=setInterval(()=>{this.sourceBuffer?.updating||(this.mediaSource?.endOfStream(),clearInterval(a))},10)}finishStream(){let a=setInterval(()=>{if(this.cacheBuffers.length||(this.theEndOfStream(),clearInterval(a)),this.cacheBuffers.length&&!this.sourceBuffer?.updating){let a=this.cacheBuffers.shift();this.sourceBuffer?.appendBuffer(a)}},10)}async playAudioWithAudio(a,b=!0){if(!a||!a.length)return void this.finishStream();let c=Buffer.from(a,"base64");this.receiveAudioData(new Uint8Array(c)),b&&(this.isLoadData=!0,this.audio.paused?this.audioContext.resume().then(a=>{this.audio.play(),this.callback?.("play")}):this.audio.ended?(this.audio.play(),this.callback?.("play")):this.audio.played||(this.audio.play(),this.callback?.("play")))}pauseAudio(){this.callback?.("paused"),this.audio.pause(),this.audioContext.suspend()}receiveAudioData(a){if(!a)return void this.finishStream();let b=this.byteArrayToArrayBuffer(a);if(!b.byteLength){this.mediaSource?.readyState==="open"&&this.finishStream();return}if(this.sourceBuffer?.updating)this.cacheBuffers.push(b);else if(this.cacheBuffers.length&&!this.sourceBuffer?.updating){this.cacheBuffers.push(b);let a=this.cacheBuffers.shift();this.sourceBuffer?.appendBuffer(a)}else this.sourceBuffer?.appendBuffer(b)}byteArrayToArrayBuffer(a){let b=new ArrayBuffer(a.length);return new Uint8Array(b).set(a),b}}class e{static instance;audioPlayers=null;msgId;static getInstance(){return e.instance||(e.instance=new e,this.instance=e.instance),e.instance}getAudioPlayer(a,b,c,e,f,g){if(this.msgId&&this.msgId===c&&this.audioPlayers)return this.audioPlayers.setCallback(g),this.audioPlayers;if(this.audioPlayers)try{this.audioPlayers.pauseAudio(),this.audioPlayers.cacheBuffers=[],this.audioPlayers.sourceBuffer?.abort()}catch{}return this.msgId=c,this.audioPlayers=new d(a,b,c,e,f,g),this.audioPlayers}resetMsgId(a){this.msgId=a,this.audioPlayers?.resetMsgId(a)}}a.s(["AudioPlayerManager",()=>e],41548)},399450,a=>{"use strict";var b=a.i(739858),c=a.i(735310);let d=[c.BlockEnum.Agent,c.BlockEnum.Tool],e=(a,b)=>{let{children:c}=a;c&&0!==c.length&&(c.find(a=>(a.message_id||a.id)===b)&&(a.hasCircle=!0,a.children=a.children.filter(a=>(a.message_id||a.id)!==b),c=a.children),c.forEach(a=>{e(a,b)}))},f=a=>{let c=(0,b.cloneDeep)(a);if(!c.children||0===c.children.length)return c;c.children=(a=>{if(!a||0===a.length)return[];let b=[],c=[];return a.forEach(a=>{let d=a.message_id||a.id;d&&!c.includes(d)&&(b.push(a),c.push(d))}),b})(c.children);let d=c.message_id||c.id,{children:g}=c;return g.find(a=>(a.message_id||a.id)===d)&&(c.hasCircle=!0,c.children=c.children.filter(a=>(a.message_id||a.id)!==d),g=c.children),g.forEach((a,b)=>{e(a,d),g[b]=f(a)}),c},g=(a,b,d)=>{let e=[...a];e.forEach(a=>{let b=a.parallel_id??a.execution_metadata?.parallel_id??null,d=a.parallel_start_node_id??a.execution_metadata?.parallel_start_node_id??null,f=a.parent_parallel_id??a.execution_metadata?.parent_parallel_id??null,g=a.parallel_start_node_id??a.execution_metadata?.parallel_start_node_id??null,h=a.parent_parallel_start_node_id??a.execution_metadata?.parent_parallel_start_node_id??null;if(!b||a.node_type===c.BlockEnum.End)return;if(d===a.node_id){let b={...a,parallelDetail:void 0};if(a.parallelDetail={isParallelStartNode:!0,children:[b]},!f)return;let c=e.find(a=>a.node_id===h);if(c&&(c?.parallelDetail||(c.parallelDetail={children:[]}),c.parallelDetail.children)){let b=c.parallelDetail.children.findLastIndex(a=>(a.parallel_start_node_id??a.execution_metadata?.parallel_start_node_id??null)===h);-1!==b?c.parallelDetail.children.splice(b+1,0,a):c.parallelDetail.children.push(a)}return}let i=e.find(a=>d===a.node_id);if(i&&i.parallelDetail&&i.parallelDetail.children){let b=i.parallelDetail.children.findLastIndex(a=>(a.parallel_start_node_id??a.execution_metadata?.parallel_start_node_id??null)===g);-1!==b?i.parallelDetail.children.splice(b+1,0,a):i.parallelDetail.children.push(a)}});let f=e.filter(a=>!(a.parallel_id??a.execution_metadata?.parallel_id)||a.node_type===c.BlockEnum.End||!(a.parent_parallel_id??a.execution_metadata?.parent_parallel_id)&&!!a.parallelDetail?.isParallelStartNode);return d&&f.forEach(a=>{Date.now(),function a(b,c){"  ".repeat(c),b.parallelDetail?.children&&b.parallelDetail.children.forEach(b=>{a(b,c+1)})}(a,0)}),!function a({list:b,depth:d,belongParallelIndexInfo:e},f){let g=0,h=b.filter(a=>a.parallelDetail?.isParallelStartNode).length>1;b.forEach(i=>{let j=i.parallel_id??i.execution_metadata?.parallel_id??null,k=i.parallel_start_node_id??i.execution_metadata?.parallel_start_node_id??null;if(!j||i.node_type===c.BlockEnum.End)return;let l=i.parallelDetail?.isParallelStartNode,m=l&&h?String.fromCharCode(64+(1+b.filter(a=>a.parallelDetail?.isParallelStartNode).findIndex(a=>a.node_id===i.node_id))):"",n=`${d}${m}`;if(l&&(i.parallelDetail.isParallelStartNode=!0,i.parallelDetail.parallelTitle=`${f("common.parallel",{ns:"workflow"})}-${n}`),k===i.node_id){let a=String.fromCharCode(64+ ++g);i.parallelDetail||(i.parallelDetail={branchTitle:""}),i.parallelDetail.branchTitle=`${f("common.branch",{ns:"workflow"})}-${e}-${a}`}i.parallelDetail?.children&&i.parallelDetail.children.length>0&&a({list:i.parallelDetail.children,depth:d+1,belongParallelIndexInfo:n},f)})}({list:f,depth:1},b),f};a.s(["default",0,(a,e)=>{var h,i;let j,k,l,m,n,o,p,q=(k=(j=(h=(0,b.cloneDeep)([...a]).sort((a,b)=>a.index-b.index).map(a=>{let b=[];return d.includes(a.node_type)&&a.execution_metadata?.agent_log&&a.execution_metadata?.agent_log.length>0&&(b=(a=>{if(!a||0===a.length)return[];let b=new Map,c=new Map;a.forEach(a=>{let d=a.message_id||a.id;d&&!b.has(d)&&b.set(d,a),d&&!c.has(d)&&c.set(d,[]),a.parent_id&&(c.has(a.parent_id)||c.set(a.parent_id,[]),c.get(a.parent_id).push(a))});let d=[];return b.forEach(a=>{if(!a.parent_id){let b=a.message_id||a.id,e=c.get(b);e&&e.length>0&&(a.children=e),d.push(a)}}),b.forEach(a=>{let b=a.message_id||a.id,d=c.get(b);d&&d.length>0&&(a.children=d)}),d})(a.execution_metadata.agent_log)),a.agentLog=b.length>0?b.map(a=>f(a)):[],a})).filter(a=>"retry"===a.status)).map(a=>a.node_id),i=h.filter(a=>"retry"!==a.status).map(a=>{let{execution_metadata:b}=a,c=!!b?.iteration_id,d=!!b?.loop_id,e=a.node_id;return k.includes(e)?{...a,retryDetail:j.filter(a=>c||d?c?a.node_id===e&&a.execution_metadata?.iteration_index===b?.iteration_index:!!d&&a.node_id===e&&a.execution_metadata?.loop_index===b?.loop_index:a.node_id===e)}:a}),m=(l=(0,b.cloneDeep)(i)).filter(a=>a.node_type===c.BlockEnum.Loop).map(a=>a.node_id),n=l.filter(a=>a.node_type===c.BlockEnum.Iteration).map(a=>a.node_id),o=l.filter(a=>a.execution_metadata?.loop_id&&m.includes(a.execution_metadata.loop_id)).map(a=>a.node_id),p=l.filter(a=>a.execution_metadata?.iteration_id&&n.includes(a.execution_metadata.iteration_id)).map(a=>a.node_id),l.filter(a=>!o.includes(a.node_id)&&!p.includes(a.node_id)).map(a=>{if(a.node_type===c.BlockEnum.Loop){let b,c=l.filter(b=>b.execution_metadata?.loop_id===a.node_id),d=c.find(a=>"failed"===a.status);d&&(a.status="failed",a.error=d.error);let f=(b=[],c.forEach(a=>{if(!a.execution_metadata)return;let{parallel_mode_run_id:c,loop_index:d=0}=a.execution_metadata,e=c||d;b[e]||(b[e]=[]),b[e].push(a)}),{...a,details:b});return f.details&&f.details.length>0&&(f.details=f.details.map(a=>g(a,e))),f}if(a.node_type===c.BlockEnum.Iteration){let b,c=l.filter(b=>b.execution_metadata?.iteration_id===a.node_id),d=c.find(a=>"failed"===a.status);d&&(a.status="failed",a.error=d.error);let f=(b=[],c.forEach((a,c)=>{if(!a.execution_metadata)return;let{iteration_index:d=0}=a.execution_metadata,e=void 0!==d?d:c;b[e]||(b[e]=[]),b[e].push(a)}),{...a,details:b});return f.details&&f.details.length>0&&(f.details=f.details.map(a=>g(a,e))),f}return a}));return g(q,e)}],399450)},503309,a=>{"use strict";var b=a.i(497746),c=a.i(57843);a.s(["useLogs",0,()=>{let[a,{setTrue:d,setFalse:e}]=(0,b.useBoolean)(!1),[f,g]=(0,c.useState)([]),h=(0,c.useCallback)(a=>{d(),g(a)},[d,g]),[i,{setTrue:j,setFalse:k}]=(0,b.useBoolean)(!1),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)({}),p=(0,c.useCallback)((a,b)=>{j(),m(a),o(b)},[j,m,o]),[q,{setTrue:r,setFalse:s}]=(0,b.useBoolean)(!1),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)({}),[x,y]=(0,c.useState)({}),z=(0,c.useCallback)((a,b,c)=>{r(),u(a),w(b),y(c)},[r,u,w]),[A,B]=(0,c.useState)([]),C=(0,c.useRef)(A),[D,E]=(0,c.useState)({}),F=(0,c.useRef)(D),G=(0,c.useCallback)(a=>{if(!a){B([]),C.current=[];return}let{message_id:b,children:c}=a,d=C.current.slice(),e=d.findIndex(a=>a.message_id===b);B(d=e>-1?d.slice(0,e+1):[...d.slice(),a]),C.current=d,c&&E({...F.current,[b]:c})},[B,E]);return{showSpecialResultPanel:a||i||q||!!A.length,showRetryDetail:a,setShowRetryDetailTrue:d,setShowRetryDetailFalse:e,retryResultList:f,setRetryResultList:g,handleShowRetryResultList:h,showIteratingDetail:i,setShowIteratingDetailTrue:j,setShowIteratingDetailFalse:k,iterationResultList:l,setIterationResultList:m,iterationResultDurationMap:n,setIterationResultDurationMap:o,handleShowIterationResultList:p,showLoopingDetail:q,setShowLoopingDetailTrue:r,setShowLoopingDetailFalse:s,loopResultList:t,setLoopResultList:u,loopResultDurationMap:v,setLoopResultDurationMap:w,loopResultVariableMap:x,setLoopResultVariableMap:y,handleShowLoopResultList:z,agentOrToolLogItemStack:A,agentOrToolLogListMap:D,handleShowAgentOrToolLog:G}}])},296496,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(57843);a.i(752298);var e=a.i(693025),f=a.i(935533);a.s(["default",0,({type:a})=>{let{t:g}=(0,e.useTranslation)(),h=(0,d.useMemo)(()=>a===f.ErrorHandleTypeEnum.failBranch?g("nodes.common.errorHandle.failBranch.inLog",{ns:"workflow"}):a===f.ErrorHandleTypeEnum.defaultValue?g("nodes.common.errorHandle.defaultValue.inLog",{ns:"workflow"}):void 0,[g,a]);return a?(0,b.jsxs)("div",{className:"relative flex rounded-lg border-[0.5px] border-components-panel-border bg-components-panel-bg-blur p-2 pr-[52px] shadow-xs",children:[(0,b.jsx)("div",{className:"absolute inset-0 rounded-lg opacity-40",style:{background:"linear-gradient(92deg, rgba(247, 144, 9, 0.25) 0%, rgba(255, 255, 255, 0.00) 100%)"}}),(0,b.jsx)(c.RiAlertFill,{className:"mr-1 h-4 w-4 shrink-0 text-text-warning-secondary"}),(0,b.jsx)("div",{className:"system-xs-medium grow text-text-primary",children:h})]}):null}])},471430,a=>{"use strict";var b=a.i(608061),c=a.i(730357),d=a.i(954200),e=a.i(527344);a.s(["default",0,({status:a,children:f})=>{let{theme:g}=(0,c.default)();return(0,b.jsxs)("div",{className:(0,e.cn)("system-xs-regular relative break-all rounded-lg border px-3 py-2.5","succeeded"===a&&"border-[rgba(23,178,106,0.8)] bg-workflow-display-success-bg bg-[url(~@/app/components/workflow/run/assets/bg-line-success.svg)] text-text-success","succeeded"===a&&g===d.Theme.light&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.5),inset_0_1px_3px_0_rgba(0,0,0,0.12),inset_0_2px_24px_0_rgba(23,178,106,0.2),0_1px_2px_0_rgba(9,9,11,0.05),0_0_0_1px_rgba(0,0,0,0.05)]","succeeded"===a&&g===d.Theme.dark&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.12),inset_0_1px_3px_0_rgba(0,0,0,0.4),inset_0_2px_24px_0_rgba(23,178,106,0.25),0_1px_2px_0_rgba(0,0,0,0.1),0_0_0_1px_rgba(24, 24, 27, 0.95)]","partial-succeeded"===a&&"border-[rgba(23,178,106,0.8)] bg-workflow-display-success-bg bg-[url(~@/app/components/workflow/run/assets/bg-line-success.svg)] text-text-success","partial-succeeded"===a&&g===d.Theme.light&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.5),inset_0_1px_3px_0_rgba(0,0,0,0.12),inset_0_2px_24px_0_rgba(23,178,106,0.2),0_1px_2px_0_rgba(9,9,11,0.05),0_0_0_1px_rgba(0,0,0,0.05)]","partial-succeeded"===a&&g===d.Theme.dark&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.12),inset_0_1px_3px_0_rgba(0,0,0,0.4),inset_0_2px_24px_0_rgba(23,178,106,0.25),0_1px_2px_0_rgba(0,0,0,0.1),0_0_0_1px_rgba(24, 24, 27, 0.95)]","failed"===a&&"border-[rgba(240,68,56,0.8)] bg-workflow-display-error-bg bg-[url(~@/app/components/workflow/run/assets/bg-line-error.svg)] text-text-warning","failed"===a&&g===d.Theme.light&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.5),inset_0_1px_3px_0_rgba(0,0,0,0.12),inset_0_2px_24px_0_rgba(240,68,56,0.2),0_1px_2px_0_rgba(9,9,11,0.05),0_0_0_1px_rgba(0,0,0,0.05)]","failed"===a&&g===d.Theme.dark&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.12),inset_0_1px_3px_0_rgba(0,0,0,0.4),inset_0_2px_24px_0_rgba(240,68,56,0.25),0_1px_2px_0_rgba(0,0,0,0.1),0_0_0_1px_rgba(24, 24, 27, 0.95)]","stopped"===a&&"border-[rgba(247,144,9,0.8)] bg-workflow-display-warning-bg bg-[url(~@/app/components/workflow/run/assets/bg-line-warning.svg)] text-text-destructive","stopped"===a&&g===d.Theme.light&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.5),inset_0_1px_3px_0_rgba(0,0,0,0.12),inset_0_2px_24px_0_rgba(247,144,9,0.2),0_1px_2px_0_rgba(9,9,11,0.05),0_0_0_1px_rgba(0,0,0,0.05)]","stopped"===a&&g===d.Theme.dark&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.12),inset_0_1px_3px_0_rgba(0,0,0,0.4),inset_0_2px_24px_0_rgba(247,144,9,0.25),0_1px_2px_0_rgba(0,0,0,0.1),0_0_0_1px_rgba(24, 24, 27, 0.95)]","exception"===a&&"border-[rgba(247,144,9,0.8)] bg-workflow-display-warning-bg bg-[url(~@/app/components/workflow/run/assets/bg-line-warning.svg)] text-text-destructive","exception"===a&&g===d.Theme.light&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.5),inset_0_1px_3px_0_rgba(0,0,0,0.12),inset_0_2px_24px_0_rgba(247,144,9,0.2),0_1px_2px_0_rgba(9,9,11,0.05),0_0_0_1px_rgba(0,0,0,0.05)]","exception"===a&&g===d.Theme.dark&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.12),inset_0_1px_3px_0_rgba(0,0,0,0.4),inset_0_2px_24px_0_rgba(247,144,9,0.25),0_1px_2px_0_rgba(0,0,0,0.1),0_0_0_1px_rgba(24, 24, 27, 0.95)]","running"===a&&"border-[rgba(11,165,236,0.8)] bg-workflow-display-normal-bg bg-[url(~@/app/components/workflow/run/assets/bg-line-running.svg)] text-util-colors-blue-light-blue-light-600","running"===a&&g===d.Theme.light&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.5),inset_0_1px_3px_0_rgba(0,0,0,0.12),inset_0_2px_24px_0_rgba(11,165,236,0.2),0_1px_2px_0_rgba(9,9,11,0.05),0_0_0_1px_rgba(0,0,0,0.05)]","running"===a&&g===d.Theme.dark&&"shadow-[inset_2px_2px_0_0_rgba(255,255,255,0.12),inset_0_1px_3px_0_rgba(0,0,0,0.4),inset_0_2px_24px_0_rgba(11,165,236,0.25),0_1px_2px_0_rgba(0,0,0,0.1),0_0_0_1px_rgba(24, 24, 27, 0.95)]"),children:[(0,b.jsx)("div",{className:(0,e.cn)("absolute left-0 top-0 h-[50px] w-[65%] bg-no-repeat",g===d.Theme.light&&"bg-[url(~@/app/components/workflow/run/assets/highlight.svg)]",g===d.Theme.dark&&"bg-[url(~@/app/components/workflow/run/assets/highlight-dark.svg)]")}),f]})}])},351993,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(57843);a.i(752298);var e=a.i(693025),f=a.i(527344);let g=d.memo(({textHasNoExport:a,downloadUrl:d,className:g})=>{let{t:h}=(0,e.useTranslation)(),i=h(a?"debug.variableInspect.largeDataNoExport":"debug.variableInspect.largeData",{ns:"workflow"});return(0,b.jsxs)("div",{className:(0,f.cn)("flex h-8 items-center justify-between rounded-lg border-[0.5px] border-components-panel-border bg-components-panel-bg-blur px-2 shadow-xs",g),children:[(0,b.jsxs)("div",{className:"flex h-full w-0 grow items-center space-x-1",children:[(0,b.jsx)(c.RiInformation2Fill,{className:"size-4 shrink-0 text-text-accent"}),(0,b.jsx)("div",{className:"system-xs-regular w-0 grow truncate text-text-primary",children:i})]}),d&&(0,b.jsx)("div",{className:"system-xs-medium-uppercase ml-1 shrink-0 cursor-pointer text-text-accent",children:h("debug.variableInspect.export",{ns:"workflow"})})]})});a.s(["default",0,g])},193255,747608,762056,a=>{"use strict";var b=a.i(608061),c=a.i(429150);a.i(752298);var d=a.i(693025);a.s(["default",0,({nodeInfo:a,onShowAgentOrToolLog:e})=>{let{t:f}=(0,d.useTranslation)(),{agentLog:g,execution_metadata:h}=a,i=h?.tool_info?.agent_strategy;return(0,b.jsxs)("div",{className:"cursor-pointer rounded-[10px] bg-components-button-tertiary-bg",onClick:()=>{e({message_id:a.id,children:g||[]})},children:[(0,b.jsx)("div",{className:"system-2xs-medium-uppercase flex items-center px-3 pt-2 text-text-tertiary",children:f("nodes.agent.strategy.label",{ns:"workflow"})}),(0,b.jsxs)("div",{className:"flex items-center pb-1.5 pl-3 pr-2 pt-1",children:[i&&(0,b.jsx)("div",{className:"system-xs-medium grow text-text-secondary",children:i}),(0,b.jsxs)("div",{className:"system-xs-regular-uppercase flex shrink-0 cursor-pointer items-center px-[1px] text-text-tertiary",children:[f("detail",{ns:"runLog"}),(0,b.jsx)(c.RiArrowRightLine,{className:"ml-0.5 h-3.5 w-3.5"})]})]})]})}],747608);var e=a.i(57843),f=a.i(909795),g=a.i(302785),h=a.i(438961),i=a.i(373178),j=a.i(527344);let k=({status:a,className:d})=>(0,b.jsxs)(b.Fragment,{children:["succeeded"===a&&(0,b.jsx)(c.RiCheckboxCircleFill,{className:(0,j.cn)("h-4 w-4 shrink-0 text-text-success",d)}),"failed"===a&&(0,b.jsx)(c.RiErrorWarningLine,{className:(0,j.cn)("h-4 w-4 shrink-0 text-text-warning",d)}),("stopped"===a||"exception"===a)&&(0,b.jsx)(c.RiAlertFill,{className:(0,j.cn)("h-4 w-4 shrink-0 text-text-warning-secondary",d)}),"running"===a&&(0,b.jsx)(c.RiLoader2Line,{className:(0,j.cn)("h-4 w-4 shrink-0 animate-spin text-text-accent",d)})]});var l=a.i(787405),m=a.i(735310);let n=({item:a,onShowAgentOrToolLog:d})=>{let{label:n,status:o,children:p,data:q,metadata:r}=a,[s,t]=(0,e.useState)(!1),{getIconUrl:u}=(0,g.default)(),v=(0,e.useMemo)(()=>{let a=r?.icon;return a?a.includes("http")?a:u(a):""},[u,r?.icon]),w=(0,e.useMemo)(()=>"start"===o?"running":o,[o]);return(0,b.jsxs)("div",{className:"rounded-[10px] border-[0.5px] border-components-panel-border bg-background-default",children:[(0,b.jsxs)("div",{className:(0,j.cn)("flex cursor-pointer items-center pb-2 pl-1.5 pr-3 pt-2",s&&"pb-1"),onClick:()=>t(!s),children:[s?(0,b.jsx)(c.RiArrowRightSLine,{className:"h-4 w-4 shrink-0 rotate-90 text-text-quaternary"}):(0,b.jsx)(c.RiArrowRightSLine,{className:"h-4 w-4 shrink-0 text-text-quaternary"}),(0,b.jsx)(h.default,{className:"mr-1.5 shrink-0",type:v?m.BlockEnum.Tool:m.BlockEnum.Agent,toolIcon:v}),(0,b.jsx)("div",{className:"system-sm-semibold-uppercase grow truncate text-text-secondary",title:n,children:n}),!!r?.elapsed_time&&(0,b.jsxs)("div",{className:"system-xs-regular mr-2 shrink-0 text-text-tertiary",children:[r?.elapsed_time?.toFixed(3),"s"]}),(0,b.jsx)(k,{status:w})]}),s&&(0,b.jsxs)("div",{className:"p-1 pt-0",children:[!!p?.length&&(0,b.jsxs)(f.default,{className:"mb-1 flex w-full items-center justify-between",variant:"tertiary",onClick:()=>d(a),children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(c.RiListView,{className:"mr-1 h-4 w-4 shrink-0 text-components-button-tertiary-text"}),`${p.length} Action Logs`]}),(0,b.jsx)("div",{className:"flex",children:(0,b.jsx)(c.RiArrowRightSLine,{className:"h-4 w-4 shrink-0 text-components-button-tertiary-text"})})]}),q&&(0,b.jsx)(i.default,{readOnly:!0,title:(0,b.jsx)("div",{children:"data".toLocaleUpperCase()}),language:l.CodeLanguage.json,value:q,isJSONStringifyBeauty:!0})]})]})};var o=a.i(825319);let p=({options:a,onShowAgentOrToolLog:d})=>{let[g,h]=(0,e.useState)(!1);return(0,b.jsxs)(o.PortalToFollowElem,{placement:"bottom-start",offset:{mainAxis:2,crossAxis:-54},open:g,onOpenChange:h,children:[(0,b.jsx)(o.PortalToFollowElemTrigger,{children:(0,b.jsx)(f.default,{className:"h-6 w-6",variant:"ghost-accent",children:(0,b.jsx)(c.RiMoreLine,{className:"h-4 w-4"})})}),(0,b.jsx)(o.PortalToFollowElemContent,{children:(0,b.jsx)("div",{className:"w-[136px] rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur p-1 shadow-lg",children:a.map(a=>(0,b.jsx)("div",{className:"system-md-regular flex h-8 cursor-pointer items-center rounded-lg px-2 text-text-secondary hover:bg-state-base-hover",onClick:()=>{d(a),h(!1)},children:a.label},a.message_id))})})]})},q=({agentOrToolLogItemStack:a,onShowAgentOrToolLog:e})=>{let{t:g}=(0,d.useTranslation)(),h=a.length,i=a[0],j=a.slice(1,-1),k=a.at(-1);return(0,b.jsxs)("div",{className:"flex h-8 items-center bg-components-panel-bg p-1 pr-3",children:[(0,b.jsxs)(f.default,{className:"shrink-0 px-[5px]",size:"small",variant:"ghost-accent",onClick:()=>{e()},children:[(0,b.jsx)(c.RiArrowLeftLine,{className:"mr-1 h-3.5 w-3.5"}),"AGENT"]}),(0,b.jsx)("div",{className:"system-xs-regular mx-0.5 shrink-0 text-divider-deep",children:"/"}),h>1?(0,b.jsx)(f.default,{className:"shrink-0 px-[5px]",size:"small",variant:"ghost-accent",onClick:()=>e(i),children:g("nodes.agent.strategy.label",{ns:"workflow"})}):(0,b.jsx)("div",{className:"system-xs-medium-uppercase flex items-center px-[5px] text-text-tertiary",children:g("nodes.agent.strategy.label",{ns:"workflow"})}),!!j.length&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"system-xs-regular mx-0.5 shrink-0 text-divider-deep",children:"/"}),(0,b.jsx)(p,{options:j,onShowAgentOrToolLog:e})]}),!!k&&h>1&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"system-xs-regular mx-0.5 shrink-0 text-divider-deep",children:"/"}),(0,b.jsx)("div",{className:"system-xs-medium-uppercase flex items-center px-[5px] text-text-tertiary",children:k.label})]})]})};a.s(["default",0,({agentOrToolLogItemStack:a,agentOrToolLogListMap:e,onShowAgentOrToolLog:f})=>{let{t:g}=(0,d.useTranslation)(),h=a[a.length-1],i=e[h.message_id];return(0,b.jsxs)("div",{className:"overflow-y-auto bg-background-section",children:[(0,b.jsx)(q,{agentOrToolLogItemStack:a,onShowAgentOrToolLog:f}),(0,b.jsx)("div",{className:"space-y-1 p-2",children:i.map(a=>(0,b.jsx)(n,{item:a,onShowAgentOrToolLog:f},a.message_id))}),h.hasCircle&&(0,b.jsxs)("div",{className:"mt-1 flex items-center rounded-xl border border-components-panel-border bg-components-panel-bg-blur px-3 pr-2 shadow-md",children:[(0,b.jsx)("div",{className:"absolute inset-0 rounded-xl opacity-[0.4]",style:{background:"linear-gradient(92deg, rgba(247, 144, 9, 0.25) 0%, rgba(255, 255, 255, 0.00) 100%)"}}),(0,b.jsx)(c.RiAlertFill,{className:"mr-1.5 h-4 w-4 text-text-warning-secondary"}),(0,b.jsx)("div",{className:"system-xs-medium text-text-primary",children:g("circularInvocationTip",{ns:"runLog"})})]})]})}],762056),a.s([],193255)},931604,a=>{"use strict";var b=a.i(747608);a.s(["AgentLogTrigger",()=>b.default])},408956,a=>{"use strict";var b=a.i(608061),c=a.i(429150);a.i(752298);var d=a.i(693025),e=a.i(909795);a.i(275560);var f=a.i(203995),g=a.i(735310);a.s(["default",0,({nodeInfo:a,allExecutions:h,onShowIterationResultList:i})=>{let{t:j}=(0,d.useTranslation)(),k=0,l=a.execution_metadata?.iteration_duration_map;l?k=Object.keys(l).length:a.details?.length?k=a.details.length:a.metadata?.iterator_length&&(k=a.metadata.iterator_length);let m=((b,c)=>{if(!b||0===b.length)return 0;let d=new Set;return b.forEach((a,b)=>{if(a.some(a=>a.status===g.NodeRunningStatus.Failed)){let c=a[0]?.execution_metadata?.iteration_index??b;d.add(c)}}),c?.iteration_duration_map&&h&&h.forEach(b=>{b.execution_metadata?.iteration_id===a.node_id&&b.status===g.NodeRunningStatus.Failed&&b.execution_metadata?.iteration_index!==void 0&&d.add(b.execution_metadata.iteration_index)}),d.size})(a.details,a.execution_metadata);return(0,b.jsxs)(e.default,{className:"flex w-full cursor-pointer items-center gap-2 self-stretch rounded-lg border-none bg-components-button-tertiary-bg-hover px-3 py-2 hover:bg-components-button-tertiary-bg-hover",onClick:b=>{b.stopPropagation(),b.nativeEvent.stopImmediatePropagation();let c=a.execution_metadata,d=a?.iterDurationMap||c?.iteration_duration_map||{},e=[];if(c?.iteration_duration_map){if(e=Object.keys(c.iteration_duration_map).map(b=>(b=>{if(!h)return[];let c=h.filter(a=>a.execution_metadata?.parallel_mode_run_id===b);if(c.length>0)return c;let d=Number.parseInt(b,10);if(!isNaN(d)){let b=h.filter(b=>b.execution_metadata?.iteration_id===a.node_id&&b.execution_metadata?.iteration_index===d);if(b.length>0)return b}return[]})(b)).filter(a=>a.length>0),h&&a.details?.length){let b=new Set;e.forEach(a=>{a.forEach(a=>{a.execution_metadata?.iteration_index!==void 0&&b.add(a.execution_metadata.iteration_index)})}),a.details.forEach((a,c)=>{!b.has(c)&&a.some(a=>a.status===g.NodeRunningStatus.Failed)&&e.push(a)}),e.sort((a,b)=>(a[0]?.execution_metadata?.iteration_index??0)-(b[0]?.execution_metadata?.iteration_index??0))}}else a.details?.length&&(e=a.details);i(e,d)},children:[(0,b.jsx)(f.Iteration,{className:"h-4 w-4 shrink-0 text-components-button-tertiary-text"}),(0,b.jsxs)("div",{className:"system-sm-medium flex-1 text-left text-components-button-tertiary-text",children:[j("nodes.iteration.iteration",{ns:"workflow",count:k}),m>0&&(0,b.jsxs)(b.Fragment,{children:[j("nodes.iteration.comma",{ns:"workflow"}),j("nodes.iteration.error",{ns:"workflow",count:m})]})]}),(0,b.jsx)(c.RiArrowRightSLine,{className:"h-4 w-4 shrink-0 text-components-button-tertiary-text"})]})}])},962190,469931,a=>{"use strict";a.s([],962190),a.i(408956),a.s(["default",()=>k],469931);var b=a.i(608061),c=a.i(429150),d=a.i(57843);a.i(752298);var e=a.i(693025);a.i(275560);var f=a.i(203995),g=a.i(813027),h=a.i(735310),i=a.i(527344);let j="singleRun",k=d.memo(({list:a,onBack:k,iterDurationMap:l})=>{let{t:m}=(0,e.useTranslation)(),[n,o]=(0,d.useState)({}),p=(0,d.useCallback)(a=>{o(b=>({...b,[a]:!b[a]}))},[]);return(0,b.jsxs)("div",{className:"bg-components-panel-bg",children:[(0,b.jsxs)("div",{className:"flex h-8 cursor-pointer items-center border-b-[0.5px] border-b-divider-regular px-4 text-text-accent-secondary",onClick:a=>{a.stopPropagation(),a.nativeEvent.stopImmediatePropagation(),k()},children:[(0,b.jsx)(c.RiArrowLeftLine,{className:"mr-1 h-4 w-4"}),(0,b.jsx)("div",{className:"system-sm-medium",children:m(`${j}.back`,{ns:"workflow"})})]}),(0,b.jsx)("div",{className:"bg-components-panel-bg p-2",children:a.map((a,d)=>(0,b.jsxs)("div",{className:(0,i.cn)("mb-1 overflow-hidden rounded-xl border-none bg-background-section-burn"),children:[(0,b.jsx)("div",{className:(0,i.cn)("flex w-full cursor-pointer items-center justify-between px-3",n[d]?"pb-2 pt-3":"py-3","rounded-xl text-left"),onClick:()=>p(d),children:(0,b.jsxs)("div",{className:(0,i.cn)("flex grow items-center gap-2"),children:[(0,b.jsx)("div",{className:"flex h-4 w-4 shrink-0 items-center justify-center rounded-[5px] border-divider-subtle bg-util-colors-cyan-cyan-500",children:(0,b.jsx)(f.Iteration,{className:"h-3 w-3 text-text-primary-on-surface"})}),(0,b.jsxs)("span",{className:"system-sm-semibold-uppercase grow text-text-primary",children:[m(`${j}.iteration`,{ns:"workflow"})," ",d+1]}),((a,d,e)=>{let f,g,j=d.some(a=>a.status===h.NodeRunningStatus.Failed),k=d.some(a=>a.status===h.NodeRunningStatus.Running),l=e&&0!==Object.keys(e).length;return j?(0,b.jsx)(c.RiErrorWarningLine,{className:"h-4 w-4 text-text-destructive"}):k?(0,b.jsx)(c.RiLoader2Line,{className:"h-3.5 w-3.5 animate-spin text-primary-600"}):(0,b.jsxs)(b.Fragment,{children:[l&&(0,b.jsx)("div",{className:"system-xs-regular text-text-tertiary",children:(f=d[0]?.execution_metadata?.iteration_index,g=e[d[0]?.execution_metadata?.parallel_mode_run_id||f],`${g&&g>.01?g.toFixed(2):.01}s`)}),(0,b.jsx)(c.RiArrowRightSLine,{className:(0,i.cn)("h-4 w-4 shrink-0 text-text-tertiary transition-transform duration-200",n[a]&&"rotate-90")})]})})(d,a,l)]})}),n[d]&&(0,b.jsx)("div",{className:"h-px grow bg-divider-subtle"}),(0,b.jsx)("div",{className:(0,i.cn)("transition-all duration-200",n[d]?"opacity-100":"max-h-0 overflow-hidden opacity-0"),children:(0,b.jsx)(g.default,{list:a,className:"bg-background-section-burn"})})]},d))})]})})},957251,758861,549081,793612,133846,947272,777445,83642,a=>{"use strict";a.s(["default",()=>A],957251);var b=a.i(608061),c=a.i(429150),d=a.i(57843);a.i(752298);var e=a.i(693025),f=a.i(483664),g=a.i(373178),h=a.i(296496),i=a.i(787405),j=a.i(471430);a.i(713310);var k=a.i(363444),l=a.i(252813),m=a.i(527344),n=a.i(438961),o=a.i(735310),p=a.i(351993);a.i(193255);var q=a.i(931604);a.i(962190);var r=a.i(408956);a.s(["IterationLogTrigger",()=>r.default],758861);var r=r;a.s([],793612);var s=a.i(909795);a.i(275560);var t=a.i(581994);let u=({nodeInfo:a,allExecutions:d,onShowLoopResultList:f})=>{var g;let{t:h}=(0,e.useTranslation)(),i=0,j=a.execution_metadata?.loop_duration_map;j?i=Object.keys(j).length:a.details?.length?i=a.details.length:a.metadata?.loop_length&&(i=a.metadata.loop_length);let k=(g=a.details)&&0!==g.length?g.reduce((a,b)=>(b.some(a=>"failed"===a.status)&&a++,a),0):0;return(0,b.jsxs)(s.default,{className:"flex w-full cursor-pointer items-center gap-2 self-stretch rounded-lg border-none bg-components-button-tertiary-bg-hover px-3 py-2 hover:bg-components-button-tertiary-bg-hover",onClick:b=>{b.stopPropagation(),b.nativeEvent.stopImmediatePropagation();let c=a.execution_metadata,e=a?.loopDurationMap||c?.loop_duration_map||{},g=c?.loop_variable_map||{},h=[];a.details?.length?h=a.details:c?.loop_duration_map&&(h=Object.keys(c.loop_duration_map).map(b=>(b=>{if(!d)return[];let c=d.filter(a=>a.execution_metadata?.parallel_mode_run_id===b);if(c.length>0)return c;let e=Number.parseInt(b,10);if(!isNaN(e)){let b=d.filter(b=>b.execution_metadata?.loop_id===a.node_id&&b.execution_metadata?.loop_index===e);if(b.length>0)return b}return[]})(b)).filter(a=>a.length>0)),f(h,e,g)},children:[(0,b.jsx)(t.Loop,{className:"h-4 w-4 shrink-0 text-components-button-tertiary-text"}),(0,b.jsxs)("div",{className:"system-sm-medium flex-1 text-left text-components-button-tertiary-text",children:[h("nodes.loop.loop",{ns:"workflow",count:i}),k>0&&(0,b.jsxs)(b.Fragment,{children:[h("nodes.loop.comma",{ns:"workflow"}),h("nodes.loop.error",{ns:"workflow",count:k})]})]}),(0,b.jsx)(c.RiArrowRightSLine,{className:"h-4 w-4 shrink-0 text-components-button-tertiary-text"})]})};a.s(["default",()=>x],549081);var v=a.i(813027);let w="singleRun",x=d.memo(({list:a,onBack:f,loopDurationMap:h,loopVariableMap:j})=>{let{t:k}=(0,e.useTranslation)(),[l,n]=(0,d.useState)({}),p=(0,d.useCallback)(a=>{n(b=>({...b,[a]:!b[a]}))},[]);return(0,b.jsxs)("div",{className:"bg-components-panel-bg",children:[(0,b.jsxs)("div",{className:"flex h-8 cursor-pointer items-center border-b-[0.5px] border-b-divider-regular px-4 text-text-accent-secondary",onClick:a=>{a.stopPropagation(),a.nativeEvent.stopImmediatePropagation(),f()},children:[(0,b.jsx)(c.RiArrowLeftLine,{className:"mr-1 h-4 w-4"}),(0,b.jsx)("div",{className:"system-sm-medium",children:k(`${w}.back`,{ns:"workflow"})})]}),(0,b.jsx)("div",{className:"bg-components-panel-bg p-2",children:a.map((a,d)=>(0,b.jsxs)("div",{className:(0,m.cn)("mb-1 overflow-hidden rounded-xl border-none bg-background-section-burn"),children:[(0,b.jsx)("div",{className:(0,m.cn)("flex w-full cursor-pointer items-center justify-between px-3",l[d]?"pb-2 pt-3":"py-3","rounded-xl text-left"),onClick:()=>p(d),children:(0,b.jsxs)("div",{className:(0,m.cn)("flex grow items-center gap-2"),children:[(0,b.jsx)("div",{className:"flex h-4 w-4 shrink-0 items-center justify-center rounded-[5px] border-divider-subtle bg-util-colors-cyan-cyan-500",children:(0,b.jsx)(t.Loop,{className:"h-3 w-3 text-text-primary-on-surface"})}),(0,b.jsxs)("span",{className:"system-sm-semibold-uppercase grow text-text-primary",children:[k(`${w}.loop`,{ns:"workflow"})," ",d+1]}),((a,d,e)=>{let f,g,h=d.some(a=>a.status===o.NodeRunningStatus.Failed),i=d.some(a=>a.status===o.NodeRunningStatus.Running),j=e&&0!==Object.keys(e).length;return h?(0,b.jsx)(c.RiErrorWarningLine,{className:"h-4 w-4 text-text-destructive"}):i?(0,b.jsx)(c.RiLoader2Line,{className:"h-3.5 w-3.5 animate-spin text-primary-600"}):(0,b.jsxs)(b.Fragment,{children:[j&&(0,b.jsx)("div",{className:"system-xs-regular text-text-tertiary",children:(f=d[0]?.execution_metadata?.loop_index,g=e[d[0]?.execution_metadata?.parallel_mode_run_id||f],`${g&&g>.01?g.toFixed(2):.01}s`)}),(0,b.jsx)(c.RiArrowRightSLine,{className:(0,m.cn)("h-4 w-4 shrink-0 text-text-tertiary transition-transform duration-200",l[a]&&"rotate-90")})]})})(d,a,h)]})}),l[d]&&(0,b.jsx)("div",{className:"h-px grow bg-divider-subtle"}),(0,b.jsxs)("div",{className:(0,m.cn)("transition-all duration-200",l[d]?"opacity-100":"max-h-0 overflow-hidden opacity-0"),children:[j?.[d]&&(0,b.jsx)("div",{className:"p-2 pb-0",children:(0,b.jsx)(g.default,{readOnly:!0,title:(0,b.jsx)("div",{children:k("nodes.loop.loopVariables",{ns:"workflow"}).toLocaleUpperCase()}),language:i.CodeLanguage.json,height:112,value:j[d],isJSONStringifyBeauty:!0})}),(0,b.jsx)(v.default,{list:a,className:"bg-background-section-burn"})]})]},d))})]})});a.s(["LoopLogTrigger",0,u],133846),a.s([],777445);let y=({nodeInfo:a,onShowRetryResultList:d})=>{let{t:f}=(0,e.useTranslation)(),{retryDetail:g}=a;return(0,b.jsxs)(s.default,{className:"mb-1 flex w-full items-center justify-between",variant:"tertiary",onClick:a=>{a.stopPropagation(),a.nativeEvent.stopImmediatePropagation(),d(g||[])},children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(c.RiRestartFill,{className:"mr-0.5 h-4 w-4 shrink-0 text-components-button-tertiary-text"}),f("nodes.common.retry.retries",{ns:"workflow",num:g?.length})]}),(0,b.jsx)(c.RiArrowRightSLine,{className:"h-4 w-4 shrink-0 text-components-button-tertiary-text"})]})};a.s(["default",()=>z],947272);let z=(0,d.memo)(({list:a,onBack:d})=>{let{t:f}=(0,e.useTranslation)();return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"system-sm-medium flex h-8 cursor-pointer items-center bg-components-panel-bg px-4 text-text-accent-secondary",onClick:a=>{a.stopPropagation(),a.nativeEvent.stopImmediatePropagation(),d()},children:[(0,b.jsx)(c.RiArrowLeftLine,{className:"mr-1 h-4 w-4"}),f("singleRun.back",{ns:"workflow"})]}),(0,b.jsx)(v.default,{list:a.map((a,b)=>({...a,title:`${f("nodes.common.retry.retry",{ns:"workflow"})} ${b+1}`})),className:"bg-background-section-burn"})]})});a.s(["RetryLogTrigger",0,y],83642);let A=({className:a,nodeInfo:s,allExecutions:t,inMessage:v=!1,hideInfo:w=!1,hideProcessDetail:x,onShowIterationDetail:z,onShowLoopDetail:A,onShowRetryDetail:B,onShowAgentOrToolLog:C,notShowIterationNav:D,notShowLoopNav:E})=>{var F,G;let[H,I]=(0,d.useState)(!0),J=(0,d.useCallback)(a=>{x||I(a)},[x]),{t:K}=(0,e.useTranslation)(),L=(0,l.useDocLink)();(0,d.useEffect)(()=>{J(!s.expand)},[s.expand,J]);let M=s.node_type===o.BlockEnum.Iteration&&!!s.details?.length,N=s.node_type===o.BlockEnum.Loop&&!!s.details?.length,O=(0,k.hasRetryNode)(s.node_type)&&!!s.retryDetail?.length,P=s.node_type===o.BlockEnum.Agent&&!!s.agentLog?.length,Q=s.node_type===o.BlockEnum.Tool&&!!s.agentLog?.length,R=(0,d.useMemo)(()=>{let a=K("common.input",{ns:"workflow"});return s.node_type===o.BlockEnum.Loop&&(a=K("nodes.loop.initialLoopVariables",{ns:"workflow"})),a.toLocaleUpperCase()},[s.node_type,K]),S=K("common.processData",{ns:"workflow"}).toLocaleUpperCase(),T=(0,d.useMemo)(()=>{let a=K("common.output",{ns:"workflow"});return s.node_type===o.BlockEnum.Loop&&(a=K("nodes.loop.finalLoopVariables",{ns:"workflow"})),a.toLocaleUpperCase()},[s.node_type,K]);return(0,b.jsx)("div",{className:(0,m.cn)("px-2 py-1",a),children:(0,b.jsxs)("div",{className:"group rounded-[10px] border border-components-panel-border bg-background-default shadow-xs transition-all hover:shadow-md",children:[(0,b.jsxs)("div",{className:(0,m.cn)("flex cursor-pointer items-center pl-1 pr-3",w?"py-2 pl-2":"py-1.5",!H&&(w?"!pb-1":"!pb-1.5")),onClick:()=>J(!H),children:[!x&&(0,b.jsx)(c.RiArrowRightSLine,{className:(0,m.cn)("mr-1 h-4 w-4 shrink-0 text-text-quaternary transition-all group-hover:text-text-tertiary",!H&&"rotate-90")}),(0,b.jsx)(n.default,{size:v?"xs":"sm",className:(0,m.cn)("mr-2 shrink-0",v&&"!mr-1"),type:s.node_type,toolIcon:s.extras?.icon||s.extras}),(0,b.jsx)(f.default,{popupContent:(0,b.jsx)("div",{className:"max-w-xs",children:s.title}),children:(0,b.jsx)("div",{className:(0,m.cn)("system-xs-semibold-uppercase grow truncate text-text-secondary",w&&"!text-xs"),children:s.title})}),"running"!==s.status&&!w&&(0,b.jsxs)("div",{className:"system-xs-regular shrink-0 text-text-tertiary",children:[s.execution_metadata?.total_tokens?`${(F=s.execution_metadata?.total_tokens||0)<1e3?F:F>=1e3&&F<1e6?`${Number.parseFloat((F/1e3).toFixed(3))}K`:F>=1e6?`${Number.parseFloat((F/1e6).toFixed(3))}M`:void 0} tokens \xb7 `:"",`${(G=s.elapsed_time||0)<1?`${(1e3*G).toFixed(3)} ms`:G>60?`${Math.floor(G/60)} m ${(G%60).toFixed(3)} s`:`${G.toFixed(3)} s`}`]}),"succeeded"===s.status&&(0,b.jsx)(c.RiCheckboxCircleFill,{className:"ml-2 h-3.5 w-3.5 shrink-0 text-text-success"}),"failed"===s.status&&(0,b.jsx)(c.RiErrorWarningLine,{className:"ml-2 h-3.5 w-3.5 shrink-0 text-text-warning"}),"stopped"===s.status&&(0,b.jsx)(c.RiAlertFill,{className:(0,m.cn)("ml-2 h-4 w-4 shrink-0 text-text-warning-secondary",v&&"h-3.5 w-3.5")}),"exception"===s.status&&(0,b.jsx)(c.RiAlertFill,{className:(0,m.cn)("ml-2 h-4 w-4 shrink-0 text-text-warning-secondary",v&&"h-3.5 w-3.5")}),"running"===s.status&&(0,b.jsxs)("div",{className:"flex shrink-0 items-center text-[13px] font-medium leading-[16px] text-text-accent",children:[(0,b.jsx)("span",{className:"mr-2 text-xs font-normal",children:"Running"}),(0,b.jsx)(c.RiLoader2Line,{className:"h-3.5 w-3.5 animate-spin"})]})]}),!H&&!x&&(0,b.jsxs)("div",{className:"px-1 pb-1",children:[M&&!D&&z&&(0,b.jsx)(r.default,{nodeInfo:s,allExecutions:t,onShowIterationResultList:z}),N&&!E&&A&&(0,b.jsx)(u,{nodeInfo:s,allExecutions:t,onShowLoopResultList:A}),O&&B&&(0,b.jsx)(y,{nodeInfo:s,onShowRetryResultList:B}),(P||Q)&&C&&(0,b.jsx)(q.AgentLogTrigger,{nodeInfo:s,onShowAgentOrToolLog:C}),(0,b.jsxs)("div",{className:(0,m.cn)("mb-1",w&&"!px-2 !py-0.5"),children:["stopped"===s.status&&(0,b.jsx)(j.default,{status:"stopped",children:K("tracing.stopBy",{ns:"workflow",user:s.created_by?s.created_by.name:"N/A"})}),"exception"===s.status&&(0,b.jsxs)(j.default,{status:"stopped",children:[s.error,(0,b.jsx)("a",{href:L("/use-dify/debug/error-type"),target:"_blank",className:"text-text-accent",children:K("common.learnMore",{ns:"workflow"})})]}),"failed"===s.status&&(0,b.jsx)(j.default,{status:"failed",children:s.error}),"retry"===s.status&&(0,b.jsx)(j.default,{status:"failed",children:s.error})]}),s.inputs&&(0,b.jsx)("div",{className:(0,m.cn)("mb-1"),children:(0,b.jsx)(g.default,{readOnly:!0,title:(0,b.jsx)("div",{children:R}),language:i.CodeLanguage.json,value:s.inputs,isJSONStringifyBeauty:!0,footer:s.inputs_truncated&&(0,b.jsx)(p.default,{textHasNoExport:!0,className:"mx-1 mb-1 mt-2 h-7"})})}),s.process_data&&(0,b.jsx)("div",{className:(0,m.cn)("mb-1"),children:(0,b.jsx)(g.default,{readOnly:!0,title:(0,b.jsx)("div",{children:S}),language:i.CodeLanguage.json,value:s.process_data,isJSONStringifyBeauty:!0})}),s.outputs&&(0,b.jsx)("div",{children:(0,b.jsx)(g.default,{readOnly:!0,title:(0,b.jsx)("div",{children:T}),language:i.CodeLanguage.json,value:s.outputs,isJSONStringifyBeauty:!0,tip:(0,b.jsx)(h.default,{type:s.execution_metadata?.error_strategy}),footer:s.outputs_truncated&&(0,b.jsx)(p.default,{textHasNoExport:!0,downloadUrl:s.outputs_full_content?.download_url,className:"mx-1 mb-1 mt-2 h-7"})})})]})]})})}},91489,a=>{"use strict";var b=a.i(762056);a.s(["AgentResultPanel",()=>b.default])},587988,a=>{"use strict";a.s(["default",()=>g],587988);var b=a.i(608061);a.i(193255);var c=a.i(91489);a.i(962190);var d=a.i(469931),d=d;a.i(793612);var e=a.i(549081),e=e;a.i(777445);var f=a.i(947272),f=f;let g=({showRetryDetail:a,setShowRetryDetailFalse:g,retryResultList:h,showIteratingDetail:i,setShowIteratingDetailFalse:j,iterationResultList:k,iterationResultDurationMap:l,showLoopingDetail:m,setShowLoopingDetailFalse:n,loopResultList:o,loopResultDurationMap:p,loopResultVariableMap:q,agentOrToolLogItemStack:r,agentOrToolLogListMap:s,handleShowAgentOrToolLog:t})=>(0,b.jsxs)("div",{onClick:a=>{a.stopPropagation(),a.nativeEvent.stopImmediatePropagation()},children:[!!a&&!!h?.length&&g&&(0,b.jsx)(f.default,{list:h,onBack:g}),i&&!!k?.length&&j&&(0,b.jsx)(d.default,{list:k,onBack:j,iterDurationMap:l}),m&&!!o?.length&&n&&(0,b.jsx)(e.default,{list:o,onBack:n,loopDurationMap:p,loopVariableMap:q}),!!r?.length&&s&&t&&(0,b.jsx)(c.AgentResultPanel,{agentOrToolLogItemStack:r,agentOrToolLogListMap:s,onShowAgentOrToolLog:t})]})},813027,a=>{"use strict";a.s(["default",()=>k]);var b=a.i(608061),c=a.i(429150),d=a.i(57843);a.i(752298);var e=a.i(693025),f=a.i(399450),g=a.i(527344),h=a.i(503309),i=a.i(957251),j=a.i(587988);let k=({list:a,className:k,hideNodeInfo:l=!1,hideNodeProcessDetail:m=!1})=>{let{t:n}=(0,e.useTranslation)(),o=(0,f.default)(a,n),[p,q]=(0,d.useState)(()=>new Set),[r,s]=(0,d.useState)(null),t=(0,d.useCallback)(a=>{s(a)},[]),u=(0,d.useCallback)(a=>{let b=a.relatedTarget;if(b&&"closest"in b){let a=b.closest("[data-parallel-id]");a?s(a.getAttribute("data-parallel-id")):s(null)}else s(null)},[]),{showSpecialResultPanel:v,showRetryDetail:w,setShowRetryDetailFalse:x,retryResultList:y,handleShowRetryResultList:z,showIteratingDetail:A,setShowIteratingDetailFalse:B,iterationResultList:C,iterationResultDurationMap:D,handleShowIterationResultList:E,showLoopingDetail:F,setShowLoopingDetailFalse:G,loopResultList:H,loopResultDurationMap:I,loopResultVariableMap:J,handleShowLoopResultList:K,agentOrToolLogItemStack:L,agentOrToolLogListMap:M,handleShowAgentOrToolLog:N}=(0,h.useLogs)(),O=d=>{if(d.parallelDetail?.isParallelStartNode){let a=d.parallelDetail,e=p.has(d.id),f=r===d.id;return(0,b.jsxs)("div",{className:"relative mb-2 ml-4","data-parallel-id":d.id,onMouseEnter:()=>t(d.id),onMouseLeave:u,children:[(0,b.jsxs)("div",{className:"mb-1 flex items-center",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{var a;return a=d.id,void q(b=>{let c=new Set(b);return c.has(a)?c.delete(a):c.add(a),c})},className:(0,g.cn)("mr-2 transition-colors",f?"rounded border-components-button-primary-border bg-components-button-primary-bg text-text-primary-on-surface":"text-text-secondary hover:text-text-primary"),children:f?(0,b.jsx)(c.RiArrowDownSLine,{className:"h-3 w-3"}):(0,b.jsx)(c.RiMenu4Line,{className:"h-3 w-3 text-text-tertiary"})}),(0,b.jsx)("div",{className:"system-xs-semibold-uppercase flex items-center text-text-secondary",children:(0,b.jsx)("span",{children:a.parallelTitle})}),(0,b.jsx)("div",{className:"mx-2 h-px grow bg-divider-subtle",style:{background:"linear-gradient(to right, rgba(16, 24, 40, 0.08), rgba(255, 255, 255, 0)"}})]}),(0,b.jsxs)("div",{className:`relative pl-2 ${e?"hidden":""}`,children:[(0,b.jsx)("div",{className:(0,g.cn)("absolute bottom-0 left-[5px] top-0 w-[2px]",f?"bg-text-accent-secondary":"bg-divider-subtle")}),a.children.map(O)]})]},d.id)}{let c=r===d.id;return(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:(0,g.cn)("system-2xs-medium-uppercase -mb-1.5 pl-4",c?"text-text-tertiary":"text-text-quaternary"),children:d?.parallelDetail?.branchTitle}),(0,b.jsx)(i.default,{nodeInfo:d,allExecutions:a,onShowIterationDetail:E,onShowLoopDetail:K,onShowRetryDetail:z,onShowAgentOrToolLog:N,hideInfo:l,hideProcessDetail:m})]},d.id)}};return v?(0,b.jsx)(j.default,{showRetryDetail:w,setShowRetryDetailFalse:x,retryResultList:y,showIteratingDetail:A,setShowIteratingDetailFalse:B,iterationResultList:C,iterationResultDurationMap:D,showLoopingDetail:F,setShowLoopingDetailFalse:G,loopResultList:H,loopResultDurationMap:I,loopResultVariableMap:J,agentOrToolLogItemStack:L,agentOrToolLogListMap:M,handleShowAgentOrToolLog:N}):(0,b.jsx)("div",{className:(0,g.cn)("py-2",k),onClick:a=>{a.stopPropagation(),a.nativeEvent.stopImmediatePropagation()},children:o.map(O)})}},785918,a=>{"use strict";var b=a.i(608061);a.i(752298);var c=a.i(693025),d=a.i(854867),e=a.i(471430),f=a.i(252813),g=a.i(527344);a.s(["default",0,({status:a,time:h,tokens:i,error:j,exceptionCounts:k,isListening:l=!1})=>{let{t:m}=(0,c.useTranslation)(),n=(0,f.useDocLink)();return(0,b.jsxs)(e.default,{status:a,children:[(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsxs)("div",{className:(0,g.cn)("max-w-[120px] flex-[33%]","partial-succeeded"===a&&"min-w-[140px]"),children:[(0,b.jsx)("div",{className:"system-2xs-medium-uppercase mb-1 text-text-tertiary",children:m("resultPanel.status",{ns:"runLog"})}),(0,b.jsxs)("div",{className:(0,g.cn)("system-xs-semibold-uppercase flex items-center gap-1","succeeded"===a&&"text-util-colors-green-green-600","partial-succeeded"===a&&"text-util-colors-green-green-600","failed"===a&&"text-util-colors-red-red-600","stopped"===a&&"text-util-colors-warning-warning-600","running"===a&&"text-util-colors-blue-light-blue-light-600"),children:["running"===a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.default,{color:"blue"}),(0,b.jsx)("span",{children:l?"Listening":"Running"})]}),"succeeded"===a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.default,{color:"green"}),(0,b.jsx)("span",{children:"SUCCESS"})]}),"partial-succeeded"===a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.default,{color:"green"}),(0,b.jsx)("span",{children:"PARTIAL SUCCESS"})]}),"exception"===a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.default,{color:"yellow"}),(0,b.jsx)("span",{children:"EXCEPTION"})]}),"failed"===a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.default,{color:"red"}),(0,b.jsx)("span",{children:"FAIL"})]}),"stopped"===a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.default,{color:"yellow"}),(0,b.jsx)("span",{children:"STOP"})]})]})]}),(0,b.jsxs)("div",{className:"max-w-[152px] flex-[33%]",children:[(0,b.jsx)("div",{className:"system-2xs-medium-uppercase mb-1 text-text-tertiary",children:m("resultPanel.time",{ns:"runLog"})}),(0,b.jsxs)("div",{className:"system-sm-medium flex items-center gap-1 text-text-secondary",children:["running"===a&&(0,b.jsx)("div",{className:"h-2 w-16 rounded-sm bg-text-quaternary"}),"running"!==a&&(0,b.jsx)("span",{children:h?`${h?.toFixed(3)}s`:"-"})]})]}),(0,b.jsxs)("div",{className:"flex-[33%]",children:[(0,b.jsx)("div",{className:"system-2xs-medium-uppercase mb-1 text-text-tertiary",children:m("resultPanel.tokens",{ns:"runLog"})}),(0,b.jsxs)("div",{className:"system-sm-medium flex items-center gap-1 text-text-secondary",children:["running"===a&&(0,b.jsx)("div",{className:"h-2 w-20 rounded-sm bg-text-quaternary"}),"running"!==a&&(0,b.jsx)("span",{children:`${i||0} Tokens`})]})]})]}),"failed"===a&&j&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"my-2 h-[0.5px] bg-divider-subtle"}),(0,b.jsx)("div",{className:"system-xs-regular whitespace-pre-wrap text-text-destructive",children:j}),!!k&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"my-2 h-[0.5px] bg-divider-subtle"}),(0,b.jsx)("div",{className:"system-xs-regular text-text-destructive",children:m("nodes.common.errorHandle.partialSucceeded.tip",{ns:"workflow",num:k})})]})]}),"partial-succeeded"===a&&!!k&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"my-2 h-[0.5px] bg-divider-deep"}),(0,b.jsx)("div",{className:"system-xs-medium text-text-warning",children:m("nodes.common.errorHandle.partialSucceeded.tip",{ns:"workflow",num:k})})]}),"exception"===a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"my-2 h-[0.5px] bg-divider-deep"}),(0,b.jsxs)("div",{className:"system-xs-medium text-text-warning",children:[j,(0,b.jsx)("a",{href:n("/use-dify/debug/error-type"),target:"_blank",className:"text-text-accent",children:m("common.learnMore",{ns:"workflow"})})]})]})]})}])}];

//# sourceMappingURL=app_components_f77ed754._.js.map