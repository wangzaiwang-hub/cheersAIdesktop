module.exports=[71905,a=>{"use strict";var b=a.i(57843);a.i(752298);var c=a.i(693025),d=a.i(263636);let e=["agent","rag","search","image","videos","weather","finance","design","travel","social","news","medical","productivity","education","business","entertainment","utilities","other"],f=[d.PluginCategoryEnum.model,d.PluginCategoryEnum.tool,d.PluginCategoryEnum.datasource,d.PluginCategoryEnum.agent,d.PluginCategoryEnum.extension,"bundle",d.PluginCategoryEnum.trigger],g={plugins:"plugins",marketplace:"discover"};a.s(["PLUGIN_PAGE_TABS_MAP",0,g,"useCategories",0,a=>{let{t:e}=(0,c.useTranslation)(),g=(0,b.useMemo)(()=>f.map(b=>b===d.PluginCategoryEnum.agent?{name:d.PluginCategoryEnum.agent,label:a?e("categorySingle.agent",{ns:"plugin"}):e("category.agents",{ns:"plugin"})}:{name:b,label:a?e(`categorySingle.${b}`,{ns:"plugin"}):e(`category.${b}s`,{ns:"plugin"})}),[e,a]),h=(0,b.useMemo)(()=>g.reduce((a,b)=>(a[b.name]=b,a),{}),[g]);return{categories:g,categoriesMap:h}},"usePluginPageTabs",0,()=>{let{t:a}=(0,c.useTranslation)();return[{value:g.plugins,text:a("menus.plugins",{ns:"common"})},{value:g.marketplace,text:a("menus.exploreMarketplace",{ns:"common"})}]},"useTags",0,()=>{let{t:a}=(0,c.useTranslation)(),d=(0,b.useMemo)(()=>e.map(b=>({name:b,label:a(`tags.${b}`,{ns:"pluginTags"})})),[a]),f=(0,b.useMemo)(()=>d.reduce((a,b)=>(a[b.name]=b,a),{}),[d]),g=(0,b.useMemo)(()=>a=>f[a]?f[a].label:a,[f]);return{tags:d,tagsMap:f,getTagLabel:g}}],71905)},515943,878023,891789,377143,a=>{"use strict";var b=a.i(608061),c=a.i(796807),d=a.i(673614);let e=({ref:a,...e})=>(0,b.jsx)(c.default,{...e,ref:a,data:d.default});e.displayName="BoxSparkleFill",a.s(["default",0,e],878023);var f=a.i(604233);let g=({ref:a,...d})=>(0,b.jsx)(c.default,{...d,ref:a,data:f.default});g.displayName="LeftCorner",a.s(["default",0,g],891789);var h=a.i(146);let i=({ref:a,...d})=>(0,b.jsx)(c.default,{...d,ref:a,data:h.default});i.displayName="Trigger",a.s(["default",0,i],377143),a.s([],515943)},5873,229190,778711,970039,547075,843990,28877,825503,500460,a=>{"use strict";var b=a.i(608061),c=a.i(245035),d=a.i(429150),e=a.i(57843),f=a.i(252813),g=a.i(730357),h=a.i(366231),i=a.i(954200),j=a.i(527344),k=a.i(796807),l=a.i(427256);let m=({ref:a,...c})=>(0,b.jsx)(k.default,{...c,ref:a,data:l.default});m.displayName="PartnerDark";var n=a.i(963664);let o=({ref:a,...c})=>(0,b.jsx)(k.default,{...c,ref:a,data:n.default});o.displayName="PartnerLight";var p=a.i(483664);let q=e.memo(({className:a,theme:c,popupContent:d,BadgeIconLight:e,BadgeIconDark:f})=>{let g=c===i.Theme.dark,h=(0,j.cn)("h-5 w-5",a);return(0,b.jsx)(p.default,{popupClassName:"p-1.5 border-[0.5px] border-[0.5px] border-components-panel-border bg-components-tooltip-bg text-text-secondary system-xs-medium",popupContent:d,children:(0,b.jsx)("div",{className:"flex shrink-0 items-center justify-center",children:(0,b.jsx)(g?f:e,{className:h})})})}),r=({className:a,text:c})=>{let{theme:d}=(0,g.default)();return(0,b.jsx)(q,{className:a,theme:d,BadgeIconLight:o,BadgeIconDark:m,popupContent:c})};var s=a.i(913788);let t=({ref:a,...c})=>(0,b.jsx)(k.default,{...c,ref:a,data:s.default});t.displayName="VerifiedDark";var u=a.i(397758);let v=({ref:a,...c})=>(0,b.jsx)(k.default,{...c,ref:a,data:u.default});v.displayName="VerifiedLight";let w=({className:a,text:c})=>{let{theme:d}=(0,g.default)();return(0,b.jsx)(q,{className:a,theme:d,BadgeIconLight:v,BadgeIconDark:t,popupContent:c})};a.s(["default",0,w],229190);var x=a.i(355968);a.i(10035);var y=a.i(2373);let z=a=>"object"==typeof a&&a?.content==="ðŸ”—";a.s(["shouldUseMcpIcon",0,z,"shouldUseMcpIconForAppIcon",0,(a,b)=>"emoji"===a&&"ðŸ”—"===b],778711);let A={xs:"w-4 h-4 text-base",tiny:"w-6 h-6 text-base",small:"w-8 h-8",medium:"w-9 h-9",large:"w-10 h-10"},B=({className:a,src:c,installed:e=!1,installFailed:f=!1,size:g="large"})=>{let h="flex justify-center items-center gap-2 absolute bottom-[-4px] right-[-4px] w-[18px] h-[18px] rounded-full border-2 border-components-panel-bg";return"object"==typeof c?(0,b.jsx)("div",{className:(0,j.cn)("relative",a),children:(0,b.jsx)(x.default,{size:g,iconType:"emoji",icon:c.content,background:c.background,className:"rounded-md",innerIcon:z(c)?(0,b.jsx)(y.Mcp,{className:"h-8 w-8 text-text-primary-on-surface"}):void 0})}):(0,b.jsxs)("div",{className:(0,j.cn)("relative shrink-0 rounded-md bg-contain bg-center bg-no-repeat",A[g],a),style:{backgroundImage:`url(${c})`},children:[e&&(0,b.jsx)("div",{className:(0,j.cn)(h,"bg-state-success-solid"),children:(0,b.jsx)(d.RiCheckLine,{className:"h-3 w-3 text-text-primary-on-surface"})}),f&&(0,b.jsx)("div",{className:(0,j.cn)(h,"bg-state-destructive-solid"),children:(0,b.jsx)(d.RiCloseLine,{className:"h-3 w-3 text-text-primary-on-surface"})})]})};a.s(["default",0,B],970039);var C=a.i(71905);a.i(515943);var D=a.i(891789),D=D;let E=({text:a})=>(0,b.jsxs)("div",{className:"absolute right-0 top-0 flex pl-[13px] ",children:[(0,b.jsx)(D.default,{className:"text-background-section"}),(0,b.jsx)("div",{className:"system-2xs-medium-uppercase h-5 rounded-tr-xl bg-background-section pr-2 leading-5 text-text-tertiary",children:a})]});a.s(["default",0,E],547075);let F=({className:a,text:c,descriptionLineRows:d})=>{let f=(0,e.useMemo)(()=>1===d?"h-4 truncate":2===d?"h-8 line-clamp-2":"h-12 line-clamp-3",[d]);return(0,b.jsx)("div",{className:(0,j.cn)("system-xs-regular text-text-tertiary",f,a),children:c})};a.s(["default",0,F],843990);let G=({className:a,orgName:c,packageName:d,packageNameClassName:e})=>(0,b.jsxs)("div",{className:(0,j.cn)("flex h-4 items-center space-x-0.5",a),children:[c&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"system-xs-regular shrink-0 text-text-tertiary",children:c}),(0,b.jsx)("span",{className:"system-xs-regular shrink-0 text-text-quaternary",children:"/"})]}),(0,b.jsx)("span",{className:(0,j.cn)("system-xs-regular w-0 shrink-0 grow truncate text-text-tertiary",e),children:d})]});a.s(["default",0,G],28877);var H=a.i(192875),I=a.i(423963);let J=({title:a})=>(0,b.jsx)("div",{className:"system-md-semibold truncate text-text-secondary",children:a});a.s(["default",0,J],825503);let K=({wrapClassName:a,loadingFileName:c})=>(0,b.jsxs)("div",{className:a,children:[(0,b.jsxs)(H.SkeletonRow,{children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center gap-2 rounded-[10px] border-[0.5px] border-components-panel-border bg-background-default p-1 backdrop-blur-sm",children:(0,b.jsx)("div",{className:"flex h-5 w-5 items-center justify-center",children:(0,b.jsx)(I.Group,{className:"text-text-tertiary"})})}),(0,b.jsx)("div",{className:"grow",children:(0,b.jsxs)(H.SkeletonContainer,{children:[(0,b.jsx)("div",{className:"flex h-5 items-center",children:c?(0,b.jsx)(J,{title:c}):(0,b.jsx)(H.SkeletonRectangle,{className:"w-[260px]"})}),(0,b.jsxs)(H.SkeletonRow,{className:"h-4",children:[(0,b.jsx)(H.SkeletonRectangle,{className:"w-[41px]"}),(0,b.jsx)(H.SkeletonPoint,{}),(0,b.jsx)(H.SkeletonRectangle,{className:"w-[180px]"})]})]})})]}),(0,b.jsx)(H.SkeletonRectangle,{className:"mt-3 w-[420px]"})]});a.s(["LoadingPlaceholder",0,({className:a})=>(0,b.jsx)("div",{className:(0,j.cn)("h-2 rounded-sm bg-text-quaternary opacity-20",a)}),"default",0,K],500460);let L=e.memo(({className:a,payload:e,titleLeft:k,installed:l,installFailed:m,hideCornerMark:n,descriptionLineRows:o=2,footer:p,isLoading:q=!1,loadingFileName:s,limitedInstall:t=!1})=>{let u=(0,f.useGetLanguage)(),{t:v}=(0,c.useTranslation)(),{categoriesMap:x}=(0,C.useCategories)(!0),{category:y,type:z,name:A,org:D,label:H,brief:I,icon:L,icon_dark:M,verified:N,badges:O=[]}=e,{theme:P}=(0,g.default)(),Q=P===i.Theme.dark&&M?M:L,R=a=>a?(0,h.renderI18nObject)(a,u):"",S=O.includes("partner"),T=(0,j.cn)("hover-bg-components-panel-on-panel-item-bg relative overflow-hidden rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-on-panel-item-bg shadow-xs",a);return q?(0,b.jsx)(K,{wrapClassName:T,loadingFileName:s}):(0,b.jsxs)("div",{className:T,children:[(0,b.jsxs)("div",{className:(0,j.cn)("p-4 pb-3",t&&"pb-1"),children:[!n&&(0,b.jsx)(E,{text:x["bundle"===z?z:y]?.label}),(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)(B,{src:Q,installed:l,installFailed:m}),(0,b.jsxs)("div",{className:"ml-3 w-0 grow",children:[(0,b.jsxs)("div",{className:"flex h-5 items-center",children:[(0,b.jsx)(J,{title:R(H)}),S&&(0,b.jsx)(r,{className:"ml-0.5 h-4 w-4",text:v("marketplace.partnerTip",{ns:"plugin"})}),N&&(0,b.jsx)(w,{className:"ml-0.5 h-4 w-4",text:v("marketplace.verifiedTip",{ns:"plugin"})}),k," "]}),(0,b.jsx)(G,{className:"mt-0.5",orgName:D,packageName:A})]})]}),(0,b.jsx)(F,{className:"mt-3",text:R(I),descriptionLineRows:o}),!!p&&(0,b.jsx)("div",{children:p})]}),t&&(0,b.jsxs)("div",{className:"relative flex h-8 items-center gap-x-2 px-3 after:absolute after:bottom-0 after:left-0 after:right-0 after:top-0 after:bg-toast-warning-bg after:opacity-40",children:[(0,b.jsx)(d.RiAlertFill,{className:"h-3 w-3 shrink-0 text-text-warning-secondary"}),(0,b.jsx)("p",{className:"system-xs-regular z-10 grow text-text-secondary",children:v("installModal.installWarning",{ns:"plugin"})})]})]})});a.s(["default",0,L],5873)},595879,a=>{"use strict";var b=a.i(947677),c=a.i(336836),d=a.i(654718);a.s(["convertRepoToUrl",0,a=>a?`https://github.com/${a}`:"","parseGitHubUrl",0,a=>{let b=/^https:\/\/github\.com\/([^/]+)\/([^/]+)\/?$/.exec(a);return b?{isValid:!0,owner:b[1],repo:b[2]}:{isValid:!1}},"pluginManifestInMarketToPluginProps",0,a=>({plugin_id:a.plugin_unique_identifier,type:a.category,category:a.category,name:a.name,version:a.latest_version,latest_version:a.latest_version,latest_package_identifier:"",org:a.org,label:a.label,brief:a.brief,description:a.brief,icon:a.icon,verified:!0,introduction:a.introduction,repository:"",install_count:0,endpoint:{settings:[]},tags:[],badges:a.badges,verification:!function(a){if(null==a)return!0;if((0,c.isArrayLike)(a))return(!("function"!=typeof a.splice&&"string"!=typeof a&&("u"<typeof Buffer||!Buffer.isBuffer(a)))||!!(0,d.isTypedArray)(a)||!!(0,b.isArguments)(a))&&0===a.length;if("object"==typeof a){let b;if(a instanceof Map||a instanceof Set)return 0===a.size;let c=Object.keys(a);return(b=a?.constructor,a===("function"==typeof b?b.prototype:Object.prototype))?0===c.filter(a=>"constructor"!==a).length:0===c.length}return!0}(a.verification)?a.verification:{authorized_category:"langgenius"},from:a.from}),"pluginManifestToCardPluginProps",0,a=>({plugin_id:a.plugin_unique_identifier,type:a.category,category:a.category,name:a.name,version:a.version,latest_version:"",latest_package_identifier:"",org:a.author,author:a.author,label:a.label,brief:a.description,description:a.description,icon:a.icon,icon_dark:a.icon_dark,verified:a.verified,introduction:"",repository:"",install_count:0,endpoint:{settings:[]},tags:a.tags.map(a=>({name:a})),badges:[],verification:{authorized_category:"langgenius"},from:"package"})],595879)},241101,118644,a=>{"use strict";var b=a.i(608061),c=a.i(57843);a.i(752298);var d=a.i(693025),e=a.i(648660),f=a.i(909795),g=a.i(5873),h=a.i(595879);let i=c.memo(({payload:a,isMarketPayload:c,isFailed:i,errMsg:j,onCancel:k})=>{let{t:l}=(0,d.useTranslation)();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex flex-col items-start justify-center gap-4 self-stretch px-6 py-3",children:[(0,b.jsx)("p",{className:"system-md-regular text-text-secondary",children:i&&j?j:l(`installModal.${i?"installFailedDesc":"installedSuccessfullyDesc"}`,{ns:"plugin"})}),a&&(0,b.jsx)("div",{className:"flex flex-wrap content-start items-start gap-1 self-stretch rounded-2xl bg-background-section-burn p-2",children:(0,b.jsx)(g.default,{className:"w-full",payload:c?(0,h.pluginManifestInMarketToPluginProps)(a):(0,h.pluginManifestToCardPluginProps)(a),installed:!i,installFailed:i,titleLeft:(0,b.jsx)(e.default,{className:"mx-1",size:"s",state:e.BadgeState.Default,children:a.version||a.latest_version})})})]}),(0,b.jsx)("div",{className:"flex items-center justify-end gap-2 self-stretch p-6 pt-5",children:(0,b.jsx)(f.default,{variant:"primary",className:"min-w-[72px]",onClick:()=>{k()},children:l("operation.close",{ns:"common"})})})]})});a.s(["default",0,i],241101);var j=a.i(459858);let k="install-modal";function l(a){let b=a.getBoundingClientRect();return{x:b.left+b.width/2+window.scrollX,y:b.top+b.height/2+window.scrollY}}a.s(["default",0,a=>{let b,d,e,f,{modalClassName:g,foldIntoAnim:h,clearCountDown:i,countDownFoldIntoAnim:m}=(d=()=>{clearTimeout(b)},e=async()=>{d();let b=document.querySelector(`.${k}`),c=document.getElementById("plugin-task-trigger")||document.querySelector(".plugins-nav-button");if(!b||!c)return void a();let e=l(b),f=b.getBoundingClientRect(),g=l(c),h=g.x-e.x,i=g.y-e.y,m=1/Math.max(f.width,f.height);b.style.transition="all cubic-bezier(0.4, 0, 0.2, 1) 750ms",b.style.transform=`translate(${h}px, ${i}px) scale(${m})`,await (0,j.sleep)(750),a()},f=async()=>{b=window.setTimeout(()=>{e()},15e3)},{modalClassName:k,foldIntoAnim:e,clearCountDown:d,countDownFoldIntoAnim:f}),[n,o]=(0,c.useState)(!1),p=(0,c.useCallback)(a=>{a||i(),o(a)},[i]),q=(0,c.useCallback)(()=>{n?h():a()},[h,n,a]),r=(0,c.useCallback)(()=>{p(!0),m()},[m,p]);return{modalClassName:g,foldAnimInto:q,setIsInstalling:p,handleStartToInstall:r}}],118644)},553953,a=>{"use strict";var b=a.i(57843);let c={enabled:!0};function d(a){var d;let e=(0,b.useRef)(void 0);e.current||(e.current=a??{all:d=d||new Map,on:function(a,b){var c=d.get(a);c?c.push(b):d.set(a,[b])},off:function(a,b){var c=d.get(a);c&&(b?c.splice(c.indexOf(b)>>>0,1):d.set(a,[]))},emit:function(a,b){var c=d.get(a);c&&c.slice().map(function(a){a(b)}),(c=d.get("*"))&&c.slice().map(function(c){c(a,b)})}}),a&&e.current!==a&&(e.current.off("*"),e.current=a);let f=e.current;return{emit:f.emit,useSubscribe:(a,d,e)=>{let{enabled:g}=((...a)=>Object.assign({},...a))(c,e);(0,b.useEffect)(()=>{if(g)return f.on(a,d),()=>f.off(a,d)})}}}a.s(["useMitt",()=>d],553953)},837080,a=>{"use strict";var b=a.i(238387),c=a.i(459858),d=a.i(263636);a.s(["default",0,function(){let a=d.TaskStatus.running,e=!1,f=async({taskId:g,pluginUniqueIdentifier:h})=>{if(e)return{status:d.TaskStatus.success};let{plugins:i}=(await (0,b.checkTaskStatus)(g)).task,j=i.find(a=>a.plugin_unique_identifier===h);return j?(a=j.status)===d.TaskStatus.running?(await (0,c.sleep)(1e4),await f({taskId:g,pluginUniqueIdentifier:h})):a===d.TaskStatus.failed?{status:d.TaskStatus.failed,error:j.message}:{status:d.TaskStatus.success}:(a=d.TaskStatus.failed,{status:d.TaskStatus.failed,error:"Plugin package not found"})};return{check:f,stop:()=>{e=!0}}}])},864314,(a,b,c)=>{"use strict";b.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||0x1fffffffffffff,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},143570,(a,b,c)=>{"use strict";b.exports="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...a)=>console.error("SEMVER",...a):()=>{}},217698,(a,b,c)=>{"use strict";let{MAX_SAFE_COMPONENT_LENGTH:d,MAX_SAFE_BUILD_LENGTH:e,MAX_LENGTH:f}=a.r(864314),g=a.r(143570),h=(c=b.exports={}).re=[],i=c.safeRe=[],j=c.src=[],k=c.safeSrc=[],l=c.t={},m=0,n="[a-zA-Z0-9-]",o=[["\\s",1],["\\d",f],[n,e]],p=(a,b,c)=>{let d=(a=>{for(let[b,c]of o)a=a.split(`${b}*`).join(`${b}{0,${c}}`).split(`${b}+`).join(`${b}{1,${c}}`);return a})(b),e=m++;g(a,e,b),l[a]=e,j[e]=b,k[e]=d,h[e]=new RegExp(b,c?"g":void 0),i[e]=new RegExp(d,c?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${n}*`),p("MAINVERSION",`(${j[l.NUMERICIDENTIFIER]})\\.(${j[l.NUMERICIDENTIFIER]})\\.(${j[l.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${j[l.NUMERICIDENTIFIERLOOSE]})\\.(${j[l.NUMERICIDENTIFIERLOOSE]})\\.(${j[l.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${j[l.NONNUMERICIDENTIFIER]}|${j[l.NUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${j[l.NONNUMERICIDENTIFIER]}|${j[l.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASE",`(?:-(${j[l.PRERELEASEIDENTIFIER]}(?:\\.${j[l.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${j[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${j[l.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${n}+`),p("BUILD",`(?:\\+(${j[l.BUILDIDENTIFIER]}(?:\\.${j[l.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${j[l.MAINVERSION]}${j[l.PRERELEASE]}?${j[l.BUILD]}?`),p("FULL",`^${j[l.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${j[l.MAINVERSIONLOOSE]}${j[l.PRERELEASELOOSE]}?${j[l.BUILD]}?`),p("LOOSE",`^${j[l.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${j[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${j[l.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${j[l.XRANGEIDENTIFIER]})(?:\\.(${j[l.XRANGEIDENTIFIER]})(?:\\.(${j[l.XRANGEIDENTIFIER]})(?:${j[l.PRERELEASE]})?${j[l.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${j[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${j[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${j[l.XRANGEIDENTIFIERLOOSE]})(?:${j[l.PRERELEASELOOSE]})?${j[l.BUILD]}?)?)?`),p("XRANGE",`^${j[l.GTLT]}\\s*${j[l.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${j[l.GTLT]}\\s*${j[l.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${d}})(?:\\.(\\d{1,${d}}))?(?:\\.(\\d{1,${d}}))?`),p("COERCE",`${j[l.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",j[l.COERCEPLAIN]+`(?:${j[l.PRERELEASE]})?`+`(?:${j[l.BUILD]})?`+"(?:$|[^\\d])"),p("COERCERTL",j[l.COERCE],!0),p("COERCERTLFULL",j[l.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${j[l.LONETILDE]}\\s+`,!0),c.tildeTrimReplace="$1~",p("TILDE",`^${j[l.LONETILDE]}${j[l.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${j[l.LONETILDE]}${j[l.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${j[l.LONECARET]}\\s+`,!0),c.caretTrimReplace="$1^",p("CARET",`^${j[l.LONECARET]}${j[l.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${j[l.LONECARET]}${j[l.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${j[l.GTLT]}\\s*(${j[l.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${j[l.GTLT]}\\s*(${j[l.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${j[l.GTLT]}\\s*(${j[l.LOOSEPLAIN]}|${j[l.XRANGEPLAIN]})`,!0),c.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${j[l.XRANGEPLAIN]})\\s+-\\s+(${j[l.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${j[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${j[l.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},503475,(a,b,c)=>{"use strict";let d=Object.freeze({loose:!0}),e=Object.freeze({});b.exports=a=>a?"object"!=typeof a?d:a:e},725496,(a,b,c)=>{"use strict";let d=/^[0-9]+$/,e=(a,b)=>{if("number"==typeof a&&"number"==typeof b)return a===b?0:a<b?-1:1;let c=d.test(a),e=d.test(b);return c&&e&&(a*=1,b*=1),a===b?0:c&&!e?-1:e&&!c?1:a<b?-1:1};b.exports={compareIdentifiers:e,rcompareIdentifiers:(a,b)=>e(b,a)}},979363,(a,b,c)=>{"use strict";let d=a.r(143570),{MAX_LENGTH:e,MAX_SAFE_INTEGER:f}=a.r(864314),{safeRe:g,t:h}=a.r(217698),i=a.r(503475),{compareIdentifiers:j}=a.r(725496);class k{constructor(a,b){if(b=i(b),a instanceof k)if(!!b.loose===a.loose&&!!b.includePrerelease===a.includePrerelease)return a;else a=a.version;else if("string"!=typeof a)throw TypeError(`Invalid version. Must be a string. Got type "${typeof a}".`);if(a.length>e)throw TypeError(`version is longer than ${e} characters`);d("SemVer",a,b),this.options=b,this.loose=!!b.loose,this.includePrerelease=!!b.includePrerelease;const c=a.trim().match(b.loose?g[h.LOOSE]:g[h.FULL]);if(!c)throw TypeError(`Invalid Version: ${a}`);if(this.raw=a,this.major=+c[1],this.minor=+c[2],this.patch=+c[3],this.major>f||this.major<0)throw TypeError("Invalid major version");if(this.minor>f||this.minor<0)throw TypeError("Invalid minor version");if(this.patch>f||this.patch<0)throw TypeError("Invalid patch version");c[4]?this.prerelease=c[4].split(".").map(a=>{if(/^[0-9]+$/.test(a)){let b=+a;if(b>=0&&b<f)return b}return a}):this.prerelease=[],this.build=c[5]?c[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(a){if(d("SemVer.compare",this.version,this.options,a),!(a instanceof k)){if("string"==typeof a&&a===this.version)return 0;a=new k(a,this.options)}return a.version===this.version?0:this.compareMain(a)||this.comparePre(a)}compareMain(a){return(a instanceof k||(a=new k(a,this.options)),this.major<a.major)?-1:this.major>a.major?1:this.minor<a.minor?-1:this.minor>a.minor?1:this.patch<a.patch?-1:+(this.patch>a.patch)}comparePre(a){if(a instanceof k||(a=new k(a,this.options)),this.prerelease.length&&!a.prerelease.length)return -1;if(!this.prerelease.length&&a.prerelease.length)return 1;if(!this.prerelease.length&&!a.prerelease.length)return 0;let b=0;do{let c=this.prerelease[b],e=a.prerelease[b];if(d("prerelease compare",b,c,e),void 0===c&&void 0===e)return 0;if(void 0===e)return 1;if(void 0===c)return -1;else if(c===e)continue;else return j(c,e)}while(++b)}compareBuild(a){a instanceof k||(a=new k(a,this.options));let b=0;do{let c=this.build[b],e=a.build[b];if(d("build compare",b,c,e),void 0===c&&void 0===e)return 0;if(void 0===e)return 1;if(void 0===c)return -1;else if(c===e)continue;else return j(c,e)}while(++b)}inc(a,b,c){if(a.startsWith("pre")){if(!b&&!1===c)throw Error("invalid increment argument: identifier is empty");if(b){let a=`-${b}`.match(this.options.loose?g[h.PRERELEASELOOSE]:g[h.PRERELEASE]);if(!a||a[1]!==b)throw Error(`invalid identifier: ${b}`)}}switch(a){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",b,c);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",b,c);break;case"prepatch":this.prerelease.length=0,this.inc("patch",b,c),this.inc("pre",b,c);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",b,c),this.inc("pre",b,c);break;case"release":if(0===this.prerelease.length)throw Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{let a=+!!Number(c);if(0===this.prerelease.length)this.prerelease=[a];else{let d=this.prerelease.length;for(;--d>=0;)"number"==typeof this.prerelease[d]&&(this.prerelease[d]++,d=-2);if(-1===d){if(b===this.prerelease.join(".")&&!1===c)throw Error("invalid increment argument: identifier already exists");this.prerelease.push(a)}}if(b){let d=[b,a];!1===c&&(d=[b]),0===j(this.prerelease[0],b)?isNaN(this.prerelease[1])&&(this.prerelease=d):this.prerelease=d}break}default:throw Error(`invalid increment argument: ${a}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}b.exports=k},588837,(a,b,c)=>{"use strict";let d=a.r(979363);b.exports=(a,b,c=!1)=>{if(a instanceof d)return a;try{return new d(a,b)}catch(a){if(!c)return null;throw a}}},465312,(a,b,c)=>{"use strict";let d=a.r(588837);b.exports=(a,b)=>{let c=d(a,b);return c?c.version:null}},118975,(a,b,c)=>{"use strict";let d=a.r(588837);b.exports=(a,b)=>{let c=d(a.trim().replace(/^[=v]+/,""),b);return c?c.version:null}},623952,(a,b,c)=>{"use strict";let d=a.r(979363);b.exports=(a,b,c,e,f)=>{"string"==typeof c&&(f=e,e=c,c=void 0);try{return new d(a instanceof d?a.version:a,c).inc(b,e,f).version}catch(a){return null}}},658895,(a,b,c)=>{"use strict";let d=a.r(588837);b.exports=(a,b)=>{let c=d(a,null,!0),e=d(b,null,!0),f=c.compare(e);if(0===f)return null;let g=f>0,h=g?c:e,i=g?e:c,j=!!h.prerelease.length;if(i.prerelease.length&&!j){if(!i.patch&&!i.minor)return"major";if(0===i.compareMain(h))return i.minor&&!i.patch?"minor":"patch"}let k=j?"pre":"";return c.major!==e.major?k+"major":c.minor!==e.minor?k+"minor":c.patch!==e.patch?k+"patch":"prerelease"}},419569,(a,b,c)=>{"use strict";let d=a.r(979363);b.exports=(a,b)=>new d(a,b).major},552302,(a,b,c)=>{"use strict";let d=a.r(979363);b.exports=(a,b)=>new d(a,b).minor},324019,(a,b,c)=>{"use strict";let d=a.r(979363);b.exports=(a,b)=>new d(a,b).patch},767044,(a,b,c)=>{"use strict";let d=a.r(588837);b.exports=(a,b)=>{let c=d(a,b);return c&&c.prerelease.length?c.prerelease:null}},530611,(a,b,c)=>{"use strict";let d=a.r(979363);b.exports=(a,b,c)=>new d(a,c).compare(new d(b,c))},1700,(a,b,c)=>{"use strict";let d=a.r(530611);b.exports=(a,b,c)=>d(b,a,c)},624939,(a,b,c)=>{"use strict";let d=a.r(530611);b.exports=(a,b)=>d(a,b,!0)},255180,(a,b,c)=>{"use strict";let d=a.r(979363);b.exports=(a,b,c)=>{let e=new d(a,c),f=new d(b,c);return e.compare(f)||e.compareBuild(f)}},642380,(a,b,c)=>{"use strict";let d=a.r(255180);b.exports=(a,b)=>a.sort((a,c)=>d(a,c,b))},115934,(a,b,c)=>{"use strict";let d=a.r(255180);b.exports=(a,b)=>a.sort((a,c)=>d(c,a,b))},333965,(a,b,c)=>{"use strict";let d=a.r(530611);b.exports=(a,b,c)=>d(a,b,c)>0},119396,(a,b,c)=>{"use strict";let d=a.r(530611);b.exports=(a,b,c)=>0>d(a,b,c)},767146,(a,b,c)=>{"use strict";let d=a.r(530611);b.exports=(a,b,c)=>0===d(a,b,c)},958551,(a,b,c)=>{"use strict";let d=a.r(530611);b.exports=(a,b,c)=>0!==d(a,b,c)},391540,(a,b,c)=>{"use strict";let d=a.r(530611);b.exports=(a,b,c)=>d(a,b,c)>=0},9973,(a,b,c)=>{"use strict";let d=a.r(530611);b.exports=(a,b,c)=>0>=d(a,b,c)},613791,(a,b,c)=>{"use strict";let d=a.r(767146),e=a.r(958551),f=a.r(333965),g=a.r(391540),h=a.r(119396),i=a.r(9973);b.exports=(a,b,c,j)=>{switch(b){case"===":return"object"==typeof a&&(a=a.version),"object"==typeof c&&(c=c.version),a===c;case"!==":return"object"==typeof a&&(a=a.version),"object"==typeof c&&(c=c.version),a!==c;case"":case"=":case"==":return d(a,c,j);case"!=":return e(a,c,j);case">":return f(a,c,j);case">=":return g(a,c,j);case"<":return h(a,c,j);case"<=":return i(a,c,j);default:throw TypeError(`Invalid operator: ${b}`)}}},360308,(a,b,c)=>{"use strict";let d=a.r(979363),e=a.r(588837),{safeRe:f,t:g}=a.r(217698);b.exports=(a,b)=>{if(a instanceof d)return a;if("number"==typeof a&&(a=String(a)),"string"!=typeof a)return null;let c=null;if((b=b||{}).rtl){let d,e=b.includePrerelease?f[g.COERCERTLFULL]:f[g.COERCERTL];for(;(d=e.exec(a))&&(!c||c.index+c[0].length!==a.length);)c&&d.index+d[0].length===c.index+c[0].length||(c=d),e.lastIndex=d.index+d[1].length+d[2].length;e.lastIndex=-1}else c=a.match(b.includePrerelease?f[g.COERCEFULL]:f[g.COERCE]);if(null===c)return null;let h=c[2],i=c[3]||"0",j=c[4]||"0",k=b.includePrerelease&&c[5]?`-${c[5]}`:"",l=b.includePrerelease&&c[6]?`+${c[6]}`:"";return e(`${h}.${i}.${j}${k}${l}`,b)}},480603,(a,b,c)=>{"use strict";b.exports=class{constructor(){this.max=1e3,this.map=new Map}get(a){let b=this.map.get(a);if(void 0!==b)return this.map.delete(a),this.map.set(a,b),b}delete(a){return this.map.delete(a)}set(a,b){if(!this.delete(a)&&void 0!==b){if(this.map.size>=this.max){let a=this.map.keys().next().value;this.delete(a)}this.map.set(a,b)}return this}}},747595,(a,b,c)=>{"use strict";let d=/\s+/g;class e{constructor(a,b){if(b=g(b),a instanceof e)if(!!b.loose===a.loose&&!!b.includePrerelease===a.includePrerelease)return a;else return new e(a.raw,b);if(a instanceof h)return this.raw=a.value,this.set=[[a]],this.formatted=void 0,this;if(this.options=b,this.loose=!!b.loose,this.includePrerelease=!!b.includePrerelease,this.raw=a.trim().replace(d," "),this.set=this.raw.split("||").map(a=>this.parseRange(a.trim())).filter(a=>a.length),!this.set.length)throw TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const a=this.set[0];if(this.set=this.set.filter(a=>!r(a[0])),0===this.set.length)this.set=[a];else if(this.set.length>1){for(const a of this.set)if(1===a.length&&s(a[0])){this.set=[a];break}}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let a=0;a<this.set.length;a++){a>0&&(this.formatted+="||");let b=this.set[a];for(let a=0;a<b.length;a++)a>0&&(this.formatted+=" "),this.formatted+=b[a].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(a){let b=((this.options.includePrerelease&&p)|(this.options.loose&&q))+":"+a,c=f.get(b);if(c)return c;let d=this.options.loose,e=d?k[l.HYPHENRANGELOOSE]:k[l.HYPHENRANGE];i("hyphen replace",a=a.replace(e,E(this.options.includePrerelease))),i("comparator trim",a=a.replace(k[l.COMPARATORTRIM],m)),i("tilde trim",a=a.replace(k[l.TILDETRIM],n)),i("caret trim",a=a.replace(k[l.CARETTRIM],o));let g=a.split(" ").map(a=>u(a,this.options)).join(" ").split(/\s+/).map(a=>D(a,this.options));d&&(g=g.filter(a=>(i("loose invalid filter",a,this.options),!!a.match(k[l.COMPARATORLOOSE])))),i("range list",g);let j=new Map;for(let a of g.map(a=>new h(a,this.options))){if(r(a))return[a];j.set(a.value,a)}j.size>1&&j.has("")&&j.delete("");let s=[...j.values()];return f.set(b,s),s}intersects(a,b){if(!(a instanceof e))throw TypeError("a Range is required");return this.set.some(c=>t(c,b)&&a.set.some(a=>t(a,b)&&c.every(c=>a.every(a=>c.intersects(a,b)))))}test(a){if(!a)return!1;if("string"==typeof a)try{a=new j(a,this.options)}catch(a){return!1}for(let b=0;b<this.set.length;b++)if(F(this.set[b],a,this.options))return!0;return!1}}b.exports=e;let f=new(a.r(480603)),g=a.r(503475),h=a.r(440255),i=a.r(143570),j=a.r(979363),{safeRe:k,t:l,comparatorTrimReplace:m,tildeTrimReplace:n,caretTrimReplace:o}=a.r(217698),{FLAG_INCLUDE_PRERELEASE:p,FLAG_LOOSE:q}=a.r(864314),r=a=>"<0.0.0-0"===a.value,s=a=>""===a.value,t=(a,b)=>{let c=!0,d=a.slice(),e=d.pop();for(;c&&d.length;)c=d.every(a=>e.intersects(a,b)),e=d.pop();return c},u=(a,b)=>(i("comp",a=a.replace(k[l.BUILD],""),b),i("caret",a=y(a,b)),i("tildes",a=w(a,b)),i("xrange",a=A(a,b)),i("stars",a=C(a,b)),a),v=a=>!a||"x"===a.toLowerCase()||"*"===a,w=(a,b)=>a.trim().split(/\s+/).map(a=>x(a,b)).join(" "),x=(a,b)=>{let c=b.loose?k[l.TILDELOOSE]:k[l.TILDE];return a.replace(c,(b,c,d,e,f)=>{let g;return i("tilde",a,b,c,d,e,f),v(c)?g="":v(d)?g=`>=${c}.0.0 <${+c+1}.0.0-0`:v(e)?g=`>=${c}.${d}.0 <${c}.${+d+1}.0-0`:f?(i("replaceTilde pr",f),g=`>=${c}.${d}.${e}-${f} <${c}.${+d+1}.0-0`):g=`>=${c}.${d}.${e} <${c}.${+d+1}.0-0`,i("tilde return",g),g})},y=(a,b)=>a.trim().split(/\s+/).map(a=>z(a,b)).join(" "),z=(a,b)=>{i("caret",a,b);let c=b.loose?k[l.CARETLOOSE]:k[l.CARET],d=b.includePrerelease?"-0":"";return a.replace(c,(b,c,e,f,g)=>{let h;return i("caret",a,b,c,e,f,g),v(c)?h="":v(e)?h=`>=${c}.0.0${d} <${+c+1}.0.0-0`:v(f)?h="0"===c?`>=${c}.${e}.0${d} <${c}.${+e+1}.0-0`:`>=${c}.${e}.0${d} <${+c+1}.0.0-0`:g?(i("replaceCaret pr",g),h="0"===c?"0"===e?`>=${c}.${e}.${f}-${g} <${c}.${e}.${+f+1}-0`:`>=${c}.${e}.${f}-${g} <${c}.${+e+1}.0-0`:`>=${c}.${e}.${f}-${g} <${+c+1}.0.0-0`):(i("no pr"),h="0"===c?"0"===e?`>=${c}.${e}.${f}${d} <${c}.${e}.${+f+1}-0`:`>=${c}.${e}.${f}${d} <${c}.${+e+1}.0-0`:`>=${c}.${e}.${f} <${+c+1}.0.0-0`),i("caret return",h),h})},A=(a,b)=>(i("replaceXRanges",a,b),a.split(/\s+/).map(a=>B(a,b)).join(" ")),B=(a,b)=>{a=a.trim();let c=b.loose?k[l.XRANGELOOSE]:k[l.XRANGE];return a.replace(c,(c,d,e,f,g,h)=>{i("xRange",a,c,d,e,f,g,h);let j=v(e),k=j||v(f),l=k||v(g);return"="===d&&l&&(d=""),h=b.includePrerelease?"-0":"",j?c=">"===d||"<"===d?"<0.0.0-0":"*":d&&l?(k&&(f=0),g=0,">"===d?(d=">=",k?(e=+e+1,f=0):f=+f+1,g=0):"<="===d&&(d="<",k?e=+e+1:f=+f+1),"<"===d&&(h="-0"),c=`${d+e}.${f}.${g}${h}`):k?c=`>=${e}.0.0${h} <${+e+1}.0.0-0`:l&&(c=`>=${e}.${f}.0${h} <${e}.${+f+1}.0-0`),i("xRange return",c),c})},C=(a,b)=>(i("replaceStars",a,b),a.trim().replace(k[l.STAR],"")),D=(a,b)=>(i("replaceGTE0",a,b),a.trim().replace(k[b.includePrerelease?l.GTE0PRE:l.GTE0],"")),E=a=>(b,c,d,e,f,g,h,i,j,k,l,m)=>(c=v(d)?"":v(e)?`>=${d}.0.0${a?"-0":""}`:v(f)?`>=${d}.${e}.0${a?"-0":""}`:g?`>=${c}`:`>=${c}${a?"-0":""}`,i=v(j)?"":v(k)?`<${+j+1}.0.0-0`:v(l)?`<${j}.${+k+1}.0-0`:m?`<=${j}.${k}.${l}-${m}`:a?`<${j}.${k}.${+l+1}-0`:`<=${i}`,`${c} ${i}`.trim()),F=(a,b,c)=>{for(let c=0;c<a.length;c++)if(!a[c].test(b))return!1;if(b.prerelease.length&&!c.includePrerelease){for(let c=0;c<a.length;c++)if(i(a[c].semver),a[c].semver!==h.ANY&&a[c].semver.prerelease.length>0){let d=a[c].semver;if(d.major===b.major&&d.minor===b.minor&&d.patch===b.patch)return!0}return!1}return!0}},440255,(a,b,c)=>{"use strict";let d=Symbol("SemVer ANY");class e{static get ANY(){return d}constructor(a,b){if(b=f(b),a instanceof e)if(!!b.loose===a.loose)return a;else a=a.value;j("comparator",a=a.trim().split(/\s+/).join(" "),b),this.options=b,this.loose=!!b.loose,this.parse(a),this.semver===d?this.value="":this.value=this.operator+this.semver.version,j("comp",this)}parse(a){let b=this.options.loose?g[h.COMPARATORLOOSE]:g[h.COMPARATOR],c=a.match(b);if(!c)throw TypeError(`Invalid comparator: ${a}`);this.operator=void 0!==c[1]?c[1]:"","="===this.operator&&(this.operator=""),c[2]?this.semver=new k(c[2],this.options.loose):this.semver=d}toString(){return this.value}test(a){if(j("Comparator.test",a,this.options.loose),this.semver===d||a===d)return!0;if("string"==typeof a)try{a=new k(a,this.options)}catch(a){return!1}return i(a,this.operator,this.semver,this.options)}intersects(a,b){if(!(a instanceof e))throw TypeError("a Comparator is required");return""===this.operator?""===this.value||new l(a.value,b).test(this.value):""===a.operator?""===a.value||new l(this.value,b).test(a.semver):!((b=f(b)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===a.value)||!b.includePrerelease&&(this.value.startsWith("<0.0.0")||a.value.startsWith("<0.0.0")))&&!!(this.operator.startsWith(">")&&a.operator.startsWith(">")||this.operator.startsWith("<")&&a.operator.startsWith("<")||this.semver.version===a.semver.version&&this.operator.includes("=")&&a.operator.includes("=")||i(this.semver,"<",a.semver,b)&&this.operator.startsWith(">")&&a.operator.startsWith("<")||i(this.semver,">",a.semver,b)&&this.operator.startsWith("<")&&a.operator.startsWith(">"))}}b.exports=e;let f=a.r(503475),{safeRe:g,t:h}=a.r(217698),i=a.r(613791),j=a.r(143570),k=a.r(979363),l=a.r(747595)},133224,(a,b,c)=>{"use strict";let d=a.r(747595);b.exports=(a,b,c)=>{try{b=new d(b,c)}catch(a){return!1}return b.test(a)}},734495,(a,b,c)=>{"use strict";let d=a.r(747595);b.exports=(a,b)=>new d(a,b).set.map(a=>a.map(a=>a.value).join(" ").trim().split(" "))},829890,(a,b,c)=>{"use strict";let d=a.r(979363),e=a.r(747595);b.exports=(a,b,c)=>{let f=null,g=null,h=null;try{h=new e(b,c)}catch(a){return null}return a.forEach(a=>{h.test(a)&&(!f||-1===g.compare(a))&&(g=new d(f=a,c))}),f}},745459,(a,b,c)=>{"use strict";let d=a.r(979363),e=a.r(747595);b.exports=(a,b,c)=>{let f=null,g=null,h=null;try{h=new e(b,c)}catch(a){return null}return a.forEach(a=>{h.test(a)&&(!f||1===g.compare(a))&&(g=new d(f=a,c))}),f}},721055,(a,b,c)=>{"use strict";let d=a.r(979363),e=a.r(747595),f=a.r(333965);b.exports=(a,b)=>{a=new e(a,b);let c=new d("0.0.0");if(a.test(c)||(c=new d("0.0.0-0"),a.test(c)))return c;c=null;for(let b=0;b<a.set.length;++b){let e=a.set[b],g=null;e.forEach(a=>{let b=new d(a.semver.version);switch(a.operator){case">":0===b.prerelease.length?b.patch++:b.prerelease.push(0),b.raw=b.format();case"":case">=":(!g||f(b,g))&&(g=b);break;case"<":case"<=":break;default:throw Error(`Unexpected operation: ${a.operator}`)}}),g&&(!c||f(c,g))&&(c=g)}return c&&a.test(c)?c:null}},814814,(a,b,c)=>{"use strict";let d=a.r(747595);b.exports=(a,b)=>{try{return new d(a,b).range||"*"}catch(a){return null}}},142635,(a,b,c)=>{"use strict";let d=a.r(979363),e=a.r(440255),{ANY:f}=e,g=a.r(747595),h=a.r(133224),i=a.r(333965),j=a.r(119396),k=a.r(9973),l=a.r(391540);b.exports=(a,b,c,m)=>{let n,o,p,q,r;switch(a=new d(a,m),b=new g(b,m),c){case">":n=i,o=k,p=j,q=">",r=">=";break;case"<":n=j,o=l,p=i,q="<",r="<=";break;default:throw TypeError('Must provide a hilo val of "<" or ">"')}if(h(a,b,m))return!1;for(let c=0;c<b.set.length;++c){let d=b.set[c],g=null,h=null;if(d.forEach(a=>{a.semver===f&&(a=new e(">=0.0.0")),g=g||a,h=h||a,n(a.semver,g.semver,m)?g=a:p(a.semver,h.semver,m)&&(h=a)}),g.operator===q||g.operator===r||(!h.operator||h.operator===q)&&o(a,h.semver)||h.operator===r&&p(a,h.semver))return!1}return!0}},134115,(a,b,c)=>{"use strict";let d=a.r(142635);b.exports=(a,b,c)=>d(a,b,">",c)},304911,(a,b,c)=>{"use strict";let d=a.r(142635);b.exports=(a,b,c)=>d(a,b,"<",c)},981291,(a,b,c)=>{"use strict";let d=a.r(747595);b.exports=(a,b,c)=>(a=new d(a,c),b=new d(b,c),a.intersects(b,c))},364285,(a,b,c)=>{"use strict";let d=a.r(133224),e=a.r(530611);b.exports=(a,b,c)=>{let f=[],g=null,h=null,i=a.sort((a,b)=>e(a,b,c));for(let a of i)d(a,b,c)?(h=a,g||(g=a)):(h&&f.push([g,h]),h=null,g=null);g&&f.push([g,null]);let j=[];for(let[a,b]of f)a===b?j.push(a):b||a!==i[0]?b?a===i[0]?j.push(`<=${b}`):j.push(`${a} - ${b}`):j.push(`>=${a}`):j.push("*");let k=j.join(" || "),l="string"==typeof b.raw?b.raw:String(b);return k.length<l.length?k:b}},789277,(a,b,c)=>{"use strict";let d=a.r(747595),e=a.r(440255),{ANY:f}=e,g=a.r(133224),h=a.r(530611),i=[new e(">=0.0.0-0")],j=[new e(">=0.0.0")],k=(a,b,c)=>{let d,e,k,n,o,p,q;if(a===b)return!0;if(1===a.length&&a[0].semver===f)if(1===b.length&&b[0].semver===f)return!0;else a=c.includePrerelease?i:j;if(1===b.length&&b[0].semver===f)if(c.includePrerelease)return!0;else b=j;let r=new Set;for(let b of a)">"===b.operator||">="===b.operator?d=l(d,b,c):"<"===b.operator||"<="===b.operator?e=m(e,b,c):r.add(b.semver);if(r.size>1)return null;if(d&&e&&((k=h(d.semver,e.semver,c))>0||0===k&&(">="!==d.operator||"<="!==e.operator)))return null;for(let a of r){if(d&&!g(a,String(d),c)||e&&!g(a,String(e),c))return null;for(let d of b)if(!g(a,String(d),c))return!1;return!0}let s=!!e&&!c.includePrerelease&&!!e.semver.prerelease.length&&e.semver,t=!!d&&!c.includePrerelease&&!!d.semver.prerelease.length&&d.semver;for(let a of(s&&1===s.prerelease.length&&"<"===e.operator&&0===s.prerelease[0]&&(s=!1),b)){if(q=q||">"===a.operator||">="===a.operator,p=p||"<"===a.operator||"<="===a.operator,d){if(t&&a.semver.prerelease&&a.semver.prerelease.length&&a.semver.major===t.major&&a.semver.minor===t.minor&&a.semver.patch===t.patch&&(t=!1),">"===a.operator||">="===a.operator){if((n=l(d,a,c))===a&&n!==d)return!1}else if(">="===d.operator&&!g(d.semver,String(a),c))return!1}if(e){if(s&&a.semver.prerelease&&a.semver.prerelease.length&&a.semver.major===s.major&&a.semver.minor===s.minor&&a.semver.patch===s.patch&&(s=!1),"<"===a.operator||"<="===a.operator){if((o=m(e,a,c))===a&&o!==e)return!1}else if("<="===e.operator&&!g(e.semver,String(a),c))return!1}if(!a.operator&&(e||d)&&0!==k)return!1}return(!d||!p||!!e||0===k)&&(!e||!q||!!d||0===k)&&!t&&!s&&!0},l=(a,b,c)=>{if(!a)return b;let d=h(a.semver,b.semver,c);return d>0?a:d<0||">"===b.operator&&">="===a.operator?b:a},m=(a,b,c)=>{if(!a)return b;let d=h(a.semver,b.semver,c);return d<0?a:d>0||"<"===b.operator&&"<="===a.operator?b:a};b.exports=(a,b,c={})=>{if(a===b)return!0;a=new d(a,c),b=new d(b,c);let e=!1;a:for(let d of a.set){for(let a of b.set){let b=k(d,a,c);if(e=e||null!==b,b)continue a}if(e)return!1}return!0}},854868,(a,b,c)=>{"use strict";let d=a.r(217698),e=a.r(864314),f=a.r(979363),g=a.r(725496),h=a.r(588837),i=a.r(465312),j=a.r(118975),k=a.r(623952),l=a.r(658895),m=a.r(419569),n=a.r(552302),o=a.r(324019),p=a.r(767044),q=a.r(530611),r=a.r(1700),s=a.r(624939),t=a.r(255180),u=a.r(642380),v=a.r(115934),w=a.r(333965),x=a.r(119396),y=a.r(767146),z=a.r(958551),A=a.r(391540),B=a.r(9973),C=a.r(613791),D=a.r(360308),E=a.r(440255),F=a.r(747595),G=a.r(133224),H=a.r(734495),I=a.r(829890),J=a.r(745459),K=a.r(721055),L=a.r(814814),M=a.r(142635),N=a.r(134115),O=a.r(304911),P=a.r(981291);b.exports={parse:h,valid:i,clean:j,inc:k,diff:l,major:m,minor:n,patch:o,prerelease:p,compare:q,rcompare:r,compareLoose:s,compareBuild:t,sort:u,rsort:v,gt:w,lt:x,eq:y,neq:z,gte:A,lte:B,cmp:C,coerce:D,Comparator:E,Range:F,satisfies:G,toComparators:H,maxSatisfying:I,minSatisfying:J,minVersion:K,validRange:L,outside:M,gtr:N,ltr:O,intersects:P,simplifyRange:a.r(364285),subset:a.r(789277),SemVer:f,re:d.re,src:d.src,tokens:d.t,SEMVER_SPEC_VERSION:e.SEMVER_SPEC_VERSION,RELEASE_TYPES:e.RELEASE_TYPES,compareIdentifiers:g.compareIdentifiers,rcompareIdentifiers:g.rcompareIdentifiers}},917122,104188,601349,226181,782900,a=>{"use strict";var b=a.i(608061),c=a.i(57843);a.i(752298);var d=a.i(693025),e=a.i(940272),f=a.i(527344),g=a.i(263636),h=a.i(241101),i=a.i(118644),j=a.i(757014),k=a.i(429150),l=a.i(909795),m=a.i(168799),n=a.i(465592),o=a.i(111089),p=a.i(639378),q=a.i(553953);let r=(0,p.createContext)({emit:o.noop,useSubscribe:o.noop});function s(a){return(0,p.useContextSelector)(r,a)}a.s(["MittProvider",0,({children:a})=>{let c=(0,q.useMitt)();return(0,b.jsx)(r.Provider,{value:c,children:a})},"useMittContextSelector",()=>s],104188);var t=a.i(781362),u=a.i(837080),v=a.i(494261);let w=a=>{let{data:b,isLoading:d,error:e}=(0,t.useCheckInstalled)(a);return{installedInfo:(0,c.useMemo)(()=>{if(!b)return;let a={};return b?.plugins.forEach(b=>{a[b.plugin_id]={installedId:b.id,installedVersion:b.declaration.version,uniqueIdentifier:b.plugin_unique_identifier}}),a},[b]),isLoading:d,error:e}};a.s(["default",0,w],601349);var x=a.i(724423),y=a.i(500460);a.i(10035);var z=a.i(423963);let A=c.memo(()=>{let{t:a}=(0,d.useTranslation)();return(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(m.default,{className:"shrink-0",checked:!1,disabled:!0}),(0,b.jsxs)("div",{className:"hover-bg-components-panel-on-panel-item-bg relative grow rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-on-panel-item-bg p-4 pb-3 shadow-xs",children:[(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsxs)("div",{className:"relative flex h-10 w-10 items-center justify-center gap-2 rounded-[10px] border-[0.5px] border-state-destructive-border bg-state-destructive-hover p-1 backdrop-blur-sm",children:[(0,b.jsx)("div",{className:"flex h-5 w-5 items-center justify-center",children:(0,b.jsx)(z.Group,{className:"text-text-quaternary"})}),(0,b.jsx)("div",{className:"absolute bottom-[-4px] right-[-4px] rounded-full border-[2px] border-components-panel-bg bg-state-destructive-solid",children:(0,b.jsx)(k.RiCloseLine,{className:"h-3 w-3 text-text-primary-on-surface"})})]}),(0,b.jsxs)("div",{className:"ml-3 grow",children:[(0,b.jsx)("div",{className:"system-md-semibold flex h-5 items-center text-text-destructive",children:a("installModal.pluginLoadError",{ns:"plugin"})}),(0,b.jsx)("div",{className:"system-xs-regular mt-0.5 text-text-tertiary",children:a("installModal.pluginLoadErrorDesc",{ns:"plugin"})})]})]}),(0,b.jsx)(y.LoadingPlaceholder,{className:"mt-3 w-[420px]"})]})]})});var B=a.i(850953);function C(a,b){if(b.plugin_installation_permission.restrict_to_marketplace_only&&("github"===a.from||"package"===a.from))return{canInstall:!1};if(b.plugin_installation_permission.plugin_installation_scope===B.InstallationScope.ALL)return{canInstall:!0};if(b.plugin_installation_permission.plugin_installation_scope===B.InstallationScope.NONE)return{canInstall:!1};let c=a.verification||{};return(a.verification&&a.verification.authorized_category||(c.authorized_category="langgenius"),b.plugin_installation_permission.plugin_installation_scope===B.InstallationScope.OFFICIAL_ONLY)?{canInstall:"langgenius"===c.authorized_category}:b.plugin_installation_permission.plugin_installation_scope===B.InstallationScope.OFFICIAL_AND_PARTNER?{canInstall:"langgenius"===c.authorized_category||"partner"===c.authorized_category}:{canInstall:!0}}function D(a){return C(a,(0,x.useGlobalPublicStore)(a=>a.systemFeatures))}let E=c.memo(()=>(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(m.default,{className:"shrink-0",checked:!1,disabled:!0}),(0,b.jsx)("div",{className:"hover-bg-components-panel-on-panel-item-bg relative grow rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-on-panel-item-bg p-4 pb-3 shadow-xs",children:(0,b.jsx)(y.default,{wrapClassName:"w-full"})})]}));var F=a.i(595879),G=a.i(18039),H=a.i(5873),I=a.i(302785),J=a.i(648660);let K=c.memo(({hasInstalled:a,installedVersion:c,toInstallVersion:d})=>(0,b.jsx)(b.Fragment,{children:a?(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(J.default,{className:"mx-1",size:"s",state:J.BadgeState.Warning,children:`${c} -> ${d}`})}):(0,b.jsx)(J.default,{className:"mx-1",size:"s",state:J.BadgeState.Default,children:d})}));a.s(["default",0,K],226181);let L=c.memo(({checked:a,onCheckedChange:c,payload:d,isFromMarketPlace:e,versionInfo:f})=>{let{getIconUrl:g}=(0,I.default)(),h={...f,toInstallVersion:d.version},{canInstall:i}=D(d);return(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(m.default,{disabled:!i,className:"shrink-0",checked:a,onCheck:()=>c(d)}),(0,b.jsx)(H.default,{className:"grow",payload:{...d,icon:e?`${G.MARKETPLACE_API_PREFIX}/plugins/${d.org}/${d.name}/icon`:g(d.icon)},titleLeft:d.version?(0,b.jsx)(K,{...h}):null,limitedInstall:!i})]})}),M=c.memo(({checked:a,onCheckedChange:d,dependency:e,versionInfo:f,onFetchedPayload:g,onFetchError:h})=>{let i=e.value,{data:j,error:k}=(0,t.useUploadGitHub)({repo:i.repo,version:i.release||i.version,package:i.packages||i.package}),[l,m]=c.useState(null);return((0,c.useEffect)(()=>{if(j){let a={...(0,F.pluginManifestToCardPluginProps)(j.manifest),plugin_id:j.unique_identifier};g(a),m({...a,from:e.type})}},[j]),(0,c.useEffect)(()=>{k&&h()},[k]),l)?(0,b.jsx)(L,{payload:l,versionInfo:f,checked:a,onCheckedChange:d}):(0,b.jsx)(E,{})}),N=c.memo(({checked:a,onCheckedChange:c,payload:d,version:e,versionInfo:f})=>d?(0,b.jsx)(L,{checked:a,onCheckedChange:c,payload:{...d,version:e},isFromMarketPlace:!0,versionInfo:f}):(0,b.jsx)(E,{})),O=c.memo(({payload:a,checked:c,onCheckedChange:d,isFromMarketPlace:e,versionInfo:f})=>{if(!a.value?.manifest)return(0,b.jsx)(A,{});let g=(0,F.pluginManifestToCardPluginProps)(a.value.manifest);return(0,b.jsx)(L,{payload:{...g,from:a.type},checked:c,onCheckedChange:d,isFromMarketPlace:e,versionInfo:f})}),P=({allPlugins:a,selectedPlugins:d,onSelect:e,onSelectAll:f,onDeSelectAll:g,onLoadedAllPlugin:h,isFromMarketPlace:i,ref:j})=>{let k=(0,x.useGlobalPublicStore)(a=>a.systemFeatures),{isLoading:l,data:m,error:n}=(0,t.useFetchPluginsInMarketPlaceByInfo)(a.filter(a=>"marketplace"===a.type).map(a=>{let[b,c]=a.value.marketplace_plugin_unique_identifier.split("@")[0].split("/"),[d,e]=c.split(":");return{organization:b,plugin:d,version:e}})),{isLoading:o,data:p,error:q}=(0,t.useFetchPluginsInMarketPlaceByInfo)(a.filter(a=>"marketplace"===a.type).map(a=>a.value)),[r,s]=(0,c.useState)(a.some(a=>"package"===a.type)?a.map(a=>{if("package"===a.type)return{...a.value.manifest,plugin_id:a.value.unique_identifier}}):[]),u=c.useRef(r),y=(0,c.useCallback)(a=>{s(a),u.current=a},[]),[z,B]=(0,c.useState)([]),D=(0,c.useCallback)(a=>b=>{y((0,v.produce)(u.current,c=>{c[a]=b}))},[y]),E=(0,c.useCallback)(a=>()=>{B([...z,a])},[z]),F=(0,c.useMemo)(()=>{let b=[];return a.forEach((a,c)=>{"marketplace"===a.type&&b.push(c)}),b},[a]);(0,c.useEffect)(()=>{if(!l&&m?.data.list){let b=a.filter(a=>"marketplace"===a.type).map(a=>{let b=a.value.marketplace_plugin_unique_identifier?.split(":")[0];return{...m.data.list.find(a=>a.plugin.plugin_id===b)?.plugin,from:a.type}}),c=[];y((0,v.produce)(u.current,a=>{F.forEach((d,e)=>{b[e]?a[d]={...b[e],version:b[e].version||b[e].latest_version}:c.push(d)})})),c.length>0&&B([...z,...c])}},[l]),(0,c.useEffect)(()=>{if(!o&&p?.data.list){let a=p?.data.list,b=[];y((0,v.produce)(u.current,c=>{F.forEach((d,e)=>{if(a[e]){let b=a[e];c[d]={...b.plugin,plugin_id:b.version.unique_identifier}}else b.push(d)})})),b.length>0&&B([...z,...b])}},[o]),(0,c.useEffect)(()=>{(q||n)&&B([...z,...F])},[q,n]);let G=r.filter(a=>!!a).length+z.length===a.length,{installedInfo:H}=w({pluginIds:r?.filter(a=>!!a).map(a=>`${a?.org||a?.author}/${a?.name}`)||[],enabled:G}),I=(0,c.useCallback)(a=>{let b=H?.[a];return{hasInstalled:!!b,installedVersion:b?.installedVersion,toInstallVersion:""}},[H]);(0,c.useEffect)(()=>{G&&H&&h(H)},[G,H]);let J=(0,c.useCallback)(a=>()=>{let b=r.filter(a=>{let{canInstall:b}=C(a,k);return b});e(r[a],a,b.length)},[e,r,k]);return(0,c.useImperativeHandle)(j,()=>({selectAllPlugins:()=>{let b=[],c=[];a.forEach((a,d)=>{let e=r[d];if(!e)return;let{canInstall:f}=C(e,k);f&&(b.push(d),c.push(e))}),f(c,b)},deSelectAllPlugins:()=>{g()}})),(0,b.jsx)(b.Fragment,{children:a.map((a,c)=>{if(z.includes(c))return(0,b.jsx)(A,{},c);let e=r[c];return"github"===a.type?(0,b.jsx)(M,{checked:!!d.find(a=>a.plugin_id===r[c]?.plugin_id),onCheckedChange:J(c),dependency:a,onFetchedPayload:D(c),onFetchError:E(c),versionInfo:I(`${e?.org||e?.author}/${e?.name}`)},c):"marketplace"===a.type?(0,b.jsx)(N,{checked:!!d.find(a=>a.plugin_id===r[c]?.plugin_id),onCheckedChange:J(c),payload:{...e,from:a.type},version:a.value.version||e?.version||"",versionInfo:I(`${e?.org||e?.author}/${e?.name}`)},c):(0,b.jsx)(O,{checked:!!d.find(a=>a.plugin_id===r[c]?.plugin_id),onCheckedChange:J(c),payload:a,isFromMarketPlace:i,versionInfo:I(`${e?.org||e?.author}/${e?.name}`)},c)})})},Q="installModal",R=c.memo(({allPlugins:a,onStartToInstall:e,onInstalled:f,onCancel:h,isFromMarketPlace:i,isHideButton:o})=>{let{t:p}=(0,d.useTranslation)(),q=s(a=>a.emit),[r,v]=c.useState([]),[w,x]=c.useState([]),y=r.length,z=(0,c.useRef)(null),{refreshPluginList:A}=(0,j.default)(),[B,C]=(0,c.useState)(!1),D=(0,c.useCallback)(()=>{B?z.current?.deSelectAllPlugins():z.current?.selectAllPlugins()},[B]),[E,F]=c.useState(!1),[G,H]=(0,c.useState)(void 0),I=(0,c.useCallback)(a=>{D(),H(a),F(!0)},[]),{check:J,stop:K}=(0,u.default)(),L=(0,c.useCallback)(()=>{K(),h()},[h,K]),{handleRefetch:M}=(0,t.usePluginTaskList)(),{mutate:N,isPending:O}=(0,t.useInstallOrUpdate)({onSuccess:async b=>{if(b.every(a=>a.status===g.TaskStatus.success||a.status===g.TaskStatus.failed)){f(r,b.map((b,c)=>({success:b.status===g.TaskStatus.success,isFromMarketPlace:"marketplace"===a[w[c]].type}))),b.some(a=>a.status===g.TaskStatus.success)&&(A(void 0,!0),q("plugin:install:success",r.map(a=>`${a.plugin_id}/${a.name}`)));return}M();let c=await Promise.all(b.map(async(b,c)=>{if(b.status!==g.TaskStatus.running)return{success:b.status===g.TaskStatus.success,isFromMarketPlace:"marketplace"===a[w[c]].type};let{status:d}=await J({taskId:b.taskId,pluginUniqueIdentifier:b.uniqueIdentifier});return{success:d===g.TaskStatus.success,isFromMarketPlace:"marketplace"===a[w[c]].type}}));f(r,c),c.some(a=>a.success)&&q("plugin:install:success",r.map(a=>`${a.plugin_id}/${a.name}`))}}),[R,S]=(0,c.useState)(!1),T=(0,c.useCallback)((a,b)=>{v(a),x(b),C(!0),S(!1)},[]),U=(0,c.useCallback)(()=>{v([]),x([]),C(!1),S(!1)},[]),V=(0,c.useCallback)((a,b,c)=>{let d,e=!!r.find(b=>b.plugin_id===a.plugin_id);v(d=e?r.filter(b=>b.plugin_id!==a.plugin_id):[...r,a]),x(e?w.filter(a=>a!==b):[...w,b]),0===d.length?(C(!1),S(!1)):d.length===c?(C(!0),S(!1)):(S(!0),C(!1))},[r,w]),{canInstallPluginFromMarketplace:W}=(0,n.useCanInstallPluginFromMarketplace)();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex flex-col items-start justify-center gap-4 self-stretch px-6 py-3",children:[(0,b.jsx)("div",{className:"system-md-regular text-text-secondary",children:(0,b.jsx)("p",{children:p(`${Q}.${y>1?"readyToInstallPackages":"readyToInstallPackage"}`,{ns:"plugin",num:y})})}),(0,b.jsx)("div",{className:"w-full space-y-1 rounded-2xl bg-background-section-burn p-2",children:(0,b.jsx)(P,{ref:z,allPlugins:a,selectedPlugins:r,onSelect:V,onSelectAll:T,onDeSelectAll:U,onLoadedAllPlugin:I,isFromMarketPlace:i})})]}),!o&&(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2 self-stretch p-6 pt-5",children:[(0,b.jsx)("div",{className:"px-2",children:E&&(0,b.jsxs)("div",{className:"flex items-center gap-x-2",onClick:D,children:[(0,b.jsx)(m.default,{checked:B,indeterminate:R}),(0,b.jsx)("p",{className:"system-sm-medium cursor-pointer text-text-secondary",children:p(B?"operation.deSelectAll":"operation.selectAll",{ns:"common"})})]})}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2 self-stretch",children:[!E&&(0,b.jsx)(l.default,{variant:"secondary",className:"min-w-[72px]",onClick:L,children:p("operation.cancel",{ns:"common"})}),(0,b.jsxs)(l.default,{variant:"primary",className:"flex min-w-[72px] space-x-0.5",disabled:!E||O||0===r.length||!W,onClick:()=>{e?.(),N({payload:a.filter((a,b)=>w.includes(b)),plugin:r,installedInfo:G})},children:[O&&(0,b.jsx)(k.RiLoader2Line,{className:"h-4 w-4 animate-spin-slow"}),(0,b.jsx)("span",{children:p(`${Q}.${O?"installing":"install"}`,{ns:"plugin"})})]})]})]})]})}),S=c.memo(({list:a,installStatus:c,onCancel:e,isHideButton:f})=>{let{t:g}=(0,d.useTranslation)(),{getIconUrl:h}=(0,I.default)();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"flex flex-col items-start justify-center gap-4 self-stretch px-6 py-3",children:(0,b.jsx)("div",{className:"flex flex-wrap content-start items-start gap-1 space-y-1 self-stretch rounded-2xl bg-background-section-burn p-2",children:a.map((a,d)=>(0,b.jsx)(H.default,{className:"w-full",payload:{...a,icon:c[d].isFromMarketPlace?`${G.MARKETPLACE_API_PREFIX}/plugins/${a.org}/${a.name}/icon`:h(a.icon)},installed:c[d].success,installFailed:!c[d].success,titleLeft:a.version?(0,b.jsx)(J.default,{className:"mx-1",size:"s",state:J.BadgeState.Default,children:a.version}):null},a.plugin_id))})}),!f&&(0,b.jsx)("div",{className:"flex items-center justify-end gap-2 self-stretch p-6 pt-5",children:(0,b.jsx)(l.default,{variant:"primary",className:"min-w-[72px]",onClick:e,children:g("operation.close",{ns:"common"})})})]})}),T=c.memo(({step:a,onStepChange:d,onStartToInstall:e,setIsInstalling:f,allPlugins:h,onClose:i,isFromMarketPlace:j})=>{let[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)([]),o=(0,c.useCallback)((a,b)=>{n(b),l(a),d(g.InstallStep.installed),f(!1)},[d,f]);return(0,b.jsxs)(b.Fragment,{children:[a===g.InstallStep.readyToInstall&&(0,b.jsx)(R,{allPlugins:h,onCancel:i,onStartToInstall:e,onInstalled:o,isFromMarketPlace:j}),a===g.InstallStep.installed&&(0,b.jsx)(S,{list:k,installStatus:m,onCancel:i})]})});a.s(["default",0,T],782900);var U=a.i(854868),V=a.i(705134);let W="installModal",X=c.memo(({uniqueIdentifier:a,payload:e,onCancel:f,onStartToInstall:h,onInstalled:i,onFailed:j})=>{let{t:m}=(0,d.useTranslation)(),n=e.version||e.latest_version,o=e.plugin_id,{installedInfo:p,isLoading:q}=w({pluginIds:[o],enabled:!!o}),r=p?.[o],s=r?.installedVersion,v=!!s,{mutateAsync:x}=(0,t.useInstallPackageFromMarketPlace)(),{mutateAsync:y}=(0,t.useUpdatePackageFromMarketPlace)(),[z,A]=c.useState(!1),{check:B,stop:C}=(0,u.default)(),{handleRefetch:E}=(0,t.usePluginTaskList)(e.category);(0,c.useEffect)(()=>{v&&a===r.uniqueIdentifier&&i()},[v]);let G=async()=>{if(!z){h?.(),A(!0);try{let b,c;if(v){let{all_installed:d,task_id:e}=await y({original_plugin_unique_identifier:r.uniqueIdentifier,new_plugin_unique_identifier:a});b=e,c=d}else{let{all_installed:d,task_id:e}=await x(a);b=e,c=d}if(c)return void i();E();let{status:d,error:e}=await B({taskId:b,pluginUniqueIdentifier:a});if(d===g.TaskStatus.failed)return void j(e);i(!0)}catch(a){if("string"==typeof a)return void j(a);j()}}},{langGeniusVersionInfo:I}=(0,V.useAppContext)(),{data:J}=(0,t.usePluginDeclarationFromMarketPlace)(a),L=(0,c.useMemo)(()=>!J||!I.current_version||(0,U.gte)(I.current_version,J?.manifest.meta.minimum_dify_version??"0.0.0"),[I.current_version,J]),{canInstall:M}=D({...e,from:"marketplace"});return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex flex-col items-start justify-center gap-4 self-stretch px-6 py-3",children:[(0,b.jsxs)("div",{className:"system-md-regular text-text-secondary",children:[(0,b.jsx)("p",{children:m(`${W}.readyToInstall`,{ns:"plugin"})}),!L&&(0,b.jsx)("p",{className:"system-md-regular text-text-warning",children:m("difyVersionNotCompatible",{ns:"plugin",minimalDifyVersion:J?.manifest.meta.minimum_dify_version})})]}),(0,b.jsx)("div",{className:"flex flex-wrap content-start items-start gap-1 self-stretch rounded-2xl bg-background-section-burn p-2",children:(0,b.jsx)(H.default,{className:"w-full",payload:(0,F.pluginManifestInMarketToPluginProps)(e),titleLeft:!q&&(0,b.jsx)(K,{hasInstalled:v,installedVersion:s,toInstallVersion:n}),limitedInstall:!M})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2 self-stretch p-6 pt-5",children:[!z&&(0,b.jsx)(l.default,{variant:"secondary",className:"min-w-[72px]",onClick:()=>{C(),f()},children:m("operation.cancel",{ns:"common"})}),(0,b.jsxs)(l.default,{variant:"primary",className:"flex min-w-[72px] space-x-0.5",disabled:z||q||!M,onClick:G,children:[z&&(0,b.jsx)(k.RiLoader2Line,{className:"h-4 w-4 animate-spin-slow"}),(0,b.jsx)("span",{children:m(`${W}.${z?"installing":"install"}`,{ns:"plugin"})})]})]})]})}),Y="installModal";a.s(["default",0,({uniqueIdentifier:a,manifest:k,isBundle:l,dependencies:m,onSuccess:n,onClose:o})=>{let{t:p}=(0,d.useTranslation)(),[q,r]=(0,c.useState)(g.InstallStep.readyToInstall),[s,t]=(0,c.useState)(null),{refreshPluginList:u}=(0,j.default)(),{modalClassName:v,foldAnimInto:w,setIsInstalling:x,handleStartToInstall:y}=(0,i.default)(o),z=(0,c.useCallback)(()=>l&&q===g.InstallStep.installed?p(`${Y}.installComplete`,{ns:"plugin"}):q===g.InstallStep.installed?p(`${Y}.installedSuccessfully`,{ns:"plugin"}):q===g.InstallStep.installFailed?p(`${Y}.installFailed`,{ns:"plugin"}):p(`${Y}.installPlugin`,{ns:"plugin"}),[l,q,p]),A=(0,c.useCallback)(a=>{r(g.InstallStep.installed),a||u(k),x(!1)},[k,u,x]),B=(0,c.useCallback)(a=>{r(g.InstallStep.installFailed),x(!1),a&&t(a)},[x]);return(0,b.jsxs)(e.default,{isShow:!0,onClose:w,wrapperClassName:"z-[9999]",className:(0,f.cn)(v,"shadows-shadow-xl flex min-w-[560px] flex-col items-start rounded-2xl border-[0.5px] border-components-panel-border bg-components-panel-bg p-0"),closable:!0,children:[(0,b.jsx)("div",{className:"flex items-start gap-2 self-stretch pb-3 pl-6 pr-14 pt-6",children:(0,b.jsx)("div",{className:"title-2xl-semi-bold self-stretch text-text-primary",children:z()})}),l?(0,b.jsx)(T,{step:q,onStepChange:r,onStartToInstall:y,setIsInstalling:x,onClose:o,allPlugins:m,isFromMarketPlace:!0}):(0,b.jsxs)(b.Fragment,{children:[q===g.InstallStep.readyToInstall&&(0,b.jsx)(X,{uniqueIdentifier:a,payload:k,onCancel:o,onInstalled:A,onFailed:B,onStartToInstall:y}),[g.InstallStep.installed,g.InstallStep.installFailed].includes(q)&&(0,b.jsx)(h.default,{payload:k,isMarketPayload:!0,isFailed:q===g.InstallStep.installFailed,errMsg:s,onCancel:n})]})]})}],917122)},590205,377309,162807,480138,915006,438331,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(413192);a.i(752298);var e=a.i(693025),f=a.i(527344);a.s(["EncryptedBottom",0,a=>{let{t:g}=(0,e.useTranslation)(),{frontTextKey:h="provider.encrypted.front",backTextKey:i="provider.encrypted.back",className:j}=a;return(0,b.jsxs)("div",{className:(0,f.cn)("system-xs-regular flex items-center justify-center rounded-b-2xl border-t-[0.5px] border-divider-subtle bg-background-soft px-2 py-3 text-text-tertiary",j),children:[(0,b.jsx)(c.RiLock2Fill,{className:"mx-1 h-3 w-3 text-text-quaternary"}),g(h,{ns:"common"}),(0,b.jsx)(d.default,{className:"mx-1 text-text-accent",target:"_blank",rel:"noopener noreferrer",href:"https://pycryptodome.readthedocs.io/en/latest/src/cipher/oaep.html",children:"PKCS1_OAEP"}),g(i,{ns:"common"})]})}],590205);var g=a.i(57843);a.s([],480138);var h=a.i(53952),i=a.i(682541),j=a.i(218865),k=a.i(168799),l=a.i(260208);let m={src:a.i(48803).default,width:32,height:32,blurWidth:0,blurHeight:0};var n=a.i(909795);let o=({title:a="",label:c,description:d,options:h,value:o=[],onChange:p,disabled:q=!1,containerClassName:r,showSelectAll:s=!0,showCount:t=!0,showSearch:u=!0,maxHeight:v})=>{let{t:w}=(0,e.useTranslation)(),[x,y]=(0,g.useState)(""),z=(0,g.useMemo)(()=>{if(!x?.trim())return h;let a=x.toLowerCase();return h.filter(b=>b.label.toLowerCase().includes(a)||b.value.toLowerCase().includes(a))},[h,x]),A=o.length,B=(0,g.useMemo)(()=>{let a=h.filter(a=>!a.disabled);return a.length>0&&a.every(a=>o.includes(a.value))},[h,o]),C=(0,g.useMemo)(()=>{let a=h.filter(a=>!a.disabled),b=a.filter(a=>o.includes(a.value)).length;return b>0&&b<a.length},[h,o]),D=(0,g.useCallback)(()=>{if(!q)if(B)p?.([]);else{let a=h.filter(a=>!a.disabled).map(a=>a.value);p?.(a)}},[B,h,p,q]),E=(0,g.useCallback)(a=>{if(q)return;let b=o.includes(a)?o.filter(b=>b!==a):[...o,a];p?.(b)},[o,p,q]);return(0,b.jsxs)("div",{className:(0,f.cn)("flex w-full flex-col gap-1",r),children:[c&&(0,b.jsx)("div",{className:"system-sm-medium text-text-secondary",children:c}),d&&(0,b.jsx)("div",{className:"body-xs-regular text-text-tertiary",children:d}),(0,b.jsxs)("div",{className:"rounded-lg border border-components-panel-border bg-components-panel-bg",children:[(s||a||u)&&(0,b.jsxs)("div",{className:"relative flex items-center gap-2 border-b border-divider-subtle px-3 py-2",children:[!x&&s&&(0,b.jsx)(k.default,{checked:B,indeterminate:C,onCheck:D,disabled:q}),x?(0,b.jsx)("div",{className:"system-sm-medium-uppercase flex-1 leading-6 text-text-secondary",children:z.length>0?w("operation.searchCount",{ns:"common",count:z.length,content:a}):w("operation.noSearchCount",{ns:"common",content:a})}):(0,b.jsxs)("div",{className:"flex min-w-0 flex-1 items-center gap-1",children:[a&&(0,b.jsx)("span",{className:"system-xs-semibold-uppercase truncate leading-5 text-text-secondary",children:a}),t&&A>0&&(0,b.jsx)(j.default,{uppercase:!0,children:w("operation.selectCount",{ns:"common",count:A})})]}),u&&(0,b.jsx)(l.default,{value:x,onChange:y,placeholder:w("placeholder.search",{ns:"common"}),className:"w-40"})]}),(0,b.jsx)("div",{className:"p-1",style:v?{maxHeight:v,overflowY:"auto"}:{},children:z.length?z.map(a=>{let c=o.includes(a.value);return(0,b.jsxs)("div",{className:(0,f.cn)("flex cursor-pointer items-center gap-2 rounded-md px-2 py-1.5 transition-colors hover:bg-state-base-hover",a.disabled&&"cursor-not-allowed opacity-50"),onClick:()=>{a.disabled||q||E(a.value)},children:[(0,b.jsx)(k.default,{checked:c,onCheck:()=>{a.disabled||q||E(a.value)},disabled:a.disabled||q}),(0,b.jsx)("div",{className:"system-sm-medium flex-1 truncate text-text-secondary",title:a.label,children:a.label})]},a.value)}):(0,b.jsx)("div",{className:"px-3 py-6 text-center text-sm text-text-tertiary",children:x?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2",children:[(0,b.jsx)(i.default,{alt:"search menu",src:m,width:32}),(0,b.jsx)("span",{className:"system-sm-regular text-text-secondary",children:w("operation.noSearchResults",{ns:"common",content:a})}),(0,b.jsx)(n.default,{variant:"secondary-accent",size:"small",onClick:()=>y(""),children:w("operation.resetKeywords",{ns:"common"})})]}):w("noData",{ns:"common"})})})]})]})};a.s(["default",0,o],377309);var p=a.i(478801),q=a.i(816134),r=a.i(649469),s=a.i(31736),t=a.i(166102),u=a.i(483664),v=a.i(701458),w=a.i(366231);let x=()=>{let a=(0,v.useLanguage)();return b=>(0,w.renderI18nObject)(b,a)};a.s(["useRenderI18nObject",0,x],162807);var y=a.i(970854);let z=({content:a,render:b})=>(0,g.isValidElement)(a)||"string"==typeof a?a:"object"==typeof a&&null!==a?b(a):"",A={[p.FormItemValidateStatusEnum.Error]:{componentClassName:"border-components-input-border-destructive focus:border-components-input-border-destructive",textClassName:"text-text-destructive",infoFieldName:"errors"},[p.FormItemValidateStatusEnum.Warning]:{componentClassName:"border-components-input-border-warning focus:border-components-input-border-warning",textClassName:"text-text-warning",infoFieldName:"warnings"},[p.FormItemValidateStatusEnum.Success]:{componentClassName:"",textClassName:"",infoFieldName:""},[p.FormItemValidateStatusEnum.Validating]:{componentClassName:"",textClassName:"",infoFieldName:""}},B=(0,g.memo)(({fieldClassName:a,labelClassName:d,inputContainerClassName:i,inputClassName:j,formSchema:k,field:l,disabled:m,onChange:n,fieldState:v})=>{let w=x(),{t:B}=(0,e.useTranslation)(),{name:C,label:D,required:E,placeholder:F,options:G,labelClassName:H,disabled:I,type:J,dynamicSelectParams:K,multiple:L=!1,tooltip:M,showCopy:N,description:O,url:P,help:Q}=k,R=m||I,[S,T,U,V,W]=(0,g.useMemo)(()=>{let a=[D,F,M,O,Q].map(a=>z({content:a,render:w}));return a[1]||(a[1]=B("placeholder.input",{ns:"common"})),a},[D,F,M,O,Q,w]),X=(0,g.useMemo)(()=>{let a=new Set;for(let b of G||[])for(let c of b.show_on||[])a.add(c.variable);return Array.from(a)},[G]),Y=(0,h.useStore)(l.form.store,a=>{let b={};for(let c of X)b[c]=a.values[c];return b}),Z=(0,g.useMemo)(()=>G?.filter(a=>!a.show_on?.length||a.show_on.every(a=>Y[a.variable]===a.value)).map(a=>({label:z({content:a.label,render:w}),value:a.value}))||[],[G,w,Y]),$=(0,h.useStore)(l.form.store,a=>a.values[l.name]),{data:_,isLoading:aa,error:ab}=(0,y.useTriggerPluginDynamicOptions)(K||{plugin_id:"",provider:"",action:"",parameter:"",credential_id:""},J===p.FormTypeEnum.dynamicSelect),ac=(0,g.useMemo)(()=>_?.options?_.options.map(a=>({label:z({content:a.label,render:w}),value:a.value})):[],[_,w]),ad=(0,g.useCallback)(a=>{l.handleChange(a),n?.(l.name,a)},[l,n]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:(0,f.cn)(a),children:[(0,b.jsxs)("div",{className:(0,f.cn)(d,H),children:[S,E&&!(0,g.isValidElement)(D)&&(0,b.jsx)("span",{className:"ml-1 text-text-destructive-secondary",children:"*"}),M&&(0,b.jsx)(u.default,{popupContent:(0,b.jsx)("div",{className:"w-[200px]",children:U}),triggerClassName:"ml-0.5 w-4 h-4"})]}),(0,b.jsxs)("div",{className:(0,f.cn)(i),children:[[p.FormTypeEnum.textInput,p.FormTypeEnum.secretInput,p.FormTypeEnum.textNumber].includes(J)&&(0,b.jsx)(q.default,{id:l.name,name:l.name,className:(0,f.cn)(j,A[v?.validateStatus]?.componentClassName),value:$||"",onChange:a=>{ad(a.target.value)},onBlur:l.handleBlur,disabled:R,placeholder:T,...(a=>{switch(a){case p.FormTypeEnum.secretInput:return{type:"password",autoComplete:"new-password"};case p.FormTypeEnum.textNumber:return{type:"number"};default:return{type:"text"}}})(J),showCopyIcon:N}),J===p.FormTypeEnum.select&&!L&&(0,b.jsx)(t.default,{value:$,onChange:a=>ad(a),disabled:R,placeholder:T,options:Z,triggerPopupSameWidth:!0,popupProps:{className:"max-h-[320px] overflow-y-auto"}}),J===p.FormTypeEnum.checkbox&&(0,b.jsx)(o,{title:C,value:$,onChange:a=>l.handleChange(a),options:Z,maxHeight:"200px"}),J===p.FormTypeEnum.dynamicSelect&&(0,b.jsx)(t.default,{options:ac,value:$,onChange:l.handleChange,disabled:R||aa,placeholder:aa?B("dynamicSelect.loading",{ns:"common"}):T,...ab?{popupProps:{title:B("dynamicSelect.error",{ns:"common"}),titleClassName:"text-text-destructive-secondary"}}:!ac.length?{popupProps:{title:B("dynamicSelect.noData",{ns:"common"})}}:{},triggerPopupSameWidth:!0,multiple:L}),J===p.FormTypeEnum.radio&&(0,b.jsx)("div",{className:(0,f.cn)(Z.length<3?"flex items-center space-x-2":"space-y-2"),children:Z.map(a=>(0,b.jsxs)("div",{className:(0,f.cn)("system-sm-regular hover:bg-components-option-card-option-hover-bg hover:border-components-option-card-option-hover-border flex h-8 flex-[1] grow cursor-pointer items-center justify-center gap-2 rounded-lg border border-components-option-card-option-border bg-components-option-card-option-bg p-2 text-text-secondary",$===a.value&&"border-components-option-card-option-selected-border bg-components-option-card-option-selected-bg text-text-primary shadow-xs",R&&"cursor-not-allowed opacity-50",j),onClick:()=>!R&&ad(a.value),children:[k.showRadioUI&&(0,b.jsx)(s.default,{className:"mr-2",isChecked:$===a.value}),a.label]},a.value))}),J===p.FormTypeEnum.boolean&&(0,b.jsxs)(r.default.Group,{className:"flex w-fit items-center",value:$,onChange:a=>l.handleChange(a),children:[(0,b.jsx)(r.default,{value:!0,className:"!mr-1",children:"True"}),(0,b.jsx)(r.default,{value:!1,children:"False"})]}),v?.validateStatus&&[p.FormItemValidateStatusEnum.Error,p.FormItemValidateStatusEnum.Warning].includes(v?.validateStatus)&&(0,b.jsx)("div",{className:(0,f.cn)("system-xs-regular mt-1 px-0 py-[2px]",A[v?.validateStatus].textClassName),children:v?.[A[v?.validateStatus].infoFieldName]})]})]}),O&&(0,b.jsx)("div",{className:"system-xs-regular mt-4 text-text-tertiary",children:V}),P&&(0,b.jsxs)("a",{className:"system-xs-regular mt-4 flex items-center text-text-accent",href:P,target:"_blank",children:[(0,b.jsx)("span",{className:"break-all",children:W}),(0,b.jsx)(c.RiExternalLinkLine,{className:"ml-1 h-3 w-3 shrink-0"})]})]})});var C=a.i(45936),D=a.i(114715);let E=(0,g.memo)(({formSchemas:a=[],defaultValues:c,formClassName:d,fieldClassName:i,labelClassName:j,inputContainerClassName:k,inputClassName:l,ref:m,disabled:n,formFromProps:o,onChange:q,onSubmit:r,preventDefaultSubmit:s=!1})=>{let t=(0,g.useMemo)(()=>c||a.reduce((a,b)=>(b.default&&(a[b.name]=b.default),a),{}),[c]),u=(0,C.useForm)({defaultValues:t}),v=o||u,{getFormValues:w}=((a,b)=>{let{checkValidated:c}=((a,b)=>{let{notify:c}=(0,D.useToastContext)();return{checkValidated:(0,g.useCallback)(()=>{let d=a?.getAllErrors(),e=a.state.values;if(d){let a=d.fields,f=Object.keys(a).reduce((c,d)=>{let{show_on:f=[]}=b.find(a=>a.name===d)||{},g=f.reduce((a,b)=>(a[b.variable]=e[b.variable],a),{});return[...c,...f?.every(a=>g[a.variable]===a.value)?a[d].errors:[]]},[]);if(f.length)return c({type:"error",message:f[0]}),!1}return!0},[a,c,b])}})(a,b);return{getFormValues:(0,g.useCallback)(({needCheckValidatedValues:d=!0,needTransformWhenSecretFieldIsPristine:e})=>{let f=a?.store.state.values||{};return d?c()?{values:e?((a,b)=>{let c,d=b?.store.state.values||{},e=[];for(let c=0;c<a.length;c++){let d=a[c];if(d.type===p.FormTypeEnum.secretInput){let a=b?.getFieldMeta(d.name);a?.isPristine&&e.push(d.name)}}return c={...d},e.forEach(a=>{c[a]&&(c[a]="[__HIDDEN__]")}),c})(b,a):f,isCheckValidated:!0}:{values:{},isCheckValidated:!1}:{values:f,isCheckValidated:!0}},[a,c,b])}})(v,a),{getValidators:y}=(()=>{let{t:a}=(0,e.useTranslation)(),b=x(),c=(0,g.useCallback)(a=>(0,g.isValidElement)(a)?"":"string"==typeof a?a:"object"==typeof a&&null!==a?b(a):void 0,[]);return{getValidators:(0,g.useCallback)(b=>{let{name:d,validators:e,required:f,label:g}=b,h=e,i=c(g);return f&&!e&&(h={onMount:({value:b})=>{if(!b)return a("errorMsg.fieldRequired",{ns:"common",field:i||d})},onChange:({value:b})=>{if(!b)return a("errorMsg.fieldRequired",{ns:"common",field:i||d})},onBlur:({value:b})=>{if(!b)return a("errorMsg.fieldRequired",{ns:"common",field:i})}}),h},[a,c])}})(),[z,A]=(0,g.useState)({}),E=(0,h.useStore)(v.store,b=>{let c={};return a.forEach(a=>{let{show_on:d}=a;d?.length&&d.forEach(a=>{c[a.variable]=b.values[a.variable]})}),c}),F=(0,g.useCallback)(a=>{let b={...z};for(let c of a){let{name:a,value:d,errors:e,warnings:f,validateStatus:g,help:h}=c;void 0!==d&&v.setFieldValue(a,d);let i=g;!i&&(e&&e.length>0?i=p.FormItemValidateStatusEnum.Error:f&&f.length>0&&(i=p.FormItemValidateStatusEnum.Warning)),b[a]={validateStatus:i,help:h,errors:e,warnings:f}}A(b)},[v,z]);(0,g.useImperativeHandle)(m,()=>({getForm:()=>v,getFormValues:a=>w(a),setFields:F}),[v,w,F]);let G=(0,g.useCallback)(c=>{let d=a?.find(a=>a.name===c.name);return d?(0,b.jsx)(B,{field:c,formSchema:d,fieldClassName:i??d.fieldClassName,labelClassName:j??d.labelClassName,inputContainerClassName:k,inputClassName:l,disabled:n,onChange:q,fieldState:z[c.name]}):null},[a,i,j,k,l,n,q,z]),H=(0,g.useCallback)(a=>{let c=y(a),{name:d,show_on:e=[]}=a;return e?.every(a=>E[a.variable]===a.value)?(0,b.jsx)(v.Field,{name:d,validators:c,children:G},d):null},[G,v,y,E]);return a?.length?(0,b.jsx)("form",{className:(0,f.cn)(d),onSubmit:a=>{s&&(a.preventDefault(),a.stopPropagation()),r?.(a)},children:a.map(H)}):null});a.s(["BaseForm",0,E],915006);let F=(0,g.memo)(({formSchemas:a=[],defaultValues:c,ref:d,formFromProps:e,...f})=>(0,b.jsx)(E,{ref:d,formSchemas:a,defaultValues:c,formClassName:"space-y-4",labelClassName:"h-6 flex items-center mb-1 system-sm-medium text-text-secondary",formFromProps:e,...f}));a.s(["default",0,F],438331)},481366,469453,a=>{"use strict";var b,c=a.i(608061),d=a.i(429150);a.i(752298);var e=a.i(693025),f=a.i(527344);let g=["code","audio","time","webscraper"];var h=a.i(282791),i=((b={}).drawer="drawer",b.modal="modal",b);let j=(0,h.create)(a=>({currentPluginDetail:void 0,setCurrentPluginDetail:(b,c)=>a({currentPluginDetail:b?{detail:b,showType:c??"drawer"}:void 0})}));a.s(["ReadmeShowType",()=>i,"useReadmePanelStore",0,j],469453),a.s(["ReadmeEntrance",0,({pluginDetail:a,showType:b=i.drawer,className:h,showShortTip:k=!1})=>{let{t:l}=(0,e.useTranslation)(),{setCurrentPluginDetail:m}=j();return!a||!a?.plugin_unique_identifier||g.includes(a.id)?null:(0,c.jsxs)("div",{className:(0,f.cn)("flex flex-col items-start justify-center gap-2 pb-4 pt-0",b===i.drawer&&"px-4",h),children:[!k&&(0,c.jsx)("div",{className:"relative h-1 w-8 shrink-0",children:(0,c.jsx)("div",{className:"h-px w-full bg-divider-regular"})}),(0,c.jsxs)("button",{onClick:()=>{a&&m(a,b)},className:"flex w-full items-center justify-start gap-1 text-text-tertiary transition-opacity hover:text-text-accent-light-mode-only",children:[(0,c.jsx)("div",{className:"relative flex h-3 w-3 items-center justify-center overflow-hidden",children:(0,c.jsx)(d.RiBookReadLine,{className:"h-3 w-3"})}),(0,c.jsx)("span",{className:"text-xs font-normal leading-4",children:l(k?"readmeInfo.title":"readmeInfo.needHelpCheckReadme",{ns:"plugin"})})]})]})}],481366)},76955,257898,176578,202906,628860,234009,277265,104017,11740,128565,612222,a=>{"use strict";a.s([],76955);var b,c,d=a.i(608061),e=a.i(57843),f=a.i(909795);a.i(752298);var g=a.i(693025),h=a.i(590205),i=a.i(438331),j=a.i(478801),k=a.i(105249),l=a.i(314109),m=a.i(114715),n=a.i(481366),o=a.i(469453),p=a.i(848636),q=a.i(528698),r=a.i(41511),s=a.i(425282);let t="plugins-auth";var u=a.i(844137),v=((b={}).tool="tool",b.datasource="datasource",b.model="model",b.trigger="trigger",b),w=((c={}).OAUTH2="oauth2",c.API_KEY="api-key",c);a.s(["AuthCategory",()=>v,"CredentialTypeEnum",()=>w],257898);let x=({category:a=v.tool,provider:b})=>a===v.tool?{getCredentialInfo:`/workspaces/current/tool-provider/builtin/${b}/credential/info`,setDefaultCredential:`/workspaces/current/tool-provider/builtin/${b}/default-credential`,getCredentials:`/workspaces/current/tool-provider/builtin/${b}/credentials`,addCredential:`/workspaces/current/tool-provider/builtin/${b}/add`,updateCredential:`/workspaces/current/tool-provider/builtin/${b}/update`,deleteCredential:`/workspaces/current/tool-provider/builtin/${b}/delete`,getCredentialSchema:a=>`/workspaces/current/tool-provider/builtin/${b}/credential/schema/${a}`,getOauthUrl:`/oauth/plugin/${b}/tool/authorization-url`,getOauthClientSchema:`/workspaces/current/tool-provider/builtin/${b}/oauth/client-schema`,setCustomOauthClient:`/workspaces/current/tool-provider/builtin/${b}/oauth/custom-client`,getCustomOAuthClientValues:`/workspaces/current/tool-provider/builtin/${b}/oauth/custom-client`,deleteCustomOAuthClient:`/workspaces/current/tool-provider/builtin/${b}/oauth/custom-client`}:a===v.datasource?{getCredentialInfo:"",setDefaultCredential:`/auth/plugin/datasource/${b}/default`,getCredentials:`/auth/plugin/datasource/${b}`,addCredential:`/auth/plugin/datasource/${b}`,updateCredential:`/auth/plugin/datasource/${b}/update`,deleteCredential:`/auth/plugin/datasource/${b}/delete`,getCredentialSchema:()=>"",getOauthUrl:`/oauth/plugin/${b}/datasource/get-authorization-url`,getOauthClientSchema:"",setCustomOauthClient:`/auth/plugin/datasource/${b}/custom-client`,deleteCustomOAuthClient:`/auth/plugin/datasource/${b}/custom-client`}:{getCredentialInfo:"",setDefaultCredential:"",getCredentials:"",addCredential:"",updateCredential:"",deleteCredential:"",getCredentialSchema:()=>"",getOauthUrl:"",getOauthClientSchema:"",setCustomOauthClient:"",getCustomOAuthClientValues:"",deleteCustomOAuthClient:""},y=a=>{let b;return b=x(a).deleteCredential,(0,p.useMutation)({mutationFn:a=>(0,r.post)(b,{body:a})})},z=a=>{let b;return b=x(a).setDefaultCredential,(0,p.useMutation)({mutationFn:a=>(0,r.post)(b,{body:{id:a}})})},A=a=>{let b;return b=x(a).updateCredential,(0,p.useMutation)({mutationFn:a=>(0,r.post)(b,{body:a})})},B=(0,e.memo)(({pluginPayload:a,onClose:b,editValues:c,onRemove:f,disabled:s,onUpdate:u,formSchemas:v=[]})=>{var y;let z,B,{t:C}=(0,g.useTranslation)(),{notify:D}=(0,m.useToastContext)(),[E,F]=(0,e.useState)(!1),G=(0,e.useRef)(E),H=(0,e.useCallback)(a=>{G.current=a,F(a)},[]),{data:I=[],isLoading:J}=(y=w.API_KEY,z=x(a).getCredentialSchema(y),(0,q.useQuery)({enabled:!!z,queryKey:[t,"credential-schema",z],queryFn:()=>(0,r.get)(z)})),K=(0,e.useMemo)(()=>v?.length?v:I,[v,I]),L=(0,e.useMemo)(()=>[{type:j.FormTypeEnum.textInput,name:"__name__",label:C("auth.authorizationName",{ns:"plugin"}),required:!1},...K],[K,C]),M=L.reduce((a,b)=>(b.default&&(a[b.name]=b.default),a),{}),{mutateAsync:N}=(B=x(a).addCredential,(0,p.useMutation)({mutationFn:a=>(0,r.post)(B,{body:a})})),{mutateAsync:O}=A(a),P=(0,e.useRef)(null),Q=(0,e.useCallback)(async()=>{if(G.current)return;let{isCheckValidated:a,values:d}=P.current?.getFormValues({needCheckValidatedValues:!0,needTransformWhenSecretFieldIsPristine:!0})||{isCheckValidated:!1,values:{}};if(a)try{let{__name__:a,__credential_id__:e,...f}=d;H(!0),c?await O({credentials:f,credential_id:e,name:a||""}):await N({credentials:f,type:w.API_KEY,name:a||""}),D({type:"success",message:C("api.actionSuccess",{ns:"common"})}),b?.(),u?.()}finally{H(!1)}},[N,b,u,O,D,C,c,H]);return(0,d.jsxs)(l.default,{size:"md",title:C("auth.useApiAuth",{ns:"plugin"}),subTitle:C("auth.useApiAuthDesc",{ns:"plugin"}),onClose:b,onCancel:b,footerSlot:(0,d.jsx)("div",{}),bottomSlot:(0,d.jsx)(h.EncryptedBottom,{}),onConfirm:Q,showExtraButton:!!c,onExtraButtonClick:f,disabled:s||J||E,clickOutsideNotClose:!0,wrapperClassName:"!z-[101]",children:[a.detail&&(0,d.jsx)(n.ReadmeEntrance,{pluginDetail:a.detail,showType:o.ReadmeShowType.modal}),J&&(0,d.jsx)("div",{className:"flex h-40 items-center justify-center",children:(0,d.jsx)(k.default,{})}),!J&&!!K.length&&(0,d.jsx)(i.default,{ref:P,formSchemas:L,defaultValues:c||M,disabled:s})]})});a.s(["default",0,B],176578);let C=(0,e.memo)(({pluginPayload:a,buttonVariant:b="secondary-accent",buttonText:c="Use Api Key",disabled:g,onUpdate:h,formSchemas:i=[]})=>{let[j,k]=(0,e.useState)(!1);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(f.default,{className:"w-full",variant:b,onClick:()=>k(!0),disabled:g,children:c}),j&&(0,d.jsx)(B,{pluginPayload:a,onClose:()=>k(!1),onUpdate:h,formSchemas:i})]})});a.s(["default",0,C],202906);var D=a.i(429150),E=a.i(175809),F=a.i(218865),G=a.i(162807),H=a.i(646772),I=a.i(527344),J=a.i(45936),K=a.i(53952);let L=(0,e.memo)(({pluginPayload:a,onClose:b,editValues:c,disabled:h,schemas:j,onAuth:k,hasOriginalClientParams:q,onUpdate:u})=>{let v,w,y,{t:z}=(0,g.useTranslation)(),{notify:A}=(0,m.useToastContext)(),[B,C]=(0,e.useState)(!1),D=(0,e.useRef)(B),E=(0,e.useCallback)(a=>{D.current=a,C(a)},[]),F=j.reduce((a,b)=>(b.default&&(a[b.name]=b.default),a),{}),{mutateAsync:G}=(v=x(a).setCustomOauthClient,(0,p.useMutation)({mutationFn:a=>(0,r.post)(v,{body:a})})),H=(w=x(a).getOauthClientSchema,(0,s.useInvalid)([t,"oauth-client-schema",w])),I=(0,e.useRef)(null),L=(0,e.useCallback)(async()=>{if(!D.current)try{let{isCheckValidated:a,values:c}=I.current?.getFormValues({needCheckValidatedValues:!0,needTransformWhenSecretFieldIsPristine:!0})||{isCheckValidated:!1,values:{}};if(!a)throw Error("error");let{__oauth_client__:d,...e}=c;E(!0),await G({client_params:e,enable_oauth_custom_client:"custom"===d}),A({type:"success",message:z("api.actionSuccess",{ns:"common"})}),b?.(),u?.(),H()}finally{E(!1)}},[b,u,H,G,A,z,E]),M=(0,e.useCallback)(async()=>{await L(),k&&await k()},[L,k]),{mutateAsync:N}=(y=x(a).deleteCustomOAuthClient,(0,p.useMutation)({mutationFn:()=>(0,r.del)(y)})),O=(0,e.useCallback)(async()=>{if(!D.current)try{E(!0),await N(),A({type:"success",message:z("api.actionSuccess",{ns:"common"})}),b?.(),u?.(),H()}finally{E(!1)}},[u,H,N,A,z,E,b]),P=(0,J.useForm)({defaultValues:c||F}),Q=(0,K.useStore)(P.store,a=>a.values.__oauth_client__);return(0,d.jsxs)(l.default,{title:z("auth.oauthClientSettings",{ns:"plugin"}),confirmButtonText:z("auth.saveAndAuth",{ns:"plugin"}),cancelButtonText:z("auth.saveOnly",{ns:"plugin"}),extraButtonText:z("operation.cancel",{ns:"common"}),showExtraButton:!0,extraButtonVariant:"secondary",onExtraButtonClick:b,onClose:b,onCancel:L,onConfirm:M,disabled:h||B,footerSlot:"custom"===Q&&q&&(0,d.jsx)("div",{className:"grow",children:(0,d.jsx)(f.default,{variant:"secondary",className:"text-components-button-destructive-secondary-text",disabled:h||B||!c,onClick:O,children:z("operation.remove",{ns:"common"})})}),containerClassName:"pt-0",wrapperClassName:"!z-[101]",clickOutsideNotClose:!0,children:[a.detail&&(0,d.jsx)(n.ReadmeEntrance,{pluginDetail:a.detail,showType:o.ReadmeShowType.modal}),(0,d.jsx)(i.default,{formFromProps:P,ref:I,formSchemas:j,defaultValues:c||F,disabled:h})]})}),M=(0,e.memo)(({pluginPayload:a,buttonVariant:b="primary",buttonText:c="use oauth",className:h,buttonLeftClassName:i,buttonRightClassName:k,dividerClassName:l,disabled:m,onUpdate:n,oAuthData:o})=>{let s,u,{t:v}=(0,g.useTranslation)(),w=(0,G.useRenderI18nObject)(),[y,z]=(0,e.useState)(!1),{mutateAsync:A}=(s=x(a).getOauthUrl,(0,p.useMutation)({mutationKey:[t,"oauth-url",s],mutationFn:()=>(0,r.get)(s)})),{data:B,isLoading:C}=(u=x(a).getOauthClientSchema,(0,q.useQuery)({enabled:!!u,queryKey:[t,"oauth-client-schema",u],queryFn:()=>(0,r.get)(u),staleTime:0})),{schema:J=[],is_oauth_custom_client_enabled:K,is_system_oauth_params_exists:M,client_params:N,redirect_uri:O}=(0,e.useMemo)(()=>o||B,[o,B])||{},P=M||K,Q=(0,e.useCallback)(async()=>{let{authorization_url:a}=await A();a&&(0,H.openOAuthPopup)(a,()=>n?.())},[A,n]),R=(0,e.useCallback)(a=>(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsxs)("div",{className:"mb-4 flex rounded-xl bg-background-section-burn p-4",children:[(0,d.jsx)("div",{className:"mr-3 flex h-9 w-9 shrink-0 items-center justify-center rounded-lg border-[0.5px] border-components-card-border bg-components-card-bg shadow-lg",children:(0,d.jsx)(D.RiInformation2Fill,{className:"h-5 w-5 text-text-accent"})}),(0,d.jsxs)("div",{className:"w-0 grow",children:[(0,d.jsx)("div",{className:"system-sm-regular mb-1.5",children:v("auth.clientInfo",{ns:"plugin"})}),O&&(0,d.jsxs)("div",{className:"system-sm-medium flex w-full py-0.5",children:[(0,d.jsx)("div",{className:"w-0 grow break-words break-all",children:O}),(0,d.jsx)(E.default,{className:"shrink-0",onClick:()=>{navigator.clipboard.writeText(O||"")},children:(0,d.jsx)(D.RiClipboardLine,{className:"h-4 w-4"})})]})]})]}),(0,d.jsxs)("div",{className:"system-sm-medium flex h-6 items-center text-text-secondary",children:[w(a.label),a.required&&(0,d.jsx)("span",{className:"ml-1 text-text-destructive-secondary",children:"*"})]})]}),[v,O,w]),S=(0,e.useMemo)(()=>{let a=J.map((a,b)=>({...a,label:0===b?R(a):a.label,labelClassName:0===b?"h-auto":void 0}));return M&&(a.unshift({name:"__oauth_client__",label:v("auth.oauthClient",{ns:"plugin"}),type:j.FormTypeEnum.radio,options:[{label:v("auth.default",{ns:"plugin"}),value:"default"},{label:v("auth.custom",{ns:"plugin"}),value:"custom"}],required:!1,default:K?"custom":"default"}),a.forEach((a,b)=>{b>0&&(a.show_on=[{variable:"__oauth_client__",value:"custom"}],N&&(a.default=N[a.name]||a.default))})),a},[J,R,v,M,K,N]),T=(0,e.useMemo)(()=>P?K?"custom":"default":M?"default":"custom",[P,K,M]);return(0,d.jsxs)(d.Fragment,{children:[P&&(0,d.jsxs)(f.default,{variant:b,className:(0,I.cn)("w-full px-0 py-0 hover:bg-components-button-primary-bg",h),disabled:m,onClick:Q,children:[(0,d.jsxs)("div",{className:(0,I.cn)("flex h-full w-0 grow items-center justify-center rounded-l-lg pl-0.5 hover:bg-components-button-primary-bg-hover",i),children:[(0,d.jsx)("div",{className:"truncate",title:c,children:c}),K&&(0,d.jsx)(F.default,{className:(0,I.cn)("ml-1 mr-0.5","primary"===b&&"border-text-primary-on-surface bg-components-badge-bg-dimm text-text-primary-on-surface"),children:v("auth.custom",{ns:"plugin"})})]}),(0,d.jsx)("div",{className:(0,I.cn)("h-4 w-[1px] shrink-0 bg-text-primary-on-surface opacity-[0.15]",l)}),(0,d.jsx)("div",{"data-testid":"oauth-settings-button",className:(0,I.cn)("flex h-full w-8 shrink-0 items-center justify-center rounded-r-lg hover:bg-components-button-primary-bg-hover",k),onClick:a=>{a.stopPropagation(),z(!0)},children:(0,d.jsx)(D.RiEqualizer2Line,{className:"h-4 w-4"})})]}),!P&&(0,d.jsxs)(f.default,{variant:b,onClick:()=>z(!0),disabled:m,className:"w-full",children:[(0,d.jsx)(D.RiEqualizer2Line,{className:"mr-0.5 h-4 w-4"}),v("auth.setupOAuth",{ns:"plugin"})]}),y&&(0,d.jsx)(L,{pluginPayload:a,onClose:()=>z(!1),disabled:m||C,schemas:S,onAuth:Q,editValues:{...N,__oauth_client__:T},hasOriginalClientParams:Object.keys(N||{}).length>0,onUpdate:n})]})});a.s(["default",0,M],628860);var N=a.i(42550),O=a.i(825319),P=a.i(854867),Q=a.i(483664);let R=(0,e.memo)(({pluginPayload:a,theme:b="primary",showDivider:c=!0,canOAuth:f,canApiKey:h,disabled:i,onUpdate:j,notAllowCustomCredential:k})=>{let{t:l}=(0,g.useTranslation)(),m=(0,e.useMemo)(()=>"secondary"===b?{buttonText:h?l("auth.addOAuth",{ns:"plugin"}):l("auth.useOAuthAuth",{ns:"plugin"}),buttonVariant:"secondary",className:"hover:bg-components-button-secondary-bg",buttonLeftClassName:"hover:bg-components-button-secondary-bg-hover",buttonRightClassName:"hover:bg-components-button-secondary-bg-hover",dividerClassName:"bg-divider-regular opacity-100",pluginPayload:a}:{buttonText:h?l("auth.addOAuth",{ns:"plugin"}):l("auth.useOAuthAuth",{ns:"plugin"}),pluginPayload:a},[h,b,a,l]),n=(0,e.useMemo)(()=>"secondary"===b?{pluginPayload:a,buttonVariant:"secondary",buttonText:f?l("auth.addApi",{ns:"plugin"}):l("auth.useApiAuth",{ns:"plugin"})}:{pluginPayload:a,buttonText:f?l("auth.addApi",{ns:"plugin"}):l("auth.useApiAuth",{ns:"plugin"}),buttonVariant:f?"secondary-accent":"primary"},[f,b,a,l]),o=(0,e.useMemo)(()=>{let a=(0,d.jsx)("div",{className:(0,I.cn)("min-w-0 flex-[1]",k&&"opacity-50"),children:(0,d.jsx)(M,{...m,disabled:i||k,onUpdate:j})});return k?(0,d.jsx)(Q.default,{popupContent:l("auth.credentialUnavailable",{ns:"plugin"}),children:a}):a},[k,m,i,j,l]),p=(0,e.useMemo)(()=>{let a=(0,d.jsx)("div",{className:(0,I.cn)("min-w-0 flex-[1]",k&&"opacity-50"),children:(0,d.jsx)(C,{...n,disabled:i||k,onUpdate:j})});return k?(0,d.jsx)(Q.default,{popupContent:l("auth.credentialUnavailable",{ns:"plugin"}),children:a}):a},[k,n,i,j,l]);return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:"flex items-center space-x-1.5",children:[f&&o,c&&f&&h&&(0,d.jsxs)("div",{className:"system-2xs-medium-uppercase flex shrink-0 flex-col items-center justify-between text-text-tertiary",children:[(0,d.jsx)("div",{className:"h-2 w-[1px] bg-divider-subtle"}),"or",(0,d.jsx)("div",{className:"h-2 w-[1px] bg-divider-subtle"})]}),h&&p]})})});var S=a.i(816134);let T=(0,e.memo)(({credential:a,disabled:b,onDelete:c,onEdit:h,onSetDefault:i,onRename:j,disableRename:k,disableEdit:l,disableDelete:m,disableSetDefault:n,onItemClick:o,showSelectedIcon:p,selectedCredentialId:q})=>{let{t:r}=(0,g.useTranslation)(),[s,t]=(0,e.useState)(!1),[u,v]=(0,e.useState)(a.name),x=a.credential_type===w.OAUTH2,y=(0,e.useMemo)(()=>!(k&&l&&m&&n),[k,l,m,n]),z=(0,d.jsxs)("div",{className:(0,I.cn)("group flex h-8 items-center rounded-lg p-1 hover:bg-state-base-hover",s&&"bg-state-base-hover",(b||a.not_allowed_to_use)&&"cursor-not-allowed opacity-50"),onClick:()=>{a.not_allowed_to_use||b||o?.("__workspace_default__"===a.id?"":a.id)},children:[s&&(0,d.jsxs)("div",{className:"flex w-full items-center space-x-1",children:[(0,d.jsx)(S.default,{wrapperClassName:"grow rounded-[6px]",className:"h-6",value:u,onChange:a=>v(a.target.value),placeholder:r("placeholder.input",{ns:"common"}),onClick:a=>a.stopPropagation()}),(0,d.jsx)(f.default,{size:"small",variant:"primary",onClick:b=>{b.stopPropagation(),j?.({credential_id:a.id,name:u}),t(!1)},children:r("operation.save",{ns:"common"})}),(0,d.jsx)(f.default,{size:"small",onClick:a=>{a.stopPropagation(),t(!1)},children:r("operation.cancel",{ns:"common"})})]}),!s&&(0,d.jsxs)("div",{className:"flex w-0 grow items-center space-x-1.5",children:[p&&(0,d.jsx)("div",{className:"h-4 w-4",children:q===a.id&&(0,d.jsx)(D.RiCheckLine,{className:"h-4 w-4 text-text-accent"})}),(0,d.jsx)(P.default,{className:"ml-2 mr-1.5 shrink-0",color:a.not_allowed_to_use?"gray":"green"}),(0,d.jsx)("div",{className:"system-md-regular truncate text-text-secondary",title:a.name,children:a.name}),a.is_default&&(0,d.jsx)(F.default,{className:"shrink-0",children:r("auth.default",{ns:"plugin"})})]}),a.from_enterprise&&(0,d.jsx)(F.default,{className:"shrink-0",children:"Enterprise"}),y&&!s&&(0,d.jsxs)("div",{className:"ml-2 hidden shrink-0 items-center group-hover:flex",children:[!a.is_default&&!n&&!a.not_allowed_to_use&&(0,d.jsx)(f.default,{size:"small",disabled:b,onClick:b=>{b.stopPropagation(),i?.(a.id)},children:r("auth.setDefault",{ns:"plugin"})}),!k&&!a.from_enterprise&&!a.not_allowed_to_use&&(0,d.jsx)(Q.default,{popupContent:r("operation.rename",{ns:"common"}),children:(0,d.jsx)(E.default,{disabled:b,onClick:b=>{b.stopPropagation(),t(!0),v(a.name)},children:(0,d.jsx)(D.RiEditLine,{className:"h-4 w-4 text-text-tertiary"})})}),!x&&!l&&!a.from_enterprise&&!a.not_allowed_to_use&&(0,d.jsx)(Q.default,{popupContent:r("operation.edit",{ns:"common"}),children:(0,d.jsx)(E.default,{disabled:b,onClick:b=>{b.stopPropagation(),h?.(a.id,{...a.credentials,__name__:a.name,__credential_id__:a.id})},children:(0,d.jsx)(D.RiEqualizer2Line,{className:"h-4 w-4 text-text-tertiary"})})}),!m&&!a.from_enterprise&&(0,d.jsx)(Q.default,{popupContent:r("operation.delete",{ns:"common"}),children:(0,d.jsx)(E.default,{className:"hover:bg-transparent",disabled:b,onClick:b=>{b.stopPropagation(),c?.(a.id)},children:(0,d.jsx)(D.RiDeleteBinLine,{className:"h-4 w-4 text-text-tertiary hover:text-text-destructive"})})})]})]},a.id);return a.not_allowed_to_use?(0,d.jsx)(Q.default,{popupContent:r("auth.customCredentialUnavailable",{ns:"plugin"}),children:z}):z}),U=(0,e.memo)(({pluginPayload:a,credentials:b,canOAuth:c,canApiKey:h,disabled:i,renderTrigger:j,isOpen:k,onOpenChange:l,offset:n=8,placement:o="bottom-start",triggerPopupSameWidth:p=!0,popupClassName:q,disableSetDefault:r,onItemClick:s,extraAuthorizationItems:t,showItemSelectedIcon:u,selectedCredentialId:v,onUpdate:x,notAllowCustomCredential:C})=>{let{t:E}=(0,g.useTranslation)(),{notify:F}=(0,m.useToastContext)(),[G,H]=(0,e.useState)(!1),J=k??G,K=(0,e.useCallback)(a=>{l&&l(a),H(a)},[l]),L=b.filter(a=>a.credential_type===w.OAUTH2),M=b.filter(a=>a.credential_type===w.API_KEY),Q=(0,e.useRef)(null),[S,U]=(0,e.useState)(null),{mutateAsync:V}=y(a),W=(0,e.useCallback)(a=>{a&&(Q.current=a),U(Q.current)},[]),X=(0,e.useCallback)(()=>{U(null),Q.current=null},[]),[Y,Z]=(0,e.useState)(!1),$=(0,e.useRef)(Y),_=(0,e.useCallback)(a=>{$.current=a,Z(a)},[]),aa=(0,e.useCallback)(async()=>{if(!$.current){if(!Q.current)return void U(null);try{_(!0),await V({credential_id:Q.current}),F({type:"success",message:E("api.actionSuccess",{ns:"common"})}),x?.(),U(null),Q.current=null}finally{_(!1)}}},[V,x,F,E,_]),[ab,ac]=(0,e.useState)(null),ad=(0,e.useCallback)((a,b)=>{Q.current=a,ac(b)},[]),ae=(0,e.useCallback)(()=>{U(Q.current)},[]),{mutateAsync:af}=z(a),ag=(0,e.useCallback)(async a=>{if(!$.current)try{_(!0),await af(a),F({type:"success",message:E("api.actionSuccess",{ns:"common"})}),x?.()}finally{_(!1)}},[af,x,F,E,_]),{mutateAsync:ah}=A(a),ai=(0,e.useCallback)(async a=>{if(!$.current)try{_(!0),await ah(a),F({type:"success",message:E("api.actionSuccess",{ns:"common"})}),x?.()}finally{_(!1)}},[ah,F,E,_,x]),aj=b.filter(a=>a.not_allowed_to_use),ak=b.find(a=>a.not_allowed_to_use&&a.is_default);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(O.PortalToFollowElem,{open:J,onOpenChange:K,placement:o,offset:n,triggerPopupSameWidth:p,children:[(0,d.jsx)(O.PortalToFollowElemTrigger,{onClick:()=>K(!J),asChild:!0,children:j?j(J):(0,d.jsxs)(f.default,{className:(0,I.cn)("w-full",k&&"bg-components-button-secondary-bg-hover"),children:[(0,d.jsx)(P.default,{className:"mr-2",color:ak?"gray":"green"}),b.length,"Â ",b.length>1?E("auth.authorizations",{ns:"plugin"}):E("auth.authorization",{ns:"plugin"}),!!aj.length&&` (${aj.length} ${E("auth.unavailable",{ns:"plugin"})})`,(0,d.jsx)(D.RiArrowDownSLine,{className:"ml-0.5 h-4 w-4"})]})}),(0,d.jsx)(O.PortalToFollowElemContent,{className:"z-[100]",children:(0,d.jsxs)("div",{className:(0,I.cn)("max-h-[360px] overflow-y-auto rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur shadow-lg",q),children:[(0,d.jsxs)("div",{className:"py-1",children:[!!t?.length&&(0,d.jsx)("div",{className:"p-1",children:t.map(a=>(0,d.jsx)(T,{credential:a,disabled:i,onItemClick:s,disableRename:!0,disableEdit:!0,disableDelete:!0,disableSetDefault:!0,showSelectedIcon:u,selectedCredentialId:v},a.id))}),!!L.length&&(0,d.jsxs)("div",{className:"p-1",children:[(0,d.jsx)("div",{className:(0,I.cn)("system-xs-medium px-3 pb-0.5 pt-1 text-text-tertiary",u&&"pl-7"),children:"OAuth"}),L.map(a=>(0,d.jsx)(T,{credential:a,disabled:i,disableEdit:!0,onDelete:W,onSetDefault:ag,onRename:ai,disableSetDefault:r,onItemClick:s,showSelectedIcon:u,selectedCredentialId:v},a.id))]}),!!M.length&&(0,d.jsxs)("div",{className:"p-1",children:[(0,d.jsx)("div",{className:(0,I.cn)("system-xs-medium px-3 pb-0.5 pt-1 text-text-tertiary",u&&"pl-7"),children:"API Keys"}),M.map(a=>(0,d.jsx)(T,{credential:a,disabled:i,onDelete:W,onEdit:ad,onSetDefault:ag,disableSetDefault:r,disableRename:!0,onItemClick:s,onRename:ai,showSelectedIcon:u,selectedCredentialId:v},a.id))]})]}),!C&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"h-[1px] bg-divider-subtle"}),(0,d.jsx)("div",{className:"p-2",children:(0,d.jsx)(R,{pluginPayload:a,theme:"secondary",showDivider:!1,canOAuth:c,canApiKey:h,disabled:i,onUpdate:x})})]})]})})]}),S&&(0,d.jsx)(N.default,{isShow:!0,title:E("list.delete.title",{ns:"datasetDocuments"}),isDisabled:Y,onCancel:X,onConfirm:aa}),!!ab&&(0,d.jsx)(B,{pluginPayload:a,editValues:ab,onClose:()=>{ac(null),Q.current=null},onRemove:ae,disabled:i||Y,onUpdate:x})]})}),V=(0,e.memo)(({authorizationsNum:a,onJumpToDataSourcePage:b})=>{let{t:c}=(0,g.useTranslation)();return(0,d.jsxs)(f.default,{size:"small",onClick:b,children:[(0,d.jsx)(P.default,{className:"mr-1.5",color:"green"}),c(a>1?"auth.authorizations":"auth.authorization",{ns:"plugin"}),(0,d.jsx)(D.RiEqualizer2Line,{className:(0,I.cn)("h-3.5 w-3.5 text-components-button-ghost-text")})]})});a.s(["default",0,V],234009),a.s(["default",()=>Y],277265);var W=a.i(705134);let X=(a,b)=>{let c,d,e,f,g,h,{data:i}=(c=x(a),d=b?c.getCredentialInfo:"",(0,q.useQuery)({enabled:!!d,queryKey:[t,"credential-info",d],queryFn:()=>(0,r.get)(d),staleTime:0})),{isCurrentWorkspaceManager:j}=(0,W.useAppContext)(),k=!!i?.credentials.length,l=i?.supported_credential_types.includes(w.OAUTH2),m=i?.supported_credential_types.includes(w.API_KEY),n=(e=x(a).getCredentialInfo,f=(0,s.useInvalid)([t,"credential-info",e]),g=a.providerType,h=(0,u.useInvalidToolsByType)(g),()=>{f(),h()});return{isAuthorized:k,canOAuth:l,canApiKey:m,credentials:i?.credentials||[],disabled:!j,notAllowCustomCredential:i?.allow_custom_token===!1,invalidPluginCredentialInfo:n}},Y=(0,e.memo)(({pluginPayload:a,onAuthorizationItemClick:b,credentialId:c})=>{let{t:h}=(0,g.useTranslation)(),[i,j]=(0,e.useState)(!1),{canApiKey:k,canOAuth:l,credentials:m,disabled:n,invalidPluginCredentialInfo:o,notAllowCustomCredential:p}=X(a,!0),q=(0,e.useCallback)(a=>{let b="",e=!1,g=!1,i="green",j=!1;if(c){let a=m.find(a=>a.id===c);b=a?a.name:h("auth.authRemoved",{ns:"plugin"}),e=!a,g=!!a?.not_allowed_to_use&&!a?.from_enterprise,e?i="red":g&&(i="gray")}else{b=h("auth.workspaceDefault",{ns:"plugin"});let a=m.find(a=>a.is_default);a?.not_allowed_to_use&&(i="gray",j=!0)}return(0,d.jsxs)(f.default,{size:"small",className:(0,I.cn)(a&&!e&&"bg-components-button-ghost-bg-hover",e&&"bg-transparent text-text-destructive"),variant:j||g?"ghost":"secondary",children:[(0,d.jsx)(P.default,{className:"mr-1.5",color:i}),b,(g||j)&&(0,d.jsxs)(d.Fragment,{children:["Â ",h("auth.unavailable",{ns:"plugin"})]}),(0,d.jsx)(D.RiArrowDownSLine,{className:(0,I.cn)("h-3.5 w-3.5 text-components-button-ghost-text",e&&"text-text-destructive")})]})},[c,m,h]),r=m.find(a=>a.is_default)?.not_allowed_to_use,s=[{id:"__workspace_default__",name:h("auth.workspaceDefault",{ns:"plugin"}),provider:"",is_default:!c,isWorkspaceDefault:!0,not_allowed_to_use:r}],t=(0,e.useCallback)(a=>{b(a),j(!1)},[b,j]);return(0,d.jsx)(U,{pluginPayload:a,credentials:m,canOAuth:l,canApiKey:k,renderTrigger:q,isOpen:i,onOpenChange:j,offset:4,placement:"bottom-end",triggerPopupSameWidth:!1,popupClassName:"w-[360px]",disabled:n,disableSetDefault:!0,onItemClick:t,extraAuthorizationItems:s,showItemSelectedIcon:!0,selectedCredentialId:c||"__workspace_default__",onUpdate:o,notAllowCustomCredential:p})});a.s(["usePluginAuthAction",0,(a,b)=>{let{t:c}=(0,g.useTranslation)(),{notify:d}=(0,m.useToastContext)(),f=(0,e.useRef)(null),[h,i]=(0,e.useState)(null),{mutateAsync:j}=y(a),k=(0,e.useCallback)(a=>{a&&(f.current=a),i(f.current)},[]),l=(0,e.useCallback)(()=>{i(null),f.current=null},[]),[n,o]=(0,e.useState)(!1),p=(0,e.useRef)(n),q=(0,e.useCallback)(a=>{p.current=a,o(a)},[]),[r,s]=(0,e.useState)(null),t=(0,e.useCallback)(async()=>{if(!p.current){if(!f.current)return void i(null);try{q(!0),await j({credential_id:f.current}),d({type:"success",message:c("api.actionSuccess",{ns:"common"})}),b?.(),i(null),f.current=null,s(null)}finally{q(!1)}}},[j,b,d,c,q]),u=(0,e.useCallback)((a,b)=>{f.current=a,s(b)},[]),v=(0,e.useCallback)(()=>{i(f.current)},[]),{mutateAsync:w}=z(a),x=(0,e.useCallback)(async a=>{if(!p.current)try{q(!0),await w(a),d({type:"success",message:c("api.actionSuccess",{ns:"common"})}),b?.()}finally{q(!1)}},[w,b,d,c,q]),{mutateAsync:B}=A(a),C=(0,e.useCallback)(async a=>{if(!p.current)try{q(!0),await B(a),d({type:"success",message:c("api.actionSuccess",{ns:"common"})}),b?.()}finally{q(!1)}},[B,d,c,q,b]);return{doingAction:n,handleSetDoingAction:q,openConfirm:k,closeConfirm:l,deleteCredentialId:h,setDeleteCredentialId:i,handleConfirm:t,editValues:r,setEditValues:s,handleEdit:u,handleRemove:v,handleSetDefault:x,handleRename:C,pendingOperationCredentialId:f}}],104017);let Z=(0,e.memo)(({pluginPayload:a,children:b,className:c})=>{let{isAuthorized:e,canOAuth:f,canApiKey:g,credentials:h,disabled:i,invalidPluginCredentialInfo:j,notAllowCustomCredential:k}=X(a,!!a.provider);return(0,d.jsxs)("div",{className:(0,I.cn)(!e&&c),children:[!e&&(0,d.jsx)(R,{pluginPayload:a,canOAuth:f,canApiKey:g,disabled:i,onUpdate:j,notAllowCustomCredential:k}),e&&!b&&(0,d.jsx)(U,{pluginPayload:a,credentials:h,canOAuth:f,canApiKey:g,disabled:i,onUpdate:j,notAllowCustomCredential:k}),e&&b]})});a.s(["default",0,Z],11740);let $=(0,e.memo)(({pluginPayload:a,credentialId:b,onAuthorizationItemClick:c})=>{let{t:h}=(0,g.useTranslation)(),[i,j]=(0,e.useState)(!1),{isAuthorized:k,canOAuth:l,canApiKey:m,credentials:n,disabled:o,invalidPluginCredentialInfo:p,notAllowCustomCredential:q}=X(a,!0),r=[{id:"__workspace_default__",name:h("auth.workspaceDefault",{ns:"plugin"}),provider:"",is_default:!b,isWorkspaceDefault:!0}],s=(0,e.useCallback)(a=>{c?.(a),j(!1)},[c,j]),t=(0,e.useCallback)(a=>{let c="",e=!1,g=!1,i="green";if(b){let a=n.find(a=>a.id===b);c=a?a.name:h("auth.authRemoved",{ns:"plugin"}),e=!a,g=!!a?.not_allowed_to_use&&!a?.from_enterprise,e?i="red":g&&(i="gray")}else c=h("auth.workspaceDefault",{ns:"plugin"});return(0,d.jsxs)(f.default,{className:(0,I.cn)("w-full",a&&"bg-components-button-secondary-bg-hover",e&&"text-text-destructive"),children:[(0,d.jsx)(P.default,{className:"mr-2",color:i}),c,g&&h("auth.unavailable",{ns:"plugin"}),(0,d.jsx)(D.RiArrowDownSLine,{className:"ml-0.5 h-4 w-4"})]})},[b,n,h]);return(0,d.jsxs)(d.Fragment,{children:[!k&&(0,d.jsx)(R,{pluginPayload:a,canOAuth:l,canApiKey:m,disabled:o,onUpdate:p,notAllowCustomCredential:q}),k&&(0,d.jsx)(U,{pluginPayload:a,credentials:n,canOAuth:l,canApiKey:m,disabled:o,disableSetDefault:!0,onItemClick:s,extraAuthorizationItems:r,showItemSelectedIcon:!0,renderTrigger:t,isOpen:i,onOpenChange:j,selectedCredentialId:b||"__workspace_default__",onUpdate:p,notAllowCustomCredential:q})]})});a.s(["default",0,$],128565);let _=(0,e.memo)(({children:a,isAuthorized:b,onJumpToDataSourcePage:c})=>{let{t:e}=(0,g.useTranslation)();return(0,d.jsxs)(d.Fragment,{children:[!b&&(0,d.jsx)("div",{className:"px-4 pb-2",children:(0,d.jsxs)(f.default,{className:"w-full",variant:"primary",onClick:c,children:[(0,d.jsx)(D.RiAddLine,{className:"mr-1 h-4 w-4"}),e("integrations.connect",{ns:"common"})]})}),b&&a]})});a.s(["default",0,_],612222)}];

//# sourceMappingURL=_d16c0e3c._.js.map