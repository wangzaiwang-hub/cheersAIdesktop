module.exports=[136156,a=>{"use strict";var b=a.i(608061),c=a.i(632789);a.s(["default",0,({isMobile:a,children:d,isOpen:e,...f})=>(0,b.jsxs)(b.Fragment,{children:[a&&(0,b.jsx)(c.default,{isOpen:e,...f,children:d}),!a&&e&&(0,b.jsx)(b.Fragment,{children:d})]})])},870799,a=>{a.v({active:"index-module__2HZM1W__active",auto:"index-module__2HZM1W__auto",button:"index-module__2HZM1W__button",calculating:"index-module__2HZM1W__calculating",click:"index-module__2HZM1W__click",content:"index-module__2HZM1W__content",csv:"index-module__2HZM1W__csv",custom:"index-module__2HZM1W__custom",customize:"index-module__2HZM1W__customize",disableMask:"index-module__2HZM1W__disableMask",disabled:"index-module__2HZM1W__disabled",divider:"index-module__2HZM1W__divider",doc:"index-module__2HZM1W__doc",docx:"index-module__2HZM1W__docx",economical:"index-module__2HZM1W__economical",fileIcon:"index-module__2HZM1W__fileIcon",fix:"index-module__2HZM1W__fix",fixed:"index-module__2HZM1W__fixed",formFooter:"index-module__2HZM1W__formFooter",formRow:"index-module__2HZM1W__formRow",htm:"index-module__2HZM1W__htm",html:"index-module__2HZM1W__html",icon:"index-module__2HZM1W__icon",indexItem:"index-module__2HZM1W__indexItem",input:"index-module__2HZM1W__input",isMobile:"index-module__2HZM1W__isMobile",json:"index-module__2HZM1W__json",label:"index-module__2HZM1W__label",markdown:"index-module__2HZM1W__markdown",md:"index-module__2HZM1W__md",pageHeader:"index-module__2HZM1W__pageHeader",pdf:"index-module__2HZM1W__pdf",previewWrap:"index-module__2HZM1W__previewWrap",qualified:"index-module__2HZM1W__qualified",radio:"index-module__2HZM1W__radio",radioItem:"index-module__2HZM1W__radioItem",recommendTag:"index-module__2HZM1W__recommendTag",ruleItem:"index-module__2HZM1W__ruleItem",segmentCount:"index-module__2HZM1W__segmentCount",segmentationItem:"index-module__2HZM1W__segmentationItem",sideTip:"index-module__2HZM1W__sideTip",source:"index-module__2HZM1W__source",sourceContent:"index-module__2HZM1W__sourceContent",sourceCount:"index-module__2HZM1W__sourceCount",tip:"index-module__2HZM1W__tip",tipCard:"index-module__2HZM1W__tipCard",title:"index-module__2HZM1W__title",txt:"index-module__2HZM1W__txt",typeFormBody:"index-module__2HZM1W__typeFormBody",typeHeader:"index-module__2HZM1W__typeHeader",typeIcon:"index-module__2HZM1W__typeIcon",warningTip:"index-module__2HZM1W__warningTip",xls:"index-module__2HZM1W__xls",xlsx:"index-module__2HZM1W__xlsx"})},158139,322715,311706,358030,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(682541);a.i(752298);var e=a.i(693025),f=a.i(909795),g=a.i(168799),h=a.i(757801),i=a.i(483664),j=a.i(57843),k=a.i(81492),l=a.i(146172),m=a.i(933988),n=a.i(701458),o=a.i(403473);let p=(0,j.memo)(({entry:a="knowledge-base",summaryIndexSetting:c,onSummaryIndexSettingChange:d,readonly:f=!1})=>{let{t:g}=(0,e.useTranslation)(),{data:h}=(0,n.useModelList)(m.ModelTypeEnum.textGeneration),p=(0,j.useMemo)(()=>{if(c?.model_name&&c?.model_provider_name)return{providerName:c?.model_provider_name,modelName:c?.model_name}},[c?.model_name,c?.model_provider_name]),q=(0,j.useCallback)(a=>{d?.({enable:a})},[d]),r=(0,j.useCallback)(a=>{d?.({model_provider_name:a.provider,model_name:a.model})},[d]),s=(0,j.useCallback)(a=>{d?.({summary_prompt:a.target.value})},[d]);return"knowledge-base"===a?(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex h-6 items-center justify-between",children:[(0,b.jsxs)("div",{className:"system-sm-semibold-uppercase flex items-center text-text-secondary",children:[g("form.summaryAutoGen",{ns:"datasetSettings"}),(0,b.jsx)(i.default,{triggerClassName:"ml-1 h-4 w-4 shrink-0",popupContent:g("form.summaryAutoGenTip",{ns:"datasetSettings"})})]}),(0,b.jsx)(k.default,{defaultValue:c?.enable??!1,onChange:q,size:"md"})]}),c?.enable&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"system-xs-medium-uppercase mb-1.5 mt-2 flex h-6 items-center text-text-tertiary",children:g("form.summaryModel",{ns:"datasetSettings"})}),(0,b.jsx)(o.default,{defaultModel:p&&{provider:p.providerName,model:p.modelName},modelList:h,onSelect:r,readonly:f,showDeprecatedWarnIcon:!0}),(0,b.jsx)("div",{className:"system-xs-medium-uppercase mt-3 flex h-6 items-center text-text-tertiary",children:g("form.summaryInstructions",{ns:"datasetSettings"})}),(0,b.jsx)(l.default,{value:c?.summary_prompt??"",onChange:s,disabled:f,placeholder:g("form.summaryInstructionsPlaceholder",{ns:"datasetSettings"})})]})]}):"dataset-settings"===a?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex gap-x-1",children:[(0,b.jsx)("div",{className:"flex h-7 w-[180px] shrink-0 items-center pt-1",children:(0,b.jsx)("div",{className:"system-sm-semibold text-text-secondary",children:g("form.summaryAutoGen",{ns:"datasetSettings"})})}),(0,b.jsxs)("div",{className:"py-1.5",children:[(0,b.jsxs)("div",{className:"system-sm-semibold flex items-center text-text-secondary",children:[(0,b.jsx)(k.default,{className:"mr-2",defaultValue:c?.enable??!1,onChange:q,size:"md"}),g(c?.enable?"list.status.enabled":"list.status.disabled",{ns:"datasetDocuments"})]}),(0,b.jsxs)("div",{className:"system-sm-regular mt-2 text-text-tertiary",children:[c?.enable&&g("form.summaryAutoGenTip",{ns:"datasetSettings"}),!c?.enable&&g("form.summaryAutoGenEnableTip",{ns:"datasetSettings"})]})]})]}),c?.enable&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex gap-x-1",children:[(0,b.jsx)("div",{className:"flex h-7 w-[180px] shrink-0 items-center pt-1",children:(0,b.jsx)("div",{className:"system-sm-medium text-text-tertiary",children:g("form.summaryModel",{ns:"datasetSettings"})})}),(0,b.jsx)("div",{className:"grow",children:(0,b.jsx)(o.default,{defaultModel:p&&{provider:p.providerName,model:p.modelName},modelList:h,onSelect:r,readonly:f,showDeprecatedWarnIcon:!0,triggerClassName:"h-8"})})]}),(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)("div",{className:"flex h-7 w-[180px] shrink-0 items-center pt-1",children:(0,b.jsx)("div",{className:"system-sm-medium text-text-tertiary",children:g("form.summaryInstructions",{ns:"datasetSettings"})})}),(0,b.jsx)("div",{className:"grow",children:(0,b.jsx)(l.default,{value:c?.summary_prompt??"",onChange:s,disabled:f,placeholder:g("form.summaryInstructionsPlaceholder",{ns:"datasetSettings"})})})]})]})]}):(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex h-6 items-center",children:[(0,b.jsx)(k.default,{className:"mr-2",defaultValue:c?.enable??!1,onChange:q,size:"md"}),(0,b.jsx)("div",{className:"system-sm-semibold text-text-secondary",children:g("form.summaryAutoGen",{ns:"datasetSettings"})})]}),c?.enable&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"system-sm-medium mb-1.5 flex h-6 items-center text-text-secondary",children:g("form.summaryModel",{ns:"datasetSettings"})}),(0,b.jsx)(o.default,{defaultModel:p&&{provider:p.providerName,model:p.modelName},modelList:h,onSelect:r,readonly:f,showDeprecatedWarnIcon:!0,triggerClassName:"h-8"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"system-sm-medium mb-1.5 flex h-6 items-center text-text-secondary",children:g("form.summaryInstructions",{ns:"datasetSettings"})}),(0,b.jsx)(l.default,{value:c?.summary_prompt??"",onChange:s,disabled:f,placeholder:g("form.summaryInstructionsPlaceholder",{ns:"datasetSettings"})})]})]})]})});a.s(["default",0,p],322715);var q=a.i(18039),r=a.i(986431);let s={src:a.i(755951).default,width:20,height:20,blurWidth:0,blurHeight:0};var t=a.i(870799),u=a.i(234782),v=a.i(136403),w=a.i(527344);let x=j.memo(({currentLanguage:a,onSelect:d,disabled:e})=>(0,b.jsx)(u.default,{manualClose:!0,trigger:"click",disabled:e,popupClassName:"z-20",htmlContent:(0,b.jsx)("div",{className:"w-full p-1",children:v.languages.filter(a=>a.supported).map(({prompt_name:e})=>(0,b.jsxs)("div",{className:"inline-flex w-full cursor-pointer items-center justify-between rounded-lg px-3 py-2 hover:bg-state-base-hover",onClick:()=>d(e),children:[(0,b.jsx)("span",{className:"system-sm-medium text-text-secondary",children:e}),a===e&&(0,b.jsx)(c.RiCheckLine,{className:"size-4 text-text-accent"})]},e))}),btnElement:(0,b.jsxs)("div",{className:(0,w.cn)("inline-flex items-center gap-x-[1px]",e&&"cursor-not-allowed"),children:[(0,b.jsx)("span",{className:(0,w.cn)("system-xs-semibold px-[3px] text-components-button-tertiary-text",e?"text-components-button-tertiary-text-disabled":""),children:a}),(0,b.jsx)(c.RiArrowDownSLine,{className:(0,w.cn)("size-3.5 text-components-button-tertiary-text",e?"text-components-button-tertiary-text-disabled":"")})]}),btnClassName:()=>(0,w.cn)("!hover:bg-components-button-tertiary-bg !mx-1 rounded-md !border-0 !bg-components-button-tertiary-bg !px-1.5 !py-1",e?"bg-components-button-tertiary-bg-disabled":""),className:"!left-1 !z-20 h-fit !w-[140px] !translate-x-0"}));var y=a.i(816134),z=a.i(644734);let A=a=>(0,b.jsx)("label",{className:"text-xs font-semibold leading-none text-text-secondary",children:a.children}),B=a=>(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)(A,{children:a.label}),a.children]}),C=a=>{let{t:c}=(0,e.useTranslation)();return(0,b.jsx)(B,{label:(0,b.jsxs)("div",{className:"mb-1 flex items-center",children:[(0,b.jsx)("span",{className:"system-sm-semibold mr-0.5",children:c("stepTwo.separator",{ns:"datasetCreation"})}),(0,b.jsx)(i.default,{popupContent:(0,b.jsx)("div",{className:"max-w-[200px]",children:a.tooltip||c("stepTwo.separatorTip",{ns:"datasetCreation"})})})]}),children:(0,b.jsx)(y.default,{type:"text",className:"h-9",placeholder:c("stepTwo.separatorPlaceholder",{ns:"datasetCreation"}),...a})})},D=a=>{let c=Number.parseInt(globalThis.document?.body?.getAttribute("data-public-indexing-max-segmentation-tokens-length")||"4000",10),{t:d}=(0,e.useTranslation)();return(0,b.jsx)(B,{label:(0,b.jsx)("div",{className:"system-sm-semibold mb-1",children:d("stepTwo.maxLength",{ns:"datasetCreation"})}),children:(0,b.jsx)(z.InputNumber,{type:"number",size:"large",placeholder:`â‰¤ ${c}`,max:c,min:1,...a})})},E=a=>{let{t:c}=(0,e.useTranslation)();return(0,b.jsx)(B,{label:(0,b.jsxs)("div",{className:"mb-1 flex items-center",children:[(0,b.jsx)("span",{className:"system-sm-semibold",children:c("stepTwo.overlap",{ns:"datasetCreation"})}),(0,b.jsx)(i.default,{popupContent:(0,b.jsx)("div",{className:"max-w-[200px]",children:c("stepTwo.overlapTip",{ns:"datasetCreation"})})})]}),children:(0,b.jsx)(z.InputNumber,{type:"number",size:"large",placeholder:c("stepTwo.overlap",{ns:"datasetCreation"})||"",min:1,...a})})};a.s(["DelimiterInput",0,C,"MaxLengthInput",0,D,"OverlapInput",0,E],311706);let F=a=>(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"11",viewBox:"0 0 24 11",fill:"none",...a,children:(0,b.jsx)("path",{d:"M9.87868 1.12132C11.0503 -0.0502525 12.9497 -0.0502525 14.1213 1.12132L23.3137 10.3137H0.686292L9.87868 1.12132Z",fill:"currentColor"})}),G=a=>{let{icon:c,title:e,description:f,isActive:g,activeClassName:h,effectImg:i,disabled:j}=a;return(0,b.jsxs)("div",{className:(0,w.cn)("relative flex h-full overflow-hidden rounded-t-xl",g&&h,!j&&"cursor-pointer"),children:[(0,b.jsxs)("div",{className:"relative flex size-14 items-center justify-center overflow-hidden",children:[g&&i&&(0,b.jsx)(d.default,{src:i,className:"absolute left-0 top-0 h-full w-full",alt:"",width:56,height:56}),(0,b.jsx)("div",{className:"p-1",children:(0,b.jsx)("div",{className:"flex size-8 justify-center rounded-lg border border-components-panel-border-subtle bg-background-default-dodge p-1.5 shadow-md",children:c})})]}),(0,b.jsx)(F,{className:(0,w.cn)("absolute -bottom-1.5 left-4 text-transparent",g&&"text-components-panel-bg")}),(0,b.jsxs)("div",{className:"flex-1 space-y-0.5 py-3 pr-4",children:[(0,b.jsx)("div",{className:"system-md-semibold text-text-secondary",children:e}),(0,b.jsx)("div",{className:"system-xs-regular text-text-tertiary",children:f})]})]})},H=({ref:a,...c})=>{let{icon:d,className:e,title:f,description:g,isActive:h,children:i,actions:j,activeHeaderClassName:k,style:l,effectImg:m,onSwitched:n,noHighlight:o,disabled:p,...q}=c;return(0,b.jsxs)("div",{className:(0,w.cn)("rounded-xl bg-components-option-card-option-bg shadow-xs",h&&!o?"border-[1.5px] border-components-option-card-option-selected-border":"border border-components-option-card-option-border",p&&"pointer-events-none opacity-50",e),style:{...l},onClick:()=>{h||p||n?.()},...q,ref:a,children:[(0,b.jsx)(G,{icon:d,title:f,description:g,isActive:h&&!o,activeClassName:k,effectImg:m,disabled:p}),!!(h&&(i||j))&&(0,b.jsxs)("div",{className:"rounded-b-xl bg-components-panel-bg px-4 py-3",children:[i,!!j&&(0,b.jsx)("div",{className:"mt-4 flex gap-2",children:j})]})]})};H.displayName="OptionCard",a.s(["OptionCard",0,H],358030);let I=({children:a})=>(0,b.jsx)("label",{className:"system-sm-semibold text-text-secondary",children:a});a.s(["GeneralChunkingOptions",0,({segmentIdentifier:a,maxChunkLength:j,overlap:k,rules:l,currentDocForm:m,docLanguage:n,isActive:o,isInUpload:u,isNotUploadInEmptyDataset:v,hasCurrentDatasetDocForm:w,onSegmentIdentifierChange:y,onMaxChunkLengthChange:z,onOverlapChange:A,onRuleToggle:B,onDocFormChange:F,onDocLanguageChange:G,onPreview:J,onReset:K,locale:L,showSummaryIndexSetting:M,summaryIndexSetting:N,onSummaryIndexSettingChange:O})=>{let{t:P}=(0,e.useTranslation)();return(0,b.jsx)(H,{className:"mb-2 bg-background-section",title:P("stepTwo.general",{ns:"datasetCreation"}),icon:(0,b.jsx)(d.default,{width:20,height:20,src:s,alt:P("stepTwo.general",{ns:"datasetCreation"})}),activeHeaderClassName:"bg-dataset-option-card-blue-gradient",description:P("stepTwo.generalTip",{ns:"datasetCreation"}),isActive:o,onSwitched:()=>F(r.ChunkingMode.text),actions:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(f.default,{variant:"secondary-accent",onClick:J,children:[(0,b.jsx)(c.RiSearchEyeLine,{className:"mr-0.5 h-4 w-4"}),P("stepTwo.previewChunk",{ns:"datasetCreation"})]}),(0,b.jsx)(f.default,{variant:"ghost",onClick:K,children:P("stepTwo.reset",{ns:"datasetCreation"})})]}),noHighlight:u&&v,children:(0,b.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(C,{value:a,onChange:a=>y(a.target.value)}),(0,b.jsx)(D,{unit:"characters",value:j,onChange:z}),(0,b.jsx)(E,{unit:"characters",value:k,min:1,onChange:A})]}),(0,b.jsxs)("div",{className:"flex w-full flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,b.jsx)("div",{className:"inline-flex shrink-0",children:(0,b.jsx)(I,{children:P("stepTwo.rules",{ns:"datasetCreation"})})}),(0,b.jsx)(h.default,{className:"grow",bgStyle:"gradient"})]}),(0,b.jsxs)("div",{className:"mt-1",children:[l.map(a=>{var c;return(0,b.jsxs)("div",{className:t.default.ruleItem,onClick:()=>B(a.id),children:[(0,b.jsx)(g.default,{checked:a.enabled}),(0,b.jsx)("label",{className:"system-sm-regular ml-2 cursor-pointer text-text-secondary",children:(c=a.id,({remove_extra_spaces:P("stepTwo.removeExtraSpaces",{ns:"datasetCreation"}),remove_urls_emails:P("stepTwo.removeUrlEmails",{ns:"datasetCreation"}),remove_stopwords:P("stepTwo.removeStopwords",{ns:"datasetCreation"})})[c]??c)})]},a.id)}),M&&(0,b.jsx)("div",{className:"mt-3",children:(0,b.jsx)(p,{entry:"create-document",summaryIndexSetting:N,onSummaryIndexSettingChange:O})}),q.IS_CE_EDITION&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.default,{type:"horizontal",className:"my-4 bg-divider-subtle"}),(0,b.jsxs)("div",{className:"flex items-center py-0.5",children:[(0,b.jsxs)("div",{className:"flex items-center",onClick:()=>{w||(m===r.ChunkingMode.qa?F(r.ChunkingMode.text):F(r.ChunkingMode.qa))},children:[(0,b.jsx)(g.default,{checked:m===r.ChunkingMode.qa,disabled:w}),(0,b.jsx)("label",{className:"system-sm-regular ml-2 cursor-pointer text-text-secondary",children:P("stepTwo.useQALanguage",{ns:"datasetCreation"})})]}),(0,b.jsx)(x,{currentLanguage:n||L,onSelect:G,disabled:m!==r.ChunkingMode.qa}),(0,b.jsx)(i.default,{popupContent:P("stepTwo.QATip",{ns:"datasetCreation"})})]}),m===r.ChunkingMode.qa&&(0,b.jsxs)("div",{style:{background:"linear-gradient(92deg, rgba(247, 144, 9, 0.1) 0%, rgba(255, 255, 255, 0.00) 100%)"},className:"mt-2 flex h-10 items-center gap-2 rounded-xl border border-components-panel-border px-3 text-xs shadow-xs backdrop-blur-[5px]",children:[(0,b.jsx)(c.RiAlertFill,{className:"size-4 text-text-warning-secondary"}),(0,b.jsx)("span",{className:"system-xs-medium text-text-primary",children:P("stepTwo.QATip",{ns:"datasetCreation"})})]})]})]})]})]})})}],158139)},382605,736188,654118,543945,295932,a=>{"use strict";var b,c=a.i(706492);a.s(["VectorSearch",()=>c.default],382605);var d=((b={}).indigo="indigo",b.blueLight="blue-light",b.orange="orange",b.purple="purple",b);a.s(["EffectColor",()=>d],736188);var e=a.i(608061),f=a.i(57843);a.i(752298);var g=a.i(693025),h=a.i(218865),i=a.i(527344);a.i(224256);var j=a.i(504454);a.s(["ArrowShape",()=>j.default],654118);var j=j;let k={[d.indigo]:"bg-util-colors-indigo-indigo-600 opacity-50",[d.blueLight]:"bg-util-colors-blue-light-blue-light-600 opacity-80",[d.orange]:"bg-util-colors-orange-orange-500 opacity-50",[d.purple]:"bg-util-colors-purple-purple-600 opacity-80"},l=f.memo(({id:a,className:b,isActive:c,icon:d,iconActiveColor:f,title:l,description:m,isRecommended:n,effectColor:o,showEffectColor:p,disabled:q,onClick:r,children:s,showChildren:t,ref:u})=>{let{t:v}=(0,g.useTranslation)();return(0,e.jsxs)("div",{ref:u,className:(0,i.cn)("cursor-pointer overflow-hidden rounded-xl border border-components-option-card-option-border bg-components-option-card-option-bg",c&&"border border-components-option-card-option-selected-border ring-[1px] ring-components-option-card-option-selected-border",q&&"cursor-not-allowed opacity-50"),onClick:()=>{c||q||r?.(a)},children:[(0,e.jsxs)("div",{className:(0,i.cn)("relative flex rounded-t-xl p-2",b),children:[o&&p&&(0,e.jsx)("div",{className:(0,i.cn)("absolute left-[-2px] top-[-2px] h-14 w-14 rounded-full blur-[80px]",`${k[o]}`)}),!!d&&(0,e.jsx)("div",{className:(0,i.cn)("flex size-6 shrink-0 items-center justify-center text-text-tertiary",c&&f),children:d}),(0,e.jsxs)("div",{className:"flex grow flex-col gap-y-0.5 py-px",children:[(0,e.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,e.jsx)("span",{className:"system-sm-medium text-text-secondary",children:l}),n&&(0,e.jsx)(h.default,{className:"h-[18px] border-text-accent-secondary text-text-accent-secondary",children:v("stepTwo.recommend",{ns:"datasetCreation"})})]}),m&&(0,e.jsx)("div",{className:"system-xs-regular text-text-tertiary",children:m})]})]}),!!(s&&t)&&(0,e.jsxs)("div",{className:"relative rounded-b-xl bg-components-panel-bg p-4",children:[(0,e.jsx)(j.default,{className:"absolute left-[14px] top-[-11px] size-4 text-components-panel-bg"}),s]})]})});a.s(["default",0,l],543945);var m=a.i(111089),n=a.i(703298);let o=a=>a>0&&a<1?`0.${10*a}`:1===a?"1.0":a,p=(0,f.memo)(({value:a,onChange:b=m.noop,readonly:c=!1})=>{let{t:d}=(0,g.useTranslation)();return(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:"space-x-3 rounded-lg border border-components-panel-border px-3 pb-2 pt-5",children:[(0,e.jsx)(n.default,{className:(0,i.cn)("h-0.5 grow rounded-full !bg-util-colors-teal-teal-500"),max:1,min:0,step:.1,value:a.value[0],onChange:a=>!c&&b({value:[a,(10-10*a)/10]}),trackClassName:"weightedScoreSliderTrack",disabled:c}),(0,e.jsxs)("div",{className:"mt-3 flex justify-between",children:[(0,e.jsxs)("div",{className:"system-xs-semibold-uppercase flex w-[90px] shrink-0 items-center text-util-colors-blue-light-blue-light-500",children:[(0,e.jsx)("div",{className:"mr-1 truncate uppercase",title:d("weightedScore.semantic",{ns:"dataset"})||"",children:d("weightedScore.semantic",{ns:"dataset"})}),o(a.value[0])]}),(0,e.jsxs)("div",{className:"system-xs-semibold-uppercase flex w-[90px] shrink-0 items-center justify-end text-util-colors-teal-teal-500",children:[o(a.value[1]),(0,e.jsx)("div",{className:"ml-1 truncate uppercase",title:d("weightedScore.keyword",{ns:"dataset"})||"",children:d("weightedScore.keyword",{ns:"dataset"})})]})]})]})})});a.s(["default",0,p],295932)},687844,a=>{"use strict";var b=a.i(608061),c=a.i(111089),d=a.i(57843),e=a.i(527344);let f=d.memo(({icon:a,iconBgClassName:d="bg-[#F5F3FF]",title:f,description:g,noRadio:h,isChosen:i,onChosen:j=c.noop,chosenConfig:k,chosenConfigWrapClassName:l,className:m})=>(0,b.jsxs)("div",{className:(0,e.cn)("relative cursor-pointer rounded-xl border-[0.5px] border-components-option-card-option-border bg-components-option-card-option-bg p-3",i&&"border-[1.5px] bg-components-option-card-option-selected-bg",m),children:[(0,b.jsxs)("div",{className:"flex gap-x-2",onClick:j,children:[(0,b.jsx)("div",{className:(0,e.cn)(d,"flex size-8 shrink-0 items-center justify-center rounded-lg shadow-md"),children:a}),(0,b.jsxs)("div",{className:"grow",children:[(0,b.jsx)("div",{className:"system-sm-semibold mb-1 text-text-secondary",children:f}),(0,b.jsx)("div",{className:"system-xs-regular text-text-tertiary",children:g})]}),!h&&(0,b.jsx)("div",{className:"absolute right-3 top-3",children:(0,b.jsx)("div",{className:(0,e.cn)("h-4 w-4 rounded-full border border-components-radio-border bg-components-radio-bg shadow-xs",i&&"border-[5px] border-components-radio-border-checked")})})]}),!!(i&&k||h)&&(0,b.jsxs)("div",{className:"mt-2 flex gap-x-2",children:[(0,b.jsx)("div",{className:"size-8 shrink-0"}),(0,b.jsx)("div",{className:(0,e.cn)(l,"grow"),children:k})]})]}));a.s(["default",0,f])},916443,985226,479873,721298,a=>{"use strict";var b=a.i(608061),c=a.i(57843);a.i(752298);var d=a.i(693025);a.i(224256);var e=a.i(382605),f=a.i(954200),g=a.i(736188),h=a.i(543945),i=a.i(682541),j=a.i(295932);a.i(955696);var k=a.i(2496),l=a.i(416985),m=a.i(102170),n=a.i(687844),o=a.i(81492),p=a.i(114715),q=a.i(483664),r=a.i(933988),s=a.i(701458),t=a.i(403473),u=a.i(986431),v=a.i(527344);let w={src:a.i(438156).default,width:20,height:20,blurWidth:0,blurHeight:0},x={src:a.i(397088).default,width:20,height:20,blurWidth:0,blurHeight:0},y=c.memo(({type:a,value:e,showMultiModalTip:g=!1,onChange:h})=>{let{t:y}=(0,d.useTranslation)(),z=a!==f.RETRIEVE_METHOD.hybrid,A=a===f.RETRIEVE_METHOD.keywordSearch,B=a===f.RETRIEVE_METHOD.hybrid,{modelList:C}=(0,s.useModelListAndDefaultModel)(r.ModelTypeEnum.rerank),{currentModel:D}=(0,s.useCurrentProviderAndModel)(C,{provider:e.reranking_model?.reranking_provider_name??"",model:e.reranking_model?.reranking_model_name??""}),E=(0,c.useCallback)(a=>{a&&!D&&p.default.notify({type:"error",message:y("errorMsg.rerankModelRequired",{ns:"workflow"})}),h({...e,reranking_enable:a})},[D,h,e]),F=(0,c.useMemo)(()=>({provider_name:e.reranking_model.reranking_provider_name,model_name:e.reranking_model.reranking_model_name}),[e.reranking_model]),G=[{value:u.RerankingModeEnum.WeightedScore,label:y("weightedScore.title",{ns:"dataset"}),tips:y("weightedScore.description",{ns:"dataset"})},{value:u.RerankingModeEnum.RerankingModel,label:y("modelProvider.rerankModel.key",{ns:"common"}),tips:y("modelProvider.rerankModel.tip",{ns:"common"})}];return(0,b.jsxs)("div",{children:[!A&&!B&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-2 flex items-center space-x-2",children:[z&&(0,b.jsx)(o.default,{size:"md",defaultValue:e.reranking_enable,onChange:E}),(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("span",{className:"system-sm-semibold mr-0.5 text-text-secondary",children:y("modelProvider.rerankModel.key",{ns:"common"})}),(0,b.jsx)(q.default,{popupContent:(0,b.jsx)("div",{className:"w-[200px]",children:y("modelProvider.rerankModel.tip",{ns:"common"})})})]})]}),e.reranking_enable&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(t.default,{defaultModel:F&&{provider:F.provider_name,model:F.model_name},modelList:C,onSelect:a=>{h({...e,reranking_model:{reranking_provider_name:a.provider,reranking_model_name:a.model}})}}),g&&(0,b.jsxs)("div",{className:"mt-2 flex h-10 items-center gap-x-0.5 overflow-hidden rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur p-2 shadow-xs backdrop-blur-[5px]",children:[(0,b.jsx)("div",{className:"absolute bottom-0 left-0 right-0 top-0 bg-dataset-warning-message-bg opacity-40"}),(0,b.jsx)("div",{className:"p-1",children:(0,b.jsx)(k.AlertTriangle,{className:"size-4 text-text-warning-secondary"})}),(0,b.jsx)("span",{className:"system-xs-medium text-text-primary",children:y("form.retrievalSetting.multiModalTip",{ns:"datasetSettings"})})]})]})]}),!B&&(0,b.jsxs)("div",{className:(0,v.cn)(!A&&"mt-4","space-between flex space-x-4"),children:[(0,b.jsx)(m.default,{className:"grow",value:e.top_k,onChange:(a,b)=>{h({...e,top_k:b})},enable:!0}),!A&&!(e.search_method===f.RETRIEVE_METHOD.fullText&&!e.reranking_enable)&&(0,b.jsx)(l.default,{className:"grow",value:e.score_threshold,onChange:(a,b)=>{h({...e,score_threshold:b})},enable:e.score_threshold_enabled,hasSwitch:!0,onSwitchChange:(a,b)=>{h({...e,score_threshold_enabled:b})}})]}),B&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"mb-4 flex gap-2",children:G.map(a=>(0,b.jsx)(n.default,{isChosen:e.reranking_mode===a.value,onChosen:()=>(a=>{if(a===e.reranking_mode)return;let b={...e,reranking_mode:a};b.weights||a!==u.RerankingModeEnum.WeightedScore||(b.weights={weight_type:u.WeightedScoreEnum.Customized,vector_setting:{vector_weight:u.DEFAULT_WEIGHTED_SCORE.other.semantic,embedding_provider_name:"",embedding_model_name:""},keyword_setting:{keyword_weight:u.DEFAULT_WEIGHTED_SCORE.other.keyword}}),a!==u.RerankingModeEnum.RerankingModel||D||p.default.notify({type:"error",message:y("errorMsg.rerankModelRequired",{ns:"workflow"})}),h(b)})(a.value),icon:(0,b.jsx)(i.default,{src:a.value===u.RerankingModeEnum.WeightedScore?w:x,alt:""}),title:a.label,description:a.tips,className:"flex-1"},a.value))}),e.reranking_mode===u.RerankingModeEnum.WeightedScore&&(0,b.jsx)(j.default,{value:{value:[e.weights.vector_setting.vector_weight,e.weights.keyword_setting.keyword_weight]},onChange:a=>{h({...e,weights:{...e.weights,vector_setting:{...e.weights.vector_setting,vector_weight:a.value[0]},keyword_setting:{...e.weights.keyword_setting,keyword_weight:a.value[1]}}})}}),e.reranking_mode!==u.RerankingModeEnum.WeightedScore&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(t.default,{defaultModel:F&&{provider:F.provider_name,model:F.model_name},modelList:C,onSelect:a=>{h({...e,reranking_model:{reranking_provider_name:a.provider,reranking_model_name:a.model}})}}),g&&(0,b.jsxs)("div",{className:"mt-2 flex h-10 items-center gap-x-0.5 overflow-hidden rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur p-2 shadow-xs backdrop-blur-[5px]",children:[(0,b.jsx)("div",{className:"absolute bottom-0 left-0 right-0 top-0 bg-dataset-warning-message-bg opacity-40"}),(0,b.jsx)("div",{className:"p-1",children:(0,b.jsx)(k.AlertTriangle,{className:"size-4 text-text-warning-secondary"})}),(0,b.jsx)("span",{className:"system-xs-medium text-text-primary",children:y("form.retrievalSetting.multiModalTip",{ns:"datasetSettings"})})]})]}),(0,b.jsxs)("div",{className:(0,v.cn)(!A&&"mt-4","space-between flex space-x-6"),children:[(0,b.jsx)(m.default,{className:"grow",value:e.top_k,onChange:(a,b)=>{h({...e,top_k:b})},enable:!0}),(0,b.jsx)(l.default,{className:"grow",value:e.score_threshold,onChange:(a,b)=>{h({...e,score_threshold:b})},enable:e.score_threshold_enabled,hasSwitch:!0,onSwitchChange:(a,b)=>{h({...e,score_threshold_enabled:b})}})]})]})]})}),z=c.memo(({disabled:a=!1,value:c,onChange:i})=>{let{t:j}=(0,d.useTranslation)();return(0,b.jsx)(h.default,{id:f.RETRIEVE_METHOD.keywordSearch,disabled:a,icon:(0,b.jsx)(e.VectorSearch,{className:"size-4"}),iconActiveColor:"text-util-colors-purple-purple-600",title:j("retrieval.keyword_search.title",{ns:"dataset"}),description:j("retrieval.keyword_search.description",{ns:"dataset"}),isActive:!0,effectColor:g.EffectColor.purple,showEffectColor:!0,showChildren:!0,className:"gap-x-2",children:(0,b.jsx)(y,{type:f.RETRIEVE_METHOD.keywordSearch,value:c,onChange:i})})});a.s(["default",0,z],916443);var A=a.i(732164);a.s(["FullTextSearch",()=>A.default],985226);var A=A,B=a.i(560551);a.s(["HybridSearch",()=>B.default],479873);var B=B,C=a.i(375616);let D=c.memo(({disabled:a=!1,value:i,showMultiModalTip:j=!1,onChange:k})=>{let{t:l}=(0,d.useTranslation)(),{supportRetrievalMethods:m}=(0,C.useProviderContext)(),{defaultModel:n,currentModel:o}=(0,s.useModelListAndDefaultModelAndCurrentProviderAndModel)(r.ModelTypeEnum.rerank),p=(0,c.useCallback)(a=>{[f.RETRIEVE_METHOD.semantic,f.RETRIEVE_METHOD.fullText].includes(a)&&k({...i,search_method:a,...!i.reranking_model.reranking_model_name||!i.reranking_model.reranking_provider_name?{reranking_model:{reranking_provider_name:o?n?.provider?.provider??"":"",reranking_model_name:o?n?.model??"":""},reranking_enable:!!o}:{reranking_enable:!0}}),a===f.RETRIEVE_METHOD.hybrid&&k({...i,search_method:a,...!i.reranking_model.reranking_model_name||!i.reranking_model.reranking_provider_name?{reranking_model:{reranking_provider_name:o?n?.provider?.provider??"":"",reranking_model_name:o?n?.model??"":""},reranking_enable:!!o,reranking_mode:o?u.RerankingModeEnum.RerankingModel:u.RerankingModeEnum.WeightedScore}:{reranking_enable:!0,reranking_mode:u.RerankingModeEnum.RerankingModel},...!i.weights?{weights:{weight_type:u.WeightedScoreEnum.Customized,vector_setting:{vector_weight:u.DEFAULT_WEIGHTED_SCORE.other.semantic,embedding_provider_name:"",embedding_model_name:""},keyword_setting:{keyword_weight:u.DEFAULT_WEIGHTED_SCORE.other.keyword}}}:{}})},[i,n,o,k]);return(0,b.jsxs)("div",{className:"flex flex-col gap-y-2",children:[m.includes(f.RETRIEVE_METHOD.semantic)&&(0,b.jsx)(h.default,{id:f.RETRIEVE_METHOD.semantic,disabled:a,icon:(0,b.jsx)(e.VectorSearch,{className:"size-4"}),iconActiveColor:"text-util-colors-purple-purple-600",title:l("retrieval.semantic_search.title",{ns:"dataset"}),description:l("retrieval.semantic_search.description",{ns:"dataset"}),isActive:i.search_method===f.RETRIEVE_METHOD.semantic,onClick:p,effectColor:g.EffectColor.purple,showEffectColor:!0,showChildren:i.search_method===f.RETRIEVE_METHOD.semantic,className:"gap-x-2",children:(0,b.jsx)(y,{type:f.RETRIEVE_METHOD.semantic,value:i,onChange:k,showMultiModalTip:j})}),m.includes(f.RETRIEVE_METHOD.fullText)&&(0,b.jsx)(h.default,{id:f.RETRIEVE_METHOD.fullText,disabled:a,icon:(0,b.jsx)(A.default,{className:"size-4"}),iconActiveColor:"text-util-colors-purple-purple-600",title:l("retrieval.full_text_search.title",{ns:"dataset"}),description:l("retrieval.full_text_search.description",{ns:"dataset"}),isActive:i.search_method===f.RETRIEVE_METHOD.fullText,onClick:p,effectColor:g.EffectColor.purple,showEffectColor:!0,showChildren:i.search_method===f.RETRIEVE_METHOD.fullText,className:"gap-x-2",children:(0,b.jsx)(y,{type:f.RETRIEVE_METHOD.fullText,value:i,onChange:k,showMultiModalTip:j})}),m.includes(f.RETRIEVE_METHOD.hybrid)&&(0,b.jsx)(h.default,{id:f.RETRIEVE_METHOD.hybrid,disabled:a,icon:(0,b.jsx)(B.default,{className:"size-4"}),iconActiveColor:"text-util-colors-purple-purple-600",title:l("retrieval.hybrid_search.title",{ns:"dataset"}),description:l("retrieval.hybrid_search.description",{ns:"dataset"}),isActive:i.search_method===f.RETRIEVE_METHOD.hybrid,onClick:p,effectColor:g.EffectColor.purple,showEffectColor:!0,isRecommended:!0,showChildren:i.search_method===f.RETRIEVE_METHOD.hybrid,className:"gap-x-2",children:(0,b.jsx)(y,{type:f.RETRIEVE_METHOD.hybrid,value:i,onChange:k,showMultiModalTip:j})})]})});a.s(["default",0,D],721298)},958887,a=>{"use strict";let b={src:a.i(843693).default,width:20,height:20,blurWidth:0,blurHeight:0},c={src:a.i(412660).default,width:20,height:20,blurWidth:0,blurHeight:0},d={src:a.i(854459).default,width:20,height:20,blurWidth:0,blurHeight:0},e={src:a.i(483763).default,width:16,height:18,blurWidth:0,blurHeight:0},f={src:a.i(246167).default,width:20,height:20,blurWidth:0,blurHeight:0};a.s(["indexMethodIcon",0,{high_quality:b,economical:d},"retrievalIcon",0,{vector:f,fullText:e,hybrid:c}],958887)},798418,a=>{"use strict";var b=a.i(986431),c=a.i(954200);a.s(["isReRankModelSelected",0,({retrievalConfig:a,rerankModelList:d,indexMethod:e})=>{let f=(()=>{if(a.reranking_model?.reranking_model_name){let b=d.find(({provider:b})=>b===a.reranking_model?.reranking_provider_name);return b?.models.find(({model:b})=>b===a.reranking_model?.reranking_model_name)}return!1})();return(!("high_quality"===e&&[c.RETRIEVE_METHOD.semantic,c.RETRIEVE_METHOD.fullText].includes(a.search_method))||!a.reranking_enable||!!f)&&("high_quality"!==e||a.search_method!==c.RETRIEVE_METHOD.hybrid||a.reranking_mode===b.RerankingModeEnum.WeightedScore||!!f)}])},516877,a=>{"use strict";a.s(["checkShowMultiModalTip",()=>d]);var b=a.i(933988);a.i(387799);var c=a.i(944054);let d=({embeddingModel:a,rerankingEnable:d,rerankModel:e,indexMethod:f,embeddingModelList:g,rerankModelList:h})=>{if(f!==c.IndexingType.QUALIFIED||!a.provider||!a.model)return!1;let i=g.find(b=>b.provider===a.provider);if(!i)return!1;let j=i.models.find(b=>b.model===a.model);if(!j||!j.features?.includes(b.ModelFeatureEnum.vision))return!1;let{rerankingModelName:k,rerankingProviderName:l}=e;if(!d||!k||!l)return!1;let m=h.find(a=>a.provider===l);if(!m)return!1;let n=m.models.find(a=>a.model===k);return!!n&&!n.features?.includes(b.ModelFeatureEnum.vision)}},18796,944054,992192,766646,353785,355919,922506,552633,a=>{"use strict";a.s(["IndexingModeSection",()=>S],18796);var b,c=a.i(608061),d=a.i(682541),e=a.i(413192);a.i(752298);var f=a.i(693025),g=a.i(218865),h=a.i(909795),i=a.i(16476),j=a.i(757801);a.i(955696);var k=a.i(2496),l=a.i(483664),m=a.i(916443),n=a.i(721298),o=a.i(403473),p=a.i(252813),q=a.i(986431),r=a.i(527344),s=a.i(958887);a.s([],922506),a.s(["useDocumentCreation",()=>P],766646);var t=a.i(57843);a.i(60796);var u=a.i(55282),v=a.i(114715),w=a.i(798418),x=a.i(723205),y=a.i(164024),z=a.i(847733);a.s(["IndexingType",()=>E,"useIndexingConfig",()=>G],944054);var A=a.i(516877),B=a.i(933988),C=a.i(701458),D=a.i(954200),E=((b={}).QUALIFIED="high_quality",b.ECONOMICAL="economy",b);let F={search_method:D.RETRIEVE_METHOD.semantic,reranking_enable:!1,reranking_model:{reranking_provider_name:"",reranking_model_name:""},top_k:3,score_threshold_enabled:!1,score_threshold:.5},G=a=>{let{initialIndexType:b,initialEmbeddingModel:c,initialRetrievalConfig:d,isAPIKeySet:e,hasSetIndexType:f}=a,{modelList:g,defaultModel:h,currentModel:i}=(0,C.useModelListAndDefaultModelAndCurrentProviderAndModel)(B.ModelTypeEnum.rerank),{data:j}=(0,C.useModelList)(B.ModelTypeEnum.textEmbedding),{data:k}=(0,C.useDefaultModel)(B.ModelTypeEnum.textEmbedding),[l,m]=(0,t.useState)(()=>b||(e?"high_quality":"economy")),[n,o]=(0,t.useState)(c??{provider:k?.provider.provider||"",model:k?.model||""}),[p,q]=(0,t.useState)(d??F);(0,t.useEffect)(()=>{d||q({search_method:D.RETRIEVE_METHOD.semantic,reranking_enable:!!i,reranking_model:{reranking_provider_name:i?h?.provider.provider??"":"",reranking_model_name:i?h?.model??"":""},top_k:3,score_threshold_enabled:!1,score_threshold:.5})},[h,i,d]),(0,t.useEffect)(()=>{b?m(b):m(e?"high_quality":"economy")},[e,b]);let r=(0,t.useMemo)(()=>(0,A.checkShowMultiModalTip)({embeddingModel:n,rerankingEnable:p.reranking_enable,rerankModel:{rerankingProviderName:p.reranking_model.reranking_provider_name,rerankingModelName:p.reranking_model.reranking_model_name},indexMethod:l,embeddingModelList:j,rerankModelList:g}),[n,p,l,j,g]);return{indexType:l,setIndexType:m,hasSetIndexType:f,getIndexingTechnique:()=>b||l,embeddingModel:n,setEmbeddingModel:o,embeddingModelList:j,defaultEmbeddingModel:k,retrievalConfig:p,setRetrievalConfig:q,rerankModelList:g,rerankDefaultModel:h,isRerankDefaultModelValid:i,showMultiModalTip:r}},H=function(a){return a&&"string"==typeof a?a.replaceAll("\0","\\0").replaceAll("\b","\\b").replaceAll("\f","\\f").replaceAll("\n","\\n").replaceAll("\r","\\r").replaceAll("	","\\t").replaceAll("\v","\\v").replaceAll("'","\\'"):""},I=/\\(u\{([0-9A-Fa-f]+)\}|u([0-9A-Fa-f]{4})|x([0-9A-Fa-f]{2})|([1-7][0-7]{0,2}|[0-7]{2,3})|(['"tbrnfv0\\]))|\\U([0-9A-Fa-f]{8})/g,J={0:"\0",b:"\b",f:"\f",n:"\n",r:"\r",t:"	",v:"\v","'":"'",'"':'"',"\\":"\\"},K=a=>String.fromCodePoint(Number.parseInt(a,16)),L=a=>a.replace(I,(a,b,c,d,e,f,g,h)=>{if(void 0!==c)return K(c);if(void 0!==d)return K(d);if(void 0!==e)return K(e);if(void 0!==f)return String.fromCodePoint(Number.parseInt(f,8));if(void 0!==h)return K(h);else return J[g]}),M="\\n\\n",N=Number.parseInt(globalThis.document?.body?.getAttribute("data-public-indexing-max-segmentation-tokens-length")||"4000",10),O={chunkForContext:"paragraph",parent:{delimiter:"\\n\\n",maxLength:1024},child:{delimiter:"\\n",maxLength:512}};a.s(["MAXIMUM_CHUNK_TOKEN_LENGTH",0,N,"useSegmentationState",0,(a={})=>{let{initialSegmentationType:b,initialSummaryIndexSetting:c}=a,[d,e]=(0,t.useState)(b??q.ProcessMode.general),[f,g]=(0,t.useState)(M),[h,i]=(0,t.useState)(1024),[j,k]=(0,t.useState)(N),[l,m]=(0,t.useState)(50),[n,o]=(0,t.useState)([]),[p,r]=(0,t.useState)(),[s,u]=(0,t.useState)(c),v=(0,t.useRef)(c),w=(0,t.useCallback)(a=>{u(b=>{let c={...b,...a};return v.current=c,c})},[]),[x,y]=(0,t.useState)(O),z=(0,t.useCallback)((a,b)=>{a?g(H(a)):g(b?"":M)},[]),A=(0,t.useCallback)(a=>{o(b=>b.map(b=>b.id===a?{...b,enabled:!b.enabled}:b))},[]),B=(0,t.useCallback)(()=>{p&&(z(p.segmentation.separator),i(p.segmentation.max_tokens),m(p.segmentation.chunk_overlap),o(p.pre_processing_rules)),y(O)},[p,z]),C=(0,t.useCallback)((a,b)=>{let c=a.segmentation.separator,d=a.segmentation.max_tokens,e=a.segmentation.chunk_overlap;z(c),i(d),m(e),o(a.pre_processing_rules),r(a),b&&y({chunkForContext:a.parent_mode||"paragraph",parent:{delimiter:H(a.segmentation.separator),maxLength:a.segmentation.max_tokens},child:{delimiter:H(a.subchunk_segmentation.separator),maxLength:a.subchunk_segmentation.max_tokens}})},[z]),D=(0,t.useCallback)(a=>a===q.ChunkingMode.parentChild?{rules:{pre_processing_rules:n,segmentation:{separator:L(x.parent.delimiter),max_tokens:x.parent.maxLength},parent_mode:x.chunkForContext,subchunk_segmentation:{separator:L(x.child.delimiter),max_tokens:x.child.maxLength}},mode:"hierarchical",summary_index_setting:v.current}:{rules:{pre_processing_rules:n,segmentation:{separator:L(f),max_tokens:h,chunk_overlap:l}},mode:d,summary_index_setting:v.current},[n,x,f,h,l,d]),E=(0,t.useCallback)((a,b)=>{y(c=>{let d;return d="delimiter"===a?b?H(b):"":b,{...c,parent:{...c.parent,[a]:d}}})},[]),F=(0,t.useCallback)((a,b)=>{y(c=>{let d;return d="delimiter"===a?b?H(b):"":b,{...c,child:{...c.child,[a]:d}}})},[]),G=(0,t.useCallback)(a=>{y(b=>({...b,chunkForContext:a}))},[]);return{segmentationType:d,setSegmentationType:e,segmentIdentifier:f,setSegmentIdentifier:z,maxChunkLength:h,setMaxChunkLength:i,limitMaxChunkLength:j,setLimitMaxChunkLength:k,overlap:l,setOverlap:m,rules:n,setRules:o,defaultConfig:p,setDefaultConfig:r,toggleRule:A,summaryIndexSetting:s,handleSummaryIndexSettingChange:w,parentChildConfig:x,setParentChildConfig:y,updateParentConfig:E,updateChildConfig:F,setChunkForContext:G,resetToDefaults:B,applyConfigFromRules:C,getProcessRule:D}}],992192);let P=a=>{let{t:b}=(0,f.useTranslation)(),{datasetId:c,isSetting:d,documentDetail:e,dataSourceType:g,files:h,notionPages:i,notionCredentialId:j,websitePages:k,crawlOptions:l,websiteCrawlProvider:m=x.DataSourceProvider.jinaReader,websiteCrawlJobId:n="",onStepChange:o,updateIndexingTypeCache:p,updateResultCache:r,updateRetrievalMethodCache:s,onSave:A,mutateDatasetRes:B}=a,C=(0,y.useCreateFirstDocument)(),D=(0,y.useCreateDocument)(c),F=(0,z.useInvalidDatasetList)(),G=C.isPending||D.isPending,H=(0,t.useCallback)(a=>{let{segmentationType:c,maxChunkLength:e,limitMaxChunkLength:f,overlap:g,indexType:h,embeddingModel:i,rerankModelList:j,retrievalConfig:k}=a;if("general"===c&&g>e)return v.default.notify({type:"error",message:b("stepTwo.overlapCheck",{ns:"datasetCreation"})}),!1;if("general"===c&&e>f)return v.default.notify({type:"error",message:b("stepTwo.maxLengthCheck",{ns:"datasetCreation",limit:f})}),!1;if(!d){if(h===E.QUALIFIED&&(!i.model||!i.provider))return v.default.notify({type:"error",message:b("datasetConfig.embeddingModelRequired",{ns:"appDebug"})}),!1;if(!(0,w.isReRankModelSelected)({rerankModelList:j,retrievalConfig:k,indexMethod:h}))return v.default.notify({type:"error",message:b("datasetConfig.rerankModelRequired",{ns:"appDebug"})}),!1}return!0},[b,d]),I=(0,t.useCallback)((a,b,c,f,o,p,r)=>{if(d)return{original_document_id:e?.id,doc_form:a,doc_language:b,process_rule:c,summary_index_setting:r,retrieval_model:f,embedding_model:o.model,embedding_model_provider:o.provider,indexing_technique:p};let s={data_source:{type:g,info_list:{data_source_type:g}},indexing_technique:p,process_rule:c,summary_index_setting:r,doc_form:a,doc_language:b,retrieval_model:f,embedding_model:o.model,embedding_model_provider:o.provider};return g===q.DataSourceType.FILE&&(s.data_source.info_list.file_info_list={file_ids:h.map(a=>a.id||"").filter(Boolean)}),g===q.DataSourceType.NOTION&&(s.data_source.info_list.notion_info_list=(0,y.getNotionInfo)(i,j)),g===q.DataSourceType.WEB&&(s.data_source.info_list.website_info_list=(0,y.getWebsiteInfo)({websiteCrawlProvider:m,websiteCrawlJobId:n,websitePages:k,crawlOptions:l})),s},[d,e,g,h,i,j,k,m,n,l]);return{isCreating:G,validateParams:H,buildCreationParams:I,executeCreation:(0,t.useCallback)(async(a,b,e)=>{c?await D.mutateAsync(a,{onSuccess(a){p?.(b),r?.(a),s?.(e.search_method)}}):await C.mutateAsync(a,{onSuccess(a){p?.(b),r?.(a),s?.(e.search_method)}}),B?.(),F(),(0,u.trackEvent)("create_datasets",{data_source_type:g,indexing_technique:b}),o?.(1),d&&A?.()},[c,C,D,p,r,s,B,F,g,o,d,A]),validatePreviewParams:(0,t.useCallback)(a=>!(a>N)||(v.default.notify({type:"error",message:b("stepTwo.maxLengthCheck",{ns:"datasetCreation",limit:N})}),!1),[b])}};a.s(["useIndexingEstimate",0,a=>{let{dataSourceType:b,datasetId:c,currentDocForm:d,docLanguage:e,files:f,previewFileName:g,previewNotionPage:h,notionCredentialId:i,previewWebsitePage:j,crawlOptions:k,websiteCrawlProvider:l,websiteCrawlJobId:m,indexingTechnique:n,processRule:o}=a,p=(0,y.useFetchFileIndexingEstimateForFile)({docForm:d,docLanguage:e,dataSourceType:q.DataSourceType.FILE,files:g?[f.find(a=>a.name===g)]:f,indexingTechnique:n,processRule:o,dataset_id:c}),r=(0,y.useFetchFileIndexingEstimateForNotion)({docForm:d,docLanguage:e,dataSourceType:q.DataSourceType.NOTION,notionPages:[h],indexingTechnique:n,processRule:o,dataset_id:c||"",credential_id:i}),s=(0,y.useFetchFileIndexingEstimateForWeb)({docForm:d,docLanguage:e,dataSourceType:q.DataSourceType.WEB,websitePages:[j],crawlOptions:k,websiteCrawlProvider:l??x.DataSourceProvider.jinaReader,websiteCrawlJobId:m??"",indexingTechnique:n,processRule:o,dataset_id:c||""}),u=(0,t.useCallback)(()=>b===q.DataSourceType.FILE?p:b===q.DataSourceType.NOTION?r:s,[b,p,r,s])(),v=(0,t.useCallback)(()=>{b===q.DataSourceType.FILE?p.mutate():b===q.DataSourceType.NOTION?r.mutate():s.mutate()},[b,p,r,s]);return{currentMutation:u,estimate:u.data,isIdle:u.isIdle,isPending:u.isPending,fetchEstimate:v,reset:u.reset}}],353785),a.s(["usePreviewState",0,a=>{let{dataSourceType:b,files:c,notionPages:d,websitePages:e,documentDetail:f,datasetId:g}=a,[h,i]=(0,t.useState)(g&&f?f.file:c[0]),[j,k]=(0,t.useState)(g&&f?f.notion_page:d[0]),[l,m]=(0,t.useState)(g&&f?f.website_page:e[0]),n=(0,t.useCallback)(()=>b===q.DataSourceType.FILE?c:b===q.DataSourceType.NOTION?d.map(a=>({id:a.page_id,name:a.page_name,extension:"md"})):b===q.DataSourceType.WEB?e.map(a=>({id:a.source_url,name:a.title,extension:"md"})):[],[b,c,d,e]),o=(0,t.useCallback)(()=>b===q.DataSourceType.FILE?h:b===q.DataSourceType.NOTION?{id:j?.page_id||"",name:j?.page_name||"",extension:"md"}:b===q.DataSourceType.WEB?{id:l?.source_url||"",name:l?.title||"",extension:"md"}:{id:"",name:"",extension:""},[b,h,j,l]),p=(0,t.useCallback)(a=>{if(b===q.DataSourceType.FILE)i(a);else if(b===q.DataSourceType.NOTION){let b=d.find(b=>b.page_id===a.id);b&&k(b)}else if(b===q.DataSourceType.WEB){let b=e.find(b=>b.source_url===a.id);b&&m(b)}},[b,d,e]);return{previewFile:h,setPreviewFile:i,previewNotionPage:j,setPreviewNotionPage:k,previewWebsitePage:l,setPreviewWebsitePage:m,getPreviewPickerItems:n,getPreviewPickerValue:o,handlePreviewChange:p}}],355919);var Q=a.i(870799),R=a.i(358030);let S=({indexType:a,hasSetIndexType:b,docForm:t,embeddingModel:u,embeddingModelList:v,retrievalConfig:w,showMultiModalTip:x,isModelAndRetrievalConfigDisabled:y,datasetId:z,isQAConfirmDialogOpen:A,onIndexTypeChange:B,onEmbeddingModelChange:C,onRetrievalConfigChange:D,onQAConfirmDialogClose:F,onQAConfirmDialogConfirm:G})=>{let{t:H}=(0,f.useTranslation)(),I=(0,p.useDocLink)();return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"system-md-semibold mb-1 text-text-secondary",children:H("stepTwo.indexMode",{ns:"datasetCreation"})}),(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(!b||b&&a===E.QUALIFIED)&&(0,c.jsx)(R.OptionCard,{className:"flex-1 self-stretch",title:(0,c.jsxs)("div",{className:"flex items-center",children:[H("stepTwo.qualified",{ns:"datasetCreation"}),(0,c.jsx)(g.default,{className:(0,r.cn)("ml-1 h-[18px]",b||a!==E.QUALIFIED?"":"border-text-accent-secondary text-text-accent-secondary"),uppercase:!0,children:H("stepTwo.recommend",{ns:"datasetCreation"})}),(0,c.jsx)("span",{className:"ml-auto",children:!b&&(0,c.jsx)("span",{className:(0,r.cn)(Q.default.radio)})})]}),description:H("stepTwo.qualifiedTip",{ns:"datasetCreation"}),icon:(0,c.jsx)(d.default,{src:s.indexMethodIcon.high_quality,alt:""}),isActive:!b&&a===E.QUALIFIED,disabled:b,onSwitched:()=>B(E.QUALIFIED)}),(!b||b&&a===E.ECONOMICAL)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(i.default,{show:A,onClose:F,className:"w-[432px]",children:[(0,c.jsxs)("header",{className:"mb-4 pt-6",children:[(0,c.jsx)("h2",{className:"text-lg font-semibold text-text-primary",children:H("stepTwo.qaSwitchHighQualityTipTitle",{ns:"datasetCreation"})}),(0,c.jsx)("p",{className:"mt-2 text-sm font-normal text-text-secondary",children:H("stepTwo.qaSwitchHighQualityTipContent",{ns:"datasetCreation"})})]}),(0,c.jsxs)("div",{className:"flex gap-2 pb-6",children:[(0,c.jsx)(h.default,{className:"ml-auto",onClick:F,children:H("stepTwo.cancel",{ns:"datasetCreation"})}),(0,c.jsx)(h.default,{variant:"primary",onClick:G,children:H("stepTwo.switch",{ns:"datasetCreation"})})]})]}),(0,c.jsx)(l.default,{popupContent:(0,c.jsx)("div",{className:"rounded-lg border-components-panel-border bg-components-tooltip-bg p-3 text-xs font-medium text-text-secondary shadow-lg",children:H(t===q.ChunkingMode.qa?"stepTwo.notAvailableForQA":"stepTwo.notAvailableForParentChild",{ns:"datasetCreation"})}),noDecoration:!0,position:"top",asChild:!1,triggerClassName:"flex-1 self-stretch",children:(0,c.jsx)(R.OptionCard,{className:"h-full",title:H("stepTwo.economical",{ns:"datasetCreation"}),description:H("stepTwo.economicalTip",{ns:"datasetCreation"}),icon:(0,c.jsx)(d.default,{src:s.indexMethodIcon.economical,alt:""}),isActive:!b&&a===E.ECONOMICAL,disabled:b||t!==q.ChunkingMode.text,onSwitched:()=>B(E.ECONOMICAL)})})]})]}),!b&&a===E.QUALIFIED&&(0,c.jsxs)("div",{className:"mt-2 flex h-10 items-center gap-x-0.5 overflow-hidden rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur p-2 shadow-xs backdrop-blur-[5px]",children:[(0,c.jsx)("div",{className:"absolute bottom-0 left-0 right-0 top-0 bg-dataset-warning-message-bg opacity-40"}),(0,c.jsx)("div",{className:"p-1",children:(0,c.jsx)(k.AlertTriangle,{className:"size-4 text-text-warning-secondary"})}),(0,c.jsx)("span",{className:"system-xs-medium text-text-primary",children:H("stepTwo.highQualityTip",{ns:"datasetCreation"})})]}),b&&a===E.ECONOMICAL&&(0,c.jsxs)("div",{className:"system-xs-medium mt-2 text-text-tertiary",children:[H("stepTwo.indexSettingTip",{ns:"datasetCreation"}),(0,c.jsx)(e.default,{className:"text-text-accent",href:`/datasets/${z}/settings`,children:H("stepTwo.datasetSettingLink",{ns:"datasetCreation"})})]}),a===E.QUALIFIED&&(0,c.jsxs)("div",{className:"mt-5",children:[(0,c.jsx)("div",{className:(0,r.cn)("system-md-semibold mb-1 text-text-secondary",z&&"flex items-center justify-between"),children:H("form.embeddingModel",{ns:"datasetSettings"})}),(0,c.jsx)(o.default,{readonly:y,triggerClassName:y?"opacity-50":"",defaultModel:u,modelList:v??[],onSelect:C}),y&&(0,c.jsxs)("div",{className:"system-xs-medium mt-2 text-text-tertiary",children:[H("stepTwo.indexSettingTip",{ns:"datasetCreation"}),(0,c.jsx)(e.default,{className:"text-text-accent",href:`/datasets/${z}/settings`,children:H("stepTwo.datasetSettingLink",{ns:"datasetCreation"})})]})]}),(0,c.jsx)(j.default,{className:"my-5"}),(0,c.jsxs)("div",{children:[y?(0,c.jsx)("div",{className:(0,r.cn)("system-md-semibold mb-0.5 text-text-secondary","flex items-center justify-between"),children:(0,c.jsx)("div",{children:H("form.retrievalSetting.title",{ns:"datasetSettings"})})}):(0,c.jsxs)("div",{className:"mb-1",children:[(0,c.jsx)("div",{className:"system-md-semibold mb-0.5 text-text-secondary",children:H("form.retrievalSetting.title",{ns:"datasetSettings"})}),(0,c.jsxs)("div",{className:"body-xs-regular text-text-tertiary",children:[(0,c.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:I("/use-dify/knowledge/create-knowledge/setting-indexing-methods"),className:"text-text-accent",children:H("form.retrievalSetting.learnMore",{ns:"datasetSettings"})}),H("form.retrievalSetting.longDescription",{ns:"datasetSettings"})]})]}),(0,c.jsx)("div",{children:a===E.QUALIFIED?(0,c.jsx)(n.default,{disabled:y,value:w,onChange:D,showMultiModalTip:x}):(0,c.jsx)(m.default,{disabled:y,value:w,onChange:D})})]})]})};var T=a.i(429150),U=a.i(168799);a.i(224256);var V=a.i(12588),W=a.i(687844),X=a.i(322715);let Y={src:a.i(729301).default,width:20,height:20,blurWidth:0,blurHeight:0},Z={src:a.i(755693).default,width:20,height:20,blurWidth:0,blurHeight:0},$={src:a.i(256168).default,width:220,height:220,blurWidth:0,blurHeight:0};var _=a.i(311706);let aa=({children:a})=>(0,c.jsx)("label",{className:"system-sm-semibold text-text-secondary",children:a});a.s(["ParentChildOptions",0,({parentChildConfig:a,rules:b,summaryIndexSetting:e,currentDocForm:g,isActive:i,isInUpload:k,isNotUploadInEmptyDataset:l,onDocFormChange:m,onChunkForContextChange:n,onParentDelimiterChange:o,onParentMaxLengthChange:p,onChildDelimiterChange:r,onChildMaxLengthChange:s,onRuleToggle:t,onSummaryIndexSettingChange:u,onPreview:v,onReset:w,showSummaryIndexSetting:x})=>{let{t:y}=(0,f.useTranslation)();return(0,c.jsx)(R.OptionCard,{title:y("stepTwo.parentChild",{ns:"datasetCreation"}),icon:(0,c.jsx)(V.ParentChildChunk,{className:"h-[20px] w-[20px]"}),effectImg:$.src,className:"text-util-colors-blue-light-blue-light-500",activeHeaderClassName:"bg-dataset-option-card-blue-gradient",description:y("stepTwo.parentChildTip",{ns:"datasetCreation"}),isActive:i,onSwitched:()=>m(q.ChunkingMode.parentChild),actions:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(h.default,{variant:"secondary-accent",onClick:v,children:[(0,c.jsx)(T.RiSearchEyeLine,{className:"mr-0.5 h-4 w-4"}),y("stepTwo.previewChunk",{ns:"datasetCreation"})]}),(0,c.jsx)(h.default,{variant:"ghost",onClick:w,children:y("stepTwo.reset",{ns:"datasetCreation"})})]}),noHighlight:k&&l,children:(0,c.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,c.jsx)("div",{className:"inline-flex shrink-0",children:(0,c.jsx)(aa,{children:y("stepTwo.parentChunkForContext",{ns:"datasetCreation"})})}),(0,c.jsx)(j.default,{className:"grow",bgStyle:"gradient"})]}),(0,c.jsx)(W.default,{className:"mt-1",icon:(0,c.jsx)(d.default,{src:Z,alt:""}),title:y("stepTwo.paragraph",{ns:"datasetCreation"}),description:y("stepTwo.paragraphTip",{ns:"datasetCreation"}),isChosen:"paragraph"===a.chunkForContext,onChosen:()=>n("paragraph"),chosenConfig:(0,c.jsxs)("div",{className:"flex gap-3",children:[(0,c.jsx)(_.DelimiterInput,{value:a.parent.delimiter,tooltip:y("stepTwo.parentChildDelimiterTip",{ns:"datasetCreation"}),onChange:a=>o(a.target.value)}),(0,c.jsx)(_.MaxLengthInput,{unit:"characters",value:a.parent.maxLength,onChange:p})]})}),(0,c.jsx)(W.default,{className:"mt-2",icon:(0,c.jsx)(d.default,{src:Y,alt:""}),title:y("stepTwo.fullDoc",{ns:"datasetCreation"}),description:y("stepTwo.fullDocTip",{ns:"datasetCreation"}),onChosen:()=>n("full-doc"),isChosen:"full-doc"===a.chunkForContext})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,c.jsx)("div",{className:"inline-flex shrink-0",children:(0,c.jsx)(aa,{children:y("stepTwo.childChunkForRetrieval",{ns:"datasetCreation"})})}),(0,c.jsx)(j.default,{className:"grow",bgStyle:"gradient"})]}),(0,c.jsxs)("div",{className:"mt-1 flex gap-3",children:[(0,c.jsx)(_.DelimiterInput,{value:a.child.delimiter,tooltip:y("stepTwo.parentChildChunkDelimiterTip",{ns:"datasetCreation"}),onChange:a=>r(a.target.value)}),(0,c.jsx)(_.MaxLengthInput,{unit:"characters",value:a.child.maxLength,onChange:s})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,c.jsx)("div",{className:"inline-flex shrink-0",children:(0,c.jsx)(aa,{children:y("stepTwo.rules",{ns:"datasetCreation"})})}),(0,c.jsx)(j.default,{className:"grow",bgStyle:"gradient"})]}),(0,c.jsxs)("div",{className:"mt-1",children:[b.map(a=>{var b;return(0,c.jsxs)("div",{className:Q.default.ruleItem,onClick:()=>t(a.id),children:[(0,c.jsx)(U.default,{checked:a.enabled}),(0,c.jsx)("label",{className:"system-sm-regular ml-2 cursor-pointer text-text-secondary",children:(b=a.id,({remove_extra_spaces:y("stepTwo.removeExtraSpaces",{ns:"datasetCreation"}),remove_urls_emails:y("stepTwo.removeUrlEmails",{ns:"datasetCreation"}),remove_stopwords:y("stepTwo.removeStopwords",{ns:"datasetCreation"})})[b]??b)})]},a.id)}),x&&(0,c.jsx)("div",{className:"mt-3",children:(0,c.jsx)(X.default,{entry:"create-document",summaryIndexSetting:e,onSummaryIndexSettingChange:u})})]})]})]})})}],552633)},914513,519292,485907,716369,472253,538328,97847,a=>{"use strict";var b=a.i(608061),c=a.i(796807);a.i(868084);var d=a.i(942174);let e=({ref:a,...e})=>(0,b.jsx)(c.default,{...e,ref:a,data:d.default});e.displayName="OptionCardEffectBlue",a.s(["default",0,e],519292);var f=a.i(710799);let g=({ref:a,...d})=>(0,b.jsx)(c.default,{...d,ref:a,data:f.default});g.displayName="OptionCardEffectBlueLight",a.s(["default",0,g],485907);var h=a.i(649280);let i=({ref:a,...d})=>(0,b.jsx)(c.default,{...d,ref:a,data:h.default});i.displayName="OptionCardEffectOrange",a.s(["default",0,i],716369);var j=a.i(101411);let k=({ref:a,...d})=>(0,b.jsx)(c.default,{...d,ref:a,data:j.default});k.displayName="OptionCardEffectPurple",a.s(["default",0,k],472253);var l=a.i(963786);let m=({ref:a,...d})=>(0,b.jsx)(c.default,{...d,ref:a,data:l.default});m.displayName="OptionCardEffectTeal",a.s(["default",0,m],538328);var n=a.i(857305);let o=({ref:a,...d})=>(0,b.jsx)(c.default,{...d,ref:a,data:n.default});o.displayName="SelectionMod",a.i(365036),a.s([],97847);let p=a=>{let{label:c,characterCount:d}=a;return(0,b.jsxs)("div",{className:"flex items-center text-xs font-medium text-text-tertiary",children:[(0,b.jsx)(o,{className:"size-[10px]"}),(0,b.jsxs)("p",{className:"ml-0.5 flex gap-2",children:[(0,b.jsx)("span",{children:c}),(0,b.jsx)("span",{children:"Â·"}),(0,b.jsx)("span",{children:`${d} characters`})]})]})};a.s(["ChunkContainer",0,a=>{let{label:c,characterCount:d,children:e}=a;return(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(p,{label:c,characterCount:d}),(0,b.jsx)("div",{className:"body-md-regular text-text-secondary",children:e})]})},"QAPreview",0,a=>{let{qa:c}=a;return(0,b.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,b.jsxs)("div",{className:"flex gap-x-1",children:[(0,b.jsx)("label",{className:"shrink-0 text-[13px] font-medium leading-[20px] text-text-tertiary",children:"Q"}),(0,b.jsx)("p",{className:"body-md-regular text-text-secondary",children:c.question})]}),(0,b.jsxs)("div",{className:"flex gap-x-1",children:[(0,b.jsx)("label",{className:"shrink-0 text-[13px] font-medium leading-[20px] text-text-tertiary",children:"A"}),(0,b.jsx)("p",{className:"body-md-regular text-text-secondary",children:c.answer})]})]})}],914513)},42521,a=>{"use strict";var b=a.i(608061),c=a.i(57843),d=a.i(441885),e=a.i(780442);let f={pdf:d.FileAppearanceTypeEnum.pdf,json:d.FileAppearanceTypeEnum.document,html:d.FileAppearanceTypeEnum.document,txt:d.FileAppearanceTypeEnum.document,markdown:d.FileAppearanceTypeEnum.markdown,md:d.FileAppearanceTypeEnum.markdown,xlsx:d.FileAppearanceTypeEnum.excel,xls:d.FileAppearanceTypeEnum.excel,csv:d.FileAppearanceTypeEnum.excel,doc:d.FileAppearanceTypeEnum.word,docx:d.FileAppearanceTypeEnum.word},g=c.memo(({extension:a,name:c,size:g="md",className:h})=>{let i=a?.toLowerCase()||c?.split(".")?.pop()?.toLowerCase();return(0,b.jsx)(e.default,{type:f[i]||d.FileAppearanceTypeEnum.document,size:g,className:h})});a.s(["default",0,g])},50051,429625,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(497746),e=a.i(57843);a.i(752298);var f=a.i(693025),g=a.i(105249),h=a.i(825319),i=a.i(527344),j=a.i(42521);let k=e.memo(({className:a,list:c,onChange:d})=>{let f=(0,e.useCallback)(a=>()=>d(a),[d]);return(0,b.jsx)("div",{className:(0,i.cn)("max-h-[calc(100vh-120px)] overflow-auto",a),children:c.map(a=>{let{id:c,name:d,extension:e}=a;return(0,b.jsxs)("div",{className:"flex h-8 cursor-pointer items-center space-x-2 rounded-lg px-2 hover:bg-state-base-hover",onClick:f(a),children:[(0,b.jsx)(j.default,{name:a.name,extension:e,size:"lg"}),(0,b.jsx)("div",{className:"truncate text-sm text-text-secondary",children:d})]},c)})})});a.s(["default",0,k],429625);let l=e.memo(({className:a,value:l,files:m,onChange:n})=>{let{t:o}=(0,f.useTranslation)(),p=l?.name||"",q=l?.extension,[r,{set:s,toggle:t}]=(0,d.useBoolean)(!1),u=c.RiArrowDownSLine,v=(0,e.useCallback)(a=>{n(a),s(!1)},[n,s]);return(0,b.jsxs)(h.PortalToFollowElem,{open:r,onOpenChange:s,placement:"bottom-start",offset:4,children:[(0,b.jsx)(h.PortalToFollowElemTrigger,{onClick:t,children:(0,b.jsxs)("div",{className:(0,i.cn)("flex h-6 select-none items-center rounded-md px-1 hover:bg-state-base-hover",r&&"bg-state-base-hover",a),children:[(0,b.jsx)(j.default,{name:p,extension:q,size:"lg"}),(0,b.jsx)("div",{className:"ml-1 flex flex-col items-start",children:(0,b.jsxs)("div",{className:"flex items-center space-x-0.5",children:[(0,b.jsxs)("span",{className:(0,i.cn)("system-md-semibold max-w-[200px] truncate text-text-primary"),children:[" ",p||"--"]}),(0,b.jsx)(u,{className:"h-[18px] w-[18px] text-text-primary"})]})})]})}),(0,b.jsx)(h.PortalToFollowElemContent,{className:"z-[11]",children:(0,b.jsxs)("div",{className:"w-[392px] rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur p-1 shadow-lg backdrop-blur-[5px]",children:[m?.length>1&&(0,b.jsx)("div",{className:"system-xs-medium-uppercase flex h-8 items-center pl-2 text-text-tertiary",children:o("preprocessDocument",{ns:"dataset",num:m.length})}),m?.length>0?(0,b.jsx)(k,{list:m,onChange:v}):(0,b.jsx)("div",{className:"mt-2 flex h-[100px] w-[360px] items-center justify-center",children:(0,b.jsx)(g.default,{})})]})})]})});a.s(["default",0,l],50051)},368206,502594,a=>{"use strict";var b=a.i(608061),c=a.i(57843);a.i(752298);var d=a.i(693025),e=a.i(527344);let f=(0,c.memo)(({summary:a,className:c})=>{let{t:f}=(0,d.useTranslation)();return(0,b.jsxs)("div",{className:(0,e.cn)("space-y-1",c),children:[(0,b.jsxs)("div",{className:"system-xs-medium-uppercase mt-2 flex items-center justify-between text-text-tertiary",children:[f("segment.summary",{ns:"datasetDocuments"}),(0,b.jsx)("div",{className:"ml-2 h-px grow bg-divider-regular"})]}),(0,b.jsx)("div",{className:"body-xs-regular text-text-tertiary",children:a})]})});a.s(["default",0,f],368206);let g="py-[3px]",h=({ref:a,...c})=>{let{className:d,...f}=c;return(0,b.jsx)("span",{...f,ref:a,className:(0,e.cn)("group mr-1 select-none align-bottom text-sm",d)})};h.displayName="SliceContainer";let i=({ref:a,...c})=>{let{className:d,children:f,labelInnerClassName:h,...i}=c;return(0,b.jsx)("span",{...i,ref:a,className:(0,e.cn)(g,"bg-state-base-hover-alt px-1 uppercase text-text-tertiary group-hover:bg-state-accent-solid group-hover:text-text-primary-on-surface",d),children:(0,b.jsx)("span",{className:(0,e.cn)("text-nowrap",h),children:f})})};i.displayName="SliceLabel";let j=({ref:a,...c})=>{let{className:d,children:f,...h}=c;return(0,b.jsx)("span",{...h,ref:a,className:(0,e.cn)(g,"whitespace-pre-line break-all bg-state-base-hover px-1 leading-7 group-hover:bg-state-accent-hover-alt group-hover:text-text-primary",d),children:f})};j.displayName="SliceContent";let k=({ref:a,...c})=>{let{className:d,...f}=c;return(0,b.jsx)("span",{...f,ref:a,className:(0,e.cn)(g,"bg-state-base-active px-[1px] text-sm group-hover:bg-state-accent-solid",d),children:"â€‹"})};k.displayName="SliceDivider",a.s(["SliceContainer",0,h,"SliceContent",0,j,"SliceDivider",0,k,"SliceLabel",0,i],502594)},387799,330492,460183,209796,288117,a=>{"use strict";a.s(["default",()=>Q],387799);var b=a.i(608061),c=a.i(57843);a.i(752298);var d=a.i(693025),e=a.i(757801),f=a.i(114715),g=a.i(698636),h=a.i(252813),i=a.i(585124),j=a.i(136403),k=a.i(723205),l=a.i(986431),m=a.i(164024),n=a.i(527344),o=a.i(158139),p=a.i(18796),q=a.i(552633),r=a.i(429150),s=a.i(111089),t=a.i(218865),u=a.i(136156),v=a.i(192875),w=a.i(18039),x=a.i(914513),y=a.i(50051),z=a.i(368206),A=a.i(249730),B=a.i(909698),C=a.i(591143),D=a.i(502594);let E=a=>{let{label:d,className:e,text:f,tooltip:g,labelInnerClassName:h,dividerClassName:i,...j}=a,[k,l]=(0,c.useState)(!1),{refs:m,floatingStyles:n,context:o}=(0,C.useFloating)({open:k,onOpenChange:l,whileElementsMounted:A.autoUpdate,placement:"top",middleware:[(0,B.inline)(),(0,B.flip)(),(0,B.shift)()]}),p=(0,C.useHover)(o,{delay:{open:500},move:!0}),q=(0,C.useDismiss)(o),r=(0,C.useRole)(o,{role:"tooltip"}),{getReferenceProps:s,getFloatingProps:t}=(0,C.useInteractions)([p,q,r]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(D.SliceContainer,{...j,className:e,ref:m.setReference,...s(),children:[(0,b.jsx)(D.SliceLabel,{labelInnerClassName:h,children:d}),(0,b.jsx)(D.SliceContent,{children:f}),(0,b.jsx)(D.SliceDivider,{className:i})]}),k&&(0,b.jsx)("span",{ref:m.setFloating,style:n,...t(),className:"rounded-md border-[0.5px] border-components-panel-border bg-components-tooltip-bg p-2 text-xs leading-4 text-text-secondary shadow shadow-shadow-shadow-5 backdrop-blur-[5px]",children:g})]})};a.s(["PreviewSlice",0,E],330492);let F=a=>{let{className:c,...d}=a;return(0,b.jsx)("p",{...d,className:(0,n.cn)("leading-7",c),children:a.children})};a.s(["FormattedText",0,F],460183);let G=a=>{let{children:c,className:d,header:e,mainClassName:f,ref:g,...h}=a;return(0,b.jsx)("div",{className:d,children:(0,b.jsxs)("div",{...h,ref:g,className:(0,n.cn)("flex h-full w-full flex-col rounded-tl-xl border-l-[0.5px] border-t-[0.5px] border-components-panel-border bg-background-default-lighter shadow-md shadow-shadow-shadow-5"),children:[(0,b.jsx)("header",{className:"border-b border-divider-subtle pb-3 pl-5 pr-4 pt-4",children:e}),(0,b.jsx)("main",{className:(0,n.cn)("w-full grow overflow-y-auto px-6 py-5",f),children:c})]})})};G.displayName="PreviewContainer",a.s(["default",0,G],209796);let H=a=>{let{title:c,className:d,children:e,...f}=a;return(0,b.jsxs)("div",{...f,className:(0,n.cn)(d),children:[(0,b.jsx)("div",{className:"system-2xs-semibold-uppercase mb-1 px-1 uppercase text-text-accent",children:c}),e]})};a.s(["PreviewHeader",0,H],288117);let I=({isMobile:a,dataSourceType:c,currentDocForm:e,estimate:f,parentChildConfig:g,isSetting:h,pickerFiles:i,pickerValue:j,isIdle:k,isPending:m,onPickerChange:o})=>{let{t:p}=(0,d.useTranslation)();return(0,b.jsx)(u.default,{isMobile:a,isOpen:!0,onClose:s.noop,footer:null,children:(0,b.jsxs)(G,{header:(0,b.jsx)(H,{title:p("stepTwo.preview",{ns:"datasetCreation"}),children:(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(y.default,{files:i,onChange:o,value:h?i[0]:j}),e!==l.ChunkingMode.qa&&(0,b.jsx)(t.default,{text:p("stepTwo.previewChunkCount",{ns:"datasetCreation",count:f?.total_segments||0})})]})}),className:(0,n.cn)("relative flex h-full w-1/2 shrink-0 p-4 pr-0",a&&"w-full max-w-[524px]"),mainClassName:"space-y-6",children:[e===l.ChunkingMode.qa&&f?.qa_preview&&f.qa_preview.map((a,c)=>(0,b.jsx)(x.ChunkContainer,{label:`Chunk-${c+1}`,characterCount:a.question.length+a.answer.length,children:(0,b.jsx)(x.QAPreview,{qa:a})},a.question)),e===l.ChunkingMode.text&&f?.preview&&f.preview.map((a,c)=>(0,b.jsxs)(x.ChunkContainer,{label:`Chunk-${c+1}`,characterCount:a.content.length,children:[a.content,a.summary&&(0,b.jsx)(z.default,{summary:a.summary})]},a.content)),e===l.ChunkingMode.parentChild&&f?.preview&&f.preview.map((a,c)=>{let d="full-doc"===g.chunkForContext?a.child_chunks.slice(0,w.FULL_DOC_PREVIEW_LENGTH):a.child_chunks;return(0,b.jsxs)(x.ChunkContainer,{label:`Chunk-${c+1}`,characterCount:a.content.length,children:[(0,b.jsx)(F,{children:d.map((a,c)=>{let d=c+1;return(0,b.jsx)(E,{label:`C-${d}`,text:a,tooltip:`Child-chunk-${d} \xb7 ${a.length} Characters`,labelInnerClassName:"text-[10px] font-semibold align-bottom leading-7",dividerClassName:"leading-7"},`C-${d}-${a}`)})}),a.summary&&(0,b.jsx)(z.default,{summary:a.summary})]},a.content)}),k&&(0,b.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3",children:[(0,b.jsx)(r.RiSearchEyeLine,{className:"size-10 text-text-empty-state-icon"}),(0,b.jsx)("p",{className:"text-sm text-text-tertiary",children:p("stepTwo.previewChunkTip",{ns:"datasetCreation"})})]})}),m&&(0,b.jsx)("div",{className:"space-y-6",children:Array.from({length:10},(a,c)=>(0,b.jsxs)(v.SkeletonContainer,{children:[(0,b.jsxs)(v.SkeletonRow,{children:[(0,b.jsx)(v.SkeletonRectangle,{className:"w-20"}),(0,b.jsx)(v.SkeletonPoint,{}),(0,b.jsx)(v.SkeletonRectangle,{className:"w-24"})]}),(0,b.jsx)(v.SkeletonRectangle,{className:"w-full"}),(0,b.jsx)(v.SkeletonRectangle,{className:"w-full"}),(0,b.jsx)(v.SkeletonRectangle,{className:"w-[422px]"})]},c))})]})})};var J=a.i(909795);let K=({isSetting:a,isCreating:c,onPrevious:e,onCreate:f,onCancel:g})=>{let{t:h}=(0,d.useTranslation)();return a?(0,b.jsxs)("div",{className:"mt-8 flex items-center py-2",children:[(0,b.jsx)(J.default,{loading:c,variant:"primary",onClick:f,children:h("stepTwo.save",{ns:"datasetCreation"})}),(0,b.jsx)(J.default,{className:"ml-2",onClick:g,children:h("stepTwo.cancel",{ns:"datasetCreation"})})]}):(0,b.jsxs)("div",{className:"mt-8 flex items-center py-2",children:[(0,b.jsxs)(J.default,{onClick:e,children:[(0,b.jsx)(r.RiArrowLeftLine,{className:"mr-1 h-4 w-4"}),h("stepTwo.previousStep",{ns:"datasetCreation"})]}),(0,b.jsx)(J.default,{className:"ml-auto",loading:c,variant:"primary",onClick:f,children:h("stepTwo.nextStep",{ns:"datasetCreation"})})]})};a.i(922506);var L=a.i(944054),M=a.i(992192),N=a.i(766646),O=a.i(353785),P=a.i(355919);let Q=({isSetting:a,documentDetail:r,isAPIKeySet:s,datasetId:t,indexingType:u,dataSourceType:v,files:w,notionPages:x=[],notionCredentialId:y,websitePages:z=[],crawlOptions:A,websiteCrawlProvider:B=k.DataSourceProvider.jinaReader,websiteCrawlJobId:C="",onStepChange:D,updateIndexingTypeCache:E,updateResultCache:F,onSave:G,onCancel:H,updateRetrievalMethodCache:J})=>{let{t:Q}=(0,d.useTranslation)(),R=(0,h.useLocale)(),S=(0,i.default)()===i.MediaType.mobile,T=(0,g.useDatasetDetailContextWithSelector)(a=>a.dataset),U=(0,g.useDatasetDetailContextWithSelector)(a=>a.mutateDatasetRes),V=!!T,W=V&&!T?.doc_form,X=!W,Y=!V&&!a,Z=t&&(!t||T?.data_source_type)?T?.data_source_type??v:v,$=!!u,_=!!t&&!!T?.data_source_type,[aa,ab]=(0,c.useState)(t&&r?r.doc_form:l.ChunkingMode.text),[ac,ad]=(0,c.useState)(()=>t&&r?r.doc_language:R!==j.LanguagesSupported[1]?"English":"Chinese Simplified"),[ae,af]=(0,c.useState)(!1),ag=T?.doc_form||aa,ah=(0,M.useSegmentationState)({initialSegmentationType:T?.doc_form===l.ChunkingMode.parentChild?l.ProcessMode.parentChild:l.ProcessMode.general,initialSummaryIndexSetting:T?.summary_index_setting}),ai=!T,aj=(0,L.useIndexingConfig)({initialIndexType:u,initialEmbeddingModel:T?.embedding_model?{provider:T.embedding_model_provider,model:T.embedding_model}:void 0,initialRetrievalConfig:T?.retrieval_model_dict,isAPIKeySet:s,hasSetIndexType:$}),ak=(0,P.usePreviewState)({dataSourceType:Z,files:w,notionPages:x,websitePages:z,documentDetail:r,datasetId:t}),al=(0,N.useDocumentCreation)({datasetId:t,isSetting:a,documentDetail:r,dataSourceType:Z,files:w,notionPages:x,notionCredentialId:y,websitePages:z,crawlOptions:A,websiteCrawlProvider:B,websiteCrawlJobId:C,onStepChange:D,updateIndexingTypeCache:E,updateResultCache:F,updateRetrievalMethodCache:J,onSave:G,mutateDatasetRes:U}),am=(0,O.useIndexingEstimate)({dataSourceType:Z,datasetId:t,currentDocForm:ag,docLanguage:ac,files:w,previewFileName:ak.previewFile?.name,previewNotionPage:ak.previewNotionPage,notionCredentialId:y,previewWebsitePage:ak.previewWebsitePage,crawlOptions:A,websiteCrawlProvider:B,websiteCrawlJobId:C,indexingTechnique:aj.getIndexingTechnique(),processRule:ah.getProcessRule(ag)}),an=(0,m.useFetchDefaultProcessRule)({onSuccess(a){ah.setSegmentIdentifier(a.rules.segmentation.separator),ah.setMaxChunkLength(a.rules.segmentation.max_tokens),ah.setOverlap(a.rules.segmentation.chunk_overlap),ah.setRules(a.rules.pre_processing_rules),ah.setDefaultConfig(a.rules),ah.setLimitMaxChunkLength(a.limits.indexing_max_segmentation_tokens_length)}}),ao=(0,c.useCallback)(a=>{a===l.ChunkingMode.qa&&aj.indexType===L.IndexingType.ECONOMICAL?af(!0):(a===l.ChunkingMode.parentChild&&aj.indexType===L.IndexingType.ECONOMICAL&&aj.setIndexType(L.IndexingType.QUALIFIED),ab(a),ah.setSegmentationType(a===l.ChunkingMode.parentChild?l.ProcessMode.parentChild:l.ProcessMode.general),am.reset())},[aj,ah,am]),ap=(0,c.useCallback)(()=>{ah.segmentationType===l.ProcessMode.general&&ah.maxChunkLength>M.MAXIMUM_CHUNK_TOKEN_LENGTH?f.default.notify({type:"error",message:Q("stepTwo.maxLengthCheck",{ns:"datasetCreation",limit:M.MAXIMUM_CHUNK_TOKEN_LENGTH})}):am.fetchEstimate()},[ah,Q,am]),aq=(0,c.useCallback)(async()=>{if(!al.validateParams({segmentationType:ah.segmentationType,maxChunkLength:ah.maxChunkLength,limitMaxChunkLength:ah.limitMaxChunkLength,overlap:ah.overlap,indexType:aj.indexType,embeddingModel:aj.embeddingModel,rerankModelList:aj.rerankModelList,retrievalConfig:aj.retrievalConfig}))return;let a=al.buildCreationParams(ag,ac,ah.getProcessRule(ag),aj.retrievalConfig,aj.embeddingModel,aj.getIndexingTechnique(),ah.summaryIndexSetting);a&&await al.executeCreation(a,aj.indexType,aj.retrievalConfig)},[al,ah,aj,ag,ac]),ar=(0,c.useCallback)(a=>{am.reset(),ak.handlePreviewChange(a),am.fetchEstimate()},[am,ak]),as=(0,c.useCallback)(()=>{af(!1),aj.setIndexType(L.IndexingType.QUALIFIED),ab(l.ChunkingMode.qa)},[aj]);(0,c.useEffect)(()=>{if(a){if(r){let a=r.dataset_process_rule.rules,b=r.doc_form===l.ChunkingMode.parentChild||!!(a.parent_mode&&a.subchunk_segmentation);ah.applyConfigFromRules(a,b),ah.setSegmentationType(r.dataset_process_rule.mode)}}else an.mutate("/datasets/process-rule")},[]);let at=V&&[l.ChunkingMode.text,l.ChunkingMode.qa].includes(T.doc_form)||W||Y,au=V&&T.doc_form===l.ChunkingMode.parentChild||W||Y;return(0,b.jsxs)("div",{className:"flex h-full w-full",children:[(0,b.jsxs)("div",{className:(0,n.cn)("relative h-full w-1/2 overflow-y-auto py-6",S?"px-4":"px-12"),children:[(0,b.jsx)("div",{className:"system-md-semibold mb-1 text-text-secondary",children:Q("stepTwo.segmentation",{ns:"datasetCreation"})}),at&&(0,b.jsx)(o.GeneralChunkingOptions,{segmentIdentifier:ah.segmentIdentifier,maxChunkLength:ah.maxChunkLength,overlap:ah.overlap,rules:ah.rules,currentDocForm:ag,docLanguage:ac,isActive:[l.ChunkingMode.text,l.ChunkingMode.qa].includes(ag),isInUpload:V,isNotUploadInEmptyDataset:X,hasCurrentDatasetDocForm:!!T?.doc_form,onSegmentIdentifierChange:a=>ah.setSegmentIdentifier(a,!0),onMaxChunkLengthChange:ah.setMaxChunkLength,onOverlapChange:ah.setOverlap,onRuleToggle:ah.toggleRule,onDocFormChange:ao,onDocLanguageChange:ad,onPreview:ap,onReset:ah.resetToDefaults,locale:R,showSummaryIndexSetting:ai,summaryIndexSetting:ah.summaryIndexSetting,onSummaryIndexSettingChange:ah.handleSummaryIndexSettingChange}),au&&(0,b.jsx)(q.ParentChildOptions,{parentChildConfig:ah.parentChildConfig,rules:ah.rules,currentDocForm:ag,isActive:ag===l.ChunkingMode.parentChild,isInUpload:V,isNotUploadInEmptyDataset:X,onDocFormChange:ao,onChunkForContextChange:ah.setChunkForContext,onParentDelimiterChange:a=>ah.updateParentConfig("delimiter",a),onParentMaxLengthChange:a=>ah.updateParentConfig("maxLength",a),onChildDelimiterChange:a=>ah.updateChildConfig("delimiter",a),onChildMaxLengthChange:a=>ah.updateChildConfig("maxLength",a),onRuleToggle:ah.toggleRule,onPreview:ap,onReset:ah.resetToDefaults,showSummaryIndexSetting:ai,summaryIndexSetting:ah.summaryIndexSetting,onSummaryIndexSettingChange:ah.handleSummaryIndexSettingChange}),(0,b.jsx)(e.default,{className:"my-5"}),(0,b.jsx)(p.IndexingModeSection,{indexType:aj.indexType,hasSetIndexType:$,docForm:aa,embeddingModel:aj.embeddingModel,embeddingModelList:aj.embeddingModelList,retrievalConfig:aj.retrievalConfig,showMultiModalTip:aj.showMultiModalTip,isModelAndRetrievalConfigDisabled:_,datasetId:t,isQAConfirmDialogOpen:ae,onIndexTypeChange:aj.setIndexType,onEmbeddingModelChange:aj.setEmbeddingModel,onRetrievalConfigChange:aj.setRetrievalConfig,onQAConfirmDialogClose:()=>af(!1),onQAConfirmDialogConfirm:as}),(0,b.jsx)(K,{isSetting:a,isCreating:al.isCreating,onPrevious:()=>D?.(-1),onCreate:aq,onCancel:H})]}),(0,b.jsx)(I,{isMobile:S,dataSourceType:Z,currentDocForm:ag,estimate:am.estimate,parentChildConfig:ah.parentChildConfig,isSetting:a,pickerFiles:ak.getPreviewPickerItems(),pickerValue:ak.getPreviewPickerValue(),isIdle:am.isIdle,isPending:am.isPending,onPickerChange:ar})]})}}];

//# sourceMappingURL=app_components_0ae3e4cd._.js.map