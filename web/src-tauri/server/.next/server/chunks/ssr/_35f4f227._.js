module.exports=[470759,a=>{"use strict";var b=a.i(848636),c=a.i(528698),d=a.i(41511);let e="segment",f=[e,"chunkList"],g=[e,"chunkList",{enabled:!0}],h=[e,"chunkList",{enabled:!1}],i=[e,"chunkList",{enabled:"all"}],j=[e,"childChunkList"];a.s(["useAddChildSegment",0,()=>(0,b.useMutation)({mutationKey:[e,"childChunk","add"],mutationFn:a=>{let{datasetId:b,documentId:c,segmentId:e,body:f}=a;return(0,d.post)(`/datasets/${b}/documents/${c}/segments/${e}/child_chunks`,{body:f})}}),"useAddSegment",0,()=>(0,b.useMutation)({mutationKey:[e,"add"],mutationFn:a=>{let{datasetId:b,documentId:c,body:e}=a;return(0,d.post)(`/datasets/${b}/documents/${c}/segment`,{body:e})}}),"useCheckSegmentBatchImportProgress",0,()=>(0,b.useMutation)({mutationKey:[e,"batchImport","checkProgress"],mutationFn:a=>{let{jobID:b}=a;return(0,d.get)(`/datasets/batch_import_status/${b}`)}}),"useChildSegmentList",0,(a,b)=>{let{datasetId:e,documentId:f,segmentId:g,params:h}=a;return(0,c.useQuery)({queryKey:[...j,e,f,g,h],queryFn:()=>(0,d.get)(`/datasets/${e}/documents/${f}/segments/${g}/child_chunks`,{params:h}),enabled:!b})},"useChildSegmentListKey",0,j,"useChunkListAllKey",0,i,"useChunkListDisabledKey",0,h,"useChunkListEnabledKey",0,g,"useDeleteChildSegment",0,()=>(0,b.useMutation)({mutationKey:[e,"childChunk","delete"],mutationFn:a=>{let{datasetId:b,documentId:c,segmentId:e,childChunkId:f}=a;return(0,d.del)(`/datasets/${b}/documents/${c}/segments/${e}/child_chunks/${f}`)}}),"useDeleteSegment",0,()=>(0,b.useMutation)({mutationKey:[e,"delete"],mutationFn:a=>{let{datasetId:b,documentId:c,segmentIds:e}=a,f=e.map(a=>`segment_id=${a}`).join("&");return(0,d.del)(`/datasets/${b}/documents/${c}/segments?${f}`)}}),"useDisableSegment",0,()=>(0,b.useMutation)({mutationKey:[e,"disable"],mutationFn:a=>{let{datasetId:b,documentId:c,segmentIds:e}=a,f=e.map(a=>`segment_id=${a}`).join("&");return(0,d.patch)(`/datasets/${b}/documents/${c}/segment/disable?${f}`)}}),"useEnableSegment",0,()=>(0,b.useMutation)({mutationKey:[e,"enable"],mutationFn:a=>{let{datasetId:b,documentId:c,segmentIds:e}=a,f=e.map(a=>`segment_id=${a}`).join("&");return(0,d.patch)(`/datasets/${b}/documents/${c}/segment/enable?${f}`)}}),"useSegmentBatchImport",0,()=>(0,b.useMutation)({mutationKey:[e,"batchImport"],mutationFn:a=>{let{url:b,body:c}=a;return(0,d.post)(b,{body:c})}}),"useSegmentList",0,(a,b)=>{let{datasetId:e,documentId:g,params:h}=a;return(0,c.useQuery)({queryKey:[...f,e,g,h],queryFn:()=>(0,d.get)(`/datasets/${e}/documents/${g}/segments`,{params:h}),enabled:!b})},"useSegmentListKey",0,f,"useUpdateChildSegment",0,()=>(0,b.useMutation)({mutationKey:[e,"childChunk","update"],mutationFn:a=>{let{datasetId:b,documentId:c,segmentId:e,childChunkId:f,body:g}=a;return(0,d.patch)(`/datasets/${b}/documents/${c}/segments/${e}/child_chunks/${f}`,{body:g})}}),"useUpdateSegment",0,()=>(0,b.useMutation)({mutationKey:[e,"update"],mutationFn:a=>{let{datasetId:b,documentId:c,segmentId:e,body:f}=a;return(0,d.patch)(`/datasets/${b}/documents/${c}/segments/${e}`,{body:f})}})])},585447,803506,820703,a=>{"use strict";var b,c,d=a.i(848636),e=a.i(528698),f=a.i(749249),g=a.i(41511),h=a.i(425282),i=a.i(820051);let j="dataset-metadata",k=a=>(0,h.useInvalid)([j,"dataset",a]),l=a=>{let b,c=k(a),d=(0,i.useInvalidDocumentList)(a),e=(b=(0,f.useQueryClient)(),()=>{b.invalidateQueries({queryKey:[j,"document",a],exact:!1})});return async()=>{await c(),d(),await e()}};a.s(["useBatchUpdateDocMetadata",0,()=>{let a=(0,f.useQueryClient)();return(0,d.useMutation)({mutationFn:async b=>{let c=b.metadata_list.map(a=>a.document_id);await (0,g.post)(`/datasets/${b.dataset_id}/documents/metadata`,{body:{operation_data:b.metadata_list}}),await a.invalidateQueries({queryKey:[j,"dataset",b.dataset_id]}),await a.invalidateQueries({queryKey:[j,"document",b.dataset_id]}),await a.invalidateQueries({queryKey:[...i.useDocumentListKey,b.dataset_id]}),await Promise.all(c.map(c=>a.invalidateQueries({queryKey:[j,"document",b.dataset_id,c]})))}})},"useBuiltInMetaDataFields",0,()=>(0,e.useQuery)({queryKey:[j,"built-in"],queryFn:()=>(0,g.get)("/datasets/metadata/built-in")}),"useCreateMetaData",0,a=>{let b=k(a);return(0,d.useMutation)({mutationFn:async c=>(await (0,g.post)(`/datasets/${a}/metadata`,{body:c}),await b(),Promise.resolve(!0))})},"useDatasetMetaData",0,a=>(0,e.useQuery)({queryKey:[j,"dataset",a],queryFn:()=>(0,g.get)(`/datasets/${a}/metadata`)}),"useDeleteMetaData",0,a=>{let b=l(a);return(0,d.useMutation)({mutationFn:async c=>{await (0,g.del)(`/datasets/${a}/metadata/${c}`),await b()}})},"useDocumentMetaData",0,({datasetId:a,documentId:b})=>(0,e.useQuery)({queryKey:[j,"document",a,b],queryFn:()=>(0,g.get)(`/datasets/${a}/documents/${b}`,{params:{metadata:"only"}})}),"useRenameMeta",0,a=>{let b=l(a);return(0,d.useMutation)({mutationFn:async c=>{await (0,g.patch)(`/datasets/${a}/metadata/${c.id}`,{body:{name:c.name}}),await b()}})},"useUpdateBuiltInStatus",0,a=>{let b=k(a);return(0,d.useMutation)({mutationFn:async c=>{await (0,g.post)(`/datasets/${a}/metadata/built-in/${c?"enable":"disable"}`),b()}})}],585447);var m=((b={}).string="string",b.number="number",b.time="time",b),n=((c={}).changeValue="changeValue",c.delete="delete",c);a.s(["DataType",()=>m,"UpdateType",()=>n,"isShowManageMetadataLocalStorageKey",0,"dify-isShowManageMetadata"],803506),a.i(752298);var o=a.i(693025);let p="metadata.checkName";a.s(["default",0,()=>{let{t:a}=(0,o.useTranslation)();return{checkName:b=>b?/^[a-z][a-z0-9_]*$/.test(b)?b.length>255?{errorMsg:a(`${p}.tooLong`,{ns:"dataset",max:255})}:{errorMsg:""}:{errorMsg:a(`${p}.invalid`,{ns:"dataset"})}:{errorMsg:a(`${p}.empty`,{ns:"dataset"})}}}],820703)},834075,412491,173958,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(111089),e=a.i(57843);a.i(752298);var f=a.i(693025),g=a.i(816134),h=a.i(527344),i=a.i(909795);let j=e.memo(({title:a,className:d,beforeHeader:e,children:g,onClose:j,hideCloseBtn:k,onConfirm:l})=>{let{t:m}=(0,f.useTranslation)();return(0,b.jsxs)("div",{className:(0,h.cn)("w-[320px] rounded-2xl border-[0.5px] border-components-panel-border bg-components-panel-bg px-3 pb-4 pt-3.5 shadow-xl",d),children:[e||null,(0,b.jsxs)("div",{className:"mb-1 flex h-6 items-center justify-between",children:[(0,b.jsx)("div",{className:"system-xl-semibold text-text-primary",children:a}),!k&&(0,b.jsx)("div",{className:"cursor-pointer p-1.5 text-text-tertiary",onClick:j,children:(0,b.jsx)(c.RiCloseLine,{className:"size-4"})})]}),(0,b.jsx)("div",{className:"mt-2",children:g}),(0,b.jsxs)("div",{className:"mt-4 flex justify-end",children:[(0,b.jsx)(i.default,{className:"mr-2",onClick:j,children:m("operation.cancel",{ns:"common"})}),(0,b.jsx)(i.default,{onClick:l,variant:"primary",children:m("operation.save",{ns:"common"})})]})]})});var k=a.i(335913),l=a.i(803506);let m=e.memo(({className:a,label:c,children:d})=>(0,b.jsxs)("div",{className:a,children:[(0,b.jsx)("div",{className:"system-sm-semibold py-1 text-text-secondary",children:c}),(0,b.jsx)("div",{className:"mt-1",children:d})]}));a.s(["default",0,m],412491);let n="metadata.createMetadata",o=e.memo(({onClose:a=d.noop,hasBack:h,onBack:i,onSave:o})=>{let{t:p}=(0,f.useTranslation)(),[q,r]=(0,e.useState)(l.DataType.string),s=(0,e.useCallback)(a=>()=>r(a),[r]),[t,u]=(0,e.useState)(""),v=(0,e.useCallback)(a=>{u(a.target.value)},[u]),w=(0,e.useCallback)(()=>{o({type:q,name:t})},[o,q,t]);return(0,b.jsx)(j,{title:p(`${n}.title`,{ns:"dataset"}),onClose:a,onConfirm:w,hideCloseBtn:h,beforeHeader:h&&(0,b.jsxs)("div",{className:"relative left-[-4px] mb-1 flex cursor-pointer items-center space-x-1 py-1 text-text-accent",onClick:i,children:[(0,b.jsx)(c.RiArrowLeftLine,{className:"size-4"}),(0,b.jsx)("div",{className:"system-xs-semibold-uppercase",children:p(`${n}.back`,{ns:"dataset"})})]}),children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(m,{label:p(`${n}.type`,{ns:"dataset"}),children:(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,b.jsx)(k.default,{title:"String",selected:q===l.DataType.string,onSelect:s(l.DataType.string)}),(0,b.jsx)(k.default,{title:"Number",selected:q===l.DataType.number,onSelect:s(l.DataType.number)}),(0,b.jsx)(k.default,{title:"Time",selected:q===l.DataType.time,onSelect:s(l.DataType.time)})]})}),(0,b.jsx)(m,{label:p(`${n}.name`,{ns:"dataset"}),children:(0,b.jsx)(g.default,{value:t,onChange:v,placeholder:p(`${n}.namePlaceholder`,{ns:"dataset"})})})]})})});a.s(["default",0,o],834075),a.s(["getIcon",0,a=>({[l.DataType.string]:c.RiTextSnippet,[l.DataType.number]:c.RiHashtag,[l.DataType.time]:c.RiTimeLine})[a]||c.RiTextSnippet],173958)},677658,a=>{"use strict";a.i(752298);var b=a.i(693025);a.s(["useIndexStatus",0,()=>{let{t:a}=(0,b.useTranslation)();return{queuing:{color:"orange",text:a("list.status.queuing",{ns:"datasetDocuments"})},indexing:{color:"blue",text:a("list.status.indexing",{ns:"datasetDocuments"})},paused:{color:"orange",text:a("list.status.paused",{ns:"datasetDocuments"})},error:{color:"red",text:a("list.status.error",{ns:"datasetDocuments"})},available:{color:"green",text:a("list.status.available",{ns:"datasetDocuments"})},enabled:{color:"green",text:a("list.status.enabled",{ns:"datasetDocuments"})},disabled:{color:"gray",text:a("list.status.disabled",{ns:"datasetDocuments"})},archived:{color:"gray",text:a("list.status.archived",{ns:"datasetDocuments"})}}}])},301034,a=>{a.v({actionIcon:"style-module__GM7H8a__actionIcon",actionIconWrapperDetail:"style-module__GM7H8a__actionIconWrapperDetail",actionIconWrapperList:"style-module__GM7H8a__actionIconWrapperList",actionItem:"style-module__GM7H8a__actionItem",actionName:"style-module__GM7H8a__actionName",addFileBtn:"style-module__GM7H8a__addFileBtn",commonIcon:"style-module__GM7H8a__commonIcon",csvIcon:"style-module__GM7H8a__csvIcon",delModal:"style-module__GM7H8a__delModal",deleteActionItem:"style-module__GM7H8a__deleteActionItem",docIcon:"style-module__GM7H8a__docIcon",documentTable:"style-module__GM7H8a__documentTable",docxIcon:"style-module__GM7H8a__docxIcon",emptyElement:"style-module__GM7H8a__emptyElement",emptySymbolIconWrapper:"style-module__GM7H8a__emptySymbolIconWrapper",emptyTip:"style-module__GM7H8a__emptyTip",emptyTitle:"style-module__GM7H8a__emptyTitle",emptyWrapper:"style-module__GM7H8a__emptyWrapper",htmlIcon:"style-module__GM7H8a__htmlIcon",jsonIcon:"style-module__GM7H8a__jsonIcon",markdownIcon:"style-module__GM7H8a__markdownIcon",mdIcon:"style-module__GM7H8a__mdIcon",pdfIcon:"style-module__GM7H8a__pdfIcon",plusIcon:"style-module__GM7H8a__plusIcon",statusItemDetail:"style-module__GM7H8a__statusItemDetail",tdValue:"style-module__GM7H8a__tdValue",txtIcon:"style-module__GM7H8a__txtIcon",warningIcon:"style-module__GM7H8a__warningIcon",warningWrapper:"style-module__GM7H8a__warningWrapper",xlsIcon:"style-module__GM7H8a__xlsIcon",xlsxIcon:"style-module__GM7H8a__xlsxIcon"})},127349,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(57843);a.i(752298);var e=a.i(693025),f=a.i(527344),g=a.i(909795);let h=d.memo(({className:a,onClick:d})=>{let{t:h}=(0,e.useTranslation)();return(0,b.jsxs)(g.default,{className:(0,f.cn)("flex w-full items-center",a),size:"small",variant:"tertiary",onClick:d,children:[(0,b.jsx)(c.RiAddLine,{className:"mr-1 size-3.5"}),(0,b.jsx)("div",{children:h("metadata.addMetadata",{ns:"dataset"})})]})});a.s(["default",0,h])},220809,a=>{"use strict";var b,c=a.i(608061),d=a.i(57843),e=a.i(585447),f=a.i(825319),g=a.i(834075),h=a.i(429150);a.i(752298);var i=a.i(693025),j=a.i(260208),k=a.i(173958);let l="metadata.selectMetadata",m=d.memo(({list:a,onSelect:b,onNew:e,onManage:f})=>{let{t:g}=(0,i.useTranslation)(),[m,n]=(0,d.useState)(""),o=(0,d.useMemo)(()=>m?a.filter(a=>a.name.toLowerCase().includes(m.toLowerCase())):a,[m,a]);return(0,c.jsxs)("div",{className:"w-[320px] rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur pb-0 pt-2 shadow-lg backdrop-blur-[5px]",children:[(0,c.jsx)(j.default,{className:"mx-2",value:m,onChange:n,placeholder:g(`${l}.search`,{ns:"dataset"})}),(0,c.jsx)("div",{className:"mt-2",children:o.map(a=>{let d=(0,k.getIcon)(a.type);return(0,c.jsxs)("div",{className:"mx-1 flex h-6 cursor-pointer  items-center justify-between rounded-md px-3 hover:bg-state-base-hover",onClick:()=>b({id:a.id,name:a.name,type:a.type}),children:[(0,c.jsxs)("div",{className:"flex h-full w-0 grow items-center text-text-secondary",children:[(0,c.jsx)(d,{className:"mr-[5px] size-3.5 shrink-0"}),(0,c.jsx)("div",{className:"system-sm-medium w-0 grow truncate",children:a.name})]}),(0,c.jsx)("div",{className:"system-xs-regular ml-1 shrink-0 text-text-tertiary",children:a.type})]},a.id)})}),(0,c.jsxs)("div",{className:"mt-1 flex justify-between border-t border-divider-subtle p-1",children:[(0,c.jsxs)("div",{className:"flex h-6 cursor-pointer items-center space-x-1 rounded-md px-3 text-text-secondary hover:bg-state-base-hover",onClick:e,children:[(0,c.jsx)(h.RiAddLine,{className:"size-3.5"}),(0,c.jsx)("div",{className:"system-sm-medium",children:g(`${l}.newAction`,{ns:"dataset"})})]}),(0,c.jsxs)("div",{className:"flex h-6 items-center text-text-secondary ",children:[(0,c.jsx)("div",{className:"mr-[3px] h-3 w-px bg-divider-regular"}),(0,c.jsxs)("div",{className:"flex h-full cursor-pointer items-center rounded-md px-1.5 hover:bg-state-base-hover",onClick:f,children:[(0,c.jsx)("div",{className:"system-sm-medium mr-1",children:g(`${l}.manageAction`,{ns:"dataset"})}),(0,c.jsx)(h.RiArrowRightUpLine,{className:"size-3.5"})]})]})]})]})});var n=((b=n||{}).select="select",b.create="create",b);let o=d.memo(({datasetId:a,popupPlacement:b="left-start",popupOffset:h={mainAxis:-38,crossAxis:4},trigger:i,onSelect:j,onSave:k,onManage:l})=>{let{data:n}=(0,e.useDatasetMetaData)(a),[o,p]=(0,d.useState)(!1),[q,r]=(0,d.useState)("select"),s=(0,d.useCallback)(async a=>{await k(a),r("select")},[k]);return(0,c.jsxs)(f.PortalToFollowElem,{open:o,onOpenChange:p,placement:b,offset:h,children:[(0,c.jsx)(f.PortalToFollowElemTrigger,{onClick:()=>p(!o),className:"block",children:i}),(0,c.jsx)(f.PortalToFollowElemContent,{className:"z-[1000]",children:"select"===q?(0,c.jsx)(m,{onSelect:a=>{j(a),p(!1)},list:n?.doc_metadata||[],onNew:()=>r("create"),onManage:l}):(0,c.jsx)(g.default,{onSave:s,hasBack:!0,onBack:()=>r("select"),onClose:()=>r("select")})})]})});a.s(["default",0,o],220809)},625963,a=>{"use strict";var b=a.i(608061),c=a.i(57843),d=a.i(816134),e=a.i(644734),f=a.i(527344),g=a.i(429150),h=a.i(435133);a.i(752298);var i=a.i(693025),j=a.i(368988),k=a.i(98654);let l=({className:a,value:d,onChange:e})=>{let{t:l}=(0,i.useTranslation)(),{formatTime:m}=(0,k.default)(),n=(0,c.useCallback)(a=>{a?e(a.unix()):e(null)},[e]),o=(0,c.useCallback)(({handleClickTrigger:c})=>(0,b.jsxs)("div",{onClick:c,className:(0,f.cn)("group flex items-center rounded-md bg-components-input-bg-normal",a),children:[(0,b.jsx)("div",{className:(0,f.cn)("grow",d?"text-text-secondary":"text-text-tertiary"),children:d?m(d,l("metadata.dateTimeFormat",{ns:"datasetDocuments"})):l("metadata.chooseTime",{ns:"dataset"})}),(0,b.jsx)(g.RiCloseCircleFill,{className:(0,f.cn)("hidden h-4 w-4 cursor-pointer hover:text-components-input-text-filled group-hover:block",d&&"text-text-quaternary"),onClick:()=>n()}),(0,b.jsx)(g.RiCalendarLine,{className:(0,f.cn)("block h-4 w-4 shrink-0 group-hover:hidden",d?"text-text-quaternary":"text-text-tertiary")})]}),[a,d,m,l,n]);return(0,b.jsx)(j.default,{value:(0,h.default)(d?1e3*d:Date.now()),onChange:n,onClear:n,renderTrigger:o,triggerWrapClassName:"w-full",popupZIndexClassname:"z-[1000]"})};var m=a.i(803506);let n=c.memo(({className:a,type:c,value:g,onChange:h,readOnly:i})=>{let j=(0,f.cn)("h-6 grow p-0.5 text-xs");return c===m.DataType.time?(0,b.jsx)(l,{className:j,value:g,onChange:h}):c===m.DataType.number?(0,b.jsx)("div",{className:"grow text-[0]",children:(0,b.jsx)(e.InputNumber,{className:(0,f.cn)(j,"rounded-l-md"),value:g,onChange:h,size:"regular",controlWrapClassName:"overflow-hidden",controlClassName:"pt-0 pb-0",readOnly:i})}):(0,b.jsx)(d.default,{wrapperClassName:a,className:(0,f.cn)(j,"rounded-md"),value:g,onChange:a=>h(a.target.value),readOnly:i})});a.s(["default",0,n],625963)},850959,a=>{"use strict";var b=a.i(185105);a.s(["SearchLinesSparkle",()=>b.default])},301128,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(497746),e=a.i(57843);a.i(752298);var f=a.i(693025),g=a.i(909795),h=a.i(42550),i=a.i(757801);a.i(224256);var j=a.i(850959),k=a.i(527344);let l="batchAction",m=e.memo(({className:a,selectedIds:e,onBatchEnable:m,onBatchDisable:n,onBatchSummary:o,onBatchDownload:p,onArchive:q,onBatchDelete:r,onEditMetadata:s,onBatchReIndex:t,onCancel:u})=>{let{t:v}=(0,f.useTranslation)(),[w,{setTrue:x,setFalse:y}]=(0,d.useBoolean)(!1),[z,{setTrue:A}]=(0,d.useBoolean)(!1),B=async()=>{A(),await r(),y()};return(0,b.jsxs)("div",{className:(0,k.cn)("pointer-events-none flex w-full justify-center gap-x-2",a),children:[(0,b.jsxs)("div",{className:"pointer-events-auto flex items-center gap-x-1 rounded-[10px] border border-components-actionbar-border-accent bg-components-actionbar-bg-accent p-1 shadow-xl shadow-shadow-shadow-5",children:[(0,b.jsxs)("div",{className:"inline-flex items-center gap-x-2 py-1 pl-2 pr-3",children:[(0,b.jsx)("span",{className:"system-xs-medium flex h-5 w-5 items-center justify-center rounded-md bg-text-accent text-text-primary-on-surface",children:e.length}),(0,b.jsx)("span",{className:"system-sm-semibold text-text-accent",children:v(`${l}.selected`,{ns:"dataset"})})]}),(0,b.jsx)(i.default,{type:"vertical",className:"mx-0.5 h-3.5 bg-divider-regular"}),(0,b.jsxs)(g.default,{variant:"ghost",className:"gap-x-0.5 px-3",onClick:m,children:[(0,b.jsx)(c.RiCheckboxCircleLine,{className:"size-4"}),(0,b.jsx)("span",{className:"px-0.5",children:v(`${l}.enable`,{ns:"dataset"})})]}),(0,b.jsxs)(g.default,{variant:"ghost",className:"gap-x-0.5 px-3",onClick:n,children:[(0,b.jsx)(c.RiCloseCircleLine,{className:"size-4"}),(0,b.jsx)("span",{className:"px-0.5",children:v(`${l}.disable`,{ns:"dataset"})})]}),s&&(0,b.jsxs)(g.default,{variant:"ghost",className:"gap-x-0.5 px-3",onClick:s,children:[(0,b.jsx)(c.RiDraftLine,{className:"size-4"}),(0,b.jsx)("span",{className:"px-0.5",children:v("metadata.metadata",{ns:"dataset"})})]}),o&&(0,b.jsxs)(g.default,{variant:"ghost",className:"gap-x-0.5 px-3",onClick:o,children:[(0,b.jsx)(j.SearchLinesSparkle,{className:"size-4"}),(0,b.jsx)("span",{className:"px-0.5",children:v("list.action.summary",{ns:"datasetDocuments"})})]}),q&&(0,b.jsxs)(g.default,{variant:"ghost",className:"gap-x-0.5 px-3",onClick:q,children:[(0,b.jsx)(c.RiArchive2Line,{className:"size-4"}),(0,b.jsx)("span",{className:"px-0.5",children:v(`${l}.archive`,{ns:"dataset"})})]}),t&&(0,b.jsxs)(g.default,{variant:"ghost",className:"gap-x-0.5 px-3",onClick:t,children:[(0,b.jsx)(c.RiRefreshLine,{className:"size-4"}),(0,b.jsx)("span",{className:"px-0.5",children:v(`${l}.reIndex`,{ns:"dataset"})})]}),p&&(0,b.jsxs)(g.default,{variant:"ghost",className:"gap-x-0.5 px-3",onClick:p,children:[(0,b.jsx)(c.RiDownload2Line,{className:"size-4"}),(0,b.jsx)("span",{className:"px-0.5",children:v(`${l}.download`,{ns:"dataset"})})]}),(0,b.jsxs)(g.default,{variant:"ghost",destructive:!0,className:"gap-x-0.5 px-3",onClick:x,children:[(0,b.jsx)(c.RiDeleteBinLine,{className:"size-4"}),(0,b.jsx)("span",{className:"px-0.5",children:v(`${l}.delete`,{ns:"dataset"})})]}),(0,b.jsx)(i.default,{type:"vertical",className:"mx-0.5 h-3.5 bg-divider-regular"}),(0,b.jsx)(g.default,{variant:"ghost",className:"px-3",onClick:u,children:(0,b.jsx)("span",{className:"px-0.5",children:v(`${l}.cancel`,{ns:"dataset"})})})]}),w&&(0,b.jsx)(h.default,{isShow:!0,title:v("list.delete.title",{ns:"datasetDocuments"}),content:v("list.delete.content",{ns:"datasetDocuments"}),confirmText:v("operation.sure",{ns:"common"}),onConfirm:B,onCancel:y,isLoading:z,isDisabled:z})]})});a.s(["default",0,m])},322927,a=>{"use strict";var b=a.i(608061),c=a.i(981133),d=a.i(57843);a.i(752298);var e=a.i(693025),f=a.i(639378),g=a.i(81492),h=a.i(114715),i=a.i(483664),j=a.i(854867),k=a.i(820051),l=a.i(459858),m=a.i(527344),n=a.i(301034),o=a.i(677658);let p={green:"text-util-colors-green-green-600",orange:"text-util-colors-warning-warning-600",red:"text-util-colors-red-red-600",blue:"text-util-colors-blue-light-blue-light-600",yellow:"text-util-colors-warning-warning-600",gray:"text-text-tertiary"},q=d.memo(({status:a,reverse:q=!1,scene:r="list",textCls:s="",errorMessage:t,datasetId:u="",detail:v,onUpdate:w})=>{let{t:x}=(0,e.useTranslation)(),{notify:y}=(0,f.useContext)(h.ToastContext),z=(0,o.useIndexStatus)(),A=a.toLowerCase(),{enabled:B=!1,archived:C=!1,id:D=""}=v||{},{mutateAsync:E}=(0,k.useDocumentEnable)(),{mutateAsync:F}=(0,k.useDocumentDisable)(),{mutateAsync:G}=(0,k.useDocumentDelete)(),H=async a=>{let b=G;switch(a){case"enable":b=E;break;case"disable":b=F}let[c]=await (0,l.asyncRunSafe)(b({datasetId:u,documentId:D}));c?y({type:"error",message:x("actionMsg.modifiedUnsuccessfully",{ns:"common"})}):(y({type:"success",message:x("actionMsg.modifiedSuccessfully",{ns:"common"})}),w?.(a))},{run:I}=(0,c.useDebounceFn)(a=>{"enable"===a&&B||("disable"!==a||B)&&H(a)},{wait:500}),J=(0,d.useMemo)(()=>["queuing","indexing","paused"].includes(A),[A]);return(0,b.jsxs)("div",{className:(0,m.cn)("flex items-center",q?"flex-row-reverse":"","detail"===r?n.default.statusItemDetail:""),children:[(0,b.jsx)(j.default,{color:z[A]?.color,className:q?"ml-2":"mr-2"}),(0,b.jsx)("span",{className:(0,m.cn)(`${p[z[A].color]} text-sm`,s),children:z[A]?.text}),t&&(0,b.jsx)(i.default,{popupContent:(0,b.jsx)("div",{className:"max-w-[260px] break-all",children:t}),triggerClassName:"ml-1 w-4 h-4",triggerTestId:"error-tooltip-trigger"}),"detail"===r&&(0,b.jsx)("div",{className:"ml-1.5 flex items-center justify-between",children:(0,b.jsx)(i.default,{popupContent:x("list.action.enableWarning",{ns:"datasetDocuments"}),popupClassName:"text-text-secondary system-xs-medium",disabled:!C,children:(0,b.jsx)(g.default,{defaultValue:!C&&B,onChange:a=>!C&&I(a?"enable":"disable"),disabled:J||C,size:"md"})})})]})});a.s(["default",0,q])},380794,889493,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(497746),e=a.i(981133),f=a.i(111089),g=a.i(533306),h=a.i(57843);a.i(752298);var i=a.i(693025),j=a.i(639378),k=a.i(42550),l=a.i(757801);a.i(224256);var m=a.i(850959),n=a.i(234782),o=a.i(81492),p=a.i(114715),q=a.i(483664),r=a.i(986431),s=a.i(820051),t=a.i(459858),u=a.i(527344),v=a.i(760327),w=a.i(301034),x=a.i(909795),y=a.i(816134),z=a.i(940272),A=a.i(218257);let B=h.memo(({documentId:a,datasetId:c,name:e,onClose:f,onSaved:g})=>{let{t:j}=(0,i.useTranslation)(),[k,l]=(0,h.useState)(e),[m,{setTrue:n,setFalse:o}]=(0,d.useBoolean)(!1),q=async()=>{n();try{await (0,A.renameDocumentName)({datasetId:c,documentId:a,name:k}),p.default.notify({type:"success",message:j("actionMsg.modifiedSuccessfully",{ns:"common"})}),g(),f()}catch(a){a&&p.default.notify({type:"error",message:a.toString()})}finally{o()}};return(0,b.jsxs)(z.default,{title:j("list.table.rename",{ns:"datasetDocuments"}),isShow:!0,onClose:f,children:[(0,b.jsx)("div",{className:"mt-6 text-sm font-medium leading-[21px] text-text-primary",children:j("list.table.name",{ns:"datasetDocuments"})}),(0,b.jsx)(y.default,{className:"mt-2 h-10",value:k,onChange:a=>l(a.target.value)}),(0,b.jsxs)("div",{className:"mt-10 flex justify-end",children:[(0,b.jsx)(x.default,{className:"mr-2 shrink-0",onClick:f,children:j("operation.cancel",{ns:"common"})}),(0,b.jsx)(x.default,{variant:"primary",className:"shrink-0",onClick:q,loading:m,children:j("operation.save",{ns:"common"})})]})]})});a.s(["default",0,B],889493);let C=h.memo(({embeddingAvailable:a,datasetId:x,detail:y,selectedIds:z,onSelectedIdChange:A,onUpdate:C,scene:D="list",className:E=""})=>{let{id:F,name:G,enabled:H=!1,archived:I=!1,data_source_type:J,display_status:K}=y||{},[L,M]=(0,h.useState)(!1),[N,O]=(0,h.useState)(!1),{notify:P}=(0,j.useContext)(p.ToastContext),{t:Q}=(0,i.useTranslation)(),R=(0,g.useRouter)(),{mutateAsync:S}=(0,s.useDocumentArchive)(),{mutateAsync:T}=(0,s.useDocumentUnArchive)(),{mutateAsync:U}=(0,s.useDocumentEnable)(),{mutateAsync:V}=(0,s.useDocumentDisable)(),{mutateAsync:W}=(0,s.useDocumentDelete)(),{mutateAsync:X,isPending:Y}=(0,s.useDocumentDownload)(),{mutateAsync:Z}=(0,s.useSyncDocument)(),{mutateAsync:$}=(0,s.useSyncWebsite)(),{mutateAsync:_}=(0,s.useDocumentSummary)(),{mutateAsync:aa}=(0,s.useDocumentPause)(),{mutateAsync:ab}=(0,s.useDocumentResume)(),ac="list"===D,ad=async a=>{let b;switch(a){case"archive":b=S;break;case"un_archive":b=T;break;case"enable":b=U;break;case"disable":b=V;break;case"sync":b="notion_import"===J?Z:$;break;case"summary":b=_;break;case"pause":b=aa;break;case"resume":b=ab;break;default:b=W,O(!0)}let[c]=await (0,t.asyncRunSafe)(b({datasetId:x,documentId:F}));c?P({type:"error",message:Q("actionMsg.modifiedUnsuccessfully",{ns:"common"})}):(P({type:"success",message:Q("actionMsg.modifiedSuccessfully",{ns:"common"})}),z&&A&&a===r.DocumentActionType.delete&&A(z.filter(a=>a!==F)),C(a)),a===r.DocumentActionType.delete&&O(!1)},{run:ae}=(0,e.useDebounceFn)(a=>{a===r.DocumentActionType.enable&&H||(a!==r.DocumentActionType.disable||H)&&ad(a)},{wait:500}),[af,ag]=(0,h.useState)(null),[ah,{setTrue:ai,setFalse:aj}]=(0,d.useBoolean)(!1),ak=(0,h.useCallback)(a=>{ag(a),ai()},[ai]),al=(0,h.useCallback)(()=>{C()},[C]),am=(0,h.useCallback)(async()=>{if(Y)return;let[a,b]=await (0,t.asyncRunSafe)(X({datasetId:x,documentId:F}));a||!b?.url?P({type:"error",message:Q("actionMsg.downloadUnsuccessfully",{ns:"common"})}):(0,v.downloadUrl)({url:b.url,fileName:G})},[x,X,F,Y,G,P,Q]);return(0,b.jsxs)("div",{className:"flex items-center",onClick:a=>a.stopPropagation(),children:[ac&&!a&&(0,b.jsx)(o.default,{defaultValue:!1,onChange:f.noop,disabled:!0,size:"md"}),ac&&a&&(0,b.jsxs)(b.Fragment,{children:[I?(0,b.jsx)(q.default,{popupContent:Q("list.action.enableWarning",{ns:"datasetDocuments"}),popupClassName:"!font-semibold",children:(0,b.jsx)("div",{children:(0,b.jsx)(o.default,{defaultValue:!1,onChange:f.noop,disabled:!0,size:"md"})})}):(0,b.jsx)(o.default,{defaultValue:H,onChange:a=>ae(a?"enable":"disable"),size:"md"}),(0,b.jsx)(l.default,{className:"!ml-4 !mr-2 !h-3",type:"vertical"})]}),a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q.default,{popupContent:Q("list.action.settings",{ns:"datasetDocuments"}),popupClassName:"text-text-secondary system-xs-medium",needsDelay:!1,children:(0,b.jsx)("button",{type:"button",className:(0,u.cn)("mr-2 cursor-pointer rounded-lg",ac?"p-0.5 hover:bg-state-base-hover":"border-[0.5px] border-components-button-secondary-border bg-components-button-secondary-bg p-2 shadow-xs shadow-shadow-shadow-3 backdrop-blur-[5px] hover:border-components-button-secondary-border-hover hover:bg-components-button-secondary-bg-hover"),onClick:()=>R.push(`/datasets/${x}/documents/${y.id}/settings`),children:(0,b.jsx)(c.RiEqualizer2Line,{className:"h-4 w-4 text-components-button-secondary-text"})})}),(0,b.jsx)(n.default,{htmlContent:(0,b.jsxs)("div",{className:"w-full py-1",children:[!I&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:w.default.actionItem,onClick:()=>{ak({id:y.id,name:y.name})},children:[(0,b.jsx)(c.RiEditLine,{className:"h-4 w-4 text-text-tertiary"}),(0,b.jsx)("span",{className:w.default.actionName,children:Q("list.table.rename",{ns:"datasetDocuments"})})]}),J===r.DataSourceType.FILE&&(0,b.jsxs)("div",{className:w.default.actionItem,onClick:a=>{a.preventDefault(),a.stopPropagation(),a.nativeEvent.stopImmediatePropagation?.(),am()},children:[(0,b.jsx)(c.RiDownload2Line,{className:"h-4 w-4 text-text-tertiary"}),(0,b.jsx)("span",{className:w.default.actionName,children:Q("list.action.download",{ns:"datasetDocuments"})})]}),["notion_import",r.DataSourceType.WEB].includes(J)&&(0,b.jsxs)("div",{className:w.default.actionItem,onClick:()=>ad("sync"),children:[(0,b.jsx)(c.RiLoopLeftLine,{className:"h-4 w-4 text-text-tertiary"}),(0,b.jsx)("span",{className:w.default.actionName,children:Q("list.action.sync",{ns:"datasetDocuments"})})]}),(0,b.jsxs)("div",{className:w.default.actionItem,onClick:()=>ad("summary"),children:[(0,b.jsx)(m.SearchLinesSparkle,{className:"h-4 w-4 text-text-tertiary"}),(0,b.jsx)("span",{className:w.default.actionName,children:Q("list.action.summary",{ns:"datasetDocuments"})})]}),(0,b.jsx)(l.default,{className:"my-1"})]}),I&&J===r.DataSourceType.FILE&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:w.default.actionItem,onClick:a=>{a.preventDefault(),a.stopPropagation(),a.nativeEvent.stopImmediatePropagation?.(),am()},children:[(0,b.jsx)(c.RiDownload2Line,{className:"h-4 w-4 text-text-tertiary"}),(0,b.jsx)("span",{className:w.default.actionName,children:Q("list.action.download",{ns:"datasetDocuments"})})]}),(0,b.jsx)(l.default,{className:"my-1"})]}),!I&&K?.toLowerCase()==="indexing"&&(0,b.jsxs)("div",{className:w.default.actionItem,onClick:()=>ad("pause"),children:[(0,b.jsx)(c.RiPauseCircleLine,{className:"h-4 w-4 text-text-tertiary"}),(0,b.jsx)("span",{className:w.default.actionName,children:Q("list.action.pause",{ns:"datasetDocuments"})})]}),!I&&K?.toLowerCase()==="paused"&&(0,b.jsxs)("div",{className:w.default.actionItem,onClick:()=>ad("resume"),children:[(0,b.jsx)(c.RiPlayCircleLine,{className:"h-4 w-4 text-text-tertiary"}),(0,b.jsx)("span",{className:w.default.actionName,children:Q("list.action.resume",{ns:"datasetDocuments"})})]}),!I&&(0,b.jsxs)("div",{className:w.default.actionItem,onClick:()=>ad("archive"),children:[(0,b.jsx)(c.RiArchive2Line,{className:"h-4 w-4 text-text-tertiary"}),(0,b.jsx)("span",{className:w.default.actionName,children:Q("list.action.archive",{ns:"datasetDocuments"})})]}),I&&(0,b.jsxs)("div",{className:w.default.actionItem,onClick:()=>ad("un_archive"),children:[(0,b.jsx)(c.RiArchive2Line,{className:"h-4 w-4 text-text-tertiary"}),(0,b.jsx)("span",{className:w.default.actionName,children:Q("list.action.unarchive",{ns:"datasetDocuments"})})]}),(0,b.jsxs)("div",{className:(0,u.cn)(w.default.actionItem,w.default.deleteActionItem,"group"),onClick:()=>M(!0),children:[(0,b.jsx)(c.RiDeleteBinLine,{className:"h-4 w-4 text-text-tertiary group-hover:text-text-destructive"}),(0,b.jsx)("span",{className:(0,u.cn)(w.default.actionName,"group-hover:text-text-destructive"),children:Q("list.action.delete",{ns:"datasetDocuments"})})]})]}),trigger:"click",position:"br",btnElement:(0,b.jsx)("div",{className:(0,u.cn)(w.default.commonIcon),children:(0,b.jsx)(c.RiMoreFill,{className:"h-4 w-4 text-components-button-secondary-text"})}),btnClassName:a=>(0,u.cn)(ac?w.default.actionIconWrapperList:w.default.actionIconWrapperDetail,a?"!hover:bg-state-base-hover !shadow-none":"!bg-transparent"),popupClassName:"!w-full",className:`!z-20 flex h-fit !w-[200px] justify-end ${E}`})]}),L&&(0,b.jsx)(k.default,{isShow:L,isLoading:N,isDisabled:N,title:Q("list.delete.title",{ns:"datasetDocuments"}),content:Q("list.delete.content",{ns:"datasetDocuments"}),confirmText:Q("operation.sure",{ns:"common"}),onConfirm:()=>ad("delete"),onCancel:()=>M(!1)}),ah&&af&&(0,b.jsx)(B,{datasetId:x,documentId:af.id,name:af.name,onClose:aj,onSaved:al})]})});a.s(["default",0,C],380794)}];

//# sourceMappingURL=_35f4f227._.js.map