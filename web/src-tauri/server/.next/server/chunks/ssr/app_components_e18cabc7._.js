module.exports=[774944,a=>{a.v({autoWidth:"style-module__Qu6CpW__autoWidth",close:"style-module__Qu6CpW__close",copied:"style-module__Qu6CpW__copied",copyIcon:"style-module__Qu6CpW__copyIcon",customApi:"style-module__Qu6CpW__customApi",customModal:"style-module__Qu6CpW__customModal",trash:"style-module__Qu6CpW__trash",trashIcon:"style-module__Qu6CpW__trashIcon",w64:"style-module__Qu6CpW__w64"})},972729,a=>{"use strict";var b=a.i(608061),c=a.i(911364),d=a.i(893500),e=a.i(429150),f=a.i(57843);a.i(752298);var g=a.i(693025),h=a.i(175809),i=a.i(909795),j=a.i(42550),k=a.i(748240),l=a.i(105249),m=a.i(940272),n=a.i(705134),o=a.i(98654),p=a.i(802066),q=a.i(218257),r=a.i(847733),s=a.i(926261),t=a.i(875067),u=a.i(934402),v=a.i(483664);let w=({value:a="",className:c,children:d})=>{let[e,g]=(0,f.useState)(!1);return(0,f.useEffect)(()=>{if(e){let a=setTimeout(()=>{g(!1)},1e3);return()=>{clearTimeout(a)}}},[e]),(0,b.jsx)("div",{className:`flex items-center rounded-lg bg-components-input-bg-normal py-2 hover:bg-state-base-hover ${c}`,children:(0,b.jsxs)("div",{className:"flex h-5 grow items-center",children:[d,(0,b.jsx)("div",{className:"relative h-full grow text-[13px]",children:(0,b.jsx)("div",{className:"r-0 absolute left-0 top-0 w-full cursor-pointer truncate pl-2 pr-2",onClick:()=>{(0,t.default)(a),g(!0)},children:(0,b.jsx)(v.default,{popupContent:e?`${(0,u.t)("copied",{ns:"appApi"})}`:`${(0,u.t)("copy",{ns:"appApi"})}`,position:"bottom",children:(0,b.jsx)("span",{className:"text-text-secondary",children:a})})})}),(0,b.jsx)("div",{className:"h-4 w-px shrink-0 bg-divider-regular"}),(0,b.jsx)("div",{className:"mx-1",children:(0,b.jsx)(k.default,{content:a})})]})})};var x=a.i(774944);let y=({isShow:a=!1,onClose:c,newKey:e,className:f})=>{let{t:h}=(0,g.useTranslation)();return(0,b.jsxs)(m.default,{isShow:a,onClose:c,title:`${h("apiKeyModal.apiSecretKey",{ns:"appApi"})}`,className:`px-8 ${f}`,children:[(0,b.jsx)("div",{className:"-mr-2 -mt-6 mb-4 flex justify-end",children:(0,b.jsx)(d.XMarkIcon,{className:"h-6 w-6 cursor-pointer text-text-tertiary",onClick:c})}),(0,b.jsx)("p",{className:"mt-1 text-[13px] font-normal leading-5 text-text-tertiary",children:h("apiKeyModal.generateTips",{ns:"appApi"})}),(0,b.jsx)("div",{className:"my-4",children:(0,b.jsx)(w,{className:"w-full",value:e?.token})}),(0,b.jsx)("div",{className:"my-4 flex justify-end",children:(0,b.jsx)(i.default,{className:`shrink-0 ${x.default.w64}`,onClick:c,children:(0,b.jsx)("span",{className:"text-xs font-medium text-text-secondary",children:h("actionMsg.ok",{ns:"appApi"})})})})]})};a.s(["default",0,({isShow:a=!1,appId:t,onClose:u})=>{let{t:v}=(0,g.useTranslation)(),{formatTime:w}=(0,o.default)(),{currentWorkspace:z,isCurrentWorkspaceManager:A,isCurrentWorkspaceEditor:B}=(0,n.useAppContext)(),[C,D]=(0,f.useState)(!1),[E,F]=(0,f.useState)(!1),[G,H]=(0,f.useState)(void 0),I=(0,s.useInvalidateAppApiKeys)(),J=(0,r.useInvalidateDatasetApiKeys)(),{data:K,isLoading:L}=(0,s.useAppApiKeys)(t,{enabled:!!t&&a}),{data:M,isLoading:N}=(0,r.useDatasetApiKeys)({enabled:!t&&a}),O=t?K:M,P=t?L:N,[Q,R]=(0,f.useState)(""),S=async()=>{if(D(!1),!Q)return;let a=t?p.delApikey:q.delApikey,b=t?{url:`/apps/${t}/api-keys/${Q}`,params:{}}:{url:`/datasets/api-keys/${Q}`,params:{}};await a(b),t?I(t):J()},T=async()=>{let a=t?{url:`/apps/${t}/api-keys`,body:{}}:{url:"/datasets/api-keys",body:{}},b=t?p.createApikey:q.createApikey,c=await b(a);F(!0),H(c),t?I(t):J()};return(0,b.jsxs)(m.default,{isShow:a,onClose:u,title:`${v("apiKeyModal.apiSecretKey",{ns:"appApi"})}`,className:`${x.default.customModal} flex flex-col px-8`,children:[(0,b.jsx)("div",{className:"-mr-2 -mt-6 mb-4 flex justify-end",children:(0,b.jsx)(d.XMarkIcon,{className:"h-6 w-6 cursor-pointer text-text-tertiary",onClick:u})}),(0,b.jsx)("p",{className:"mt-1 shrink-0 text-[13px] font-normal leading-5 text-text-tertiary",children:v("apiKeyModal.apiSecretKeyTips",{ns:"appApi"})}),P&&(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)(l.default,{})}),!!O?.data?.length&&(0,b.jsxs)("div",{className:"mt-4 flex grow flex-col overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex h-9 shrink-0 items-center border-b border-divider-regular text-xs font-semibold text-text-tertiary",children:[(0,b.jsx)("div",{className:"w-64 shrink-0 px-3",children:v("apiKeyModal.secretKey",{ns:"appApi"})}),(0,b.jsx)("div",{className:"w-[200px] shrink-0 px-3",children:v("apiKeyModal.created",{ns:"appApi"})}),(0,b.jsx)("div",{className:"w-[200px] shrink-0 px-3",children:v("apiKeyModal.lastUsed",{ns:"appApi"})}),(0,b.jsx)("div",{className:"grow px-3"})]}),(0,b.jsx)("div",{className:"grow overflow-auto",children:O.data.map(a=>{let c;return(0,b.jsxs)("div",{className:"flex h-9 items-center border-b border-divider-regular text-sm font-normal text-text-secondary",children:[(0,b.jsx)("div",{className:"w-64 shrink-0 truncate px-3 font-mono",children:(c=a.token,`${c.slice(0,3)}...${c.slice(-20)}`)}),(0,b.jsx)("div",{className:"w-[200px] shrink-0 truncate px-3",children:w(Number(a.created_at),v("dateTimeFormat",{ns:"appLog"}))}),(0,b.jsx)("div",{className:"w-[200px] shrink-0 truncate px-3",children:a.last_used_at?w(Number(a.last_used_at),v("dateTimeFormat",{ns:"appLog"})):v("never",{ns:"appApi"})}),(0,b.jsxs)("div",{className:"flex grow space-x-2 px-3",children:[(0,b.jsx)(k.default,{content:a.token}),A&&(0,b.jsx)(h.default,{onClick:()=>{R(a.id),D(!0)},children:(0,b.jsx)(e.RiDeleteBinLine,{className:"h-4 w-4"})})]})]},a.id)})})]}),(0,b.jsx)("div",{className:"flex",children:(0,b.jsxs)(i.default,{className:`mt-4 flex shrink-0 ${x.default.autoWidth}`,onClick:T,disabled:!z||!B,children:[(0,b.jsx)(c.PlusIcon,{className:"mr-1 flex h-4 w-4 shrink-0"}),(0,b.jsx)("div",{className:"text-xs font-medium text-text-secondary",children:v("apiKeyModal.createNewSecretKey",{ns:"appApi"})})]})}),(0,b.jsx)(y,{className:"shrink-0",isShow:E,onClose:()=>F(!1),newKey:G}),C&&(0,b.jsx)(j.default,{title:`${v("actionMsg.deleteConfirmTitle",{ns:"appApi"})}`,content:`${v("actionMsg.deleteConfirmTips",{ns:"appApi"})}`,isShow:C,onConfirm:S,onCancel:()=>{R(""),D(!1)}})]})}],972729)},340527,a=>{"use strict";var b=a.i(999578);a.s(["ApiAggregate",()=>b.default])},556476,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(111089),e=a.i(57843);a.i(752298);var f=a.i(693025),g=a.i(909795),h=a.i(816134),i=a.i(940272),j=a.i(146172),k=a.i(218257),l=a.i(527344),m=a.i(355968),n=a.i(429178),o=a.i(114715);a.s(["default",0,({show:a,dataset:p,onSuccess:q,onClose:r})=>{let{t:s}=(0,f.useTranslation)(),[t,u]=(0,e.useState)(!1),[v,w]=(0,e.useState)(p.name),[x,y]=(0,e.useState)(p.description),z=p.external_knowledge_info.external_knowledge_id,A=p.external_knowledge_info.external_knowledge_api_id,[B,C]=(0,e.useState)(p.icon_info?.icon_type==="image"?{type:"image",url:p.icon_info?.icon_url||"",fileId:p.icon_info?.icon||""}:{type:"emoji",icon:p.icon_info?.icon||"",background:p.icon_info?.icon_background||""}),[D,E]=(0,e.useState)(!1),F=(0,e.useRef)(p.icon_info?.icon_type==="image"?{type:"image",url:p.icon_info?.icon_url||"",fileId:p.icon_info?.icon||""}:{type:"emoji",icon:p.icon_info?.icon||"",background:p.icon_info?.icon_background||""}),G=(0,e.useCallback)(()=>{E(!0),F.current=B},[B]),H=(0,e.useCallback)(a=>{C(a),E(!1)},[]),I=(0,e.useCallback)(()=>{C(F.current),E(!1)},[]),J=(0,e.useCallback)(async()=>{if(!v.trim())return void o.default.notify({type:"error",message:s("form.nameError",{ns:"datasetSettings"})});try{u(!0);let a={name:v,description:x,icon_info:{icon:"image"===B.type?B.fileId:B.icon,icon_type:B.type,icon_background:"image"===B.type?void 0:B.background,icon_url:"image"===B.type?B.url:void 0}};z&&A&&(a.external_knowledge_id=z,a.external_knowledge_api_id=A),await (0,k.updateDatasetSetting)({datasetId:p.id,body:a}),o.default.notify({type:"success",message:s("actionMsg.modifiedSuccessfully",{ns:"common"})}),q&&q(),r()}catch{o.default.notify({type:"error",message:s("actionMsg.modifiedUnsuccessfully",{ns:"common"})})}finally{u(!1)}},[B,x,p.id,A,z,v,r,q,s]);return(0,b.jsxs)(i.default,{className:"w-[520px] max-w-[520px] rounded-xl px-8 py-6",isShow:a,onClose:d.noop,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between pb-2",children:[(0,b.jsx)("div",{className:"text-xl font-medium leading-[30px] text-text-primary",children:s("title",{ns:"datasetSettings"})}),(0,b.jsx)("div",{className:"cursor-pointer p-2",onClick:r,children:(0,b.jsx)(c.RiCloseLine,{className:"h-4 w-4 text-text-tertiary"})})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:(0,l.cn)("flex flex-col py-4"),children:[(0,b.jsx)("div",{className:"shrink-0 py-2 text-sm font-medium leading-[20px] text-text-primary",children:s("form.name",{ns:"datasetSettings"})}),(0,b.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,b.jsx)(m.default,{size:"medium",onClick:G,className:"cursor-pointer",iconType:B.type,icon:"image"===B.type?B.fileId:B.icon,background:"image"===B.type?void 0:B.background,imageUrl:"image"===B.type?B.url:void 0,showEditIcon:!0}),(0,b.jsx)(h.default,{value:v,onChange:a=>w(a.target.value),className:"h-9 grow",placeholder:s("form.namePlaceholder",{ns:"datasetSettings"})||""})]})]}),(0,b.jsxs)("div",{className:(0,l.cn)("flex flex-col py-4"),children:[(0,b.jsx)("div",{className:"shrink-0 py-2 text-sm font-medium leading-[20px] text-text-primary",children:s("form.desc",{ns:"datasetSettings"})}),(0,b.jsx)("div",{className:"w-full",children:(0,b.jsx)(j.default,{value:x,onChange:a=>y(a.target.value),className:"resize-none",placeholder:s("form.descPlaceholder",{ns:"datasetSettings"})||""})})]})]}),(0,b.jsxs)("div",{className:"flex justify-end pt-6",children:[(0,b.jsx)(g.default,{className:"mr-2",onClick:r,children:s("operation.cancel",{ns:"common"})}),(0,b.jsx)(g.default,{disabled:t,variant:"primary",onClick:J,children:s("operation.save",{ns:"common"})})]}),D&&(0,b.jsx)(n.default,{onSelect:H,onClose:I})]})}])}];

//# sourceMappingURL=app_components_e18cabc7._.js.map