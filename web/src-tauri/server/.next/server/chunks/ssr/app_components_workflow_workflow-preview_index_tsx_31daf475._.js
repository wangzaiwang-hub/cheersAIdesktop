module.exports=[653621,a=>{"use strict";var b,c=a.i(608061),d=a.i(57843),e=a.i(628238),f=a.i(970502),g=a.i(180612),h=a.i(119359),i=a.i(252613),j=a.i(665982),k=a.i(700173),l=a.i(778322),m=a.i(262717),n=a.i(739642),o=a.i(455495),p=a.i(527344),q=a.i(113168),r=a.i(935533),s=a.i(735310);a.i(713310);var t=a.i(753066);let u=(0,d.memo)(({id:a,data:b,sourceHandleId:e,sourceX:g,sourceY:h,targetX:i,targetY:j,selected:k})=>{let[l]=(0,f.getBezierPath)({sourceX:g-8,sourceY:h,sourcePosition:f.Position.Right,targetX:i+8,targetY:j,targetPosition:f.Position.Left,curvature:.16}),{_sourceRunningStatus:m,_targetRunningStatus:n}=b,o=(0,d.useMemo)(()=>{if((m===s.NodeRunningStatus.Succeeded||m===s.NodeRunningStatus.Failed||m===s.NodeRunningStatus.Exception)&&(n===s.NodeRunningStatus.Succeeded||n===s.NodeRunningStatus.Failed||n===s.NodeRunningStatus.Exception||n===s.NodeRunningStatus.Running))return a},[m,n,a]),p=(0,d.useMemo)(()=>k?(0,t.getEdgeColor)(s.NodeRunningStatus.Running):o?`url(#${o})`:b?._connectedNodeIsHovering?(0,t.getEdgeColor)(s.NodeRunningStatus.Running,e===r.ErrorHandleTypeEnum.failBranch):(0,t.getEdgeColor)(),[b._connectedNodeIsHovering,o,k,e]);return(0,c.jsxs)(c.Fragment,{children:[o&&(0,c.jsx)(q.default,{id:o,startColor:(0,t.getEdgeColor)(m),stopColor:(0,t.getEdgeColor)(n),position:{x1:g,y1:h,x2:i,y2:j}}),(0,c.jsx)(f.BaseEdge,{id:a,path:l,style:{stroke:p,strokeWidth:2,opacity:b._waitingRun?.7:1}})]})});a.i(752298);var v=a.i(693025),w=a.i(483664),x=a.i(438961),y=a.i(381045);let z=(0,d.memo)(({data:a,handleId:b,handleClassName:d})=>{let e=a._connectedTargetHandleIds?.includes(b);return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(f.Handle,{id:b,type:"target",position:f.Position.Left,className:(0,p.cn)("z-[1] !h-4 !w-4 !rounded-none !border-none !bg-transparent !outline-none","after:absolute after:left-1.5 after:top-1 after:h-2 after:w-0.5 after:bg-workflow-link-line-handle","transition-all hover:scale-125",!e&&"after:opacity-0",(a.type===s.BlockEnum.Start||a.type===s.BlockEnum.TriggerWebhook||a.type===s.BlockEnum.TriggerSchedule||a.type===s.BlockEnum.TriggerPlugin)&&"opacity-0",d)})})});z.displayName="NodeTargetHandle";let A=(0,d.memo)(({data:a,handleId:b,handleClassName:d})=>{let e=a._connectedSourceHandleIds?.includes(b);return(0,c.jsx)(f.Handle,{id:b,type:"source",position:f.Position.Right,className:(0,p.cn)("group/handle z-[1] !h-4 !w-4 !rounded-none !border-none !bg-transparent !outline-none","after:absolute after:right-1.5 after:top-1 after:h-2 after:w-0.5 after:bg-workflow-link-line-handle","transition-all hover:scale-125",!e&&"after:opacity-0",d)})});A.displayName="NodeSourceHandle";let B=({id:a,data:b})=>{let{t:e}=(0,v.useTranslation)(),{error_strategy:g}=b,h=(0,f.useUpdateNodeInternals)();return((0,d.useEffect)(()=>{g===r.ErrorHandleTypeEnum.failBranch&&h(a)},[g,a,h]),g)?(0,c.jsx)("div",{className:"relative px-3 pb-2 pt-1",children:(0,c.jsxs)("div",{className:(0,p.cn)("relative flex h-6 items-center justify-between rounded-md bg-workflow-block-parma-bg px-[5px]",b._runningStatus===s.NodeRunningStatus.Exception&&"border-[0.5px] border-components-badge-status-light-warning-halo bg-state-warning-hover"),children:[(0,c.jsx)("div",{className:"system-xs-medium-uppercase text-text-tertiary",children:e("common.onFailure",{ns:"workflow"})}),(0,c.jsxs)("div",{className:(0,p.cn)("system-xs-medium text-text-secondary",b._runningStatus===s.NodeRunningStatus.Exception&&"text-text-warning"),children:[g===r.ErrorHandleTypeEnum.defaultValue&&e("nodes.common.errorHandle.defaultValue.output",{ns:"workflow"}),g===r.ErrorHandleTypeEnum.failBranch&&e("nodes.common.errorHandle.failBranch.title",{ns:"workflow"})]}),g===r.ErrorHandleTypeEnum.failBranch&&(0,c.jsx)(A,{id:a,data:b,handleId:r.ErrorHandleTypeEnum.failBranch,handleClassName:"!top-1/2 !-right-[21px] !-translate-y-1/2 after:!bg-workflow-link-line-failure-button-bg"})]})}):null},C=(0,d.memo)(({id:a,data:b,children:e})=>{let{t:f}=(0,v.useTranslation)();return(0,c.jsx)("div",{className:(0,p.cn)("flex rounded-2xl border-[2px] border-transparent"),style:{width:b.type===s.BlockEnum.Iteration||b.type===s.BlockEnum.Loop?b.width:"auto",height:b.type===s.BlockEnum.Iteration||b.type===s.BlockEnum.Loop?b.height:"auto"},children:(0,c.jsxs)("div",{className:(0,p.cn)("group relative pb-1 shadow-xs","rounded-[15px] border border-transparent","bg-workflow-block-bg hover:shadow-lg"),style:{width:b.type===s.BlockEnum.Iteration||b.type===s.BlockEnum.Loop?b.width:"240px",height:b.type===s.BlockEnum.Iteration||b.type===s.BlockEnum.Loop?b.height:"auto"},children:[(0,c.jsxs)("div",{className:(0,p.cn)("flex items-center rounded-t-2xl px-3 pb-2 pt-3"),children:[(0,c.jsx)(z,{id:a,data:b,handleClassName:"!top-4 !-left-[9px] !translate-y-0",handleId:"target"}),b.type!==s.BlockEnum.IfElse&&b.type!==s.BlockEnum.QuestionClassifier&&(0,c.jsx)(A,{id:a,data:b,handleClassName:"!top-4 !-right-[9px] !translate-y-0",handleId:"source"}),(0,c.jsx)(x.default,{className:"mr-2 shrink-0",type:b.type,size:"md"}),(0,c.jsxs)("div",{title:b.title,className:"system-sm-semibold-uppercase mr-1 flex grow items-center truncate text-text-primary",children:[(0,c.jsx)("div",{children:b.title}),b.type===s.BlockEnum.Iteration&&b.is_parallel&&(0,c.jsx)(w.default,{popupContent:(0,c.jsxs)("div",{className:"w-[180px]",children:[(0,c.jsx)("div",{className:"font-extrabold",children:f("nodes.iteration.parallelModeEnableTitle",{ns:"workflow"})}),f("nodes.iteration.parallelModeEnableDesc",{ns:"workflow"})]}),children:(0,c.jsx)("div",{className:"system-2xs-medium-uppercase ml-1 flex items-center justify-center rounded-[5px] border-[1px] border-text-warning px-[5px] py-[3px] text-text-warning ",children:f("nodes.iteration.parallelModeUpper",{ns:"workflow"})})})]})]}),b.type!==s.BlockEnum.Iteration&&b.type!==s.BlockEnum.Loop&&e&&(0,d.cloneElement)(e,{id:a,data:b}),(b.type===s.BlockEnum.Iteration||b.type===s.BlockEnum.Loop)&&e&&(0,c.jsx)("div",{className:"h-[calc(100%-42px)] w-full grow pb-1 pl-1 pr-1",children:(0,d.cloneElement)(e,{id:a,data:b})}),(0,y.hasErrorHandleNode)(b.type)&&(0,c.jsx)(B,{id:a,data:b}),b.desc&&b.type!==s.BlockEnum.Iteration&&b.type!==s.BlockEnum.Loop&&(0,c.jsx)("div",{className:"system-xs-regular whitespace-pre-line break-words px-3 pb-2 pt-1 text-text-tertiary",children:b.desc})]})})});var D=a.i(54362),E=a.i(482646),F=a.i(198536);let G="nodes.ifElse",H=d.memo(a=>{let{data:b}=a,{t:e}=(0,v.useTranslation)(),{cases:f}=b,g=f.length,h=(0,d.useCallback)(a=>!!a.variable_selector&&0!==a.variable_selector.length&&(a.sub_variable_condition?a.sub_variable_condition.conditions.every(a=>!!a.comparison_operator&&(!!(0,F.isEmptyRelatedOperator)(a.comparison_operator)||!!a.value)):!!(0,F.isEmptyRelatedOperator)(a.comparison_operator)||!!a.value),[]),i=(0,c.jsx)("div",{className:"flex h-6 items-center space-x-1 rounded-md bg-workflow-block-parma-bg px-1 text-xs font-normal text-text-secondary",children:e(`${G}.conditionNotSetup`,{ns:"workflow"})});return(0,c.jsxs)("div",{className:"px-3",children:[f.map((b,d)=>(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"relative flex h-6 items-center px-1",children:[(0,c.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,c.jsx)("div",{className:"text-[10px] font-semibold text-text-tertiary",children:g>1&&`CASE ${d+1}`}),(0,c.jsx)("div",{className:"text-[12px] font-semibold text-text-secondary",children:0===d?"IF":"ELIF"})]}),(0,c.jsx)(A,{...a,handleId:b.case_id,handleClassName:"!top-1/2 !-right-[21px] !-translate-y-1/2"})]}),(0,c.jsx)("div",{className:"space-y-0.5",children:b.conditions.map((a,d)=>(0,c.jsxs)("div",{className:"relative",children:[h(a)?!(0,F.isEmptyRelatedOperator)(a.comparison_operator)&&a.sub_variable_condition?(0,c.jsx)(D.default,{condition:a}):(0,c.jsx)(E.default,{variableSelector:a.variable_selector,operator:a.comparison_operator,value:a.value}):i,d!==b.conditions.length-1&&(0,c.jsx)("div",{className:"absolute bottom-[-10px] right-1 z-10 text-[10px] font-medium uppercase leading-4 text-text-accent",children:e(`${G}.${b.logical_operator}`,{ns:"workflow"})})]},a.id))})]},b.case_id)),(0,c.jsxs)("div",{className:"relative flex h-6 items-center px-1",children:[(0,c.jsx)("div",{className:"w-full text-right text-xs font-semibold text-text-secondary",children:"ELSE"}),(0,c.jsx)(A,{...a,handleId:"false",handleClassName:"!top-1/2 !-right-[21px] !-translate-y-1/2"})]})]})}),I=(0,d.memo)(({id:a})=>{let{zoom:b}=(0,f.useViewport)();return(0,c.jsx)("div",{className:(0,p.cn)("relative h-full min-h-[90px] w-full min-w-[240px] rounded-2xl bg-workflow-canvas-workflow-bg"),children:(0,c.jsx)(g.Background,{id:`iteration-background-${a}`,className:"!z-0 rounded-2xl",gap:[14/b,14/b],size:2/b,color:"var(--color-workflow-canvas-workflow-dot-color)"})})});var J=a.i(494261);let K=(0,d.memo)(({id:a,data:b})=>{let e,{zoom:h}=(0,f.useViewport)(),j=(0,f.useNodesInitialized)(),{handleNodeLoopRerender:k}=(e=(0,f.useStoreApi)(),{handleNodeLoopRerender:(0,d.useCallback)(a=>{let b,c,{getNodes:d,setNodes:f}=e.getState(),g=d(),h=g.find(b=>b.id===a);g.filter(b=>b.parentId===a).forEach(a=>{b?a.position.x+a.width>b.position.x+b.width&&(b=a):b=a,c?a.position.y+a.height>c.position.y+c.height&&(c=a):c=a});let j=b&&h.width<b.position.x+b.width,k=c&&h.height<c.position.y+c.height;(j||k)&&f((0,J.produce)(g,d=>{d.forEach(d=>{d.id===a&&(j&&(d.data.width=b.position.x+b.width+i.LOOP_PADDING.right,d.width=b.position.x+b.width+i.LOOP_PADDING.right),k&&(d.data.height=c.position.y+c.height+i.LOOP_PADDING.bottom,d.height=c.position.y+c.height+i.LOOP_PADDING.bottom))})}))},[e])});return(0,d.useEffect)(()=>{j&&k(a)},[j,a,k]),(0,c.jsx)("div",{className:(0,p.cn)("relative h-full min-h-[90px] w-full min-w-[240px] rounded-2xl bg-workflow-canvas-workflow-bg"),children:(0,c.jsx)(g.Background,{id:`loop-background-${a}`,className:"!z-0 rounded-2xl",gap:[14/h,14/h],size:2/h,color:"var(--color-workflow-canvas-workflow-dot-color)"})})});var L=a.i(7855);let M=d.memo(a=>{let{t:b}=(0,v.useTranslation)(),{data:d}=a,e=d.classes;return(0,c.jsx)("div",{className:"mb-1 px-3 py-1",children:!!e.length&&(0,c.jsx)("div",{className:"mt-2 space-y-0.5",children:e.map((d,e)=>(0,c.jsxs)("div",{className:"relative",children:[(0,c.jsx)(L.default,{title:`${b("nodes.questionClassifiers.class",{ns:"workflow"})} ${e+1}`,content:""}),(0,c.jsx)(A,{...a,handleId:d.id,handleClassName:"!top-1/2 !-translate-y-1/2 !-right-[21px]"})]},e))})})}),N={[s.BlockEnum.QuestionClassifier]:M,[s.BlockEnum.IfElse]:H,[s.BlockEnum.Iteration]:I,[s.BlockEnum.Loop]:K},O=a=>{let b=N[a.data.type];return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(C,{...a,children:b&&(0,c.jsx)(b,{})})})};var P=a.i(429150);let Q=(0,d.memo)(({id:a,data:b})=>{let{t:d}=(0,v.useTranslation)();return(0,c.jsxs)("div",{className:"nodrag group mt-1 flex h-11 w-11 items-center justify-center rounded-2xl border border-workflow-block-border bg-workflow-block-bg shadow-xs",children:[(0,c.jsx)(w.default,{popupContent:d("blocks.iteration-start",{ns:"workflow"}),asChild:!1,children:(0,c.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full border-[0.5px] border-components-panel-border-subtle bg-util-colors-blue-brand-blue-brand-500",children:(0,c.jsx)(P.RiHome5Fill,{className:"h-3 w-3 text-text-primary-on-surface"})})}),(0,c.jsx)(A,{id:a,data:b,handleClassName:"!top-1/2 !-right-[9px] !-translate-y-1/2",handleId:"source"})]})}),R=(0,d.memo)(({id:a,data:b})=>{let{t:d}=(0,v.useTranslation)();return(0,c.jsxs)("div",{className:"nodrag group mt-1 flex h-11 w-11 items-center justify-center rounded-2xl border border-workflow-block-border bg-workflow-block-bg",children:[(0,c.jsx)(w.default,{popupContent:d("blocks.loop-start",{ns:"workflow"}),asChild:!1,children:(0,c.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full border-[0.5px] border-components-panel-border-subtle bg-util-colors-blue-brand-blue-brand-500",children:(0,c.jsx)(P.RiHome5Fill,{className:"h-3 w-3 text-text-primary-on-surface"})})}),(0,c.jsx)(A,{id:a,data:b,handleClassName:"!top-1/2 !-right-[9px] !-translate-y-1/2",handleId:"source"})]})});a.i(727323);var S=a.i(747867),T=a.i(11364);let U=(0,d.memo)(({data:a})=>{let{t:b}=(0,v.useTranslation)(),e=(0,d.useRef)(null),f=a.theme;return(0,c.jsx)("div",{className:(0,p.cn)("relative flex flex-col rounded-md border shadow-xs hover:shadow-md",m.THEME_MAP[f].bg,a.selected?m.THEME_MAP[f].border:"border-black/5"),style:{width:a.width,height:a.height},ref:e,children:(0,c.jsx)(T.NoteEditorContextProvider,{value:a.text,editable:!1,children:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:(0,p.cn)("h-2 shrink-0 rounded-t-md opacity-50",m.THEME_MAP[f].title)}),(0,c.jsx)("div",{className:"grow overflow-y-auto px-3 py-2.5",children:(0,c.jsx)("div",{className:(0,p.cn)(a.selected&&"nodrag nopan nowheel cursor-text"),children:(0,c.jsx)(S.NoteEditor,{containerElement:e.current,placeholder:b("nodes.note.editor.placeholder",{ns:"workflow"})||""})})}),a.showAuthor&&(0,c.jsx)("div",{className:"p-3 pt-0 text-xs text-text-tertiary",children:a.author})]})})})});var V=a.i(757801),W=a.i(825319),X=a.i(208346),Y=a.i(56328),Z=((b=Z||{}).zoomIn="zoomIn",b.zoomOut="zoomOut",b.zoomToFit="zoomToFit",b.zoomTo25="zoomTo25",b.zoomTo50="zoomTo50",b.zoomTo75="zoomTo75",b.zoomTo100="zoomTo100",b.zoomTo200="zoomTo200",b);let $=(0,d.memo)(()=>{let{t:a}=(0,v.useTranslation)(),{zoomIn:b,zoomOut:e,zoomTo:g,fitView:h}=(0,f.useReactFlow)(),{zoom:i}=(0,f.useViewport)(),[j,k]=(0,d.useState)(!1),l=[[{key:"zoomTo200",text:"200%"},{key:"zoomTo100",text:"100%"},{key:"zoomTo75",text:"75%"},{key:"zoomTo50",text:"50%"},{key:"zoomTo25",text:"25%"}],[{key:"zoomToFit",text:a("operator.zoomToFit",{ns:"workflow"})}]],m=(0,d.useCallback)(()=>{k(a=>!a)},[]);return(0,c.jsxs)(W.PortalToFollowElem,{placement:"top-start",open:j,onOpenChange:k,offset:{mainAxis:4,crossAxis:-2},children:[(0,c.jsx)(W.PortalToFollowElemTrigger,{asChild:!0,children:(0,c.jsx)("div",{className:(0,p.cn)("h-9 cursor-pointer rounded-lg border-[0.5px] border-components-actionbar-border bg-components-actionbar-bg","p-0.5 text-[13px] shadow-lg backdrop-blur-[5px]","hover:bg-state-base-hover"),children:(0,c.jsxs)("div",{className:(0,p.cn)("flex h-8 w-[98px] items-center justify-between rounded-lg"),children:[(0,c.jsx)(X.default,{title:a("operator.zoomOut",{ns:"workflow"}),shortcuts:["ctrl","-"],children:(0,c.jsx)("div",{className:`flex h-8 w-8 items-center justify-center rounded-lg ${i<=.25?"cursor-not-allowed":"cursor-pointer hover:bg-black/5"}`,onClick:a=>{i<=.25||(a.stopPropagation(),e())},children:(0,c.jsx)(P.RiZoomOutLine,{className:"h-4 w-4 text-text-tertiary hover:text-text-secondary"})})}),(0,c.jsxs)("div",{onClick:m,className:(0,p.cn)("system-sm-medium w-[34px] text-text-tertiary hover:text-text-secondary"),children:[Number.parseFloat(`${100*i}`).toFixed(0),"%"]}),(0,c.jsx)(X.default,{title:a("operator.zoomIn",{ns:"workflow"}),shortcuts:["ctrl","+"],children:(0,c.jsx)("div",{className:`flex h-8 w-8 items-center justify-center rounded-lg ${i>=2?"cursor-not-allowed":"cursor-pointer hover:bg-black/5"}`,onClick:a=>{i>=2||(a.stopPropagation(),b())},children:(0,c.jsx)(P.RiZoomInLine,{className:"h-4 w-4 text-text-tertiary hover:text-text-secondary"})})})]})})}),(0,c.jsx)(W.PortalToFollowElemContent,{className:"z-10",children:(0,c.jsx)("div",{className:"w-[145px] rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur shadow-lg backdrop-blur-[5px]",children:l.map((a,b)=>(0,c.jsxs)(d.Fragment,{children:[0!==b&&(0,c.jsx)(V.default,{className:"m-0"}),(0,c.jsx)("div",{className:"p-1",children:a.map(a=>(0,c.jsxs)("div",{className:"system-md-regular flex h-8 cursor-pointer items-center justify-between space-x-1 rounded-lg py-1.5 pl-3 pr-2 text-text-secondary hover:bg-state-base-hover",onClick:()=>{var b;"zoomToFit"===(b=a.key)&&h(),"zoomTo25"===b&&g(.25),"zoomTo50"===b&&g(.5),"zoomTo75"===b&&g(.75),"zoomTo100"===b&&g(1),"zoomTo200"===b&&g(2)},children:[(0,c.jsx)("span",{children:a.text}),(0,c.jsxs)("div",{className:"flex items-center space-x-0.5",children:["zoomToFit"===a.key&&(0,c.jsx)(Y.default,{keys:["ctrl","1"]}),"zoomTo50"===a.key&&(0,c.jsx)(Y.default,{keys:["shift","5"]}),"zoomTo100"===a.key&&(0,c.jsx)(Y.default,{keys:["shift","1"]})]})]},a.key))})]},b))})})]})}),_={[i.CUSTOM_NODE]:O,[m.CUSTOM_NOTE_NODE]:U,[n.CUSTOM_SIMPLE_NODE]:O,[k.CUSTOM_ITERATION_START_NODE]:Q,[l.CUSTOM_LOOP_START_NODE]:R},aa={[i.CUSTOM_EDGE]:u},ab=({nodes:a,edges:b,viewport:k,className:l,miniMapToRight:m})=>{let[n,q]=(0,d.useState)(()=>(0,o.initialNodes)(a,b)),[r,s]=(0,d.useState)(()=>(0,o.initialEdges)(b,a)),t=(0,d.useCallback)(a=>q(b=>(0,f.applyNodeChanges)(a,b)),[]),u=(0,d.useCallback)(a=>s(b=>(0,f.applyEdgeChanges)(a,b)),[]);return(0,c.jsxs)("div",{id:"workflow-container",className:(0,p.cn)("relative h-full w-full",l),children:[(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(h.MiniMap,{pannable:!0,zoomable:!0,style:{width:102,height:72},maskColor:"var(--color-workflow-minimap-bg)",className:(0,p.cn)("!absolute !bottom-14 z-[9] !m-0 !h-[72px] !w-[102px] !rounded-lg !border-[0.5px] !border-divider-subtle !bg-background-default-subtle !shadow-md !shadow-shadow-shadow-5",m?"!right-4":"!left-4")}),(0,c.jsx)("div",{className:"absolute bottom-4 left-4 z-[9] mt-1 flex items-center gap-2",children:(0,c.jsx)($,{})})]}),(0,c.jsx)(e.default,{nodeTypes:_,edgeTypes:aa,nodes:n,onNodesChange:t,edges:r,onEdgesChange:u,connectionLineComponent:j.default,connectionLineContainerStyle:{zIndex:i.ITERATION_CHILDREN_Z_INDEX},defaultViewport:k,multiSelectionKeyCode:null,deleteKeyCode:null,nodesDraggable:!0,nodesConnectable:!1,nodesFocusable:!1,edgesFocusable:!1,panOnScroll:!1,selectionKeyCode:null,selectionMode:f.SelectionMode.Partial,minZoom:.25,children:(0,c.jsx)(g.Background,{gap:[14,14],size:2,className:"bg-workflow-canvas-workflow-bg",color:"var(--color-workflow-canvas-workflow-dot-color)"})})]})};a.s(["default",0,a=>(0,c.jsx)(f.ReactFlowProvider,{children:(0,c.jsx)(ab,{...a})})],653621)}];

//# sourceMappingURL=app_components_workflow_workflow-preview_index_tsx_31daf475._.js.map