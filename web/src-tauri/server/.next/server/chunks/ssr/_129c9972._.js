module.exports=[634919,a=>{"use strict";var b=a.i(195547);a.s(["Variable02",()=>b.default])},986963,988526,752370,656100,485198,782606,597839,284284,a=>{"use strict";var b,c=a.i(562168),d=a.i(494261),e=a.i(252613);a.i(207642);var f=a.i(315680),g=a.i(735310);a.i(713310);var h=a.i(34624),i=a.i(763539);let j=a=>null!==a&&"object"==typeof a,k=function(a,b){let c=(a,b)=>{let d=j(a),e=j(b);if(!d)return!0;if(!e){for(let b in a)if("type"===b||j(a[b])&&!c(a[b],null))return!1;return!0}let f=a.type,g=b.type,h=j(f);if(!h&&f!==g)return!1;for(let d of new Set([...Object.keys(a),...Object.keys(b)]))if(("type"!==d||h)&&!c(a[d],b[d]))return!1;return!0};return c(a,b)},l=(a,b)=>{if(!b||null==a)return"";let c=b.find(b=>k(a,b.schema));return c?c.name:""};a.s(["default",0,()=>{let{data:a,isLoading:b}=(0,i.useSchemaTypeDefinitions)();return{isLoading:b,schemaTypeDefinitions:a}},"getMatchedSchemaType",0,l],988526);let m=[{name:"datasource_type",type:g.VarType.string,description:"local_file, online_document, website_crawl"}],n=[{name:"file",type:g.VarType.file,description:"file",subItems:[{name:"name",type:g.VarType.string,description:"file name"},{name:"size",type:g.VarType.number,description:"file size"},{name:"type",type:g.VarType.string,description:"file type"},{name:"extension",type:g.VarType.string,description:"file extension"},{name:"mime_type",type:g.VarType.string,description:"file mime type"},{name:"transfer_method",type:g.VarType.string,description:"file transfer method"},{name:"url",type:g.VarType.string,description:"file url"},{name:"related_id",type:g.VarType.string,description:"file related id"}]}];a.s(["COMMON_OUTPUT",0,m,"LOCAL_FILE_OUTPUT",0,n],752370);var o=a.i(446941),p=((b={}).localFile="local_file",b.websiteCrawl="website_crawl",b.onlineDocument="online_document",b.onlineDrive="online_drive",b);a.s(["DataSourceClassification",()=>p],656100);let q="errorMsg",r={metaData:(0,h.genNodeMetaData)({sort:-1,type:g.BlockEnum.DataSource,isStart:!0,isRequired:!0}),defaultValue:{datasource_parameters:{},datasource_configurations:{}},checkValid(a,b,c){let{dataSourceInputsSchema:d,notAuthed:e}=c,g="";return e&&(g=b(`${q}.authRequired`,{ns:"workflow"})),g||d.filter(a=>a.required).forEach(c=>{let d=a.datasource_parameters[c.variable];if(!d){g=b(`${q}.fieldRequired`,{ns:"workflow",field:c.label});return}let{type:e,value:h}=d;e===f.VarType.variable?g||h&&0!==h.length||(g=b(`${q}.fieldRequired`,{ns:"workflow",field:c.label})):g||null!=h&&""!==h||(g=b(`${q}.fieldRequired`,{ns:"workflow",field:c.label}))}),{isValid:!g,errorMessage:g}},getOutputVars(a,b,c=[],{schemaTypeDefinitions:d}={schemaTypeDefinitions:[]}){let{plugin_id:e,datasource_name:f,provider_type:g}=a,h=g===p.localFile,i=b.dataSourceList?.find(a=>a.plugin_id===e),j=i?.tools?.find(a=>a.name===f),k=j?.output_schema,o=[];return k?.properties&&Object.keys(k.properties).forEach(a=>{let b=k.properties[a],c=b.type,e="array"===c?`array[${b.items?.type.slice(0,1).toLocaleLowerCase()}${b.items?.type.slice(1)}]`:`${c.slice(0,1).toLocaleLowerCase()}${c.slice(1)}`,f=l?.(b,d);"object"===e&&"file"===f&&(e="file"),o.push({variable:a,type:e,description:b.description,schemaType:f,children:"object"===b.type?{schema:{type:"object",properties:b.properties}}:void 0})}),[...m.map(a=>({variable:a.name,type:a.type})),...h?n.map(a=>({variable:a.name,type:a.type})):[],...c,...o]}};a.s(["default",0,r],485198);var s=a.i(28959),t=a.i(459858),u=a.i(193390);let v=a=>{if(!a)return;let{type:b,properties:c,items:d,oneOf:e,anyOf:f,allOf:g}=a;if(Array.isArray(b))return b.find(a=>a&&"null"!==a)||b[0];if("string"==typeof b)return b;for(let a of[e,f,g].filter(a=>Array.isArray(a)).flat()){let b=v(a);if(b)return b}return c?"object":d?"array":void 0},w=(a,b)=>{let c=l(a,b);switch(v(a)){case"string":return{type:g.VarType.string,schemaType:c};case"number":return{type:g.VarType.number,schemaType:c};case"integer":return{type:g.VarType.integer,schemaType:c};case"boolean":return{type:g.VarType.boolean,schemaType:c};case"object":if("file"===c)return{type:g.VarType.file,schemaType:c};return{type:g.VarType.object,schemaType:c};case"array":{let d=(a=>{if(a&&a.items)return Array.isArray(a.items)?a.items[0]:a.items})(a);if(!d)return{type:g.VarType.array,schemaType:c};let{type:e,schemaType:f}=w(d,b),h=c||f;if("file"===f)return{type:g.VarType.arrayFile,schemaType:h};switch(e){case g.VarType.string:return{type:g.VarType.arrayString,schemaType:h};case g.VarType.number:case g.VarType.integer:return{type:g.VarType.arrayNumber,schemaType:h};case g.VarType.boolean:return{type:g.VarType.arrayBoolean,schemaType:h};case g.VarType.object:return{type:g.VarType.arrayObject,schemaType:h};case g.VarType.file:return{type:g.VarType.arrayFile,schemaType:h};default:return{type:g.VarType.array,schemaType:h}}}default:return{type:g.VarType.any,schemaType:c}}},x="errorMsg",y={metaData:(0,h.genNodeMetaData)({sort:-1,type:g.BlockEnum.Tool,helpLinkUri:"tools"}),defaultValue:{tool_parameters:{},tool_configurations:{},tool_node_version:"2"},checkValid(a,b,c){let{toolInputsSchema:d,toolSettingSchema:e,language:g,notAuthed:h}=c,i="";return h&&(i=b(`${x}.authRequired`,{ns:"workflow"})),i||d.filter(a=>a.required).forEach(c=>{let d=a.tool_parameters[c.variable];if(!d){i=b(`${x}.fieldRequired`,{ns:"workflow",field:c.label});return}let{type:e,value:g}=d;e===f.VarType.variable?i||g&&0!==g.length||(i=b(`${x}.fieldRequired`,{ns:"workflow",field:c.label})):i||null!=g&&""!==g||(i=b(`${x}.fieldRequired`,{ns:"workflow",field:c.label}))}),i||e.filter(a=>a.required).forEach(c=>{let d=a.tool_configurations[c.variable];i||null!=d&&""!==d||(i=b(`${x}.fieldRequired`,{ns:"workflow",field:c.label[g]})),!i&&"object"==typeof d&&d.type&&(void 0===d.value||null===d.value||""===d.value||Array.isArray(d.value)&&0===d.value.length)&&(i=b(`${x}.fieldRequired`,{ns:"workflow",field:c.label[g]}))}),{isValid:!i,errorMessage:i}},getOutputVars(a,b,c,{schemaTypeDefinitions:d}={schemaTypeDefinitions:[]}){let{provider_id:f,provider_type:g}=a,h=[];switch(g){case s.CollectionType.builtIn:h=b.buildInTools??[];break;case s.CollectionType.custom:h=b.customTools??[];break;case s.CollectionType.workflow:h=b.workflowTools??[];break;case s.CollectionType.mcp:h=b.mcpTools??[];break;default:h=[]}let i=h.find(a=>(0,t.canFindTool)(a.id,f)),j=i?.tools.find(b=>b.name===a.tool_name),k=j?.output_schema,l=[];if(k&&k.properties){let a=[];Object.keys(k.properties).forEach(b=>{let c=k.properties[b],{type:e,schemaType:f}=w(c,d);a.push({variable:b,type:e,des:c.description,schemaType:f,children:"object"===c.type?{schema:{type:u.Type.object,properties:c.properties,additionalProperties:!1}}:void 0})}),l=[...e.TOOL_OUTPUT_STRUCT,...a]}else l=e.TOOL_OUTPUT_STRUCT;return l}};a.s(["default",0,y],782606);let z=a=>{if(!a)return;let{type:b,properties:c,items:d,oneOf:e,anyOf:f,allOf:g}=a;if(Array.isArray(b))return b.find(a=>a&&"null"!==a)||b[0];if("string"==typeof b)return b;for(let a of[e,f,g].filter(a=>Array.isArray(a)).flat()){let b=z(a);if(b)return b}return c?"object":d?"array":void 0},A=a=>{if(a&&a.items)return Array.isArray(a.items)?a.items[0]:a.items},B=(a,b)=>{if(!a)return;let c=a.schema_type||a.schemaType;if("string"==typeof c&&c.trim().length>0)return c},C=(a,b)=>{let c=B(a,b);switch(z(a)){case"string":return{type:g.VarType.string,schemaType:c};case"number":return{type:g.VarType.number,schemaType:c};case"integer":return{type:g.VarType.integer,schemaType:c};case"boolean":return{type:g.VarType.boolean,schemaType:c};case"object":return{type:g.VarType.object,schemaType:c};case"array":{let d=A(a);if(!d)return{type:g.VarType.array,schemaType:c};let{type:e,schemaType:f}=C(d,b),h=c||f;if("file"===f)return{type:g.VarType.arrayFile,schemaType:h};switch(e){case g.VarType.string:return{type:g.VarType.arrayString,schemaType:h};case g.VarType.number:case g.VarType.integer:return{type:g.VarType.arrayNumber,schemaType:h};case g.VarType.boolean:return{type:g.VarType.arrayBoolean,schemaType:h};case g.VarType.object:return{type:g.VarType.arrayObject,schemaType:h};case g.VarType.file:return{type:g.VarType.arrayFile,schemaType:h};default:return{type:g.VarType.array,schemaType:h}}}default:return{type:g.VarType.any,schemaType:c}}},D=(a,b)=>{let c=B(a,b),d=((a,b)=>{if("file"===b)return"array"===a?u.Type.array:u.Type.file;switch(a){case"number":case"integer":return u.Type.number;case"boolean":return u.Type.boolean;case"object":return u.Type.object;case"array":return u.Type.array;default:return u.Type.string}})(z(a),c),e={type:d};if(a?.description&&(e.description=a.description),c&&(e.schemaType=c),Array.isArray(a?.enum)&&(e.enum=a.enum),d===u.Type.object){e.properties=Object.entries(a?.properties||{}).reduce((a,[c,d])=>(a[c]=D(d,b),a),{});let c=Array.isArray(a?.required)?a.required.filter(Boolean):void 0;e.required=c&&c.length>0?c:void 0,e.additionalProperties=!1}if(d===u.Type.array){let c=A(a);if(c){let{type:a,...d}=D(c,b);e.items={...d,type:a===u.Type.array?u.Type.object:a}}}return e},E={metaData:(0,h.genNodeMetaData)({sort:1,type:g.BlockEnum.TriggerPlugin,helpLinkUri:"trigger/plugin-trigger",isStart:!0}),defaultValue:{plugin_id:"",event_name:"",event_parameters:{},config:{}},checkValid(a,b,c={}){let d="";a.subscription_id||(d=b("nodes.triggerPlugin.subscriptionRequired",{ns:"workflow"}));let{triggerInputsSchema:e=[],isReadyForCheckValid:f=!0}=c||{};return!d&&f&&e.filter(a=>a.required).forEach(c=>{if(d)return;let e=a.event_parameters?.[c.variable]??a.config?.[c.variable];if(!e){d=b("errorMsg.fieldRequired",{ns:"workflow",field:c.label});return}let{type:f,value:g}="object"==typeof e&&null!==e&&"type"in e?e:{type:o.VarKindType.constant,value:e};f===o.VarKindType.variable?(!g||Array.isArray(g)&&0===g.length)&&(d=b("errorMsg.fieldRequired",{ns:"workflow",field:c.label})):(null==g||""===g||Array.isArray(g)&&0===g.length)&&(d=b("errorMsg.fieldRequired",{ns:"workflow",field:c.label}))}),{isValid:!d,errorMessage:d}},getOutputVars(a,b,c,{schemaTypeDefinitions:d}={schemaTypeDefinitions:[]}){var e=a.output_schema||{};if(!e||"object"!=typeof e)return[];let f=e.properties;return f?Object.entries(f).map(([a,b])=>{let{type:c,schemaType:e}=C(b,d),f=z(b),g={variable:a,type:c,des:b?.description,...e?{schemaType:e}:{}};if("object"===f){let a=b?.properties?Object.entries(b.properties).reduce((a,[b,c])=>(a[b]=D(c,d),a),{}):{},c=Array.isArray(b?.required)?b.required.filter(Boolean):void 0;g.children={schema:{type:u.Type.object,properties:a,required:c&&c.length>0?c:void 0,additionalProperties:!1}}}return g}):[]}};a.s(["default",0,E],597839);var F=a.i(18039),G=a.i(954200);let H=[{value:G.TransferMethod.local_file,i18nKey:"localUpload"},{value:G.TransferMethod.remote_url,i18nKey:"url"}],I=["type","size","name","url","extension","mime_type","transfer_method","related_id"],J=I.filter(a=>"transfer_method"!==a);a.s(["FILE_TYPE_OPTIONS",0,[{value:"image",i18nKey:"image"},{value:"document",i18nKey:"doc"},{value:"audio",i18nKey:"audio"},{value:"video",i18nKey:"video"}],"OUTPUT_FILE_SUB_VARIABLES",0,J,"SUB_VARIABLES",0,I,"TRANSFER_METHOD",0,H],284284);let K=a=>"sys"===a[0]||"sys"===a[1],L=a=>!(!K(a)||["query","files"].includes(a[1])),M=a=>"env"===a[0],N=a=>"conversation"===a[0],O=a=>!!a&&"rag"===a[0],P=a=>["sys","env","conversation","rag"].includes(a),Q=a=>a&&(Array.isArray(a)&&a.length>0||!Array.isArray(a)&&Object.keys(a?.schema?.properties||{}).length>0),R=a=>({[g.InputVarType.number]:g.VarType.number,[g.InputVarType.checkbox]:g.VarType.boolean,[g.InputVarType.singleFile]:g.VarType.file,[g.InputVarType.multiFiles]:g.VarType.arrayFile,[g.InputVarType.jsonObject]:g.VarType.object})[a]||g.VarType.string,S=(a,b)=>b?({[u.Type.string]:g.VarType.arrayString,[u.Type.number]:g.VarType.arrayNumber,[u.Type.object]:g.VarType.arrayObject})[a]||g.VarType.string:({[u.Type.string]:g.VarType.string,[u.Type.number]:g.VarType.number,[u.Type.boolean]:g.VarType.boolean,[u.Type.object]:g.VarType.object,[u.Type.array]:g.VarType.array})[a]||g.VarType.string,T=(a,b)=>(0,d.produce)(a,c=>(Object.keys(a).forEach(c=>{let d=a[c],e=d.type===u.Type.object,f=d.type===u.Type.array,g=d.items?.type;e||b({variable:c,type:S(f?g:d.type,f)},[c])?d.type===u.Type.object&&d.properties&&(d.properties=T(d.properties,b)):delete a[c]}),c)),U=(a,b,c,e)=>{let f,{children:h}=a;if(h?.schema?.properties)f=(0,d.produce)(h,a=>{let c=a.schema.properties;return Object.keys(c).forEach(a=>{let d=c[a],e=d.type===u.Type.object,f=d.type===u.Type.array,g=d.items?.type;e||b({variable:a,type:S(f?g:d.type,f)},[a])?d.type===u.Type.object&&d.properties&&(d.properties=T(d.properties,b)):delete c[a]}),a});else f=Array.isArray(h)?h.map(a=>{let d,{children:e}=a,f=[...c,a.variable];if(!e)return{item:a,filteredObj:null,passesFilter:b(a,f)};let h=U(a,b,f,!1),i=Q(h.children);return d=(a.type===g.VarType.object||a.type===g.VarType.file)&&e?i||b(a,f):i,{item:a,filteredObj:h,passesFilter:d}}).filter(({passesFilter:a})=>a).map(({item:a,filteredObj:b})=>{let{children:c}=a;return c&&b?{...a,children:b.children}:a}):[];return{variable:a.variable,type:e?g.VarType.file:g.VarType.object,children:f,schemaType:a.schemaType}},V=(a,b,c=(a,b)=>!0,d=[],f=[],h=[],i,j)=>{let k={id:"global",data:{title:"SYSTEM",type:"global",globalVarList:(0,e.getGlobalVars)(b)}},l={id:"rag",data:{title:"SHARED INPUTS",type:"rag",ragVariables:h.filter(a=>"shared"===a.belong_to_node_id)}};return[...[...a].sort((a,b)=>a.data.type===g.BlockEnum.Start?1:b.data.type===g.BlockEnum.Start?-1:"env"===a.data.type?1:"env"===b.data.type?-1:"conversation"===a.data.type?1:"conversation"===b.data.type?-1:"global"===a.data.type?1:"global"===b.data.type?-1:(b.position?.x||0)-(a.position?.x||0)).filter(a=>e.SUPPORT_OUTPUT_VARS_NODE.includes(a?.data?.type)),...d.length>0?[{id:"env",data:{title:"ENVIRONMENT",type:"env",envList:d}}]:[],...b&&f.length>0?[{id:"conversation",data:{title:"CONVERSATION",type:"conversation",chatVarList:f}}]:[],k,...l.data.ragVariables.length>0?[l]:[]].map(a=>{let d=[];return a.data.type===g.BlockEnum.DataSource&&(d=h.filter(b=>b.belong_to_node_id===a.id)),{...((a,b,c,d,f,h=[])=>{let{id:i,data:j}=a,k={nodeId:i,title:j.title,vars:[]};switch(j.type){case g.BlockEnum.Start:{let{variables:a}=j;k.vars=a.map(a=>{let b=R(a.type),c={variable:a.variable,type:b,isParagraph:a.type===g.InputVarType.paragraph,isSelect:a.type===g.InputVarType.select,options:a.options,required:a.required};try{b===g.VarType.object&&a.json_schema&&(c.children={schema:"string"==typeof a.json_schema?JSON.parse(a.json_schema):a.json_schema})}catch(a){console.error("Error formatting variable:",a)}return c}),b&&k.vars.push({variable:"sys.query",type:g.VarType.string}),k.vars.push({variable:"sys.files",type:g.VarType.arrayFile});break}case g.BlockEnum.TriggerWebhook:{let{variables:a=[]}=j;k.vars=a.map(a=>{let b=a.value_type||g.VarType.string;return{variable:a.variable,type:b,isParagraph:!1,isSelect:!1,options:a.options,required:a.required}});break}case g.BlockEnum.LLM:k.vars=[...e.LLM_OUTPUT_STRUCT],j.structured_output_enabled&&j.structured_output?.schema?.properties&&Object.keys(j.structured_output.schema.properties).length>0&&k.vars.push({variable:"structured_output",type:g.VarType.object,children:j.structured_output});break;case g.BlockEnum.KnowledgeRetrieval:k.vars=e.KNOWLEDGE_RETRIEVAL_OUTPUT_STRUCT;break;case g.BlockEnum.Code:{let{outputs:a}=j;k.vars=a?Object.keys(a).map(b=>({variable:b,type:a[b].type})):[];break}case g.BlockEnum.TemplateTransform:k.vars=e.TEMPLATE_TRANSFORM_OUTPUT_STRUCT;break;case g.BlockEnum.QuestionClassifier:k.vars=e.QUESTION_CLASSIFIER_OUTPUT_STRUCT;break;case g.BlockEnum.HttpRequest:k.vars=e.HTTP_REQUEST_OUTPUT_STRUCT;break;case g.BlockEnum.VariableAssigner:{let{output_type:a,advanced_settings:b}=j;b?.group_enabled?k.vars=b?.groups.map(a=>({variable:a.group_name,type:g.VarType.object,children:[{variable:"output",type:a.output_type}]})):k.vars=[{variable:"output",type:a}];break}case g.BlockEnum.VariableAggregator:{let{output_type:a,advanced_settings:b}=j;b?.group_enabled?k.vars=b?.groups.map(a=>({variable:a.group_name,type:g.VarType.object,children:[{variable:"output",type:a.output_type}]})):k.vars=[{variable:"output",type:a}];break}case g.BlockEnum.Tool:k.vars=y.getOutputVars?.(j,d,[],{schemaTypeDefinitions:h})||[];break;case g.BlockEnum.ParameterExtractor:k.vars=[...(j.parameters||[]).map(a=>({variable:a.name,type:a.type})),...e.PARAMETER_EXTRACTOR_COMMON_STRUCT];break;case g.BlockEnum.Iteration:k.vars=[{variable:"output",type:j.output_type||g.VarType.arrayString}];break;case g.BlockEnum.Loop:{let{loop_variables:a}=j;k.isLoop=!0,k.vars=a?.map(a=>({variable:a.label,type:a.var_type,isLoopVariable:!0,nodeId:k.nodeId}))||[];break}case g.BlockEnum.DocExtractor:k.vars=[{variable:"text",type:j.is_array_file?g.VarType.arrayString:g.VarType.string}];break;case g.BlockEnum.ListFilter:if(!j.var_type)break;k.vars=[{variable:"result",type:j.var_type},{variable:"first_record",type:j.item_var_type},{variable:"last_record",type:j.item_var_type}];break;case g.BlockEnum.Agent:{let a=[];Object.keys(j.output_schema?.properties||{}).forEach(b=>{let c=j.output_schema.properties[b];a.push({variable:b,type:"array"===c.type?`Array[${c.items?.type?c.items.type.slice(0,1).toLocaleUpperCase()+c.items.type.slice(1):"Unknown"}]`:`${c.type?c.type.slice(0,1).toLocaleUpperCase()+c.type.slice(1):"Unknown"}`})}),k.vars=[...a,...e.TOOL_OUTPUT_STRUCT,...e.AGENT_OUTPUT_STRUCT];break}case g.BlockEnum.DataSource:k.vars=r.getOutputVars?.(j,d,f,{schemaTypeDefinitions:h})||[];break;case g.BlockEnum.TriggerPlugin:k.vars=E.getOutputVars?.(j,d,[],{schemaTypeDefinitions:h})||[];break;case"env":k.vars=j.envList.map(a=>({variable:`env.${a.name}`,type:a.value_type,description:a.description}));break;case"conversation":k.vars=j.chatVarList.map(a=>({variable:`conversation.${a.name}`,type:a.value_type,description:a.description}));break;case"global":k.vars=j.globalVarList;break;case"rag":k.vars=j.ragVariables.map(a=>({variable:`rag.shared.${a.variable}`,type:R(a.type),des:a.label,isRagVariable:!0}))}let{error_strategy:l}=j;l&&(k.vars=[...k.vars,{variable:"error_message",type:g.VarType.string,isException:!0},{variable:"error_type",type:g.VarType.string,isException:!0}]);let m=[i];return k.vars=k.vars.filter(a=>{if(c(a,(()=>{let b=a.variable.split("."),[c]=b;return P(c)?b:[...m,...b]})()))return!0;let b=a.type===g.VarType.file,d=b?J.map(a=>{let b=e.FILE_STRUCT.find(b=>b.variable===a);return{variable:a,type:b?.type||g.VarType.string}}):a.children;if(!d)return!1;let f=U(b?{...a,children:d}:a,c,m,b);return Q(f?.children)}).map(a=>{let b=a.type===g.VarType.file,{children:d}=b?{children:J.map(a=>{let b=e.FILE_STRUCT.find(b=>b.variable===a);return{variable:a,type:b?.type||g.VarType.string}})}:a;return d?U(b?{...a,children:d}:a,c,m,b):a}),k})(a,b,c,i,d.map(b=>({variable:`rag.${a.id}.${b.variable}`,type:R(b.type),description:b.label,isRagVariable:!0})),j),isStartNode:a.data.type===g.BlockEnum.Start}}).filter(a=>a.vars.length>0)},W=({valueSelector:a,beforeNodesOutputVars:b})=>{let c=a[0],d=K(a),e=N(a),f=d?b.find(a=>a.isStartNode):b.find(a=>a.nodeId===c);if(!f)return g.VarType.string;let h=g.VarType.string,i=f.vars;if(d||e)h=i.find(b=>b.variable===a.join("."))?.type;else for(let b=1;b<a.length;b++){let c=a[b],d=b===a.length-1;i=Array.isArray(i)?i.find(a=>a.variable===c):[],d?h=i?.type:(i?.type===g.VarType.object||i?.type===g.VarType.file)&&(i=i.children||[])}switch(h){case g.VarType.arrayString:return g.VarType.string;case g.VarType.arrayNumber:return g.VarType.number;case g.VarType.arrayBoolean:return g.VarType.boolean;case g.VarType.arrayObject:return g.VarType.object;case g.VarType.array:return g.VarType.arrayObject;case g.VarType.arrayFile:return g.VarType.file;default:return g.VarType.string}},X=({valueSelector:a,beforeNodesOutputVars:b})=>{let c=a[0],d=K(a),e=d?b.find(a=>a.isStartNode):b.find(a=>a.nodeId===c);if(!e)return g.VarType.string;let f=g.VarType.string,h=e.vars;switch(d?f=h.find(b=>b.variable===a.join("."))?.type:a.slice(1).forEach((b,c)=>{let d=c===a.length-2;h=h?.find(a=>a.variable===b),d?f=h?.type:(h?.type===g.VarType.object||h?.type===g.VarType.file)&&(h=h.children)}),f){case g.VarType.arrayString:return g.VarType.string;case g.VarType.arrayNumber:return g.VarType.number;case g.VarType.arrayObject:return g.VarType.object;case g.VarType.arrayBoolean:return g.VarType.boolean;case g.VarType.array:return g.VarType.any;case g.VarType.arrayFile:return g.VarType.file;default:return g.VarType.string}},Y=({parentNode:a,valueSelector:b,isIterationItem:c,isLoopItem:d,availableNodes:e,isChatMode:f,isConstant:h,environmentVariables:i=[],conversationVariables:j=[],ragVariables:k=[],allPluginInfoList:l,schemaTypeDefinitions:m,preferSchemaType:n})=>{if(h)return g.VarType.string;let o=V(e,f,void 0,i,j,k,l,m),p=a?.data.type===g.BlockEnum.Iteration;if(c)return W({valueSelector:b,beforeNodesOutputVars:o});if(p){if("item"===b[1])return W({valueSelector:a?.data?.iterator_selector||[],beforeNodesOutputVars:o});if("index"===b[1])return g.VarType.number}let q=a?.data.type===g.BlockEnum.Loop;if(d)return X({valueSelector:b,beforeNodesOutputVars:o});if(q){if("item"===b[1])return X({valueSelector:a?.data?.iterator_selector||[],beforeNodesOutputVars:o});if("index"===b[1])return g.VarType.number}let r=L(b),s=K(b)&&!r,t=M(b),u=N(b),v=O(b)&&"shared"===b[1],w=O(b)&&"shared"!==b[1],x=e.find(a=>a?.data.type===g.BlockEnum.Start),y=s?x?.id:r?"global":w?b[1]:b[0],z=o.find(a=>a.nodeId===y);if(!z)return g.VarType.string;let A=g.VarType.string,B=z.vars;if(s||t||u||v||r)return B.find(a=>a.variable===b.join("."))?.type;{let a=B.find(a=>w?a.variable===b.join("."):a.variable===b[1]);if(!a)return g.VarType.string;if(w)return a.type;if(a.children?.schema?.properties){if(2===b.length)return n&&a.schemaType?a.schemaType:g.VarType.object;let c=a.children.schema;return b.slice(2).forEach((a,d)=>{let e=d===b.length-3;c&&(c=c.properties[a],e&&(A=S(c?.type)))}),A}return b.slice(1).forEach((a,c)=>{let d=c===b.length-2;Array.isArray(B)&&(B=B?.find(b=>b.variable===a)),d?A=n&&B?.schemaType?B?.schemaType:B?.type:(B?.type===g.VarType.object||B?.type===g.VarType.file)&&(B=B.children)}),A}},Z=a=>{if(!a)return[];let b=[];return a.forEach(a=>{F.VAR_REGEX.lastIndex=0,"string"==typeof a&&b.push(...a.match(F.VAR_REGEX)||[])}),(0,c.uniq)(b).map(a=>a.replaceAll("{{#","").replace("#}}","").split("."))},$=(a,b,c)=>a&&"string"==typeof a&&c&&0!==c.length?a.replaceAll(`{{#${b.join(".")}#}}`,`{{#${c.join(".")}#}}`):a,_=a=>{let{data:b}=a,{type:c}=b,d=[];switch(c){case g.BlockEnum.End:d=b.outputs?.map(a=>a.value_selector);break;case g.BlockEnum.Answer:d=Z([b.answer]);break;case g.BlockEnum.LLM:{let a=b.model?.mode===G.AppModeEnum.CHAT,c=[];a?(c=b.prompt_template?.map(a=>a.text)||[],b.memory?.query_prompt_template&&c.push(b.memory.query_prompt_template)):c=[b.prompt_template.text],d=[...Z(c),...b.context?.variable_selector?[b.context?.variable_selector]:[]];break}case g.BlockEnum.KnowledgeRetrieval:{let{query_variable_selector:a,query_attachment_selector:c=[]}=b;d=[a,c];break}case g.BlockEnum.IfElse:(d=[]).push(...(b.cases||[]).flatMap(a=>a.conditions||[]).flatMap(a=>{let b=[];return a.variable_selector&&b.push(a.variable_selector),a.sub_variable_condition&&a.sub_variable_condition.conditions&&b.push(...a.sub_variable_condition.conditions.map(a=>a.variable_selector||[]).filter(a=>a.length>0)),b}));break;case g.BlockEnum.Code:d=b.variables?.map(a=>a.value_selector);break;case g.BlockEnum.TemplateTransform:d=b.variables?.map(a=>a.value_selector);break;case g.BlockEnum.QuestionClassifier:{d=[b.query_variable_selector];let a=Z([b.instruction||""]);d.push(...a);let c=b.classes.map(a=>a.name);d.push(...Z(c));break}case g.BlockEnum.HttpRequest:d=Z([b.url,b.headers,b.params,"string"==typeof b.body.data?b.body.data:b.body.data.map(a=>a.value).join("")]);break;case g.BlockEnum.Tool:d=[...Z(Object.keys(b.tool_parameters)?.filter(a=>b.tool_parameters[a].type===f.VarType.mixed).map(a=>b.tool_parameters[a].value)),...Object.keys(b.tool_parameters).filter(a=>b.tool_parameters[a].type===f.VarType.variable).map(a=>b.tool_parameters[a].value)||[]];break;case g.BlockEnum.DataSource:d=[...Z(Object.keys(b.datasource_parameters)?.filter(a=>b.datasource_parameters[a].type===f.VarType.mixed).map(a=>b.datasource_parameters[a].value)),...Object.keys(b.datasource_parameters).filter(a=>b.datasource_parameters[a].type===f.VarType.variable).map(a=>b.datasource_parameters[a].value)||[]];break;case g.BlockEnum.VariableAssigner:case g.BlockEnum.VariableAggregator:d=b?.variables;break;case g.BlockEnum.ParameterExtractor:{d=[b.query];let a=Z([b.instruction||""]);d.push(...a);break}case g.BlockEnum.Iteration:d=[b.iterator_selector];break;case g.BlockEnum.Loop:d=b.break_conditions?.map(a=>a.variable_selector||[])||[];break;case g.BlockEnum.ListFilter:d=[b.variable];break;case g.BlockEnum.Agent:{let a=[];if(!b.agent_parameters)break;Object.keys(b.agent_parameters||{}).forEach(c=>{let{value:d}=b.agent_parameters[c];"string"==typeof d&&a.push(...Z([d]))}),d=a}}return d||[]},aa=(a,b,c)=>{if(!a.variable)return;c.push([...b,a.variable]);let d=!!a.children?.schema?.properties;a.children?.length>0&&a.children.forEach(d=>{aa(d,[...b,a.variable],c)}),d&&Object.keys(a.children?.schema?.properties||{}).forEach(d=>{let e=a.children?.schema?.properties[d].type,f=e===u.Type.array,g=a.children?.schema?.properties[d].items?.type;aa({variable:d,type:S(f?g:e,f)},[...b,a.variable],c)})},ab=(a,b,c)=>{Array.isArray(a)&&a.forEach(a=>{aa(a,b,c)}),aa(a,b,c)};a.s(["findUsedVarNodes",0,(a,b)=>{let c=[];return b.forEach(b=>{_(b).find(b=>b.join(".")===a.join("."))&&c.push(b)}),c},"getNodeInfoById",0,(a,b)=>{if(Array.isArray(a))return a.find(a=>a.id===b)},"getNodeOutputVars",0,(a,b)=>{let{data:c,id:d}=a,{type:f}=c,h=[];switch(f){case g.BlockEnum.Start:{let{variables:a}=c;h=a.map(a=>[d,a.variable]),b&&(h.push([d,"sys","query"]),h.push([d,"sys","files"]));break}case g.BlockEnum.LLM:{let a=[...e.LLM_OUTPUT_STRUCT];c.structured_output_enabled&&c.structured_output?.schema?.properties&&Object.keys(c.structured_output.schema.properties).length>0&&a.push({variable:"structured_output",type:g.VarType.object,children:c.structured_output}),ab(a,[d],h);break}case g.BlockEnum.KnowledgeRetrieval:ab(e.KNOWLEDGE_RETRIEVAL_OUTPUT_STRUCT,[d],h);break;case g.BlockEnum.Code:{let{outputs:a}=c;Object.keys(a).forEach(a=>{h.push([d,a])});break}case g.BlockEnum.TemplateTransform:ab(e.TEMPLATE_TRANSFORM_OUTPUT_STRUCT,[d],h);break;case g.BlockEnum.QuestionClassifier:ab(e.QUESTION_CLASSIFIER_OUTPUT_STRUCT,[d],h);break;case g.BlockEnum.HttpRequest:ab(e.HTTP_REQUEST_OUTPUT_STRUCT,[d],h);break;case g.BlockEnum.VariableAssigner:case g.BlockEnum.VariableAggregator:h.push([d,"output"]);break;case g.BlockEnum.Tool:ab(e.TOOL_OUTPUT_STRUCT,[d],h);break;case g.BlockEnum.ParameterExtractor:{let{parameters:a}=c;a?.length>0&&a.forEach(a=>{h.push([d,a.name])});break}case g.BlockEnum.Iteration:case g.BlockEnum.Loop:h.push([d,"output"]);break;case g.BlockEnum.DocExtractor:h.push([d,"text"]);break;case g.BlockEnum.ListFilter:h.push([d,"result"]),h.push([d,"first_record"]),h.push([d,"last_record"])}return h},"getNodeUsedVarPassToServerKey",0,(a,b)=>{let{data:c}=a,{type:d}=c,e="";switch(d){case g.BlockEnum.LLM:e=[`#${b.join(".")}#`],c.context?.variable_selector.join(".")===b.join(".")&&e.push("#context#");break;case g.BlockEnum.KnowledgeRetrieval:e="query";break;case g.BlockEnum.IfElse:{let a=c=>{for(let d of c)for(let c of d.conditions||[]){if(c.variable_selector?.join(".")===b.join("."))return c;if(c.sub_variable_condition){let b=a([c.sub_variable_condition]);if(b)return b}}};a(c.cases||[])&&(e=`#${b.join(".")}#`);break}case g.BlockEnum.Code:{let a=c.variables?.find(a=>Array.isArray(a.value_selector)&&a.value_selector&&a.value_selector.join(".")===b.join("."));a&&(e=a.variable);break}case g.BlockEnum.TemplateTransform:{let a=c.variables?.find(a=>Array.isArray(a.value_selector)&&a.value_selector&&a.value_selector.join(".")===b.join("."));a&&(e=a.variable);break}case g.BlockEnum.QuestionClassifier:e="query";break;case g.BlockEnum.HttpRequest:case g.BlockEnum.Tool:case g.BlockEnum.VariableAssigner:case g.BlockEnum.VariableAggregator:e=`#${b.join(".")}#`;break;case g.BlockEnum.ParameterExtractor:e="query"}return e},"getNodeUsedVars",0,_,"getVarType",0,Y,"inputVarTypeToVarType",0,R,"isConversationVar",0,N,"isENV",0,M,"isGlobalVar",0,L,"isRagVariableVar",0,O,"isSpecialVar",0,P,"isSystemVar",0,K,"removeFileVars",0,a=>a.map(a=>({...a,vars:a.vars.filter(a=>a.type!==g.VarType.file&&a.type!==g.VarType.arrayFile)})).filter(a=>a.vars.length>0),"toNodeAvailableVars",0,({parentNode:a,t:b,beforeNodes:c,isChatMode:d,environmentVariables:e,conversationVariables:f,ragVariables:h,filterVar:i,allPluginInfoList:j,schemaTypeDefinitions:k})=>{let l=V(c,d,i,e,f,h,j,k);if(a?.data.type===g.BlockEnum.Iteration){let h=Y({parentNode:a,isIterationItem:!0,valueSelector:a?.data.iterator_selector||[],availableNodes:c,isChatMode:d,environmentVariables:e,conversationVariables:f,allPluginInfoList:j,schemaTypeDefinitions:k}),i=h===g.VarType.file?{children:J.map(a=>({variable:a,type:"size"===a?g.VarType.number:g.VarType.string}))}:{},m={nodeId:a?.id,title:b("nodes.iteration.currentIteration",{ns:"workflow"}),vars:[{variable:"item",type:h,...i},{variable:"index",type:g.VarType.number}]},n=l.findIndex(b=>b.nodeId===a?.id);n>-1&&l.splice(n,1),l.unshift(m)}return l},"toNodeOutputVars",0,V,"updateNodeVars",0,(a,b,c)=>(0,d.produce)(a,a=>{let{data:d}=a,{type:e}=d;switch(e){case g.BlockEnum.End:d.outputs&&(d.outputs=d.outputs.map(a=>(a.value_selector.join(".")===b.join(".")&&(a.value_selector=c),a)));break;case g.BlockEnum.Answer:d.variables&&(d.variables=d.variables.map(a=>(a.value_selector.join(".")===b.join(".")&&(a.value_selector=c),a)));break;case g.BlockEnum.LLM:d.model?.mode===G.AppModeEnum.CHAT?(d.prompt_template=d.prompt_template.map(a=>({...a,text:$(a.text,b,c)})),d.memory?.query_prompt_template&&(d.memory.query_prompt_template=$(d.memory.query_prompt_template,b,c))):d.prompt_template={...d.prompt_template,text:$(d.prompt_template.text,b,c)},d.context?.variable_selector?.join(".")===b.join(".")&&(d.context.variable_selector=c);break;case g.BlockEnum.KnowledgeRetrieval:d.query_variable_selector.join(".")===b.join(".")&&(d.query_variable_selector=c),d.query_attachment_selector?.join(".")===b.join(".")&&(d.query_attachment_selector=c);break;case g.BlockEnum.IfElse:d.cases&&(d.cases=d.cases.map(a=>(a.conditions&&(a.conditions=a.conditions.map(a=>(a.variable_selector?.join(".")===b.join(".")&&(a.variable_selector=c),a.sub_variable_condition&&a.sub_variable_condition.conditions&&(a.sub_variable_condition.conditions=a.sub_variable_condition.conditions.map(a=>(a.variable_selector?.join(".")===b.join(".")&&(a.variable_selector=c),a))),a))),a)));break;case g.BlockEnum.Code:d.variables&&(d.variables=d.variables.map(a=>(a.value_selector.join(".")===b.join(".")&&(a.value_selector=c),a)));break;case g.BlockEnum.TemplateTransform:d.variables&&(d.variables=d.variables.map(a=>(a.value_selector.join(".")===b.join(".")&&(a.value_selector=c),a)));break;case g.BlockEnum.QuestionClassifier:d.query_variable_selector.join(".")===b.join(".")&&(d.query_variable_selector=c),d.instruction=$(d.instruction,b,c);break;case g.BlockEnum.HttpRequest:d.url=$(d.url,b,c),d.headers=$(d.headers,b,c),d.params=$(d.params,b,c),"string"==typeof d.body.data?d.body.data=$(d.body.data,b,c):d.body.data=d.body.data.map(a=>({...a,value:$(a.value||"",b,c)}));break;case g.BlockEnum.Tool:Object.keys(d.tool_parameters)?.filter(a=>d.tool_parameters[a].type!==f.VarType.constant)&&Object.keys(d.tool_parameters).forEach(a=>{let e=d.tool_parameters[a],{type:g}=e;g===f.VarType.variable&&e.value.join(".")===b.join(".")&&(d.tool_parameters[a]={...e,value:c}),g===f.VarType.mixed&&(d.tool_parameters[a]={...e,value:$(d.tool_parameters[a].value,b,c)})});break;case g.BlockEnum.DataSource:Object.keys(d.datasource_parameters)?.filter(a=>d.datasource_parameters[a].type!==f.VarType.constant)&&Object.keys(d.datasource_parameters).forEach(a=>{let e=d.datasource_parameters[a],{type:g}=e;g===f.VarType.variable&&e.value.join(".")===b.join(".")&&(d.datasource_parameters[a]={...e,value:c}),g===f.VarType.mixed&&(d.datasource_parameters[a]={...e,value:$(d.datasource_parameters[a].value,b,c)})});break;case g.BlockEnum.VariableAssigner:d.variables&&(d.variables=d.variables.map(a=>(a.join(".")===b.join(".")&&(a=c),a)));break;case g.BlockEnum.VariableAggregator:d.variables&&(d.variables=d.variables.map(a=>(a.join(".")===b.join(".")&&(a=c),a)));break;case g.BlockEnum.ParameterExtractor:d.query.join(".")===b.join(".")&&(d.query=c),d.instruction=$(d.instruction,b,c);break;case g.BlockEnum.Iteration:d.iterator_selector.join(".")===b.join(".")&&(d.iterator_selector=c);break;case g.BlockEnum.Loop:d.break_conditions&&(d.break_conditions=d.break_conditions.map(a=>(a.variable_selector?.join(".")===b.join(".")&&(a.variable_selector=c),a)));break;case g.BlockEnum.ListFilter:d.variable.join(".")===b.join(".")&&(d.variable=c)}}),"varTypeToStructType",0,a=>({[g.VarType.string]:u.Type.string,[g.VarType.number]:u.Type.number,[g.VarType.boolean]:u.Type.boolean,[g.VarType.object]:u.Type.object,[g.VarType.array]:u.Type.array,[g.VarType.arrayString]:u.Type.array,[g.VarType.arrayNumber]:u.Type.array,[g.VarType.arrayObject]:u.Type.array,[g.VarType.arrayFile]:u.Type.array})[a]||u.Type.string],986963)},262717,447968,a=>{"use strict";var b,c=((b={}).blue="blue",b.cyan="cyan",b.green="green",b.yellow="yellow",b.pink="pink",b.violet="violet",b);a.s(["NoteTheme",()=>c],447968);let d={[c.blue]:{outer:"border-util-colors-blue-blue-500",title:"bg-util-colors-blue-blue-100",bg:"bg-util-colors-blue-blue-50",border:"border-util-colors-blue-blue-300"},[c.cyan]:{outer:"border-util-colors-cyan-cyan-500",title:"bg-util-colors-cyan-cyan-100",bg:"bg-util-colors-cyan-cyan-50",border:"border-util-colors-cyan-cyan-300"},[c.green]:{outer:"border-util-colors-green-green-500",title:"bg-util-colors-green-green-100",bg:"bg-util-colors-green-green-50",border:"border-util-colors-green-green-300"},[c.yellow]:{outer:"border-util-colors-yellow-yellow-500",title:"bg-util-colors-yellow-yellow-100",bg:"bg-util-colors-yellow-yellow-50",border:"border-util-colors-yellow-yellow-300"},[c.pink]:{outer:"border-util-colors-pink-pink-500",title:"bg-util-colors-pink-pink-100",bg:"bg-util-colors-pink-pink-50",border:"border-util-colors-pink-pink-300"},[c.violet]:{outer:"border-util-colors-violet-violet-500",title:"bg-util-colors-violet-violet-100",bg:"bg-util-colors-violet-violet-100",border:"border-util-colors-violet-violet-300"}};a.s(["CUSTOM_NOTE_NODE",0,"custom-note","THEME_MAP",0,d],262717)},617633,a=>{"use strict";var b=a.i(288e3),c=a.i(560714);let d=function(a){if(!a||!document.getRootNode)return document;var b,d=Array.isArray(a)?a:[a];return d.every(function(a){var b=(0,c.getTargetElement)(a);return!!b&&b.getRootNode()instanceof ShadowRoot})?(b=(0,c.getTargetElement)(d[0]))?b.getRootNode():document:document};var e=a.i(931572);function f(a,f,g){void 0===g&&(g="click");var h=(0,b.default)(a);(0,e.default)(function(){var a=function(a){(Array.isArray(f)?f:[f]).some(function(b){var d=(0,c.getTargetElement)(b);return!d||d.contains(a.target)})||h.current(a)},b=d(f),e=Array.isArray(g)?g:[g];return e.forEach(function(c){return b.addEventListener(c,a)}),function(){e.forEach(function(c){return b.removeEventListener(c,a)})}},Array.isArray(g)?g:[g],f)}a.s(["useClickAway",()=>f],617633)},68545,284391,962210,307558,a=>{"use strict";var b=a.i(578643);a.s(["BubbleX",()=>b.default],68545);var c=a.i(168015);a.s(["Env",()=>c.default],284391);var d=a.i(901787);a.s(["GlobalVariable",()=>d.default],962210);var e=a.i(184813);a.s(["InputField",()=>e.default],307558)},963284,203187,741107,419164,833970,61820,223529,a=>{"use strict";var b,c=a.i(608061),d=a.i(57843),e=a.i(527344);a.i(73009);var f=a.i(68545),g=a.i(284391),h=a.i(962210);a.i(137550);var i=a.i(307558);a.i(805980);var j=a.i(634919);a.i(275560);var k=a.i(581994),l=a.i(252613),m=((b={}).conversation="conversation",b.environment="env",b.node="node",b.system="sys",b);a.s(["VarInInspectType",()=>m],203187);var n=a.i(986963);let o=(a,b,c)=>(0,d.useMemo)(()=>b?"text-text-warning":"loop"===c?"text-util-colors-cyan-cyan-500":(0,n.isENV)(a)||c===m.environment||"environment"===c?"text-util-colors-violet-violet-600":(0,n.isConversationVar)(a)||c===m.conversation||"conversation"===c?"text-util-colors-teal-teal-700":(0,n.isGlobalVar)(a)||c===m.system?"text-util-colors-orange-orange-600":"text-text-accent",[a,b,c]),p=(0,d.memo)(({className:a,variables:b=[],variableCategory:d})=>{let l="loop"===d?k.Loop:"rag"===d||(0,n.isRagVariableVar)(b)?i.InputField:(0,n.isENV)(b)||d===m.environment||"environment"===d?g.Env:(0,n.isConversationVar)(b)||d===m.conversation||"conversation"===d?f.BubbleX:(0,n.isGlobalVar)(b)||d===m.system?h.GlobalVariable:j.Variable02;return l&&(0,c.jsx)(l,{className:(0,e.cn)("size-3.5 shrink-0",a)})}),q=(0,d.memo)(({isExceptionVariable:a,variableCategory:b,variables:d=[],className:f})=>{let g=o(d,a,b);return(0,c.jsx)(p,{variables:d,variableCategory:b,className:(0,e.cn)(g,f)})});a.s(["default",0,q],741107);var r=a.i(429150),s=a.i(732078),t=a.i(483664);let u=(0,d.memo)(({variables:a,className:b,notShowFullPath:f})=>{let g,h,i,j=(g=l.VAR_SHOW_NAME_MAP[a.join(".")],h=a.slice(1).join("."),(0,n.isRagVariableVar)(a)&&(h=a.slice(2).join(".")),i=(0,d.useMemo)(()=>{h=a.slice(1).join("."),(0,n.isRagVariableVar)(a)&&(h=a.slice(2).join("."));let b=a.length,c=(0,n.isSystemVar)(a),d=f?a[b-1]:h;return`${c?"sys.":""}${d}`},[a,f]),g||i);return(0,c.jsx)("div",{className:(0,e.cn)("system-xs-medium truncate",b),title:j,children:j})});var v=a.i(438961);let w=(0,d.memo)(({nodeType:a,nodeTitle:b})=>a?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(v.VarBlockIcon,{type:a,className:"shrink-0 text-text-secondary"}),b&&(0,c.jsx)("div",{className:"system-xs-medium max-w-[60px] truncate text-text-secondary",title:b,children:b}),(0,c.jsx)("div",{className:"system-xs-regular shrink-0 text-divider-deep",children:"/"})]}):null),x=(0,d.memo)(({nodeType:a,nodeTitle:b,variables:d,variableType:f,className:g,errorMsg:h,onClick:i,isExceptionVariable:j,ref:k,notShowFullPath:l,rightSlot:m})=>{let q=o(d,j),v=!((0,n.isENV)(d)||(0,n.isConversationVar)(d)||(0,n.isGlobalVar)(d)||(0,n.isRagVariableVar)(d));return(0,c.jsxs)("div",{className:(0,e.cn)("inline-flex h-6 max-w-full items-center space-x-0.5 rounded-md border-[0.5px] border-components-panel-border-subtle bg-components-badge-white-to-dark px-1.5 shadow-xs",g),onClick:i,ref:k,children:[v&&(0,c.jsx)(w,{nodeType:a,nodeTitle:b}),l&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(r.RiMoreLine,{className:"h-3 w-3 shrink-0 text-text-secondary"}),(0,c.jsx)("div",{className:"system-xs-regular shrink-0 text-divider-deep",children:"/"})]}),(0,c.jsx)(p,{variables:d,className:q}),(0,c.jsx)(u,{variables:d,className:(0,e.cn)(q),notShowFullPath:l}),!!f&&(0,c.jsx)("div",{className:"system-xs-regular shrink-0 text-text-tertiary",children:(0,s.capitalize)(f)}),!!h&&(0,c.jsx)(t.default,{popupContent:h,asChild:!0,children:(0,c.jsx)(r.RiErrorWarningFill,{className:"h-3 w-3 shrink-0 text-text-destructive"})}),m]})}),y=(0,d.memo)(({isSelected:a,variables:b,errorMsg:d,...f})=>{let{hoverBorderColor:g,hoverBgColor:h,selectedBorderColor:i,selectedBgColor:j}=d?{hoverBorderColor:"hover:border-state-destructive-active",hoverBgColor:"hover:bg-state-destructive-hover",selectedBorderColor:"!border-state-destructive-solid",selectedBgColor:"!bg-state-destructive-hover"}:(0,n.isENV)(b)?{hoverBorderColor:"hover:border-util-colors-violet-violet-100",hoverBgColor:"hover:bg-util-colors-violet-violet-50",selectedBorderColor:"border-util-colors-violet-violet-600",selectedBgColor:"bg-util-colors-violet-violet-50"}:(0,n.isConversationVar)(b)?{hoverBorderColor:"hover:border-util-colors-teal-teal-100",hoverBgColor:"hover:bg-util-colors-teal-teal-50",selectedBorderColor:"border-util-colors-teal-teal-600",selectedBgColor:"bg-util-colors-teal-teal-50"}:{hoverBorderColor:"hover:border-state-accent-alt",hoverBgColor:"hover:bg-state-accent-hover",selectedBorderColor:"border-state-accent-solid",selectedBgColor:"bg-state-accent-hover"};return(0,c.jsx)(x,{className:(0,e.cn)("h-[18px] space-x-[1px] rounded-[5px] px-1 shadow-xs",!a&&h,!a&&g,a&&"border",a&&i,a&&j),variables:b,errorMsg:d,...f})});a.s(["default",0,y],419164);let z=(0,d.memo)(a=>(0,c.jsx)(x,{className:(0,e.cn)("w-full space-x-[1px] bg-workflow-block-parma-bg px-1 shadow-none"),...a}));a.s(["default",0,z],833970);let A=(0,d.memo)(a=>(0,c.jsx)(x,{...a}));a.s(["default",0,A],61820);let B=(0,d.memo)(a=>(0,c.jsx)(x,{className:(0,e.cn)("h-[18px] space-x-[1px] rounded-[5px] px-1 shadow-xs"),...a}));a.s(["default",0,B],223529),a.s([],963284)}];

//# sourceMappingURL=_129c9972._.js.map