module.exports=[546232,181842,117544,a=>{"use strict";var b,c=a.i(314875),d=a.i(57843),e=a.i(384141),f=a.i(429264),g=a.i(936557);let h=function(a){g.default&&!(0,f.isFunction)(a)&&console.error("useMemoizedFn expected parameter is a function, got ".concat(typeof a));var b=(0,d.useRef)(a);b.current=(0,d.useMemo)(function(){return a},[a]);var c=(0,d.useRef)(void 0);return c.current||(c.current=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return b.current.apply(this,a)}),c.current};a.s(["default",0,h],181842);let i=(b=d.useEffect,function(a,c){var e=(0,d.useRef)(!1);b(function(){return function(){e.current=!1}},[]),b(function(){if(e.current)return a();e.current=!0},c)});a.s(["default",0,i],117544);var j="AHOOKS_SYNC_STORAGE_EVENT_NAME";function k(a){return function(b,g){void 0===g&&(g={});var k,l=g.listenStorageChange,m=void 0!==l&&l,n=g.onError,o=void 0===n?function(a){console.error(a)}:n;try{k=a()}catch(a){o(a)}function p(){try{var a=null==k?void 0:k.getItem(b);if(a)return g.deserializer?g.deserializer(a):JSON.parse(a)}catch(a){o(a)}return(0,f.isFunction)(g.defaultValue)?g.defaultValue():g.defaultValue}var q=(0,c.__read)((0,d.useState)(p),2),r=q[0],s=q[1];i(function(){s(p())},[b]);var t=function(a){a.key===b&&a.storageArea===k&&s(p())};return(0,e.default)("storage",t,{enable:m}),(0,e.default)(j,function(a){t(a.detail)},{enable:m}),[r,h(function(a){var c=(0,f.isFunction)(a)?a(r):a;m||s(c);try{var d=void 0,e=null==k?void 0:k.getItem(b);(0,f.isUndef)(c)?(d=null,null==k||k.removeItem(b)):(d=g.serializer?g.serializer(c):JSON.stringify(c),null==k||k.setItem(b,d)),dispatchEvent(new CustomEvent(j,{detail:{key:b,newValue:d,oldValue:e,storageArea:k}}))}catch(a){o(a)}})]}}a.s(["createUseStorageState",()=>k],546232)},411171,a=>{"use strict";var b=a.i(546232),c=a.i(446855),d=(0,b.createUseStorageState)(function(){return c.default?localStorage:void 0});a.s(["useLocalStorageState",0,d],411171)},30652,a=>{a.v({icon:{type:"element",isRootNode:!0,name:"svg",attributes:{width:"16",height:"22",viewBox:"0 0 16 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},children:[{type:"element",name:"path",attributes:{id:"Rectangle 979",d:"M0 0H16L9.91493 16.7339C8.76529 19.8955 5.76063 22 2.39658 22H0V0Z",fill:"white"},children:[]}]},name:"Triangle"})},740923,a=>{"use strict";var b=a.i(608061),c=a.i(429150),d=a.i(57843),e=a.i(555237);a.i(752298);var f=a.i(693025),g=a.i(909795),h=a.i(252813);let i=d.memo(function({isShow:a,title:i,content:j,onConfirm:k,onCancel:l,maskClosable:m=!0,showLink:n,email:o}){let{t:p}=(0,f.useTranslation)(),q=(0,h.useDocLink)(),r=(0,d.useRef)(null),[s,t]=(0,d.useState)(a),u=q("/use-dify/workspace/subscription-management#dify-for-education");(0,d.useEffect)(()=>{let a=a=>{"Escape"===a.key&&l()};return document.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",a)}},[l]);let v=a=>{m&&r.current&&!r.current.contains(a.target)&&l()};return((0,d.useEffect)(()=>(document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}),[m]),(0,d.useEffect)(()=>{if(a)t(!0);else{let a=setTimeout(()=>t(!1),200);return()=>clearTimeout(a)}},[a]),s)?(0,e.createPortal)((0,b.jsx)("div",{className:"fixed inset-0 z-[10000000] flex items-center justify-center bg-background-overlay",onClick:a=>{a.preventDefault(),a.stopPropagation()},children:(0,b.jsx)("div",{ref:r,className:"relative w-full max-w-[481px] overflow-hidden",children:(0,b.jsxs)("div",{className:"shadows-shadow-lg flex max-w-full flex-col items-start rounded-2xl border-[0.5px] border-solid border-components-panel-border bg-components-panel-bg",children:[(0,b.jsxs)("div",{className:"flex flex-col items-start gap-2 self-stretch pb-4 pl-6 pr-6 pt-6",children:[(0,b.jsx)("div",{className:"title-2xl-semi-bold text-text-primary",children:i}),(0,b.jsx)("div",{className:"system-md-regular w-full text-text-tertiary",children:j})]}),o&&(0,b.jsxs)("div",{className:"w-full space-y-1 px-6 py-3",children:[(0,b.jsx)("div",{className:"system-sm-semibold py-1 text-text-secondary",children:p("emailLabel",{ns:"education"})}),(0,b.jsx)("div",{className:"system-sm-regular rounded-lg bg-components-input-bg-disabled px-3 py-2 text-components-input-text-filled-disabled",children:o})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2 self-stretch p-6",children:[(0,b.jsx)("div",{className:"flex items-center gap-1",children:n&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("a",{onClick:()=>{window.open(u,"_blank","noopener,noreferrer")},href:u,target:"_blank",className:"system-xs-regular cursor-pointer text-text-accent",children:p("learn",{ns:"education"})}),(0,b.jsx)(c.RiExternalLinkLine,{className:"h-3 w-3 text-text-accent"})]})}),(0,b.jsx)(g.default,{variant:"primary",className:"!w-20",onClick:k,children:p("operation.ok",{ns:"common"})})]})]})})}),document.body):null});a.s(["default",0,i])},596078,a=>{"use strict";var b=a.i(981133),c=a.i(411171),d=a.i(435133),e=a.i(971335),f=a.i(127406),g=a.i(533306),h=a.i(57843),i=a.i(933887),j=a.i(705134),k=a.i(29255),l=a.i(375616),m=a.i(800034),n=a.i(263477);d.default.extend(f.default),d.default.extend(e.default);let o=(a,b)=>{if(!a||!b)return!1;let c=(0,d.default)().tz(b).startOf("day"),e=d.default.unix(a).tz(b).startOf("day");return c.isSame(e)||c.isAfter(e)};a.s(["useEducation",0,()=>{let{mutateAsync:a,isPending:c,data:d}=(0,m.useEducationAutocomplete)(),[e,f]=(0,h.useState)([]),g=(0,h.useCallback)(b=>{b.keywords&&a(b).then(a=>{let c=b.page||0,d=a.data;c>0?f(a=>[...a||[],...d]):f(d)})},[a]),{run:i}=(0,b.useDebounceFn)(a=>{g(a)},{wait:300});return{schools:e,setSchools:f,querySchoolsWithDebounced:i,handleUpdateSchools:g,isLoading:c,hasNext:d?.has_next}},"useEducationInit",0,()=>{let a=(0,k.useModalContextSelector)(a=>a.setShowAccountSettingModal),b=(0,k.useModalContextSelector)(a=>a.setShowEducationExpireNoticeModal),d=localStorage.getItem(n.EDUCATION_VERIFYING_LOCALSTORAGE_ITEM),e=(0,g.useSearchParams)().get("action");(({onNotice:a})=>{let{userProfile:{timezone:b}}=(0,j.useAppContext)(),{educationAccountExpireAt:d,allowRefreshEducationVerify:e,isLoadingEducationAccountInfo:f}=(0,l.useProviderContext)(),[g,i]=(0,c.useLocalStorageState)("education-reverify-prev-expire-at",{defaultValue:0}),[k,m]=(0,c.useLocalStorageState)("education-reverify-has-noticed",{defaultValue:!1}),[n,p]=(0,c.useLocalStorageState)("education-expired-has-noticed",{defaultValue:!1});return(0,h.useEffect)(()=>{if(!f&&b&&e){let c=o(d,b),e=g!==d;e&&(i(d),m(!1),p(!1)),!e&&(c?n:k)||(a({expireAt:d,expired:c}),c?p(!0):m(!0))}},[e,b]),o(d,b)})({onNotice:a=>{b({payload:a})}});let f=(0,g.useRouter)(),{mutateAsync:p}=(0,m.useEducationVerify)(),q=async()=>{let{token:a}=await p();a&&f.push(`/education-apply?token=${a}`)};(0,h.useEffect)(()=>{("yes"===d||e===n.EDUCATION_VERIFY_URL_SEARCHPARAMS_ACTION)&&(a({payload:i.ACCOUNT_SETTING_TAB.BILLING}),e===n.EDUCATION_VERIFY_URL_SEARCHPARAMS_ACTION&&localStorage.setItem(n.EDUCATION_VERIFYING_LOCALSTORAGE_ITEM,"yes")),e===n.EDUCATION_RE_VERIFY_ACTION&&q()},[a,d,e])}])},987748,a=>{"use strict";var b=a.i(608061),c=a.i(533306),d=a.i(57843),e=a.i(429150),f=a.i(111089);a.i(752298);var g=a.i(693025),h=a.i(909795),i=a.i(168799),j=a.i(114715),k=a.i(263477),l=a.i(252813),m=a.i(375616),n=a.i(800034),o=a.i(161934),p=a.i(527344);let q=({onChange:a,value:c})=>{let{t:d}=(0,g.useTranslation)(),e=[{key:"Student",value:d("form.schoolRole.option.student",{ns:"education"})},{key:"Teacher",value:d("form.schoolRole.option.teacher",{ns:"education"})},{key:"School-Administrator",value:d("form.schoolRole.option.administrator",{ns:"education"})}];return(0,b.jsx)("div",{className:"flex",children:e.map(d=>(0,b.jsxs)("div",{className:"system-md-regular mr-6 flex h-5 cursor-pointer items-center text-text-primary",onClick:()=>a(d.key),children:[(0,b.jsx)("div",{className:(0,p.cn)("mr-2 h-4 w-4 rounded-full border border-components-radio-border bg-components-radio-bg shadow-xs",d.key===c&&"border-[5px] border-components-radio-border-checked ")}),d.value]},d.key))})};var r=a.i(816134),s=a.i(825319),t=a.i(596078);let u=({value:a,onChange:c})=>{let{t:e}=(0,g.useTranslation)(),[f,h]=(0,d.useState)(!1),{schools:i,setSchools:j,querySchoolsWithDebounced:k,handleUpdateSchools:l,hasNext:m}=(0,t.useEducation)(),n=(0,d.useRef)(0),o=(0,d.useRef)(a),p=(0,d.useCallback)(a=>{let b=o.current,c=n.current;a?k({keywords:b,page:c}):l({keywords:b,page:c})},[k,l]),q=(0,d.useCallback)(a=>{h(!0),j([]),n.current=0;let b=a.target.value;o.current=b,c(b),p(!0)},[c,p,j]),u=(0,d.useCallback)(a=>{let{scrollTop:b,scrollHeight:c,clientHeight:d}=a.target;b+d>=c-5&&b>0&&m&&(n.current+=1,p())},[p,m]);return(0,b.jsxs)(s.PortalToFollowElem,{open:f,onOpenChange:h,placement:"bottom",offset:4,triggerPopupSameWidth:!0,children:[(0,b.jsx)(s.PortalToFollowElemTrigger,{className:"block w-full",children:(0,b.jsx)(r.default,{className:"w-full",placeholder:e("form.schoolName.placeholder",{ns:"education"}),value:a,onChange:q})}),(0,b.jsx)(s.PortalToFollowElemContent,{className:"z-[32]",children:!!i.length&&a&&(0,b.jsx)("div",{className:"max-h-[330px] overflow-y-auto rounded-xl border-[0.5px] border-components-panel-border bg-components-panel-bg-blur p-1",onScroll:u,children:i.map((a,d)=>(0,b.jsx)("div",{className:"system-md-regular flex h-8 cursor-pointer items-center truncate rounded-lg px-2 py-1.5 text-text-secondary hover:bg-state-base-hover",title:a,onClick:()=>{c(a),h(!1)},children:a},d))})})]})};var v=a.i(892839),w=a.i(796807),x=a.i(30652);let y=({ref:a,...c})=>(0,b.jsx)(w.default,{...c,ref:a,data:x.default});y.displayName="Triangle";var z=a.i(705134),A=a.i(763539);let B=()=>{let a=(0,c.useRouter)(),{t:d}=(0,g.useTranslation)(),{userProfile:e}=(0,z.useAppContext)(),{mutateAsync:f}=(0,A.useLogout)(),i=async()=>{await f(),localStorage.removeItem("setup_status"),a.push("/signin")};return(0,b.jsxs)("div",{className:"relative flex items-center justify-between rounded-xl border-[4px] border-components-panel-on-panel-item-bg bg-gradient-to-r from-background-gradient-bg-fill-chat-bg-2 to-background-gradient-bg-fill-chat-bg-1 pb-6 pl-6 pr-8 pt-9 shadow-shadow-shadow-5",children:[(0,b.jsxs)("div",{className:"absolute left-0 top-0 flex items-center",children:[(0,b.jsx)("div",{className:"system-2xs-semibold-uppercase flex h-[22px] items-center bg-components-panel-on-panel-item-bg pl-2 pt-1 text-text-accent-light-mode-only",children:d("currentSigned",{ns:"education"})}),(0,b.jsx)(y,{className:"h-[22px] w-4 text-components-panel-on-panel-item-bg"})]}),(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(v.default,{className:"mr-4",avatar:e.avatar_url,name:e.name,size:48}),(0,b.jsxs)("div",{className:"pt-1.5",children:[(0,b.jsx)("div",{className:"system-md-semibold text-text-primary",children:e.name}),(0,b.jsx)("div",{className:"system-sm-regular text-text-secondary",children:e.email})]})]}),(0,b.jsx)(h.default,{variant:"secondary",onClick:i,children:d("userProfile.logout",{ns:"common"})})]})};var C=a.i(740923);let D=()=>{let{t:a}=(0,g.useTranslation)(),[p,r]=(0,d.useState)(""),[s,t]=(0,d.useState)("Student"),[v,w]=(0,d.useState)(!1),[x,y]=(0,d.useState)(!1),{isPending:z,mutateAsync:A}=(0,n.useEducationAdd)({onSuccess:f.noop}),[D,E]=(0,d.useState)(void 0),{onPlanInfoChanged:F}=(0,m.useProviderContext)(),G=(0,n.useInvalidateEducationStatus)(),{notify:H}=(0,j.useToastContext)(),I=(0,c.useRouter)(),J=(0,l.useDocLink)(),K=()=>{E(void 0),F(),G(),localStorage.removeItem(k.EDUCATION_VERIFYING_LOCALSTORAGE_ITEM),I.replace("/")},L=(0,c.useSearchParams)().get("token");return(0,b.jsxs)("div",{className:"fixed inset-0 z-[31] overflow-y-auto bg-background-body p-6",children:[(0,b.jsxs)("div",{className:"mx-auto w-full max-w-[1408px] rounded-2xl border border-effects-highlight bg-background-default-subtle",children:[(0,b.jsx)("div",{className:"h-[349px] w-full overflow-hidden rounded-t-2xl bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url(/education/bg.png)"}}),(0,b.jsx)("div",{className:"mt-[-349px] box-content flex h-7 items-center justify-between p-6",children:(0,b.jsx)(o.default,{size:"large",style:"monochromeWhite"})}),(0,b.jsxs)("div",{className:"mx-auto max-w-[720px] px-8 pb-[180px]",children:[(0,b.jsxs)("div",{className:"mb-2 flex h-[192px] flex-col justify-end pb-4 pt-3 text-text-primary-on-surface",children:[(0,b.jsx)("div",{className:"title-5xl-bold mb-2 shadow-xs",children:a("toVerified",{ns:"education"})}),(0,b.jsxs)("div",{className:"system-md-medium shadow-xs",children:[a("toVerifiedTip.front",{ns:"education"})," ",(0,b.jsx)("span",{className:"system-md-semibold underline",children:a("toVerifiedTip.coupon",{ns:"education"})})," ",a("toVerifiedTip.end",{ns:"education"})]})]}),(0,b.jsx)("div",{className:"mb-7",children:(0,b.jsx)(B,{})}),(0,b.jsxs)("div",{className:"mb-7",children:[(0,b.jsx)("div",{className:"system-md-semibold mb-1 flex h-6 items-center text-text-secondary",children:a("form.schoolName.title",{ns:"education"})}),(0,b.jsx)(u,{value:p,onChange:r})]}),(0,b.jsxs)("div",{className:"mb-7",children:[(0,b.jsx)("div",{className:"system-md-semibold mb-1 flex h-6 items-center text-text-secondary",children:a("form.schoolRole.title",{ns:"education"})}),(0,b.jsx)(q,{value:s,onChange:t})]}),(0,b.jsxs)("div",{className:"mb-7",children:[(0,b.jsx)("div",{className:"system-md-semibold mb-1 flex h-6 items-center text-text-secondary",children:a("form.terms.title",{ns:"education"})}),(0,b.jsxs)("div",{className:"system-md-regular mb-1 text-text-tertiary",children:[a("form.terms.desc.front",{ns:"education"})," ",(0,b.jsx)("a",{href:"https://dify.ai/terms",target:"_blank",className:"text-text-secondary hover:underline",children:a("form.terms.desc.termsOfService",{ns:"education"})})," ",a("form.terms.desc.and",{ns:"education"})," ",(0,b.jsx)("a",{href:"https://dify.ai/privacy",target:"_blank",className:"text-text-secondary hover:underline",children:a("form.terms.desc.privacyPolicy",{ns:"education"})}),a("form.terms.desc.end",{ns:"education"})]}),(0,b.jsxs)("div",{className:"system-md-regular py-2 text-text-primary",children:[(0,b.jsxs)("div",{className:"mb-2 flex",children:[(0,b.jsx)(i.default,{className:"mr-2 shrink-0",checked:v,onCheck:()=>w(!v)}),a("form.terms.option.age",{ns:"education"})]}),(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)(i.default,{className:"mr-2 shrink-0",checked:x,onCheck:()=>y(!x)}),a("form.terms.option.inSchool",{ns:"education"})]})]})]}),(0,b.jsx)(h.default,{variant:"primary",disabled:!v||!x||!p||!s||z,onClick:()=>{A({token:L||"",role:s,institution:p}).then(b=>{"success"===b.message?E({title:a("successTitle",{ns:"education"}),desc:a("successContent",{ns:"education"}),onConfirm:K}):H({type:"error",message:a("submitError",{ns:"education"})})})},children:a("submit",{ns:"education"})}),(0,b.jsx)("div",{className:"mb-4 mt-5 h-px bg-gradient-to-r from-[rgba(16,24,40,0.08)]"}),(0,b.jsxs)("a",{className:"system-xs-regular flex items-center text-text-accent",href:J("/use-dify/workspace/subscription-management#dify-for-education"),target:"_blank",children:[a("learn",{ns:"education"}),(0,b.jsx)(e.RiExternalLinkLine,{className:"ml-1 h-3 w-3"})]})]})]}),(0,b.jsx)(C.default,{isShow:!!D,title:D?.title||"",content:D?.desc,onConfirm:D?.onConfirm||f.noop,onCancel:D?.onConfirm||f.noop})]})};function E(){let a=(0,c.useRouter)(),{enableEducationPlan:e}=(0,m.useProviderContext)(),f=(0,c.useSearchParams)().get("token"),g=(0,d.useMemo)(()=>e&&f,[e,f]);return(0,d.useEffect)(()=>{g||a.replace("/")},[g,a]),(0,b.jsx)(D,{})}a.s(["default",()=>E],987748)}];

//# sourceMappingURL=_81714b4f._.js.map