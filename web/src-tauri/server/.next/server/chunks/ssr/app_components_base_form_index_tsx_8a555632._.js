module.exports=[433225,a=>{"use strict";a.s(["formContext",()=>Q,"useAppForm",()=>S,"useFieldContext",()=>P,"useFormContext",()=>R,"withForm",()=>T],433225);var b=a.i(608061),c=a.i(57843),d=a.i(45936),e=a.i(53952),f=a.i(559423),g=a.i(156458);class h{constructor(a){if(this.getFormFieldName=a=>{if("string"==typeof this.fieldsMap)return(0,g.concatenatePaths)(this.fieldsMap,a);let b=(0,g.makePathArray)(a)[0];if("string"!=typeof b)return"";let c=a.slice(b.length),d=this.fieldsMap[b];return(0,g.concatenatePaths)(d,c)},this.getFormFieldOptions=a=>{let b={...a},c=b.validators;if(b.name=this.getFormFieldName(a.name),c&&(c.onChangeListenTo||c.onBlurListenTo)){let a={...c},d=a=>{if(a)return a.map(a=>this.getFormFieldName(a))};a.onChangeListenTo=d(c.onChangeListenTo),a.onBlurListenTo=d(c.onBlurListenTo),b.validators=a}return b},this.mount=()=>this.store.mount(),this.validateArrayFieldsStartingFrom=async(a,b,c)=>this.form.validateArrayFieldsStartingFrom(this.getFormFieldName(a),b,c),this.validateField=(a,b)=>this.form.validateField(this.getFormFieldName(a),b),this.getFieldValue=a=>this.form.getFieldValue(this.getFormFieldName(a)),this.getFieldMeta=a=>this.form.getFieldMeta(this.getFormFieldName(a)),this.setFieldMeta=(a,b)=>this.form.setFieldMeta(this.getFormFieldName(a),b),this.setFieldValue=(a,b,c)=>this.form.setFieldValue(this.getFormFieldName(a),b,c),this.deleteField=a=>this.form.deleteField(this.getFormFieldName(a)),this.pushFieldValue=(a,b,c)=>this.form.pushFieldValue(this.getFormFieldName(a),b,c),this.insertFieldValue=async(a,b,c,d)=>this.form.insertFieldValue(this.getFormFieldName(a),b,c,d),this.replaceFieldValue=async(a,b,c,d)=>this.form.replaceFieldValue(this.getFormFieldName(a),b,c,d),this.removeFieldValue=async(a,b,c)=>this.form.removeFieldValue(this.getFormFieldName(a),b,c),this.swapFieldValues=(a,b,c,d)=>this.form.swapFieldValues(this.getFormFieldName(a),b,c,d),this.moveFieldValues=(a,b,c,d)=>this.form.moveFieldValues(this.getFormFieldName(a),b,c,d),this.clearFieldValues=(a,b)=>this.form.clearFieldValues(this.getFormFieldName(a),b),this.resetField=a=>this.form.resetField(this.getFormFieldName(a)),this.validateAllFields=a=>this.form.validateAllFields(a),a.form instanceof h){const b=a.form;if(this.form=b.form,"string"==typeof a.fields)this.fieldsMap=b.getFormFieldName(a.fields);else{const c={...a.fields};for(const a in c)c[a]=b.getFormFieldName(c[a]);this.fieldsMap=c}}else this.form=a.form,this.fieldsMap=a.fields;this.store=new f.Derived({deps:[this.form.store],fn:({currDepVals:a})=>{let b,c=a[0];if("string"==typeof this.fieldsMap)b=(0,g.getBy)(c.values,this.fieldsMap);else{b={};let a=this.fieldsMap;for(let d in a)b[d]=(0,g.getBy)(c.values,a[d])}return{values:b}}})}get state(){return this.store.state}async handleSubmit(a){return this.form.handleSubmit(a)}}var i=a.i(57089);function j({lens:a,selector:b,children:c}){let d=(0,e.useStore)(a.store,b);return(0,g.functionalUpdate)(c,d)}let k=(0,c.createContext)(null),l=(0,c.createContext)(null);var m=a.i(527344),n=a.i(168799),o=a.i(962037);a.i(752298);var p=a.i(693025),q=a.i(483664);let r=({htmlFor:a,label:c,isRequired:d,showOptional:e,tooltip:f,className:g})=>{let{t:h}=(0,p.useTranslation)();return(0,b.jsxs)("div",{className:"flex h-6 items-center",children:[(0,b.jsx)("label",{"data-testid":"label",htmlFor:a,className:(0,m.cn)("system-sm-medium text-text-secondary",g),children:c}),!d&&e&&(0,b.jsx)("div",{className:"system-xs-regular ml-1 text-text-tertiary",children:h("label.optional",{ns:"common"})}),d&&(0,b.jsx)("div",{className:"system-xs-regular ml-1 text-text-destructive-secondary",children:"*"}),f&&(0,b.jsx)(q.default,{popupContent:(0,b.jsx)("div",{className:"w-[200px]",children:f}),triggerClassName:"ml-0.5 w-4 h-4",triggerTestId:`${a}-tooltip`})]})};var s=a.i(583252),t=a.i(735310),u=a.i(917307),v=a.i(429150),w=a.i(827460);let x=a.i(680904).z.enum(["text-input","paragraph","number","select","checkbox","file","file-list"]),y={"text-input":"text-input",paragraph:"paragraph",number:"number",select:"select",checkbox:"checkbox",file:"single-file","file-list":"multi-files"},z={[w.PipelineInputVarType.textInput]:v.RiTextSnippet,[w.PipelineInputVarType.paragraph]:v.RiAlignLeft,[w.PipelineInputVarType.number]:v.RiHashtag,[w.PipelineInputVarType.select]:v.RiListCheck3,[w.PipelineInputVarType.checkbox]:v.RiCheckboxLine,[w.PipelineInputVarType.singleFile]:v.RiFileTextLine,[w.PipelineInputVarType.multiFiles]:v.RiFileCopy2Line},A={[w.PipelineInputVarType.textInput]:"string",[w.PipelineInputVarType.paragraph]:"string",[w.PipelineInputVarType.number]:"number",[w.PipelineInputVarType.select]:"string",[w.PipelineInputVarType.checkbox]:"boolean",[w.PipelineInputVarType.singleFile]:"file",[w.PipelineInputVarType.multiFiles]:"array[file]"};var B=a.i(218865);let C=c.memo(({option:a})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(a.Icon,{className:"h-4 w-4 shrink-0 text-text-tertiary"}),(0,b.jsx)("span",{className:"grow px-1",children:a.label}),(0,b.jsx)(B.default,{text:a.type,uppercase:!1})]})),D=c.memo(({option:a,open:c})=>{let{t:d}=(0,p.useTranslation)();return(0,b.jsxs)(b.Fragment,{children:[a?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(a.Icon,{className:"h-4 w-4 shrink-0 text-text-tertiary"}),(0,b.jsx)("span",{className:"grow p-1",children:a.label}),(0,b.jsx)("div",{className:"pr-0.5",children:(0,b.jsx)(B.default,{text:a.type,uppercase:!1})})]}):(0,b.jsx)("span",{className:"grow p-1",children:d("placeholder.select",{ns:"common"})}),(0,b.jsx)(v.RiArrowDownSLine,{className:(0,m.cn)("h-4 w-4 shrink-0 text-text-quaternary group-hover:text-text-secondary",c&&"text-text-secondary")})]})});var E=a.i(644734),F=a.i(294318),G=a.i(138464),H=a.i(166102),I=a.i(816134),J=a.i(146172),K=a.i(335913),L=a.i(954200),M=a.i(597209),N=a.i(909795);let{fieldContext:O,useFieldContext:P,formContext:Q,useFormContext:R}={fieldContext:k,useFieldContext:function(){let a=(0,c.useContext)(k);if(!a)throw Error("`fieldContext` only works when within a `fieldComponent` passed to `createFormHook`");return a},useFormContext:function(){let a=(0,c.useContext)(l);if(!a)throw Error("`formContext` only works when within a `formComponent` passed to `createFormHook`");return a},formContext:l},{useAppForm:S,withForm:T}=function({fieldComponents:a,fieldContext:e,formContext:f,formComponents:g}){return{useAppForm:function(h){let i=(0,d.useForm)(h),j=(0,c.useMemo)(()=>({children:a})=>(0,b.jsx)(f.Provider,{value:i,children:a}),[i]),k=(0,c.useMemo)(()=>({children:c,...d})=>(0,b.jsx)(i.Field,{...d,children:d=>(0,b.jsx)(e.Provider,{value:d,children:c(Object.assign(d,a))})}),[i]);return(0,c.useMemo)(()=>Object.assign(i,{AppField:k,AppForm:j,...g}),[i,k,j])},withForm:function({render:a,props:b}){return c=>a({...b,...c})},withFieldGroup:function({render:a,props:d,defaultValues:e}){return function(f){let k=function(a){let[d]=(0,c.useState)(()=>{let c=new h(a),e=a.form instanceof h?a.form.form:a.form;return c.AppForm=function(a){return(0,b.jsx)(e.AppForm,{...a})},c.AppField=function(a){return(0,b.jsx)(e.AppField,{...d.getFormFieldOptions(a)})},c.Field=function(a){return(0,b.jsx)(e.Field,{...d.getFormFieldOptions(a)})},c.Subscribe=function(a){return(0,b.jsx)(j,{lens:d,selector:a.selector,children:a.children})},Object.assign(c,{...a.formComponents})});return(0,i.useIsomorphicLayoutEffect)(d.mount,[d]),d}((0,c.useMemo)(()=>({form:f.form,fields:f.fields,defaultValues:e,formComponents:g}),[f.form,f.fields]));return a({...d,...f,group:k})}}}}({fieldComponents:{TextField:({label:a,labelOptions:c,className:d,...e})=>{let f=P();return(0,b.jsxs)("div",{className:(0,m.cn)("flex flex-col gap-y-0.5",d),children:[(0,b.jsx)(r,{htmlFor:f.name,label:a,...c??{}}),(0,b.jsx)(I.default,{id:f.name,value:f.state.value,onChange:a=>f.handleChange(a.target.value),onBlur:f.handleBlur,...e})]})},TextAreaField:({label:a,labelOptions:c,className:d,...e})=>{let f=P();return(0,b.jsxs)("div",{className:(0,m.cn)("flex flex-col gap-y-0.5",d),children:[(0,b.jsx)(r,{htmlFor:f.name,label:a,...c??{}}),(0,b.jsx)(J.default,{id:f.name,value:f.state.value,onChange:a=>f.handleChange(a.target.value),onBlur:f.handleBlur,...e})]})},NumberInputField:({label:a,labelOptions:c,className:d,...e})=>{let f=P();return(0,b.jsxs)("div",{className:(0,m.cn)("flex flex-col gap-y-0.5",d),children:[(0,b.jsx)(r,{htmlFor:f.name,label:a,...c??{}}),(0,b.jsx)(E.InputNumber,{id:f.name,value:f.state.value,onChange:a=>f.handleChange(a),onBlur:f.handleBlur,...e})]})},CheckboxField:({label:a,labelClassName:c})=>{let d=P();return(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("div",{className:"flex h-6 shrink-0 items-center",children:(0,b.jsx)(n.default,{id:d.name,checked:d.state.value,onCheck:()=>{d.handleChange(!d.state.value)}})}),(0,b.jsx)("label",{htmlFor:d.name,className:(0,m.cn)("system-sm-medium grow cursor-pointer pt-1 text-text-secondary",c),onClick:()=>{d.handleChange(!d.state.value)},children:a})]})},SelectField:({label:a,labelOptions:c,options:d,onChange:e,className:f,...g})=>{let h=P();return(0,b.jsxs)("div",{className:(0,m.cn)("flex flex-col gap-y-0.5",f),children:[(0,b.jsx)(r,{htmlFor:h.name,label:a,...c??{}}),(0,b.jsx)(H.default,{value:h.state.value,options:d,onChange:a=>{h.handleChange(a),e?.(a)},...g})]})},CustomSelectField:({label:a,labelOptions:c,options:d,className:e,...f})=>{let g=P();return(0,b.jsxs)("div",{className:(0,m.cn)("flex flex-col gap-y-0.5",e),children:[(0,b.jsx)(r,{htmlFor:g.name,label:a,...c??{}}),(0,b.jsx)(o.default,{value:g.state.value,options:d,onChange:a=>g.handleChange(a),...f})]})},OptionsField:({label:a,className:c,labelOptions:d})=>{let e=P();return(0,b.jsxs)("div",{className:(0,m.cn)("flex flex-col gap-y-0.5",c),children:[(0,b.jsx)(r,{htmlFor:e.name,label:a,...d??{}}),(0,b.jsx)(G.default,{options:e.state.value,onChange:a=>e.handleChange(a)})]})},InputTypeSelectField:({label:a,labelOptions:d,supportFile:e,className:f,...g})=>{let h=P(),i=(a=>{let{t:b}=(0,p.useTranslation)();return(a?x.options:x.exclude(["file","file-list"]).options).map(a=>({value:a,label:b(`variableConfig.${y[a]}`,{ns:"appDebug"}),Icon:z[a],type:A[a]}))})(e),j=(0,c.useCallback)((a,c)=>(0,b.jsx)(D,{option:a,open:c}),[]),k=(0,c.useCallback)(a=>(0,b.jsx)(C,{option:a}),[]);return(0,b.jsxs)("div",{className:(0,m.cn)("flex flex-col gap-y-0.5",f),children:[(0,b.jsx)(r,{htmlFor:h.name,label:a,...d??{}}),(0,b.jsx)(o.default,{value:h.state.value,options:i,onChange:a=>h.handleChange(a),triggerProps:{className:"gap-x-0.5"},popupProps:{className:"w-[368px]",wrapperClassName:"z-[9999999]",itemClassName:"gap-x-1"},CustomTrigger:j,CustomOption:k,...g})]})},FileTypesField:({label:a,labelOptions:d,className:e})=>{let f=P(),g=(0,c.useCallback)(a=>{let b=[...f.state.value.allowedFileTypes];a===t.SupportUploadFileTypes.custom?b=b.includes(t.SupportUploadFileTypes.custom)?b.filter(b=>b!==a):[t.SupportUploadFileTypes.custom]:(b=b.filter(a=>a!==t.SupportUploadFileTypes.custom)).includes(a)?b=b.filter(b=>b!==a):b.push(a),f.handleChange({...f.state.value,allowedFileTypes:b})},[f]),h=(0,c.useCallback)(a=>{f.handleChange({...f.state.value,allowedFileExtensions:a})},[f]);return(0,b.jsxs)("div",{className:(0,m.cn)("flex flex-col gap-y-0.5",e),children:[(0,b.jsx)(r,{htmlFor:f.name,label:a,...d??{}}),[t.SupportUploadFileTypes.document,t.SupportUploadFileTypes.image,t.SupportUploadFileTypes.audio,t.SupportUploadFileTypes.video].map(a=>(0,b.jsx)(s.default,{type:a,selected:f.state.value.allowedFileTypes.includes(a),onToggle:g},a)),(0,b.jsx)(s.default,{type:t.SupportUploadFileTypes.custom,selected:f.state.value.allowedFileTypes.includes(t.SupportUploadFileTypes.custom),onToggle:g,customFileTypes:f.state.value.allowedFileExtensions,onCustomFileTypesChange:h})]})},UploadMethodField:({label:a,labelOptions:d,className:e})=>{let{t:f}=(0,p.useTranslation)(),g=P(),{value:h}=g.state,i=(0,c.useCallback)(a=>{g.handleChange(a===L.TransferMethod.all?[L.TransferMethod.local_file,L.TransferMethod.remote_url]:[a])},[g]);return(0,b.jsxs)("div",{className:(0,m.cn)("flex flex-col gap-y-0.5",e),children:[(0,b.jsx)(r,{htmlFor:g.name,label:a,...d??{}}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,b.jsx)(K.default,{title:f("variableConfig.localUpload",{ns:"appDebug"}),selected:1===h.length&&h.includes(L.TransferMethod.local_file),onSelect:i.bind(null,L.TransferMethod.local_file)}),(0,b.jsx)(K.default,{title:"URL",selected:1===h.length&&h.includes(L.TransferMethod.remote_url),onSelect:i.bind(null,L.TransferMethod.remote_url)}),(0,b.jsx)(K.default,{title:f("variableConfig.both",{ns:"appDebug"}),selected:h.includes(L.TransferMethod.local_file)&&h.includes(L.TransferMethod.remote_url),onSelect:i.bind(null,L.TransferMethod.all)})]})]})},NumberSliderField:({label:a,labelOptions:c,description:d,className:e,...f})=>{let g=P();return(0,b.jsxs)("div",{className:(0,m.cn)("flex flex-col gap-y-0.5",e),children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(r,{htmlFor:g.name,label:a,...c??{}}),d&&(0,b.jsx)("div",{className:"body-xs-regular pb-0.5 text-text-tertiary",children:d})]}),(0,b.jsx)(F.default,{value:g.state.value,onChange:a=>g.handleChange(a),...f})]})},VariableOrConstantInputField:({className:a,label:c,labelOptions:d})=>(0,b.jsxs)("div",{className:(0,m.cn)("flex flex-col gap-y-0.5",a),children:[(0,b.jsx)(r,{htmlFor:"variable-or-constant",label:c,...d??{}}),(0,b.jsx)("div",{className:"flex items-center",children:(0,b.jsx)(M.default,{className:"grow",nodeId:"",readonly:!1,value:[],onChange:()=>{}})})]}),FileUploaderField:({label:a,labelOptions:c,className:d,...e})=>{let f=P();return(0,b.jsxs)("div",{className:(0,m.cn)("flex flex-col gap-y-0.5",d),children:[(0,b.jsx)(r,{htmlFor:f.name,label:a,...c??{}}),(0,b.jsx)(u.default,{value:f.state.value,onChange:a=>f.handleChange(a),...e})]})}},formComponents:{Actions:({CustomActions:a})=>{let{t:c}=(0,p.useTranslation)(),d=R(),[f,g]=(0,e.useStore)(d.store,a=>[a.isSubmitting,a.canSubmit]);return a?a({form:d,isSubmitting:f,canSubmit:g}):(0,b.jsx)(N.default,{variant:"primary",disabled:f||!g,loading:f,onClick:()=>d.handleSubmit(),children:c("operation.submit",{ns:"common"})})}},fieldContext:O,formContext:Q})}];

//# sourceMappingURL=app_components_base_form_index_tsx_8a555632._.js.map